var VidyoConnector=function(){var cameraPrivacy,viewId,roomname,username,currentCallback,platformInfo={},initialized=!1,loaded=!1;return function(eventHandler){window.addEventListener?window.addEventListener("message",eventHandler,!1):window.attachEvent&&window.attachEvent("onmessage",eventHandler)}(function(msg){if(console.log("vidyoConnector.listener received event",msg),msg&&"string"==typeof msg.data&&msg.data.startsWith("{"))try{var data=JSON.parse(msg.data);data&&"VIDYO"===data.type&&"CONNECTED"===data.event&&(initialized=!0,currentCallback&&currentCallback())}catch(e){console.error("vidyoConnector.listener unable to process message",msg,e)}}),{loadPlatformInfo:function(){var userAgent=navigator.userAgent||navigator.vendor||window.opera;platformInfo.isOpera=-1!=userAgent.indexOf("Opera")||-1!=userAgent.indexOf("OPR"),platformInfo.isFirefox=-1!=userAgent.indexOf("Firefox")||-1!=userAgent.indexOf("FxiOS"),platformInfo.isChrome=-1!=userAgent.indexOf("Chrome")||-1!=userAgent.indexOf("CriOS"),platformInfo.isSafari=!platformInfo.isFirefox&&!platformInfo.isChrome&&-1!=userAgent.indexOf("Safari"),platformInfo.isAppleWebKit=!platformInfo.isSafari&&!platformInfo.isFirefox&&!platformInfo.isChrome&&-1!=userAgent.indexOf("AppleWebKit"),platformInfo.isIE=-1!=userAgent.indexOf("MSIE")||1==!!document.documentMode,platformInfo.isEdge=!platformInfo.isIE&&!!window.StyleMedia,platformInfo.isMac=navigator.platform.indexOf("Mac")>-1,platformInfo.isWin=navigator.platform.indexOf("Win")>-1,platformInfo.isLinux=navigator.platform.indexOf("Linux")>-1,platformInfo.isiOS=-1!=userAgent.indexOf("iPad")||-1!=userAgent.indexOf("iPhone"),platformInfo.isAndroid=userAgent.indexOf("android")>-1,platformInfo.isElectron="object"==typeof process&&process.versions&&void 0!==process.versions.electron,platformInfo.isWebRTCAvailable=!!(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||(navigator.mediaDevices?navigator.mediaDevices.getUserMedia:void 0)),platformInfo.is64bit=navigator.userAgent.indexOf("WOW64")>-1||navigator.userAgent.indexOf("Win64")>-1||"Win64"==window.navigator.platform},connect:function(host,token,roomname_,username_,localViewId_,remoteViewId_,callback,camera,microphone){roomname=roomname_,username=username_,viewId=localViewId_||remoteViewId_,cameraPrivacy=!localViewId_,currentCallback=callback,loaded=!0;var src="/loadCam4Vidyo?token="+encodeURIComponent(token)+"&resourceId="+encodeURIComponent(roomname)+"&displayName="+encodeURIComponent(username)+"&autoJoin=1";cameraPrivacy&&(src+="&cameraPrivacy=1&microphonePrivacy=1&hideConfig=1"),$("#vidyoPlayer").show(),$("#"+viewId).empty(),$("#"+viewId).append('<iframe id="vidyoFrame" frameborder="0" width="100%"  height="100%" allow="camera, microphone" allowfullscreen="true" src=""></iframe>'),$("#vidyoFrame").css("max-height","100%"),$("#vidyoFrame").css("width","100%"),$("#vidyoFrame").attr("src",src),$("#signalStrength").hide(),$("#broadcastResolutionControl").hide(),$("#slider").hide(),$("#privateModeMenu").hide(),$("#androidUnmuteLinkOverlay").hide(),$("#speakers").find("option").remove(),$("#cameras").find("option").remove(),$("#microphones").find("option").remove(),$("#vidyoControls").show()},disconnect:function(){console.log("disconnecting...."),currentCallback=null,$("#vidyoFrame").attr("src",""),$("#signalStrength").show(),$("#broadcastResolutionControl").show(),$("#vidyoPlayer").hide(),$("#vidyoControls").hide(),$("#slider").show(),$("#privateModeMenu").show(),"undefind"!=typeof ChatlessPlayer&&ChatlessPlayer.volume&&ChatlessPlayer.volume.setExternalClickHandler(void 0),initialized=!1,loaded=!1},isLoaded:function(){return loaded},isInitialized:function(){return initialized},isAvailable:function(){return platformInfo&&platformInfo.isWebRTCAvailable},isEdgeBrowser:function(){return platformInfo&&platformInfo.isEdge},isSafariBrowser:function(){return platformInfo&&platformInfo.isSafari}}}();$(function(){VidyoConnector.loadPlatformInfo()});
