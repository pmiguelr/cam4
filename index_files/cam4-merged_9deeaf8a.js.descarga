var BrowserDetect={uniqueProps:[],browserUID:"",browserFonts:"",isIPhonePad:function(){return navigator.userAgent.match(/iPhone|iPod/i)},isIPhone:function(){return navigator.userAgent.match(/iPhone/i)},isDesktop:function(){return!navigator.userAgent.match(/iPhone|iPad|android/i)},isAndroid:function(){return navigator.userAgent.match(/android/i)},isFirefox:function(){return navigator.userAgent.match(/firefox/i)},isIOS7:function(){return navigator.userAgent.match(/.*CPU.*OS 7_\d/i)},isChromeCrios:function(){return navigator.userAgent.match(/chrome|crios/i)},isIPad:function(){return navigator.userAgent.match(/iPad/i)},isXPSP2:function(){return-1!==window.navigator.userAgent.indexOf("SV1")},isIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream},isMSIE:function(){var ua=window.navigator.userAgent,msie=ua.indexOf("MSIE ");if(msie>0)return parseInt(ua.substring(msie+5,ua.indexOf(".",msie)),10);if(ua.indexOf("Trident/")>0){var rv=ua.indexOf("rv:");return parseInt(ua.substring(rv+3,ua.indexOf(".",rv)),10)}var edge=ua.indexOf("Edge/");return edge>0&&parseInt(ua.substring(edge+5,ua.indexOf(".",edge)),10)},isPhoneDevice:function(){return navigator.userAgent.match(/iPhone|android/i)},isChrome:function(){return!!window.chrome},isTabletAndroidFirefox:function(){return/(?:Android; Tablet).*(?:Firefox\/)/i.test(navigator.userAgent)},isWindowsPhone:function(){return/IEMobile/.test(navigator.userAgent)},isIphoneSafari:function(){var safari=!!window.safari;return!(!/iPhone/i.test(navigator.userAgent)||!safari)},isSafari:function(){return!!window.safari},isOpera:function(){return!!window.opr&&!!opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0},isIDevice:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},isFirefoxVersion:function(version){return-1!==navigator.userAgent.toLowerCase().indexOf("firefox/"+version)},getAndroidVersion:function(){var match=navigator.userAgent.match(/Android\s([0-9\.]*)/);return!!match&&match[1]},getIPadVersion:function(){return navigator.userAgent.match(/(?:iPad);.*CPU.*(?:OS (.*)_)\d/i)},getIEVer:function(){var ua=navigator.userAgent,b=ua.indexOf("MSIE ");return b<0?0:parseFloat(ua.substring(b+5,ua.indexOf(";",b)))},getBrowserUID:function(){function putData(string){string+="",BrowserDetect.uniqueProps.indexOf(string)<0&&(BrowserDetect.uniqueProps.push(string),BrowserDetect.browserUID+=""+string)}var stringType="string",numberType="number";if(BrowserDetect.browserUID="",BrowserDetect.uniqueProps=[],window.navigator&&window.navigator.plugins)for(var i in window.navigator.plugins){var plugin=window.navigator.plugins[i];for(var j in plugin)typeof plugin[j]===stringType?(putData(j),putData(plugin[j])):function(object){for(var i in object)typeof object[i]===stringType||typeof object[i]===numberType?(putData(i),putData(object[i])):putData(i+"")}(plugin[j])}return putData(BrowserDetect.browserFonts),BrowserDetect.browserUID=BrowserDetect.browserUID.replace(/\s/g,""),"undefined"!=typeof Cam4Event&&Cam4Event.dispatch("onBrowserUidGenerated"),md5(BrowserDetect.browserUID)},init:function(){try{this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version",this.OS=this.searchString(this.dataOS)||"an unknown OS",this.browser=this.searchString(this.dataBrowser)||"An unknown browser"}catch(ex){console.log("Init exception: ",ex)}if(!(!navigator.userAgent.match(/Trident/)||navigator.userAgent.match(/MSIE/))&&(BrowserDetect.browser="Explorer",!(!navigator.userAgent.match(/Trident/)||!navigator.userAgent.match(/11/))&&(BrowserDetect.version=11)),"Chrome"===BrowserDetect.browser&&"an unknown version"===BrowserDetect.version){var version=navigator.userAgent||navigator.appVersion;if((version=version.split("Chrome"))[1]){var matches=version[1].match(/\d+/);matches[0]&&(BrowserDetect.version=parseInt(matches[0]))}}return 0},searchString:function(data){for(var i=0;i<data.length;i++){var dataString=data[i].string,dataProp=data[i].prop;if(this.versionSearchString=data[i].versionSearch||data[i].identity,dataString){if(-1!=dataString.indexOf(data[i].subString))return data[i].identity}else if(dataProp)return data[i].identity}},searchVersion:function(dataString){var index=dataString.indexOf(this.versionSearchString);if(-1!==index)return parseFloat(dataString.substring(index+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"iCab",versionSearch:"iCab",identity:"iCab"},{string:navigator.userAgent,subString:"rekonq",versionSearch:"rekonq",identity:"Rekonq"},{string:navigator.userAgent,subString:"Midori",versionSearch:"Midori",identity:"Midori"},{string:navigator.userAgent,subString:"Arora",versionSearch:"Arora",identity:"Arora"},{string:navigator.userAgent,subString:"Stainless",versionSearch:"Stainless",identity:"Stainless"},{string:navigator.userAgent,subString:"Epiphany",versionSearch:"Epiphany",identity:"Epiphany"},{string:navigator.userAgent,subString:"K-Meleon",versionSearch:"K-Meleon",identity:"K-Meleon"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Maxthon",versionSearch:"Maxthon",identity:"Maxthon"},{string:navigator.userAgent,subString:"SeaMonkey",versionSearch:"SeaMonkey",identity:"SeaMonkey"},{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone"},{string:navigator.userAgent,subString:"iPad",identity:"iPad"},{string:navigator.userAgent,subString:"Android",identity:"Android"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};BrowserDetect.init();var detectDevice=function(){return BrowserDetect.isIPhone()?"iPhone":BrowserDetect.isIPad()?"iPad":BrowserDetect.isAndroid()?"Android":!!BrowserDetect.isWindowsPhone()&&"Windows Phone"};
!function(){function n(a){return void 0!==a}function ba(){}function ca(a){a.ub=function(){return a.uf?a.uf:a.uf=new a}}function da(a){var b=typeof a;if("object"==b){if(!a)return"null";if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&void 0!==a.splice&&void 0!==a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||void 0!==a.call&&void 0!==a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else if("function"==b&&void 0===a.call)return"object";return b}function ea(a){return"array"==da(a)}function fa(a){var b=da(a);return"array"==b||"object"==b&&"number"==typeof a.length}function p(a){return"string"==typeof a}function ga(a){return"number"==typeof a}function ha(a){return"function"==da(a)}function ia(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}function ja(a,b,c){return a.call.apply(a.bind,arguments)}function ka(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(c,d),a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function q(a,b,c){return(q=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ja:ka).apply(null,arguments)}function ma(a,b){function c(){}c.prototype=b.prototype,a.bh=b.prototype,a.prototype=new c,a.prototype.constructor=a,a.Yg=function(a,c,f){for(var h=Array(arguments.length-2),k=2;k<arguments.length;k++)h[k-2]=arguments[k];return b.prototype[c].apply(a,h)}}function r(a,b){for(var c in a)b.call(void 0,a[c],c,a)}function na(a,b){var d,c={};for(d in a)c[d]=b.call(void 0,a[d],d,a);return c}function oa(a,b){for(var c in a)if(!b.call(void 0,a[c],c,a))return!1;return!0}function pa(a){var c,b=0;for(c in a)b++;return b}function qa(a){for(var b in a)return b}function ra(a){var d,b=[],c=0;for(d in a)b[c++]=a[d];return b}function sa(a){var d,b=[],c=0;for(d in a)b[c++]=d;return b}function ta(a,b){for(var c in a)if(a[c]==b)return!0;return!1}function ua(a,b,c){for(var d in a)if(b.call(c,a[d],d,a))return d}function va(a,b){var c=ua(a,b,void 0);return c&&a[c]}function wa(a){for(var b in a)return!1;return!0}function xa(a){var c,b={};for(c in a)b[c]=a[c];return b}function za(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<ya.length;f++)c=ya[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}}function Aa(a){if(a=String(a),/^\s*$/.test(a)?0:/^[\],:{}\s\u2028\u2029]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r\u2028\u2029\x00-\x08\x0a-\x1f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,"")))try{return eval("("+a+")")}catch(b){}throw Error("Invalid JSON string: "+a)}function Ba(){this.Sd=void 0}function Ca(a,b,c){switch(typeof b){case"string":Da(b,c);break;case"number":c.push(isFinite(b)&&!isNaN(b)?b:"null");break;case"boolean":c.push(b);break;case"undefined":c.push("null");break;case"object":if(null==b){c.push("null");break}if(ea(b)){var d=b.length;c.push("[");for(var e="",f=0;f<d;f++)c.push(e),e=b[f],Ca(a,a.Sd?a.Sd.call(b,String(f),e):e,c),e=",";c.push("]");break}c.push("{"),d="";for(f in b)Object.prototype.hasOwnProperty.call(b,f)&&"function"!=typeof(e=b[f])&&(c.push(d),Da(f,c),c.push(":"),Ca(a,a.Sd?a.Sd.call(b,f,e):e,c),d=",");c.push("}");break;case"function":break;default:throw Error("Unknown type: "+typeof b)}}function Da(a,b){b.push('"',a.replace(Fa,function(a){if(a in Ea)return Ea[a];var b=a.charCodeAt(0),e="\\u";return 16>b?e+="000":256>b?e+="00":4096>b&&(e+="0"),Ea[a]=e+b.toString(16)}),'"')}function Ga(){return Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^la()).toString(36)}function Ka(){this.Va=-1}function La(){this.Va=-1,this.Va=64,this.N=[],this.me=[],this.Wf=[],this.Ld=[],this.Ld[0]=128;for(var a=1;a<this.Va;++a)this.Ld[a]=0;this.de=this.ac=0,this.reset()}function Ma(a,b,c){c||(c=0);var d=a.Wf;if(p(b))for(e=0;16>e;e++)d[e]=b.charCodeAt(c)<<24|b.charCodeAt(c+1)<<16|b.charCodeAt(c+2)<<8|b.charCodeAt(c+3),c+=4;else for(e=0;16>e;e++)d[e]=b[c]<<24|b[c+1]<<16|b[c+2]<<8|b[c+3],c+=4;for(e=16;80>e;e++){var f=d[e-3]^d[e-8]^d[e-14]^d[e-16];d[e]=4294967295&(f<<1|f>>>31)}b=a.N[0],c=a.N[1];for(var m,h=a.N[2],k=a.N[3],l=a.N[4],e=0;80>e;e++)40>e?20>e?(f=k^c&(h^k),m=1518500249):(f=c^h^k,m=1859775393):60>e?(f=c&h|k&(c|h),m=2400959708):(f=c^h^k,m=3395469782),f=(b<<5|b>>>27)+f+l+m+d[e]&4294967295,l=k,k=h,h=4294967295&(c<<30|c>>>2),c=b,b=f;a.N[0]=a.N[0]+b&4294967295,a.N[1]=a.N[1]+c&4294967295,a.N[2]=a.N[2]+h&4294967295,a.N[3]=a.N[3]+k&4294967295,a.N[4]=a.N[4]+l&4294967295}function Ta(a,b){var c=Ua(a,b,void 0);return 0>c?null:p(a)?a.charAt(c):a[c]}function Ua(a,b,c){for(var d=a.length,e=p(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return f;return-1}function Va(a,b){var c=Na(a,b);0<=c&&u.splice.call(a,c,1)}function Wa(a,b,c){return 2>=arguments.length?u.slice.call(a,b):u.slice.call(a,b,c)}function Xa(a,b){a.sort(b||Ya)}function Ya(a,b){return a>b?1:a<b?-1:0}function fb(a,b){if(!fa(a))throw Error("encodeByteArray takes an array as a parameter");gb();for(var c=b?db:cb,d=[],e=0;e<a.length;e+=3){var f=a[e],h=e+1<a.length,k=h?a[e+1]:0,l=e+2<a.length,t=f>>2,f=(3&f)<<4|k>>4,k=(15&k)<<2|(m=l?a[e+2]:0)>>6,m=63&m;l||(m=64,h||(k=64)),d.push(c[t],c[f],c[k],c[m])}return d.join("")}function gb(){if(!cb){cb={},db={},eb={};for(var a=0;65>a;a++)cb[a]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(a),db[a]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(a),eb[db[a]]=a,62<=a&&(eb["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(a)]=a)}}function v(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function w(a,b){if(Object.prototype.hasOwnProperty.call(a,b))return a[b]}function ib(a,b){for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b(c,a[c])}function jb(a){var b={};return ib(a,function(a,d){b[a]=d}),b}function kb(a){var b=[];return ib(a,function(a,d){ea(d)?Oa(d,function(d){b.push(encodeURIComponent(a)+"="+encodeURIComponent(d))}):b.push(encodeURIComponent(a)+"="+encodeURIComponent(d))}),b.length?"&"+b.join("&"):""}function lb(a){var b={};return a=a.replace(/^\?/,"").split("&"),Oa(a,function(a){a&&(a=a.split("="),b[a[0]]=a[1])}),b}function x(a,b,c,d){var e;if(d<b?e="at least "+b:d>c&&(e=0===c?"none":"no more than "+c),e)throw Error(a+" failed: Was called with "+d+(1===d?" argument.":" arguments.")+" Expects "+e+".")}function y(a,b,c){var d="";switch(b){case 1:d=c?"first":"First";break;case 2:d=c?"second":"Second";break;case 3:d=c?"third":"Third";break;case 4:d=c?"fourth":"Fourth";break;default:throw Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}return a=a+" failed: "+d+" argument "}function A(a,b,c,d){if((!d||n(c))&&!ha(c))throw Error(y(a,b,d)+"must be a valid function.")}function mb(a,b,c){if(n(c)&&(!ia(c)||null===c))throw Error(y(a,b,!0)+"must be a valid context object.")}function nb(a){return"undefined"!=typeof JSON&&n(JSON.parse)?JSON.parse(a):Aa(a)}function B(a){if("undefined"!=typeof JSON&&n(JSON.stringify))a=JSON.stringify(a);else{var b=[];Ca(new Ba,a,b),a=b.join("")}return a}function ob(){this.Wd=C}function pb(){}function rb(a,b,c){this.Tf=a,this.Ka=b,this.Kd=c}function vb(){this.tb=[]}function wb(a,b){for(var c=null,d=0;d<b.length;d++){var e=b[d],f=e.Zb();null===c||f.ca(c.Zb())||(a.tb.push(c),c=null),null===c&&(c=new xb(f)),c.add(e)}c&&a.tb.push(c)}function yb(a,b,c){wb(a,c),zb(a,function(a){return a.ca(b)})}function Ab(a,b,c){wb(a,c),zb(a,function(a){return a.contains(b)||b.contains(a)})}function zb(a,b){for(var c=!0,d=0;d<a.tb.length;d++)if(e=a.tb[d])if(e=e.Zb(),b(e)){for(var e=a.tb[d],f=0;f<e.vd.length;f++){var h=e.vd[f];if(null!==h){e.vd[f]=null;var k=h.Vb();Bb&&Cb("event: "+h.toString()),Db(k)}}a.tb[d]=null}else c=!1;c&&(a.tb=[])}function xb(a){this.ra=a,this.vd=[]}function D(a,b,c,d){this.type=a,this.Ja=b,this.Wa=c,this.Ke=d,this.Qd=void 0}function Eb(a){return new D(Fb,a)}function Gb(a,b,c,d){this.ue=b,this.Zd=c,this.Qd=d,this.ud=a}function Hb(a,b,c){this.ue=a,this.error=b,this.path=c}function tb(a,b,c){this.A=a,this.ea=b,this.Ub=c}function Ib(a){return a.ea}function Jb(a){return a.Ub}function Kb(a,b){return b.e()?a.ea&&!a.Ub:sb(a,E(b))}function sb(a,b){return a.ea&&!a.Ub||a.A.Da(b)}function Lb(a){this.gg=a,this.Dd=null}function Mb(a,b){this.Of={},this.fd=new Lb(a),this.ba=b;var c=1e4+2e4*Math.random();setTimeout(q(this.If,this),Math.floor(c))}function Nb(){this.Ec={}}function Ob(a,b,c){n(c)||(c=1),v(a.Ec,b)||(a.Ec[b]=0),a.Ec[b]+=c}function Rb(a){return a=a.toString(),Pb[a]||(Pb[a]=new Nb),Pb[a]}function Sb(a,b){var c=a.toString();return Qb[c]||(Qb[c]=b()),Qb[c]}function F(a,b){this.name=a,this.S=b}function Tb(a,b){return new F(a,b)}function Ub(a,b){return Vb(a.name,b.name)}function Wb(a,b){return Vb(a,b)}function Xb(a,b,c){this.type=Yb,this.source=a,this.path=b,this.Ga=c}function Zb(a,b){this.type=$b,this.source=a,this.path=b}function ac(a,b){this.La=a,this.wa=b||bc}function cc(a,b){for(var c,d=a.wa,e=null;!d.e();){if(0===(c=a.La(b,d.key))){if(d.left.e())return e?e.key:null;for(d=d.left;!d.right.e();)d=d.right;return d.key}0>c?d=d.left:0<c&&(e=d,d=d.right)}throw Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}function dc(a,b,c,d,e){for(this.Ud=e||null,this.Fe=d,this.Pa=[],e=1;!a.e();)if(e=b?c(a.key,b):1,d&&(e*=-1),0>e)a=this.Fe?a.left:a.right;else{if(0===e){this.Pa.push(a);break}this.Pa.push(a),a=this.Fe?a.right:a.left}}function J(a){if(0===a.Pa.length)return null;var c,b=a.Pa.pop();if(c=a.Ud?a.Ud(b.key,b.value):{key:b.key,value:b.value},a.Fe)for(b=b.left;!b.e();)a.Pa.push(b),b=b.right;else for(b=b.right;!b.e();)a.Pa.push(b),b=b.left;return c}function ec(a){if(0===a.Pa.length)return null;var b;return b=a.Pa,b=b[b.length-1],a.Ud?a.Ud(b.key,b.value):{key:b.key,value:b.value}}function fc(a,b,c,d,e){this.key=a,this.value=b,this.color=null==c||c,this.left=null!=d?d:bc,this.right=null!=e?e:bc}function gc(a){return a.left.e()?a:gc(a.left)}function ic(a){return a.left.e()?bc:(a.left.fa()||a.left.left.fa()||(a=jc(a)),a=a.Y(null,null,null,ic(a.left),null),hc(a))}function hc(a){return a.right.fa()&&!a.left.fa()&&(a=mc(a)),a.left.fa()&&a.left.left.fa()&&(a=kc(a)),a.left.fa()&&a.right.fa()&&(a=lc(a)),a}function jc(a){return(a=lc(a)).right.left.fa()&&(a=a.Y(null,null,null,null,kc(a.right)),a=mc(a),a=lc(a)),a}function mc(a){return a.right.Y(null,null,a.color,a.Y(null,null,!0,null,a.right.left),null)}function kc(a){return a.left.Y(null,null,a.color,null,a.Y(null,null,!0,a.left.right,null))}function lc(a){return a.Y(null,null,!a.color,a.left.Y(null,null,!a.left.color,null,null),a.right.Y(null,null,!a.right.color,null,null))}function nc(){}function oc(a,b){return a&&"object"==typeof a?(K(".sv"in a,"Unexpected leaf node or priority contents"),b[a[".sv"]]):a}function pc(a,b){var c=new qc;return rc(a,new L(""),function(a,e){c.nc(a,sc(e,b))}),c}function sc(a,b){var d,c=oc(c=a.C().I(),b);if(a.K()){var e=oc(a.Ca(),b);return e!==a.Ca()||c!==a.C().I()?new tc(e,M(c)):a}return d=a,c!==a.C().I()&&(d=d.ga(new tc(c))),a.P(N,function(a,c){var e=sc(c,b);e!==c&&(d=d.U(a,e))}),d}function uc(){this.wc={}}function vc(a){this.Fc=a,this.Pd="firebase:"}function wc(a){try{if("undefined"!=typeof window&&void 0!==window[a]){var b=window[a];return b.setItem("firebase:sentinel","cache"),b.removeItem("firebase:sentinel"),new vc(b)}}catch(c){}return new uc}function zc(a,b,c,d,e){this.host=a.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.kb=b,this.hc=c,this.Wg=d,this.Od=e||"",this.Ya=xc.get("host:"+a)||this.host}function Ac(a,b){b!==a.Ya&&(a.Ya=b,"s-"===a.Ya.substr(0,2)&&xc.set("host:"+a.host,a.Ya))}function Bc(a,b,c){if(K("string"==typeof b,"typeof type must == string"),K("object"==typeof c,"typeof params must == object"),b===Cc)b=(a.kb?"wss://":"ws://")+a.Ya+"/.ws?";else{if(b!==Dc)throw Error("Unknown connection type: "+b);b=(a.kb?"https://":"http://")+a.Ya+"/.lp?"}a.host!==a.Ya&&(c.ns=a.hc);var d=[];return r(c,function(a,b){d.push(b+"="+a)}),b+d.join("&")}function K(a,b){if(!a)throw Fc(b)}function Fc(a){return Error("Firebase ("+hb+") INTERNAL ASSERT FAILED: "+a)}function Gc(a){try{var b;if("undefined"!=typeof atob)b=atob(a);else{gb();for(var c=eb,d=[],e=0;e<a.length;){var f=c[a.charAt(e++)],h=e<a.length?c[a.charAt(e)]:0,k=++e<a.length?c[a.charAt(e)]:64,l=++e<a.length?c[a.charAt(e)]:64;if(++e,null==f||null==h||null==k||null==l)throw Error();d.push(f<<2|h>>4),64!=k&&(d.push(h<<4&240|k>>2),64!=l&&d.push(k<<6&192|l))}if(8192>d.length)b=String.fromCharCode.apply(null,d);else{for(a="",c=0;c<d.length;c+=8192)a+=String.fromCharCode.apply(null,Wa(d,c,c+8192));b=a}}return b}catch(m){Cb("base64Decode failed: ",m)}return null}function Hc(a){b=Ic(a);(a=new La).update(b);var b=[],c=8*a.de;56>a.ac?a.update(a.Ld,56-a.ac):a.update(a.Ld,a.Va-(a.ac-56));for(var d=a.Va-1;56<=d;d--)a.me[d]=255&c,c/=256;for(Ma(a,a.me),d=c=0;5>d;d++)for(var e=24;0<=e;e-=8)b[c]=a.N[d]>>e&255,++c;return fb(b)}function Jc(a){for(var b="",c=0;c<arguments.length;c++)b=fa(arguments[c])?b+Jc.apply(null,arguments[c]):"object"==typeof arguments[c]?b+B(arguments[c]):b+arguments[c],b+=" ";return b}function Cb(a){if(!0===Kc&&(Kc=!1,null===Bb&&!0===yc.get("logging_enabled")&&Lc(!0)),Bb){var b=Jc.apply(null,arguments);Bb(b)}}function Mc(a){return function(){Cb(a,arguments)}}function Nc(a){if("undefined"!=typeof console){var b="FIREBASE INTERNAL ERROR: "+Jc.apply(null,arguments);void 0!==console.error?console.error(b):console.log(b)}}function Oc(a){var b=Jc.apply(null,arguments);throw Error("FIREBASE FATAL ERROR: "+b)}function O(a){if("undefined"!=typeof console){var b="FIREBASE WARNING: "+Jc.apply(null,arguments);void 0!==console.warn?console.warn(b):console.log(b)}}function Pc(a){var b="",c="",d="",e="",f=!0,h="https",k=443;if(p(a)){var l=a.indexOf("//");for(0<=l&&(h=a.substring(0,l-1),a=a.substring(l+2)),-1===(l=a.indexOf("/"))&&(l=a.length),b=a.substring(0,l),e="",a=a.substring(l).split("/"),l=0;l<a.length;l++)if(0<a[l].length){var m=a[l];try{m=decodeURIComponent(m.replace(/\+/g," "))}catch(t){}e+="/"+m}3===(a=b.split(".")).length?(c=a[1],d=a[0].toLowerCase()):2===a.length&&(c=a[0]),0<=(l=b.indexOf(":"))&&(f="https"===h||"wss"===h,k=b.substring(l+1),isFinite(k)&&(k=String(k)),k=p(k)?/^\s*-?0x/i.test(k)?parseInt(k,16):parseInt(k,10):NaN)}return{host:b,port:k,domain:c,Tg:d,kb:f,scheme:h,$c:e}}function Qc(a){return ga(a)&&(a!=a||a==Number.POSITIVE_INFINITY||a==Number.NEGATIVE_INFINITY)}function Rc(a){if("complete"===document.readyState)a();else{var b=!1,c=function(){document.body?b||(b=!0,a()):setTimeout(c,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",c,!1),window.addEventListener("load",c,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&c()}),window.attachEvent("onload",c))}}function Vb(a,b){if(a===b)return 0;if("[MIN_NAME]"===a||"[MAX_NAME]"===b)return-1;if("[MIN_NAME]"===b||"[MAX_NAME]"===a)return 1;var c=Sc(a),d=Sc(b);return null!==c?null!==d?0==c-d?a.length-b.length:c-d:-1:null!==d?1:a<b?-1:1}function Tc(a,b){if(b&&a in b)return b[a];throw Error("Missing required key ("+a+") in object: "+B(b))}function Uc(a){if("object"!=typeof a||null===a)return B(a);var c,b=[];for(c in a)b.push(c);b.sort(),c="{";for(var d=0;d<b.length;d++)0!==d&&(c+=","),c+=B(b[d]),c+=":",c+=Uc(a[b[d]]);return c+"}"}function Vc(a,b){if(a.length<=b)return[a];for(var c=[],d=0;d<a.length;d+=b)d+b>a?c.push(a.substring(d,a.length)):c.push(a.substring(d,d+b));return c}function Wc(a,b){if(ea(a))for(var c=0;c<a.length;++c)b(c,a[c]);else r(a,b)}function Xc(a){K(!Qc(a),"Invalid JSON number");var b,c,d,e;for(0===a?(d=c=0,b=-1/0==1/a?1:0):(b=0>a,(a=Math.abs(a))>=Math.pow(2,-1022)?(d=Math.min(Math.floor(Math.log(a)/Math.LN2),1023),c=d+1023,d=Math.round(a*Math.pow(2,52-d)-Math.pow(2,52))):(c=0,d=Math.round(a/Math.pow(2,-1074)))),e=[],a=52;a;--a)e.push(d%2?1:0),d=Math.floor(d/2);for(a=11;a;--a)e.push(c%2?1:0),c=Math.floor(c/2);for(e.push(b?1:0),e.reverse(),b=e.join(""),c="",a=0;64>a;a+=8)1===(d=parseInt(b.substr(a,8),2).toString(16)).length&&(d="0"+d),c+=d;return c.toLowerCase()}function Sc(a){return Yc.test(a)&&-2147483648<=(a=Number(a))&&2147483647>=a?a:null}function Db(a){try{a()}catch(b){setTimeout(function(){throw O("Exception was thrown by user callback.",b.stack||""),b},Math.floor(0))}}function P(a,b){if(ha(a)){var c=Array.prototype.slice.call(arguments,1).slice();Db(function(){a.apply(null,c)})}}function Ic(a){for(var b=[],c=0,d=0;d<a.length;d++){var e=a.charCodeAt(d);55296<=e&&56319>=e&&(e-=55296,d++,K(d<a.length,"Surrogate pair missing trail surrogate."),e=65536+(e<<10)+(a.charCodeAt(d)-56320)),128>e?b[c++]=e:(2048>e?b[c++]=e>>6|192:(65536>e?b[c++]=e>>12|224:(b[c++]=e>>18|240,b[c++]=e>>12&63|128),b[c++]=e>>6&63|128),b[c++]=63&e|128)}return b}function Zc(a){for(var b=0,c=0;c<a.length;c++){var d=a.charCodeAt(c);128>d?b++:2048>d?b+=2:55296<=d&&56319>=d?(b+=4,c++):b+=3}return b}function $c(a){var b={},c={},d={},e="";try{var f=a.split("."),b=nb(Gc(f[0])||""),c=nb(Gc(f[1])||""),e=f[2],d=c.d||{};delete c.d}catch(h){}return{Zg:b,Bc:c,data:d,Qg:e}}function ad(a){return"object"==typeof(a=$c(a).Bc)&&a.hasOwnProperty("iat")?w(a,"iat"):null}function bd(a){var b=(a=$c(a)).Bc;return!!a.Qg&&!!b&&"object"==typeof b&&b.hasOwnProperty("iat")}function cd(a){this.W=a,this.g=a.n.g}function dd(a,b,c,d){var e=[],f=[];return Oa(b,function(b){"child_changed"===b.type&&a.g.Ad(b.Ke,b.Ja)&&f.push(new D("child_moved",b.Ja,b.Wa))}),ed(a,e,"child_removed",b,d,c),ed(a,e,"child_added",b,d,c),ed(a,e,"child_moved",f,d,c),ed(a,e,"child_changed",b,d,c),ed(a,e,Fb,b,d,c),e}function ed(a,b,c,d,e,f){Xa(d=Pa(d,function(a){return a.type===c}),q(a.hg,a)),Oa(d,function(c){var d=fd(a,c,f);Oa(e,function(e){e.Kf(c.type)&&b.push(e.createEvent(d,a.W))})})}function fd(a,b,c){return"value"!==b.type&&"child_removed"!==b.type&&(b.Qd=c.rf(b.Wa,b.Ja,a.g)),b}function gd(){this.bb={}}function hd(a,b){var c=b.type,d=b.Wa;K("child_added"==c||"child_changed"==c||"child_removed"==c,"Only child changes supported for tracking"),K(".priority"!==d,"Only non-priority child changes can be tracked.");var e=w(a.bb,d);if(e){var f=e.type;if("child_added"==c&&"child_removed"==f)a.bb[d]=new D("child_changed",b.Ja,d,e.Ja);else if("child_removed"==c&&"child_added"==f)delete a.bb[d];else if("child_removed"==c&&"child_changed"==f)a.bb[d]=new D("child_removed",e.Ke,d);else if("child_changed"==c&&"child_added"==f)a.bb[d]=new D("child_added",b.Ja,d);else{if("child_changed"!=c||"child_changed"!=f)throw Fc("Illegal combination of changes: "+b+" occurred after "+e);a.bb[d]=new D("child_changed",b.Ja,d,e.Ke)}}else a.bb[d]=b}function id(a,b,c){this.Rb=a,this.pb=b,this.rb=c||null}function jd(a,b,c){this.ha=a,this.pb=b,this.rb=c}function kd(a){this.g=a}function ld(a){this.Be=new kd(a.g),this.g=a.g;var b;a.ma?(b=md(a),b=a.g.Pc(nd(a),b)):b=a.g.Tc(),this.ed=b,a.pa?(b=od(a),a=a.g.Pc(pd(a),b)):a=a.g.Qc(),this.Gc=a}function qd(a){this.sa=new ld(a),this.g=a.g,K(a.ja,"Only valid if limit has been set"),this.ka=a.ka,this.Jb=!rd(a)}function sd(a,b,c,d,e,f){var h;if(a.Jb){var k=td(a.g);h=function(a,b){return k(b,a)}}else h=td(a.g);K(b.Db()==a.ka,"");var l=new F(c,d),m=a.Jb?ud(b,a.g):vd(b,a.g),t=a.sa.matches(l);if(b.Da(c)){for(var z=b.R(c),m=e.ye(a.g,m,a.Jb);null!=m&&(m.name==c||b.Da(m.name));)m=e.ye(a.g,m,a.Jb);return e=null==m?1:h(m,l),t&&!d.e()&&0<=e?(null!=f&&hd(f,new D("child_changed",d,c,z)),b.U(c,d)):(null!=f&&hd(f,new D("child_removed",z,c)),b=b.U(c,C),null!=m&&a.sa.matches(m)?(null!=f&&hd(f,new D("child_added",m.S,m.name)),b.U(m.name,m.S)):b)}return d.e()?b:t&&0<=h(m,l)?(null!=f&&(hd(f,new D("child_removed",m.S,m.name)),hd(f,new D("child_added",d,c))),b.U(c,d).U(m.name,C)):b}function wd(a,b){this.je=a,this.fg=b}function xd(a){this.V=a}function Hd(a,b,c,d,e,f){var h=b.O;if(null!=d.tc(c))return b;var k;if(c.e())K(Ib(b.w()),"If change path is empty, we must have complete server data"),Jb(b.w())?(e=ub(b),d=d.yc(e instanceof R?e:C)):d=d.za(ub(b)),f=a.V.xa(b.O.j(),d,f);else{var l=E(c);if(".priority"==l)K(1==Kd(c),"Can't have a priority with additional path components"),f=h.j(),k=b.w().j(),d=d.ld(c,f,k),f=null!=d?a.V.ga(f,d):h.j();else{var m=H(c);sb(h,l)?(k=b.w().j(),d=d.ld(c,h.j(),k),d=null!=d?h.j().R(l).G(m,d):h.j().R(l)):d=d.xc(l,b.w()),f=null!=d?a.V.G(h.j(),l,d,m,e,f):h.j()}}return Fd(b,f,h.ea||c.e(),a.V.Na())}function Ad(a,b,c,d,e,f,h,k){var l=b.w();if(h=h?a.V:a.V.Wb(),c.e())d=h.xa(l.j(),d,null);else if(h.Na()&&!l.Ub)d=l.j().G(c,d),d=h.xa(l.j(),d,null);else{var m=E(c);if(!Kb(l,c)&&1<Kd(c))return b;var t=H(c);d=l.j().R(m).G(t,d),d=".priority"==m?h.ga(l.j(),d):h.G(l.j(),m,d,t,qb,null)}return l=l.ea||c.e(),b=new Id(b.O,new tb(d,l,h.Na())),Hd(a,b,c,e,new rb(e,b,f),k)}function yd(a,b,c,d,e,f,h){var k=b.O;if(e=new rb(e,b,f),c.e())h=a.V.xa(b.O.j(),d,h),a=Fd(b,h,!0,a.V.Na());else if(".priority"===(f=E(c)))h=a.V.ga(b.O.j(),d),a=Fd(b,h,k.ea,k.Ub);else{c=H(c);var l=k.j().R(f);if(!c.e()){var m=e.qf(f);d=null!=m?".priority"===Ld(c)&&m.Q(c.parent()).e()?m:m.G(c,d):C}l.ca(d)?a=b:(h=a.V.G(k.j(),f,d,c,e,h),a=Fd(b,h,k.ea,a.V.Na()))}return a}function Cd(a,b,c,d,e,f,h){var k=b;return Md(d,function(d,m){var t=c.u(d);sb(b.O,E(t))&&(k=yd(a,k,t,m,e,f,h))}),Md(d,function(d,m){var t=c.u(d);sb(b.O,E(t))||(k=yd(a,k,t,m,e,f,h))}),k}function Nd(a,b){return Md(b,function(b,d){a=a.G(b,d)}),a}function Dd(a,b,c,d,e,f,h,k){if(b.w().j().e()&&!Ib(b.w()))return b;var l=b;c=c.e()?d:Od(Pd,c,d);var m=b.w().j();return c.children.ia(function(c,d){if(m.Da(c)){var I=Nd(I=b.w().j().R(c),d);l=Ad(a,l,new L(c),I,e,f,h,k)}}),c.children.ia(function(c,d){var I=!sb(b.w(),c)&&null==d.value;m.Da(c)||I||(I=b.w().j().R(c),I=Nd(I,d),l=Ad(a,l,new L(c),I,e,f,h,k))}),l}function Gd(a,b,c,d,e,f,h){if(null!=e.tc(c))return b;var k=Jb(b.w()),l=b.w();if(null!=d.value){if(c.e()&&l.ea||Kb(l,c))return Ad(a,b,c,l.j().Q(c),e,f,k,h);if(c.e()){var m=Pd;return l.j().P(Qd,function(a,b){m=m.set(new L(a),b)}),Dd(a,b,c,m,e,f,k,h)}return b}return m=Pd,Md(d,function(a){var b=c.u(a);Kb(l,b)&&(m=m.set(a,l.j().Q(b)))}),Dd(a,b,c,m,e,f,k,h)}function Rd(){}function td(a){return q(a.compare,a)}function Ud(a){K(!a.e()&&".priority"!==E(a),"Can't create PathIndex with empty path or .priority key"),this.cc=a}function Wd(){}function Xd(){}function Yd(){}function ae(){this.Tb=this.pa=this.Lb=this.ma=this.ja=!1,this.ka=0,this.Nb="",this.ec=null,this.xb="",this.bc=null,this.vb="",this.g=N}function rd(a){return""===a.Nb?a.ma:"l"===a.Nb}function nd(a){return K(a.ma,"Only valid if start has been set"),a.ec}function md(a){return K(a.ma,"Only valid if start has been set"),a.Lb?a.xb:"[MIN_NAME]"}function pd(a){return K(a.pa,"Only valid if end has been set"),a.bc}function od(a){return K(a.pa,"Only valid if end has been set"),a.Tb?a.vb:"[MAX_NAME]"}function ce(a){var b=new ae;return b.ja=a.ja,b.ka=a.ka,b.ma=a.ma,b.ec=a.ec,b.Lb=a.Lb,b.xb=a.xb,b.pa=a.pa,b.bc=a.bc,b.Tb=a.Tb,b.vb=a.vb,b.g=a.g,b}function de(a,b){var c=ce(a);return c.g=b,c}function ee(a){var b={};if(a.ma&&(b.sp=a.ec,a.Lb&&(b.sn=a.xb)),a.pa&&(b.ep=a.bc,a.Tb&&(b.en=a.vb)),a.ja){b.l=a.ka;var c=a.Nb;""===c&&(c=rd(a)?"l":"r"),b.vf=c}return a.g!==N&&(b.i=a.g.toString()),b}function S(a){return!(a.ma||a.pa||a.ja)}function fe(a){return S(a)&&a.g==N}function ge(a){var b={};if(fe(a))return b;var c;return a.g===N?c="$priority":a.g===$d?c="$value":a.g===Qd?c="$key":(K(a.g instanceof Ud,"Unrecognized index type!"),c=a.g.toString()),b.orderBy=B(c),a.ma&&(b.startAt=B(a.ec),a.Lb&&(b.startAt+=","+B(a.xb))),a.pa&&(b.endAt=B(a.bc),a.Tb&&(b.endAt+=","+B(a.vb))),a.ja&&(rd(a)?b.limitToFirst=a.ka:b.limitToLast=a.ka),b}function he(a,b){this.Bd=a,this.dc=b}function ie(a,b,c){return new he(na(a.Bd,function(d,f){var h=w(a.dc,f);if(K(h,"Missing index implementation for "+f),d===Sd){if(h.Ic(b.S)){for(var k=[],l=c.Xb(Tb),m=J(l);m;)m.name!=b.name&&k.push(m),m=J(l);return k.push(b),je(k,td(h))}return Sd}return h=c.get(b.name),k=d,h&&(k=k.remove(new F(b.name,h))),k.Oa(b,b.S)}),a.dc)}function ke(a,b,c){return new he(na(a.Bd,function(a){if(a===Sd)return a;var d=c.get(b.name);return d?a.remove(new F(b.name,d)):a}),a.dc)}function tc(a,b){this.B=a,K(n(this.B)&&null!==this.B,"LeafNode shouldn't be created with null/undefined value."),this.aa=b||C,me(this.aa),this.Cb=null}function R(a,b,c){this.m=a,(this.aa=b)&&me(this.aa),a.e()&&K(!this.aa||this.aa.e(),"An empty node cannot have a priority"),this.wb=c,this.Cb=null}function ud(a,b){var c;return(c=(c=qe(a,b))?(c=c.Sc())&&c.name:a.m.Sc())?new F(c,a.m.get(c)):null}function vd(a,b){var c;return(c=(c=qe(a,b))?(c=c.fc())&&c.name:a.m.fc())?new F(c,a.m.get(c)):null}function qe(a,b){return b===Qd?null:a.wb.get(b.toString())}function M(a,b){if(null===a)return C;var c=null;if("object"==typeof a&&".priority"in a?c=a[".priority"]:void 0!==b&&(c=b),K(null===c||"string"==typeof c||"number"==typeof c||"object"==typeof c&&".sv"in c,"Invalid priority type found: "+typeof c),"object"==typeof a&&".value"in a&&null!==a[".value"]&&(a=a[".value"]),"object"!=typeof a||".sv"in a)return new tc(a,M(c));if(a instanceof Array){var d=C,e=a;return r(e,function(a,b){if(v(e,b)&&"."!==b.substring(0,1)){var c=M(a);!c.K()&&c.e()||(d=d.U(b,c))}}),d.ga(M(c))}var f=[],h=!1,k=a;if(ib(k,function(a){if("string"!=typeof a||"."!==a.substring(0,1)){var b=M(k[a]);b.e()||(h=h||!b.C().e(),f.push(new F(a,b)))}}),0==f.length)return C;var l=je(f,Ub,function(a){return a.name},Wb);if(h){var m=je(f,td(N));return new R(l,M(c),new he({".priority":m},{".priority":N}))}return new R(l,M(c),le)}function se(a){this.count=parseInt(Math.log(a+1)/re,10),this.jf=this.count-1,this.eg=a+1&parseInt(Array(this.count+1).join("1"),2)}function te(a){var b=!(a.eg&1<<a.jf);return a.jf--,b}function je(a,b,c,d){function e(b,d){if(0==(f=d-b))return null;if(1==f){m=a[b];return new fc(t=c?c(m):m,m.S,!1,null,null)}var f=e(b,m=parseInt(f/2,10)+b),z=e(m+1,d),m=a[m],t=c?c(m):m;return new fc(t,m.S,!1,f,z)}a.sort(b);var f=function(b){function d(b,h){var k=t-b,z=t;t-=b;var z=e(k+1,z),k=a[k],z=new fc(c?c(k):k,k.S,h,null,z);f?f.left=z:m=z,f=z}for(var f=null,m=null,t=a.length,z=0;z<b.count;++z){var I=te(b),zd=Math.pow(2,b.count-(z+1));I?d(zd,!1):(d(zd,!1),d(zd,!0))}return m}(new se(a.length));return null!==f?new ac(d||b,f):new ac(d||b)}function oe(a){return"number"==typeof a?"number:"+Xc(a):"string:"+a}function me(a){if(a.K()){var b=a.I();K("string"==typeof b||"number"==typeof b||"object"==typeof b&&v(b,".sv"),"Priority must be a string or number.")}else K(a===Vd||a.e(),"priority of unexpected type.");K(a===Vd||a.C().e(),"Priority nodes can't have a priority of their own.")}function ue(){R.call(this,new ac(Wb),C,le)}function Id(a,b){this.O=a,this.Yd=b}function Fd(a,b,c,d){return new Id(new tb(b,c,d),a.Yd)}function Jd(a){return a.O.ea?a.O.j():null}function ub(a){return a.Yd.ea?a.Yd.j():null}function ve(a,b){this.W=a;var d=new kd((c=a.n).g),c=S(c)?new kd(c.g):c.ja?new qd(c):new ld(c);this.Hf=new xd(c);var e=b.w(),f=b.O,h=d.xa(C,e.j(),null),k=c.xa(C,f.j(),null);this.Ka=new Id(new tb(k,f.ea,c.Na()),new tb(h,e.ea,d.Na())),this.Xa=[],this.lg=new cd(a)}function we(a){return a.W}function ye(a,b){var c=a.Ka.O,d=[];return c.j().K()||c.j().P(N,function(a,b){d.push(new D("child_added",b,a))}),c.ea&&d.push(Eb(c.j())),xe(a,d,c.j(),b)}function xe(a,b,c,d){return dd(a.lg,b,c,d?[d]:a.Xa)}function ze(a,b,c){this.type=Bd,this.source=a,this.path=b,this.children=c}function Ae(a,b){this.f=Mc("p:rest:"),this.F=a,this.Gb=b,this.Aa=null,this.$={}}function Be(a,b){return n(b)?"tag$"+b:(K(fe(a.n),"should have a tag if it's not a default query."),a.path.toString())}function Ce(a,b,c,d){(c=c||{}).format="export",a.Aa&&(c.auth=a.Aa);var e=(a.F.kb?"https://":"http://")+a.F.host+b+"?"+kb(c);a.f("Sending REST request for "+e);var f=new XMLHttpRequest;f.onreadystatechange=function(){if(d&&4===f.readyState){a.f("REST Response for "+e+" received. status:",f.status,"response:",f.responseText);var b=null;if(200<=f.status&&300>f.status){try{b=nb(f.responseText)}catch(c){O("Failed to parse JSON response for "+e+": "+f.responseText)}d(null,b)}else 401!==f.status&&404!==f.status&&O("Got unsuccessful REST response for "+e+" Status: "+f.status),d(f.status);d=null}},f.open("GET",e,!0),f.send()}function De(a){K(ea(a)&&0<a.length,"Requires a non-empty array"),this.Xf=a,this.Oc={}}function Ee(a,b){K(Ta(a.Xf,function(a){return a===b}),"Unknown event: "+b)}function Ge(){if(De.call(this,["online"]),this.kc=!0,"undefined"!=typeof window&&void 0!==window.addEventListener){var a=this;window.addEventListener("online",function(){a.kc||(a.kc=!0,a.fe("online",!0))},!1),window.addEventListener("offline",function(){a.kc&&(a.kc=!1,a.fe("online",!1))},!1)}}function He(){De.call(this,["visible"]);var a,b;if("undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(b="visibilitychange",a="hidden"):void 0!==document.mozHidden?(b="mozvisibilitychange",a="mozHidden"):void 0!==document.msHidden?(b="msvisibilitychange",a="msHidden"):void 0!==document.webkitHidden&&(b="webkitvisibilitychange",a="webkitHidden")),this.Ob=!0,b){var c=this;document.addEventListener(b,function(){var b=!document[a];b!==c.Ob&&(c.Ob=b,c.fe("visible",b))},!1)}}function L(a,b){if(1==arguments.length){this.o=a.split("/");for(var c=0,d=0;d<this.o.length;d++)0<this.o[d].length&&(this.o[c]=this.o[d],c++);this.o.length=c,this.Z=0}else this.o=a,this.Z=b}function T(a,b){var c=E(a);if(null===c)return b;if(c===E(b))return T(H(a),H(b));throw Error("INTERNAL ERROR: innerPath ("+b+") is not within outerPath ("+a+")")}function Ie(a,b){for(var c=a.slice(),d=b.slice(),e=0;e<c.length&&e<d.length;e++){var f=Vb(c[e],d[e]);if(0!==f)return f}return c.length===d.length?0:c.length<d.length?-1:1}function E(a){return a.Z>=a.o.length?null:a.o[a.Z]}function Kd(a){return a.o.length-a.Z}function H(a){var b=a.Z;return b<a.o.length&&b++,new L(a.o,b)}function Ld(a){return a.Z<a.o.length?a.o[a.o.length-1]:null}function Je(a,b){this.Qa=a.slice(),this.Ha=Math.max(1,this.Qa.length),this.lf=b;for(var c=0;c<this.Qa.length;c++)this.Ha+=Zc(this.Qa[c]);Ke(this)}function Ke(a){if(768<a.Ha)throw Error(a.lf+"has a key path longer than 768 bytes ("+a.Ha+").");if(32<a.Qa.length)throw Error(a.lf+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Le(a))}function Le(a){return 0==a.Qa.length?"":"in property '"+a.Qa.join(".")+"'"}function Me(a,b){this.value=a,this.children=b||Ne}function Oe(a){var b=Pd;return r(a,function(a,d){b=b.set(new L(d),a)}),b}function Pe(a,b,c){if(null!=a.value&&c(a.value))return{path:G,value:a.value};if(b.e())return null;var d=E(b);return null!==(a=a.children.get(d))&&null!=(b=Pe(a,H(b),c))?{path:new L(d).u(b.path),value:b.value}:null}function Qe(a,b){return Pe(a,b,function(){return!0})}function Od(a,b,c){if(b.e())return c;var d=E(b);return b=Od(a.children.get(d)||Pd,H(b),c),d=b.e()?a.children.remove(d):a.children.Oa(d,b),new Me(a.value,d)}function Re(a,b){return Se(a,G,b)}function Se(a,b,c){var d={};return a.children.ia(function(a,f){d[a]=Se(f,b.u(a),c)}),c(b,a.value,d)}function Te(a,b,c){return Ue(a,b,G,c)}function Ue(a,b,c,d){var e=!!a.value&&d(c,a.value);return e||(b.e()?null:(e=E(b),(a=a.children.get(e))?Ue(a,H(b),c.u(e),d):null))}function Ve(a,b,c){var d=G;if(!b.e()){var e=!0;a.value&&(e=c(d,a.value)),!0===e&&(e=E(b),(a=a.children.get(e))&&We(a,H(b),d.u(e),c))}}function We(a,b,c,d){if(b.e())return a;a.value&&d(c,a.value);var e=E(b);return(a=a.children.get(e))?We(a,H(b),c.u(e),d):Pd}function Md(a,b){Xe(a,G,b)}function Xe(a,b,c){a.children.ia(function(a,e){Xe(e,b.u(a),c)}),a.value&&c(b,a.value)}function Ye(a,b){a.children.ia(function(a,d){d.value&&b(a,d.value)})}function Ze(a,b,c){this.type=Ed,this.source=$e,this.path=a,this.Qb=b,this.Vd=c}function af(a,b,c,d){this.we=a,this.pf=b,this.Hb=c,this.af=d,K(!d||b,"Tagged queries must be from server.")}function cf(a){this.X=a}function ef(a,b,c){if(b.e())return new cf(new Me(c));if(null!=(d=Qe(a.X,b))){var e=d.path,d=d.value;return b=T(e,b),d=d.G(b,c),new cf(a.X.set(e,d))}return a=Od(a.X,b,new Me(c)),new cf(a)}function ff(a,b,c){var d=a;return ib(c,function(a,c){d=ef(d,b.u(a),c)}),d}function gf(a,b){var c=Qe(a.X,b);return null!=c?a.X.get(c.path).Q(T(c.path,b)):null}function hf(a){var b=[],c=a.X.value;return null!=c?c.K()||c.P(N,function(a,c){b.push(new F(a,c))}):a.X.children.ia(function(a,c){null!=c.value&&b.push(new F(a,c.value))}),b}function jf(a,b){if(b.e())return a;var c=gf(a,b);return new cf(null!=c?new Me(c):a.X.subtree(b))}function kf(a,b,c){if(null!=b.value)return c.G(a,b.value);var d=null;return b.children.ia(function(b,f){".priority"===b?(K(null!==f.value,"Priority writes must always be leaf nodes"),d=f.value):c=kf(a.u(b),f,c)}),c.Q(a).e()||null===d||(c=c.G(a.u(".priority"),d)),c}function lf(){this.T=df,this.na=[],this.Mc=-1}function mf(a,b){for(var c=0;c<a.na.length;c++){var d=a.na[c];if(d.kd===b)return d}return null}function nf(a,b){return a.Ga?a.path.contains(b):!!ua(a.children,function(c,d){return a.path.u(d).contains(b)})}function pf(a){return a.visible}function of(a,b,c){for(var d=df,e=0;e<a.length;++e){var f=a[e];if(b(f)){var h=f.path;if(f.Ga)c.contains(h)?(h=T(c,h),d=ef(d,h,f.Ga)):h.contains(c)&&(h=T(h,c),d=ef(d,G,f.Ga.Q(h)));else{if(!f.children)throw Fc("WriteRecord should have .snap or .children");c.contains(h)?(h=T(c,h),d=ff(d,h,f.children)):h.contains(c)&&((h=T(h,c)).e()?d=ff(d,G,f.children):(f=w(f.children,E(h)))&&(f=f.Q(H(h)),d=ef(d,G,f)))}}}return d}function qf(a,b){this.Mb=a,this.X=b}function rf(){this.ya={}}function tf(a){return Pa(ra(a.ya),function(a){return!S(a.W.n)})}function uf(a,b){if(S(b.n))return sf(a);var c=b.va();return w(a.ya,c)}function sf(a){return va(a.ya,function(a){return S(a.W.n)})||null}function vf(a){this.ta=Pd,this.ib=new lf,this.$e={},this.mc={},this.Nc=a}function wf(a,b,c,d,e){var f=a.ib,h=e;return K(d>f.Mc,"Stacking an older write on top of newer ones"),n(h)||(h=!0),f.na.push({path:b,Ga:c,kd:d,visible:h}),h&&(f.T=ef(f.T,b,c)),f.Mc=d,e?xf(a,new Xb($e,b,c)):[]}function yf(a,b,c,d){var e=a.ib;return K(d>e.Mc,"Stacking an older merge on top of newer ones"),e.na.push({path:b,children:c,kd:d,visible:!0}),e.T=ff(e.T,b,c),e.Mc=d,c=Oe(c),xf(a,new ze($e,b,c))}function zf(a,b,c){c=c||!1;var d=mf(a.ib,b);if(a.ib.Rd(b)){var e=Pd;return null!=d.Ga?e=e.set(G,!0):ib(d.children,function(a,b){e=e.set(new L(a),b)}),xf(a,new Ze(d.path,e,c))}return[]}function Af(a,b,c){return c=Oe(c),xf(a,new ze(bf,b,c))}function Bf(a,b,c,d){if(null!=(d=Cf(a,d))){var e=Df(d);return d=e.path,e=e.Hb,b=T(d,b),c=new Xb(new af(!1,!0,e,!0),b,c),Ef(a,d,c)}return[]}function Ff(a,b,c,d){if(d=Cf(a,d)){var e=Df(d);return d=e.path,e=e.Hb,b=T(d,b),c=Oe(c),c=new ze(new af(!1,!0,e,!0),b,c),Ef(a,d,c)}return[]}function Jf(a){return Re(a,function(a,c,d){if(c&&null!=sf(c))return[sf(c)];var e=[];return c&&(e=tf(c)),r(d,function(a){e=e.concat(a)}),e})}function Nf(a,b){for(var c=0;c<b.length;++c)if(!S((d=b[c]).n)){var d=Gf(d),e=a.mc[d];delete a.mc[d],delete a.$e["_"+e]}}function Lf(a){return S(a.n)&&!fe(a.n)?a.Ib():a}function If(a,b,c){var d=b.path,e=Mf(a,b);if(c=Kf(a,c),b=a.Nc.Xe(Lf(b),e,c.xd,c.H),d=a.ta.subtree(d),e)K(null==sf(d.value),"If we're adding a query, it shouldn't be shadowed");else for(e=Re(d,function(a,b,c){if(!a.e()&&b&&null!=sf(b))return[we(sf(b))];var d=[];return b&&(d=d.concat(Qa(tf(b),function(a){return a.W}))),r(c,function(a){d=d.concat(a)}),d}),d=0;d<e.length;++d)c=e[d],a.Nc.ae(Lf(c),Mf(a,c));return b}function Kf(a,b){var c=b.W,d=Mf(a,c);return{xd:function(){return(b.w()||C).hash()},H:function(b){if("ok"===b){if(d){var f=c.path;if(b=Cf(a,d)){var h=Df(b);b=h.path,h=h.Hb,f=T(b,f),f=new Zb(new af(!1,!0,h,!0),f),b=Ef(a,b,f)}else b=[]}else b=xf(a,new Zb(bf,c.path));return b}return f="Unknown Error","too_big"===b?f="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"==b?f="Client doesn't have permission to access the desired data.":"unavailable"==b&&(f="The service is unavailable"),f=Error(b+": "+f),f.code=b.toUpperCase(),a.jb(c,null,f)}}}function Gf(a){return a.path.toString()+"$"+a.va()}function Df(a){var b=a.indexOf("$");return K(-1!==b&&b<a.length-1,"Bad queryKey."),{Hb:a.substr(b+1),path:new L(a.substr(0,b))}}function Cf(a,b){var c=a.$e,d="_"+b;return d in c?c[d]:void 0}function Mf(a,b){var c=Gf(b);return w(a.mc,c)}function Ef(a,b,c){var d=a.ta.get(b);return K(d,"Missing sync point for query tag that we're tracking"),d.ab(c,new qf(b,a.ib),null)}function xf(a,b){return Of(a,b,a.ta,null,new qf(G,a.ib))}function Of(a,b,c,d,e){if(b.path.e())return Pf(a,b,c,d,e);var f=c.get(G);null==d&&null!=f&&(d=f.fb(G));var h=[],k=E(b.path),l=b.Xc(k);if((c=c.children.get(k))&&l)var m=d?d.R(k):null,k=e.u(k),h=h.concat(Of(a,l,c,m,k));return f&&(h=h.concat(f.ab(b,e,d))),h}function Pf(a,b,c,d,e){var f=c.get(G);null==d&&null!=f&&(d=f.fb(G));var h=[];return c.children.ia(function(c,f){var m=d?d.R(c):null,t=e.u(c),z=b.Xc(c);z&&(h=h.concat(Pf(a,z,f,m,t)))}),f&&(h=h.concat(f.ab(b,e,d))),h}function Qf(){this.children={},this.nd=0,this.value=null}function Rf(a,b,c){this.Gd=a||"",this.Zc=b||null,this.A=c||new Qf}function Sf(a,b){for(var e,c=b instanceof L?b:new L(b),d=a;null!==(e=E(c));)d=new Rf(e,d,w(d.A.children,e)||new Qf),c=H(c);return d}function Tf(a,b){K(void 0!==b,"Cannot set value to undefined"),a.A.value=b,Uf(a)}function Vf(a,b,c,d){c&&!d&&b(a),a.P(function(a){Vf(a,b,!0,d)}),c&&d&&b(a)}function Wf(a,b){for(var c=a.parent();null!==c&&!b(c);)c=c.parent()}function Uf(a){if(null!==a.Zc){var b=a.Zc,c=a.Gd,d=a.e(),e=v(b.A.children,c);d&&e?(delete b.A.children[c],b.A.nd--,Uf(b)):d||e||(b.A.children[c]=a.A,b.A.nd++,Uf(b))}}function $f(a){return p(a)&&0!==a.length&&!Xf.test(a)}function ag(a){return null===a||p(a)||ga(a)&&!Qc(a)||ia(a)&&v(a,".sv")}function bg(a,b,c,d){d&&!n(b)||cg(y(a,1,d),b,c)}function cg(a,b,c){if(c instanceof L&&(c=new Je(c,a)),!n(b))throw Error(a+"contains undefined "+Le(c));if(ha(b))throw Error(a+"contains a function "+Le(c)+" with contents: "+b.toString());if(Qc(b))throw Error(a+"contains "+b.toString()+" "+Le(c));if(p(b)&&b.length>10485760/3&&10485760<Zc(b))throw Error(a+"contains a string greater than 10485760 utf8 bytes "+Le(c)+" ('"+b.substring(0,50)+"...')");if(ia(b)){var d=!1,e=!1;if(ib(b,function(b,h){if(".value"===b)d=!0;else if(".priority"!==b&&".sv"!==b&&(e=!0,!$f(b)))throw Error(a+" contains an invalid key ("+b+") "+Le(c)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');c.push(b),cg(a,h,c),c.pop()}),d&&e)throw Error(a+' contains ".value" child '+Le(c)+" in addition to actual children.")}}function dg(a,b){var c,d;for(c=0;c<b.length;c++)for(var e=(d=b[c]).slice(),f=0;f<e.length;f++)if((".priority"!==e[f]||f!==e.length-1)&&!$f(e[f]))throw Error(a+"contains an invalid key ("+e[f]+") in path "+d.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');for(b.sort(Ie),e=null,c=0;c<b.length;c++){if(d=b[c],null!==e&&e.contains(d))throw Error(a+"contains a path "+e.toString()+" that is ancestor of another path "+d.toString());e=d}}function eg(a,b,c){var d=y(a,1,!1);if(!ia(b)||ea(b))throw Error(d+" must be an object containing the children to replace.");var e=[];ib(b,function(a,b){var k=new L(a);if(cg(d,b,c.u(k)),".priority"===Ld(k)&&!ag(b))throw Error(d+"contains an invalid value for '"+k.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");e.push(k)}),dg(d,e)}function fg(a,b,c){if(Qc(c))throw Error(y(a,b,!1)+"is "+c.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!ag(c))throw Error(y(a,b,!1)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}function gg(a,b,c){if(!c||n(b))switch(b){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw Error(y(a,1,c)+'must be a valid event type: "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}function hg(a,b){if(n(b)&&!$f(b))throw Error(y(a,2,!0)+'was an invalid key: "'+b+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')}function ig(a,b){if(!p(b)||0===b.length||Yf.test(b))throw Error(y(a,1,!1)+'was an invalid path: "'+b+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')}function jg(a,b){if(".info"===E(b))throw Error(a+" failed: Can't modify data under /.info/")}function kg(a,b){if(!p(b))throw Error(y(a,1,!1)+"must be a valid credential (a string).")}function lg(a,b,c){if(!p(c))throw Error(y(a,b,!1)+"must be a valid string.")}function mg(a,b){if(lg(a,1,b),!Zf.test(b))throw Error(y(a,1,!1)+"'"+b+"' is not a valid authentication provider.")}function ng(a,b,c,d){if((!d||n(c))&&(!ia(c)||null===c))throw Error(y(a,b,d)+"must be a valid object.")}function og(a,b,c){if(!ia(b)||!v(b,c))throw Error(y(a,1,!1)+'must contain the key "'+c+'"');if(!p(w(b,c)))throw Error(y(a,1,!1)+'must contain the key "'+c+'" with type "string"')}function pg(){this.set={}}function qg(a,b){r(a.set,function(a,d){b(d,a)})}function qc(){this.m=this.B=null}function rg(a,b){if(b.e())return a.B=null,a.m=null,!0;if(null!==a.B){if(a.B.K())return!1;var c=a.B;return a.B=null,c.P(N,function(b,c){a.nc(new L(b),c)}),rg(a,b)}return null===a.m||(c=E(b),b=H(b),a.m.contains(c)&&rg(a.m.get(c),b)&&a.m.remove(c),!!a.m.e()&&(a.m=null,!0))}function rc(a,b,c){null!==a.B?c(b,a.B):a.P(function(a,e){rc(e,new L(b.toString()+"/"+a),c)})}function tg(a,b,c){this.od=a||{},this.ee=b||{},this.$a=c||{},this.od.remember||(this.od.remember="default")}function vg(a){var b={},c={};return ib(a||{},function(a,e){0<=Na(ug,a)?b[a]=e:c[a]=e}),new tg(b,{},c)}function wg(a,b){this.Qe=["session",a.Od,a.hc].join(":"),this.be=b}function xg(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function yg(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(xg())}function zg(){return"undefined"!=typeof location&&/^file:\//.test(location.href)}function Ag(a){var b=xg();if(""===b)return!1;if("Microsoft Internet Explorer"===navigator.appName){if((b=b.match(/MSIE ([0-9]{1,}[\.0-9]{0,})/))&&1<b.length)return parseFloat(b[1])>=a}else if(-1<b.indexOf("Trident")&&(b=b.match(/rv:([0-9]{2,2}[\.0-9]{0,})/))&&1<b.length)return parseFloat(b[1])>=a;return!1}function Bg(){var b,a=window.opener.frames;for(b=a.length-1;0<=b;b--)try{if(a[b].location.protocol===window.location.protocol&&a[b].location.host===window.location.host&&"__winchan_relay_frame"===a[b].name)return a[b]}catch(c){}return null}function Cg(a,b,c){a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener&&a.addEventListener(b,c,!1)}function Dg(a,b,c){a.detachEvent?a.detachEvent("on"+b,c):a.removeEventListener&&a.removeEventListener(b,c,!1)}function Eg(a){/^https?:\/\//.test(a)||(a=window.location.href);var b=/^(https?:\/\/[\-_a-zA-Z\.0-9:]+)/.exec(a);return b?b[1]:a}function Fg(a){var b="";try{var c=lb(a=a.replace("#",""));c&&v(c,"__firebase_request_key")&&(b=w(c,"__firebase_request_key"))}catch(d){}return b}function Gg(){var a=Pc(sg);return a.scheme+"://"+a.host+"/v2"}function Hg(a){return Gg()+"/"+a+"/auth/channel"}function Ig(a){var b=this;if(this.Ac=a,this.ce="*",Ag(8)?this.Rc=this.zd=Bg():(this.Rc=window.opener,this.zd=window),!b.Rc)throw"Unable to find relay frame";Cg(this.zd,"message",q(this.jc,this)),Cg(this.zd,"message",q(this.Bf,this));try{Jg(this,{a:"ready"})}catch(c){Cg(this.Rc,"load",function(){Jg(b,{a:"ready"})})}Cg(window,"unload",q(this.Bg,this))}function Jg(a,b){b=B(b),Ag(8)?a.Rc.doPost(b,a.ce):a.Rc.postMessage(b,a.ce)}function Kg(a){this.pc=Ga()+Ga()+Ga(),this.Ef=a}function Mg(a){var b=Error(w(Lg,a),a);return b.code=a,b}function Ng(a){var b;(b=!a.window_features)||(b=xg(),b=-1!==b.indexOf("Fennec/")||-1!==b.indexOf("Firefox/")&&-1!==b.indexOf("Android")),b&&(a.window_features=void 0),a.window_name||(a.window_name="_blank"),this.options=a}function Og(a){a.method||(a.method="GET"),a.headers||(a.headers={}),a.headers.content_type||(a.headers.content_type="application/json"),a.headers.content_type=a.headers.content_type.toLowerCase(),this.options=a}function Pg(a){this.pc=Ga()+Ga()+Ga(),this.Ef=a}function Qg(a){a.callback_parameter||(a.callback_parameter="callback"),this.options=a,window.__firebase_auth_jsonp=window.__firebase_auth_jsonp||{}}function Rg(a,b,c){setTimeout(function(){try{var d=document.createElement("script");d.type="text/javascript",d.id=a,d.async=!0,d.src=b,d.onerror=function(){var b=document.getElementById(a);null!==b&&b.parentNode.removeChild(b),c&&c(Mg("NETWORK_ERROR"))};var e=document.getElementsByTagName("head");(e&&0!=e.length?e[0]:document.documentElement).appendChild(d)}catch(f){c&&c(Mg("NETWORK_ERROR"))}},0)}function Sg(a,b,c,d){De.call(this,["auth_status"]),this.F=a,this.df=b,this.Vg=c,this.Le=d,this.sc=new wg(a,[xc,yc]),this.mb=null,this.Se=!1,Tg(this)}function Tg(a){yc.get("redirect_request_id")&&Ug(a);var b=a.sc.get();b&&b.token?(Vg(a,b),a.df(b.token,function(c,d){Wg(a,c,d,!1,b.token,b)},function(b,d){Xg(a,"resumeSession()",b,d)})):Vg(a,null)}function Yg(a,b,c,d,e,f){"firebaseio-demo.com"===a.F.domain&&O("Firebase authentication is not supported on demo Firebases (*.firebaseio-demo.com). To secure your Firebase, create a production Firebase at https://www.firebase.com."),a.df(b,function(f,k){Wg(a,f,k,!0,b,c,d||{},e)},function(b,c){Xg(a,"auth()",b,c,f)})}function Zg(a,b){a.sc.clear(),Vg(a,null),a.Vg(function(a,d){if("ok"===a)P(b,null);else{var e=(a||"error").toUpperCase(),f=e;d&&(f+=": "+d),(f=Error(f)).code=e,P(b,f)}})}function Wg(a,b,c,d,e,f,h,k){"ok"===b?(d&&(b=c.auth,f.auth=b,f.expires=c.expires,f.token=bd(e)?e:"",c=null,b&&v(b,"uid")?c=w(b,"uid"):v(f,"uid")&&(c=w(f,"uid")),f.uid=c,c="custom",b&&v(b,"provider")?c=w(b,"provider"):v(f,"provider")&&(c=w(f,"provider")),f.provider=c,a.sc.clear(),bd(e)&&(h=h||{},c=xc,"sessionOnly"===h.remember&&(c=yc),"none"!==h.remember&&a.sc.set(f,c)),Vg(a,f)),P(k,null,f)):(a.sc.clear(),Vg(a,null),f=a=(b||"error").toUpperCase(),c&&(f+=": "+c),f=Error(f),f.code=a,P(k,f))}function Xg(a,b,c,d,e){O(b+" was canceled: "+d),a.sc.clear(),Vg(a,null),(a=Error(d)).code=c.toUpperCase(),P(e,a)}function $g(a,b,c,d,e){ah(a),bh(a,[Og,Qg],"/auth/"+b,c=new tg(d||{},{},c||{}),e)}function ch(a,b,c,d){ah(a);var e=[Ng,Pg];c=vg(c),"anonymous"===b||"password"===b?setTimeout(function(){P(d,Mg("TRANSPORT_UNAVAILABLE"))},0):(c.ee.window_features="menubar=yes,modal=yes,alwaysRaised=yeslocation=yes,resizable=yes,scrollbars=yes,status=yes,height=625,width=625,top="+("object"==typeof screen?.5*(screen.height-625):0)+",left="+("object"==typeof screen?.5*(screen.width-625):0),c.ee.relay_url=Hg(a.F.hc),c.ee.requestWithCredential=q(a.qc,a),bh(a,e,"/auth/"+b,c,d))}function Ug(a){var b=yc.get("redirect_request_id");if(b){c=yc.get("redirect_client_options");yc.remove("redirect_request_id"),yc.remove("redirect_client_options");var d=[Og,Qg],c=new tg(c,{},b={requestId:b,requestKey:Fg(document.location.hash)});a.Se=!0;try{document.location.hash=document.location.hash.replace(/&__firebase_request_key=([a-zA-z0-9]*)/,"")}catch(e){}bh(a,d,"/auth/session",c,function(){this.Se=!1}.bind(a))}}function bh(a,b,c,d,e){dh(a,b,c,d,function(b,c){!b&&c&&c.token&&c.uid?Yg(a,c.token,c,d.od,function(a,b){a?P(e,a):P(e,null,b)}):P(e,b||Mg("UNKNOWN_ERROR"))})}function dh(a,b,c,d,e){0===(b=Pa(b,function(a){return"function"==typeof a.isAvailable&&a.isAvailable()})).length?setTimeout(function(){P(e,Mg("TRANSPORT_UNAVAILABLE"))},0):(b=new(b.shift())(d.ee),d=jb(d.$a),d.v="js-"+hb,d.transport=b.Cc(),d.suppress_status_codes=!0,a=Gg()+"/"+a.F.hc+c,b.open(a,d,function(a,b){if(a)P(e,a);else if(b&&b.error){var c=Error(b.error.message);c.code=b.error.code,c.details=b.error.details,P(e,c)}else P(e,null,b)}))}function Vg(a,b){var c=null!==a.mb||null!==b;a.mb=b,c&&a.fe("auth_status",b),a.Le(null!==b)}function ah(a){var b=a.F;if("firebaseio.com"!==b.domain&&"firebaseio-demo.com"!==b.domain&&"auth.firebase.com"===sg)throw Error("This custom Firebase server ('"+a.F.domain+"') does not support delegated login.")}function eh(a){this.jc=a,this.Nd=[],this.Sb=0,this.qe=-1,this.Fb=null}function fh(a,b,c){a.qe=b,a.Fb=c,a.qe<a.Sb&&(a.Fb(),a.Fb=null)}function gh(a,b,c){for(a.Nd[b]=c;a.Nd[a.Sb];){var d=a.Nd[a.Sb];delete a.Nd[a.Sb];for(var e=0;e<d.length;++e)if(d[e]){var f=a;Db(function(){f.jc(d[e])})}if(a.Sb===a.qe){a.Fb&&(clearTimeout(a.Fb),a.Fb(),a.Fb=null);break}a.Sb++}}function hh(a,b,c,d){this.re=a,this.f=Mc(a),this.nb=this.ob=0,this.Ua=Rb(b),this.Qf=c,this.Hc=!1,this.Bb=d,this.jd=function(a){return Bc(b,Dc,a)}}function lh(a,b){var c=B(b).length;a.nb+=c,Ob(a.Ua,"bytes_received",c)}function kh(a,b,c,d){if(this.jd=d,this.hb=c,this.Pe=new pg,this.ad=[],this.te=Math.floor(1e8*Math.random()),this.Xd=!0,this.he=Ec(),window["pLPCommand"+this.he]=a,window["pRTLPCB"+this.he]=b,a=document.createElement("iframe"),a.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(a);try{a.contentWindow.document||Cb("No IE domain setting required")}catch(e){a.src="javascript:void((function(){document.open();document.domain='"+document.domain+"';document.close();})())"}a.contentDocument?a.eb=a.contentDocument:a.contentWindow?a.eb=a.contentWindow.document:a.document&&(a.eb=a.document),this.Ea=a,a="",this.Ea.src&&"javascript:"===this.Ea.src.substr(0,11)&&(a='<script>document.domain="'+document.domain+'";<\/script>'),a="<html><body>"+a+"</body></html>";try{this.Ea.eb.open(),this.Ea.eb.write(a),this.Ea.eb.close()}catch(f){Cb("frame writing exception"),f.stack&&Cb(f.stack),Cb(f)}}function nh(a){if(a.le&&a.Xd&&a.Pe.count()<(0<a.ad.length?2:1)){a.te++,(b={}).id=a.ug,b.pw=a.vg,b.ser=a.te;for(var b=a.jd(b),c="",d=0;0<a.ad.length&&1870>=a.ad[0].kf.length+30+c.length;){var e=a.ad.shift(),c=c+"&seg"+d+"="+e.Mg+"&ts"+d+"="+e.Ug+"&d"+d+"="+e.kf;d++}return oh(a,b+c,a.te),!0}return!1}function oh(a,b,c){function d(){a.Pe.remove(c),nh(a)}a.Pe.add(c,1);var e=setTimeout(d,Math.floor(25e3));mh(a,b,function(){clearTimeout(e),d()})}function mh(a,b,c){setTimeout(function(){try{if(a.Xd){var d=a.Ea.eb.createElement("script");d.type="text/javascript",d.async=!0,d.src=b,d.onload=d.onreadystatechange=function(){var a=d.readyState;a&&"loaded"!==a&&"complete"!==a||(d.onload=d.onreadystatechange=null,d.parentNode&&d.parentNode.removeChild(d),c())},d.onerror=function(){Cb("Long-poll script failed to load: "+b),a.Xd=!1,a.close()},a.Ea.eb.body.appendChild(d)}}catch(e){}},Math.floor(1))}function qh(a,b,c,d){this.re=a,this.f=Mc(this.re),this.frames=this.Kc=null,this.nb=this.ob=this.bf=0,this.Ua=Rb(b),a={v:"5"},"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf("firebaseio.com")&&(a.r="f"),c&&(a.s=c),d&&(a.ls=d),this.ef=Bc(b,Cc,a)}function th(a,b){if(a.frames.push(b),a.frames.length==a.bf){var c=a.frames.join("");a.frames=null,c=nb(c),a.zg(c)}}function sh(a){clearInterval(a.Kc),a.Kc=setInterval(function(){a.ua&&a.ua.send("0"),sh(a)},Math.floor(45e3))}function uh(a){vh(this,a)}function vh(a,b){var c=qh&&qh.isAvailable(),d=c&&!(xc.wf||!0===xc.get("previous_websocket_failure"));if(b.Wg&&(c||O("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),d=!0),d)a.gd=[qh];else{var e=a.gd=[];Wc(wh,function(a,b){b&&b.isAvailable()&&e.push(b)})}}function xh(a){if(0<a.gd.length)return a.gd[0];throw Error("No transports available")}function yh(a,b,c,d,e,f,h){this.id=a,this.f=Mc("c:"+this.id+":"),this.jc=c,this.Wc=d,this.la=e,this.Ne=f,this.F=b,this.Md=[],this.ff=0,this.Pf=new uh(b),this.Ta=0,this.Bb=h,this.f("Connection created"),zh(this)}function zh(a){var b=xh(a.Pf);a.J=new b("c:"+a.id+":"+a.ff++,a.F,void 0,a.Bb),a.Re=b.responsesRequiredToBeHealthy||0;var c=Ah(a,a.J),d=Bh(a,a.J);a.hd=a.J,a.cd=a.J,a.D=null,a.Ab=!1,setTimeout(function(){a.J&&a.J.open(c,d)},Math.floor(0)),0<(b=b.healthyTimeout||0)&&(a.yd=setTimeout(function(){a.yd=null,a.Ab||(a.J&&102400<a.J.nb?(a.f("Connection exceeded healthy timeout but has received "+a.J.nb+" bytes.  Marking connection healthy."),a.Ab=!0,a.J.Ed()):a.J&&10240<a.J.ob?a.f("Connection exceeded healthy timeout but has sent "+a.J.ob+" bytes.  Leaving connection alive."):(a.f("Closing unhealthy connection after timeout."),a.close()))},Math.floor(b)))}function Bh(a,b){return function(c){b===a.J?(a.J=null,c||0!==a.Ta?1===a.Ta&&a.f("Realtime connection lost."):(a.f("Realtime connection failed."),"s-"===a.F.Ya.substr(0,2)&&(xc.remove("host:"+a.F.host),a.F.Ya=a.F.host)),a.close()):b===a.D?(a.f("Secondary connection lost."),c=a.D,a.D=null,a.hd!==c&&a.cd!==c||a.close()):a.f("closing an old connection")}}function Ah(a,b){return function(c){if(2!=a.Ta)if(b===a.cd){d=Tc("t",c);if(c=Tc("d",c),"c"==d){if(d=Tc("t",c),"d"in c)if(c=c.d,"h"===d){var d=c.ts,e=c.v,f=c.h;a.Nf=c.s,Ac(a.F,f),0==a.Ta&&(a.J.start(),Ch(a,a.J,d),"5"!==e&&O("Protocol version mismatch detected"),c=a.Pf,(c=1<c.gd.length?c.gd[1]:null)&&Dh(a,c))}else if("n"===d){for(a.f("recvd end transmission on primary"),a.cd=a.D,c=0;c<a.Md.length;++c)a.Id(a.Md[c]);a.Md=[],Eh(a)}else"s"===d?(a.f("Connection shutdown command received. Shutting down..."),a.Ne&&(a.Ne(c),a.Ne=null),a.la=null,a.close()):"r"===d?(a.f("Reset packet received.  New host: "+c),Ac(a.F,c),1===a.Ta?a.close():(Fh(a),zh(a))):"e"===d?Nc("Server Error: "+c):"o"===d?(a.f("got pong on primary."),Gh(a),Hh(a)):Nc("Unknown control packet command: "+d)}else"d"==d&&a.Id(c)}else if(b===a.D)if(d=Tc("t",c),c=Tc("d",c),"c"==d)"t"in c&&("a"===(c=c.t)?Ih(a):"r"===c?(a.f("Got a reset on secondary, closing it"),a.D.close(),a.hd!==a.D&&a.cd!==a.D||a.close()):"o"===c&&(a.f("got pong on secondary."),a.Mf--,Ih(a)));else{if("d"!=d)throw Error("Unknown protocol layer: "+d);a.Md.push(c)}else a.f("message on old connection")}}function Eh(a){a.hd===a.D&&a.cd===a.D&&(a.f("cleaning up and promoting a connection: "+a.D.re),a.J=a.D,a.D=null)}function Ih(a){0>=a.Mf?(a.f("Secondary connection is healthy."),a.Ab=!0,a.D.Ed(),a.D.start(),a.f("sending client ack on secondary"),a.D.send({t:"c",d:{t:"a",d:{}}}),a.f("Ending transmission on primary"),a.J.send({t:"c",d:{t:"n",d:{}}}),a.hd=a.D,Eh(a)):(a.f("sending ping on secondary."),a.D.send({t:"c",d:{t:"p",d:{}}}))}function Gh(a){a.Ab||(a.Re--,0>=a.Re&&(a.f("Primary connection is healthy."),a.Ab=!0,a.J.Ed()))}function Dh(a,b){a.D=new b("c:"+a.id+":"+a.ff++,a.F,a.Nf),a.Mf=b.responsesRequiredToBeHealthy||0,a.D.open(Ah(a,a.D),Bh(a,a.D)),setTimeout(function(){a.D&&(a.f("Timed out trying to upgrade."),a.D.close())},Math.floor(6e4))}function Ch(a,b,c){a.f("Realtime connection established."),a.J=b,a.Ta=1,a.Wc&&(a.Wc(c,a.Nf),a.Wc=null),0===a.Re?(a.f("Primary connection is healthy."),a.Ab=!0):setTimeout(function(){Hh(a)},Math.floor(5e3))}function Hh(a){a.Ab||1!==a.Ta||(a.f("sending ping on primary."),Jh(a,{t:"c",d:{t:"p",d:{}}}))}function Jh(a,b){if(1!==a.Ta)throw"Connection is not connected";a.hd.send(b)}function Fh(a){a.f("Shutting down all connections"),a.J&&(a.J.close(),a.J=null),a.D&&(a.D.close(),a.D=null),a.yd&&(clearTimeout(a.yd),a.yd=null)}function Kh(a,b,c,d){this.id=Lh++,this.f=Mc("p:"+this.id+":"),this.xf=this.Ee=!1,this.$={},this.qa=[],this.Yc=0,this.Vc=[],this.oa=!1,this.Za=1e3,this.Fd=3e5,this.Gb=b,this.Uc=c,this.Oe=d,this.F=a,this.sb=this.Aa=this.Ia=this.Bb=this.We=null,this.Ob=!1,this.Td={},this.Lg=0,this.nf=!0,this.Lc=this.Ge=null,Mh(this,0),He.ub().Eb("visible",this.Cg,this),-1===a.host.indexOf("fblocal")&&Ge.ub().Eb("online",this.Ag,this)}function Oh(a,b){var c=b.Ig,d=c.path.toString(),e=c.va();a.f("Listen on "+d+" for "+e);var f={p:d};b.tag&&(f.q=ee(c.n),f.t=b.tag),f.h=b.xd(),a.Fa("q",f,function(f){var k=f.d,l=f.s;if(k&&"object"==typeof k&&v(k,"w")){var m=w(k,"w");ea(m)&&0<=Na(m,"no_index")&&O('Using an unspecified index. Consider adding ".indexOn": "'+c.n.g.toString()+'" at '+c.path.toString()+" to your security rules for better performance")}(a.$[d]&&a.$[d][e])===b&&(a.f("listen response",f),"ok"!==l&&Ph(a,d,e),b.H&&b.H(l,k))})}function Qh(a){var b=a.Aa;a.oa&&b&&a.Fa("auth",{cred:b.ig},function(c){var d=c.s;c=c.d||"error","ok"!==d&&a.Aa===b&&delete a.Aa,b.of?"ok"!==d&&b.md&&b.md(d,c):(b.of=!0,b.zc&&b.zc(d,c))})}function Rh(a,b,c,d,e){c={p:c,d:d},a.f("onDisconnect "+b,c),a.Fa(b,c,function(a){e&&setTimeout(function(){e(a.s,a.d)},Math.floor(0))})}function Sh(a,b,c,d,e,f){d={p:c,d:d},n(f)&&(d.h=f),a.qa.push({action:b,Jf:d,H:e}),a.Yc++,b=a.qa.length-1,a.oa?Th(a,b):a.f("Buffering put: "+c)}function Th(a,b){var c=a.qa[b].action,d=a.qa[b].Jf,e=a.qa[b].H;a.qa[b].Jg=a.oa,a.Fa(c,d,function(d){a.f(c+" response",d),delete a.qa[b],a.Yc--,0===a.Yc&&(a.qa=[]),e&&e(d.s,d.d)})}function Mh(a,b){K(!a.Ia,"Scheduling a connect when we're already connected/ing?"),a.sb&&clearTimeout(a.sb),a.sb=setTimeout(function(){a.sb=null,Wh(a)},Math.floor(b))}function Wh(a){if(Xh(a)){a.f("Making a connection attempt"),a.Ge=(new Date).getTime(),a.Lc=null;var b=q(a.Id,a),c=q(a.Wc,a),d=q(a.Df,a),e=a.id+":"+Nh++;a.Ia=new yh(e,a.F,b,c,d,function(b){O(b+" ("+a.F.toString()+")"),a.xf=!0},a.Bb)}}function Uh(a,b,c){(a=Ph(a,b,c=c?Qa(c,function(a){return Uc(a)}).join("$"):"default"))&&a.H&&a.H("permission_denied")}function Ph(a,b,c){b=new L(b).toString();var d;return n(a.$[b])?(d=a.$[b][c],delete a.$[b][c],0===pa(a.$[b])&&delete a.$[b]):d=void 0,d}function Vh(a){Qh(a),r(a.$,function(b){r(b,function(b){Oh(a,b)})});for(var b=0;b<a.qa.length;b++)a.qa[b]&&Th(a,b);for(;a.Vc.length;)b=a.Vc.shift(),Rh(a,b.action,b.$c,b.data,b.H)}function Xh(a){var b;return b=Ge.ub().kc,!a.xf&&!a.Ee&&b}function Q(a,b,c){this.A=a,this.W=b,this.g=c}function Yh(a,b){this.F=a,this.Ua=Rb(a),this.fd=null,this.da=new vb,this.Hd=1,this.Ra=null,b||0<=("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)?(this.ba=new Ae(this.F,q(this.Gb,this)),setTimeout(q(this.Uc,this,!0),0)):this.ba=this.Ra=new Kh(this.F,q(this.Gb,this),q(this.Uc,this),q(this.Oe,this)),this.Sg=Sb(a,q(function(){return new Mb(this.Ua,this.ba)},this)),this.uc=new Rf,this.Ce=new ob;var c=this;this.Cd=new vf({Xe:function(a,b,f,h){return b=[],(f=c.Ce.j(a.path)).e()||(b=xf(c.Cd,new Xb(bf,a.path,f)),setTimeout(function(){h("ok")},0)),b},ae:ba}),Zh(this,"connected",!1),this.la=new qc,this.M=new Sg(a,q(this.ba.M,this.ba),q(this.ba.ge,this.ba),q(this.Le,this)),this.sd=0,this.De=null,this.L=new vf({Xe:function(a,b,f,h){return c.ba.yf(a,f,b,function(b,e){var f=h(b,e);Ab(c.da,a.path,f)}),[]},ae:function(a,b){c.ba.Rf(a,b)}})}function $h(a){return a=a.Ce.j(new L(".info/serverTimeOffset")).I()||0,(new Date).getTime()+a}function ai(a){return a=a={timestamp:$h(a)},a.timestamp=a.timestamp||(new Date).getTime(),a}function Zh(a,b,c){b=new L("/.info/"+b),c=M(c);var d=a.Ce;d.Wd=d.Wd.G(b,c),c=xf(a.Cd,new Xb(bf,b,c)),Ab(a.da,b,c)}function ci(a){a.f("onDisconnectEvents");var b=ai(a),c=[];rc(pc(a.la,b),G,function(b,e){c=c.concat(xf(a.L,new Xb(bf,b,e)));var f=ei(a,b);bi(a,f)}),a.la=new qc,Ab(a.da,G,c)}function fi(a,b,c,d){var e=M(c);a.ba.Me(b.toString(),e.I(!0),function(c,h){"ok"===c&&a.la.nc(b,e),di(d,c,h)})}function gi(a,b,c,d,e){var f=M(c,d);a.ba.Me(b.toString(),f.I(!0),function(c,d){"ok"===c&&a.la.nc(b,f),di(e,c,d)})}function hi(a,b,c,d){var f,e=!0;for(f in c)e=!1;e?(Cb("onDisconnect().update() called with empty data.  Don't do anything."),di(d,"ok")):a.ba.Cf(b.toString(),c,function(e,f){if("ok"===e)for(var l in c){var m=M(c[l]);a.la.nc(b.u(l),m)}di(d,e,f)})}function ii(a,b,c){c=".info"===E(b.path)?a.Cd.Pb(b,c):a.L.Pb(b,c),yb(a.da,b.path,c)}function di(a,b,c){a&&Db(function(){if("ok"==b)a(null);else{var d=(b||"error").toUpperCase(),e=d;c&&(e+=": "+c),(e=Error(e)).code=d,a(e)}})}function ji(a,b,c,d,e){function f(){}a.f("transaction on "+b);var h=new U(a,b);if(h.Eb("value",f),c={path:b,update:c,H:d,status:null,Ff:Ec(),cf:e,Lf:0,ie:function(){h.ic("value",f)},ke:null,Ba:null,pd:null,qd:null,rd:null},d=a.L.za(b,void 0)||C,c.pd=d,d=c.update(d.I()),n(d)){cg("transaction failed: Data returned ",d,c.path),c.status=1;var k=(e=Sf(a.uc,b)).Ca()||[];k.push(c),Tf(e,k),"object"==typeof d&&null!==d&&v(d,".priority")?(k=w(d,".priority"),K(ag(k),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):k=(a.L.za(b)||C).C().I(),e=ai(a),e=sc(d=M(d,k),e),c.qd=d,c.rd=e,c.Ba=a.Hd++,c=wf(a.L,b,e,c.Ba,c.cf),Ab(a.da,b,c),ki(a)}else c.ie(),c.qd=null,c.rd=null,c.H&&(a=new Q(c.pd,new U(a,c.path),N),c.H(null,!1,a))}function ki(a,b){var c=b||a.uc;if(b||li(a,c),null!==c.Ca()){var d=mi(a,c);K(0<d.length,"Sending zero length transaction queue"),Sa(d,function(a){return 1===a.status})&&ni(a,c.path(),d)}else c.wd()&&c.P(function(b){ki(a,b)})}function ni(a,b,c){for(var d=Qa(c,function(a){return a.Ba}),d=e=a.L.za(b,d)||C,e=e.hash(),f=0;f<c.length;f++){var h=c[f];K(1===h.status,"tryToSendTransactionQueue_: items in queue should all be run."),h.status=2,h.Lf++;var k=T(b,h.path),d=d.G(k,h.qd)}d=d.I(!0),a.ba.put(b.toString(),d,function(d){a.f("transaction put response",{path:b.toString(),status:d});var e=[];if("ok"===d){for(d=[],f=0;f<c.length;f++){if(c[f].status=3,e=e.concat(zf(a.L,c[f].Ba)),c[f].H){var h=c[f].rd,k=new U(a,c[f].path);d.push(q(c[f].H,null,null,!0,new Q(h,k,N)))}c[f].ie()}for(li(a,Sf(a.uc,b)),ki(a),Ab(a.da,b,e),f=0;f<d.length;f++)Db(d[f])}else{if("datastale"===d)for(f=0;f<c.length;f++)c[f].status=4===c[f].status?5:1;else for(O("transaction at "+b.toString()+" failed: "+d),f=0;f<c.length;f++)c[f].status=5,c[f].ke=d;bi(a,b)}},e)}function bi(a,b){var c=oi(a,b),d=c.path();return pi(a,c=mi(a,c),d),d}function pi(a,b,c){if(0!==b.length){for(var d=[],e=[],f=Qa(b,function(a){return a.Ba}),h=0;h<b.length;h++){var t,k=b[h],l=T(c,k.path),m=!1;if(K(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),5===k.status)m=!0,t=k.ke,e=e.concat(zf(a.L,k.Ba,!0));else if(1===k.status)if(25<=k.Lf)m=!0,t="maxretry",e=e.concat(zf(a.L,k.Ba,!0));else{var z=a.L.za(k.path,f)||C;k.pd=z;var I=b[h].update(z.I());n(I)?(cg("transaction failed: Data returned ",I,k.path),l=M(I),"object"==typeof I&&null!=I&&v(I,".priority")||(l=l.ga(z.C())),z=k.Ba,I=ai(a),I=sc(l,I),k.qd=l,k.rd=I,k.Ba=a.Hd++,Va(f,z),e=e.concat(wf(a.L,k.path,I,k.Ba,k.cf)),e=e.concat(zf(a.L,z,!0))):(m=!0,t="nodata",e=e.concat(zf(a.L,k.Ba,!0)))}Ab(a.da,c,e),e=[],m&&(b[h].status=3,setTimeout(b[h].ie,Math.floor(0)),b[h].H&&("nodata"===t?(k=new U(a,b[h].path),d.push(q(b[h].H,null,null,!1,new Q(b[h].pd,k,N)))):d.push(q(b[h].H,null,Error(t),!1,null))))}for(li(a,a.uc),h=0;h<d.length;h++)Db(d[h]);ki(a)}}function oi(a,b){for(var c,d=a.uc;null!==(c=E(b))&&null===d.Ca();)d=Sf(d,c),b=H(b);return d}function mi(a,b){var c=[];return qi(a,b,c),c.sort(function(a,b){return a.Ff-b.Ff}),c}function qi(a,b,c){var d=b.Ca();if(null!==d)for(var e=0;e<d.length;e++)c.push(d[e]);b.P(function(b){qi(a,b,c)})}function li(a,b){var c=b.Ca();if(c){for(var d=0,e=0;e<c.length;e++)3!==c[e].status&&(c[d]=c[e],d++);c.length=d,Tf(b,0<c.length?c:null)}b.P(function(b){li(a,b)})}function ei(a,b){var c=oi(a,b).path(),d=Sf(a.uc,b);return Wf(d,function(b){ri(a,b)}),ri(a,d),Vf(d,function(b){ri(a,b)}),c}function ri(a,b){var c=b.Ca();if(null!==c){for(var d=[],e=[],f=-1,h=0;h<c.length;h++)4!==c[h].status&&(2===c[h].status?(K(f===h-1,"All SENT items should be at beginning of queue."),f=h,c[h].status=4,c[h].ke="set"):(K(1===c[h].status,"Unexpected transaction status in abort"),c[h].ie(),e=e.concat(zf(a.L,c[h].Ba,!0)),c[h].H&&d.push(q(c[h].H,null,Error("set"),!1,null))));for(-1===f?Tf(b,null):c.length=f+1,Ab(a.da,b.path(),e),h=0;h<d.length;h++)Db(d[h])}}function W(){this.oc={},this.Sf=!1}function X(a,b){this.bd=a,this.ra=b}function Y(a,b,c,d){this.k=a,this.path=b,this.n=c,this.lc=d}function si(a){var b=null,c=null;if(a.ma&&(b=nd(a)),a.pa&&(c=pd(a)),a.g===Qd){if(a.ma){if("[MIN_NAME]"!=md(a))throw Error("Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().");if("string"!=typeof b)throw Error("Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.")}if(a.pa){if("[MAX_NAME]"!=od(a))throw Error("Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().");if("string"!=typeof c)throw Error("Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.")}}else if(a.g===N){if(null!=b&&!ag(b)||null!=c&&!ag(c))throw Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(K(a.g instanceof Ud||a.g===$d,"unknown index type."),null!=b&&"object"==typeof b||null!=c&&"object"==typeof c)throw Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")}function ti(a){if(a.ma&&a.pa&&a.ja&&(!a.ja||""===a.Nb))throw Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")}function ui(a,b){if(!0===a.lc)throw Error(b+": You can't combine multiple orderBy calls.")}function vi(a,b,c){var d={cancel:null,Ma:null};if(b&&c)d.cancel=b,A(a,3,d.cancel,!0),d.Ma=c,mb(a,4,d.Ma);else if(b)if("object"==typeof b&&null!==b)d.Ma=b;else{if("function"!=typeof b)throw Error(y(a,3,!0)+" must either be a cancel callback or a context object.");d.cancel=b}return d}function U(a,b){var c,d,e;if(a instanceof Yh)c=a,d=b;else{x("new Firebase",1,2,arguments.length),c=(d=Pc(arguments[0])).Tg,"firebase"===d.domain&&Oc(d.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),c&&"undefined"!=c||Oc("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),d.kb||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&O("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),c=new zc(d.host,d.kb,c,"ws"===d.scheme||"wss"===d.scheme),e=(d=new L(d.$c)).toString();var f;if(!(f=!p(c.host)||0===c.host.length||!$f(c.hc))&&(f=0!==e.length)&&(e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),f=!(p(e)&&0!==e.length&&!Yf.test(e))),f)throw Error(y("new Firebase",1,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".');if(b)if(b instanceof W)e=b;else{if(!p(b))throw Error("Expected a valid Firebase.Context for second argument to new Firebase()");e=W.ub(),c.Od=b}else e=W.ub();f=c.toString();var h=w(e.oc,f);h||(h=new Yh(c,e.Sf),e.oc[f]=h),c=h}Y.call(this,c,d,be,!1)}function Lc(a,b){K(!b||!0===a||!1===a,"Can't turn on custom loggers persistently."),!0===a?("undefined"!=typeof console&&("function"==typeof console.log?Bb=q(console.log,console):"object"==typeof console.log&&(Bb=function(a){console.log(a)})),b&&yc.set("logging_enabled",!0)):a?Bb=a:(Bb=null,yc.remove("logging_enabled"))}var g,aa=this,la=Date.now||function(){return+new Date},ya="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),Ea={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},Fa=/\uffff/.test("")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g,Ha;a:{var Ia=aa.navigator;if(Ia){var Ja=Ia.userAgent;if(Ja){Ha=Ja;break a}}Ha=""}ma(La,Ka),La.prototype.reset=function(){this.N[0]=1732584193,this.N[1]=4023233417,this.N[2]=2562383102,this.N[3]=271733878,this.N[4]=3285377520,this.de=this.ac=0},La.prototype.update=function(a,b){if(null!=a){n(b)||(b=a.length);for(var c=b-this.Va,d=0,e=this.me,f=this.ac;d<b;){if(0==f)for(;d<=c;)Ma(this,a,d),d+=this.Va;if(p(a)){for(;d<b;)if(e[f]=a.charCodeAt(d),++f,++d,f==this.Va){Ma(this,e),f=0;break}}else for(;d<b;)if(e[f]=a[d],++f,++d,f==this.Va){Ma(this,e),f=0;break}}this.ac=f,this.de+=b}};var u=Array.prototype,Na=u.indexOf?function(a,b,c){return u.indexOf.call(a,b,c)}:function(a,b,c){if(c=null==c?0:0>c?Math.max(0,a.length+c):c,p(a))return p(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Oa=u.forEach?function(a,b,c){u.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=p(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},Pa=u.filter?function(a,b,c){return u.filter.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=[],f=0,h=p(a)?a.split(""):a,k=0;k<d;k++)if(k in h){var l=h[k];b.call(c,l,k,a)&&(e[f++]=l)}return e},Qa=u.map?function(a,b,c){return u.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=p(a)?a.split(""):a,h=0;h<d;h++)h in f&&(e[h]=b.call(c,f[h],h,a));return e},Ra=u.reduce?function(a,b,c,d){for(var e=[],f=1,h=arguments.length;f<h;f++)e.push(arguments[f]);return d&&(e[0]=q(b,d)),u.reduce.apply(a,e)}:function(a,b,c,d){var e=c;return Oa(a,function(c,h){e=b.call(d,e,c,h,a)}),e},Sa=u.every?function(a,b,c){return u.every.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=p(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&!b.call(c,e[f],f,a))return!1;return!0},Za=-1!=Ha.indexOf("Opera")||-1!=Ha.indexOf("OPR"),$a=-1!=Ha.indexOf("Trident")||-1!=Ha.indexOf("MSIE"),ab=-1!=Ha.indexOf("Gecko")&&-1==Ha.toLowerCase().indexOf("webkit")&&!(-1!=Ha.indexOf("Trident")||-1!=Ha.indexOf("MSIE")),bb=-1!=Ha.toLowerCase().indexOf("webkit");!function(){var b,a="";Za&&aa.opera?(a=aa.opera.version,ha(a)&&a()):(ab?b=/rv\:([^\);]+)(\)|;)/:$a?b=/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/:bb&&(b=/WebKit\/(\S+)/),b&&(a=(a=b.exec(Ha))?a[1]:""),$a&&(b=(b=aa.document)?b.documentMode:void 0)>parseFloat(a)&&String(b))}();var cb=null,db=null,eb=null,hb=hb||"2.3.1";ob.prototype.j=function(a){return this.Wd.Q(a)},ob.prototype.toString=function(){return this.Wd.toString()},pb.prototype.qf=function(){return null},pb.prototype.ye=function(){return null};var qb=new pb;rb.prototype.qf=function(a){var b=this.Ka.O;return sb(b,a)?b.j().R(a):(b=null!=this.Kd?new tb(this.Kd,!0,!1):this.Ka.w(),this.Tf.xc(a,b))},rb.prototype.ye=function(a,b,c){var d=null!=this.Kd?this.Kd:ub(this.Ka);return 0===(a=this.Tf.ne(d,b,1,c,a)).length?null:a[0]},xb.prototype.add=function(a){this.vd.push(a)},xb.prototype.Zb=function(){return this.ra};var Fb="value";Gb.prototype.Zb=function(){var a=this.Zd.Ib();return"value"===this.ud?a.path:a.parent().path},Gb.prototype.ze=function(){return this.ud},Gb.prototype.Vb=function(){return this.ue.Vb(this)},Gb.prototype.toString=function(){return this.Zb().toString()+":"+this.ud+":"+B(this.Zd.mf())},Hb.prototype.Zb=function(){return this.path},Hb.prototype.ze=function(){return"cancel"},Hb.prototype.Vb=function(){return this.ue.Vb(this)},Hb.prototype.toString=function(){return this.path.toString()+":cancel"},tb.prototype.j=function(){return this.A},Lb.prototype.get=function(){var a=this.gg.get(),b=xa(a);if(this.Dd)for(var c in this.Dd)b[c]-=this.Dd[c];return this.Dd=a,b},Mb.prototype.If=function(){var d,a=this.fd.get(),b={},c=!1;for(d in a)0<a[d]&&v(this.Of,d)&&(b[d]=a[d],c=!0);c&&this.ba.Ue(b),setTimeout(q(this.If,this),Math.floor(6e5*Math.random()))},Nb.prototype.get=function(){return xa(this.Ec)};var Pb={},Qb={};Xb.prototype.Xc=function(a){return this.path.e()?new Xb(this.source,G,this.Ga.R(a)):new Xb(this.source,H(this.path),this.Ga)},Xb.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" overwrite: "+this.Ga.toString()+")"},Zb.prototype.Xc=function(){return this.path.e()?new Zb(this.source,G):new Zb(this.source,H(this.path))},Zb.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" listen_complete)"},g=ac.prototype,g.Oa=function(a,b){return new ac(this.La,this.wa.Oa(a,b,this.La).Y(null,null,!1,null,null))},g.remove=function(a){return new ac(this.La,this.wa.remove(a,this.La).Y(null,null,!1,null,null))},g.get=function(a){for(var b,c=this.wa;!c.e();){if(0===(b=this.La(a,c.key)))return c.value;0>b?c=c.left:0<b&&(c=c.right)}return null},g.e=function(){return this.wa.e()},g.count=function(){return this.wa.count()},g.Sc=function(){return this.wa.Sc()},g.fc=function(){return this.wa.fc()},g.ia=function(a){return this.wa.ia(a)},g.Xb=function(a){return new dc(this.wa,null,this.La,!1,a)},g.Yb=function(a,b){return new dc(this.wa,a,this.La,!1,b)},g.$b=function(a,b){return new dc(this.wa,a,this.La,!0,b)},g.sf=function(a){return new dc(this.wa,null,this.La,!0,a)},g=fc.prototype,g.Y=function(a,b,c,d,e){return new fc(null!=a?a:this.key,null!=b?b:this.value,null!=c?c:this.color,null!=d?d:this.left,null!=e?e:this.right)},g.count=function(){return this.left.count()+1+this.right.count()},g.e=function(){return!1},g.ia=function(a){return this.left.ia(a)||a(this.key,this.value)||this.right.ia(a)},g.Sc=function(){return gc(this).key},g.fc=function(){return this.right.e()?this.key:this.right.fc()},g.Oa=function(a,b,c){var d,e;return e=this,d=c(a,e.key),e=0>d?e.Y(null,null,null,e.left.Oa(a,b,c),null):0===d?e.Y(null,b,null,null,null):e.Y(null,null,null,null,e.right.Oa(a,b,c)),hc(e)},g.remove=function(a,b){var c,d;if(c=this,0>b(a,c.key))c.left.e()||c.left.fa()||c.left.left.fa()||(c=jc(c)),c=c.Y(null,null,null,c.left.remove(a,b),null);else{if(c.left.fa()&&(c=kc(c)),c.right.e()||c.right.fa()||c.right.left.fa()||(c=lc(c)).left.left.fa()&&(c=kc(c),c=lc(c)),0===b(a,c.key)){if(c.right.e())return bc;d=gc(c.right),c=c.Y(d.key,d.value,null,null,ic(c.right))}c=c.Y(null,null,null,null,c.right.remove(a,b))}return hc(c)},g.fa=function(){return this.color},g=nc.prototype,g.Y=function(){return this},g.Oa=function(a,b){return new fc(a,b,null)},g.remove=function(){return this},g.count=function(){return 0},g.e=function(){return!0},g.ia=function(){return!1},g.Sc=function(){return null},g.fc=function(){return null},g.fa=function(){return!1};var bc=new nc;uc.prototype.set=function(a,b){null==b?delete this.wc[a]:this.wc[a]=b},uc.prototype.get=function(a){return v(this.wc,a)?this.wc[a]:null},uc.prototype.remove=function(a){delete this.wc[a]},uc.prototype.wf=!0,g=vc.prototype,g.set=function(a,b){null==b?this.Fc.removeItem(this.Pd+a):this.Fc.setItem(this.Pd+a,B(b))},g.get=function(a){return null==(a=this.Fc.getItem(this.Pd+a))?null:nb(a)},g.remove=function(a){this.Fc.removeItem(this.Pd+a)},g.wf=!1,g.toString=function(){return this.Fc.toString()};var xc=wc("localStorage"),yc=wc("sessionStorage");zc.prototype.toString=function(){var a=(this.kb?"https://":"http://")+this.host;return this.Od&&(a+="<"+this.Od+">"),a};var Ec=function(){var a=1;return function(){return a++}}(),Bb=null,Kc=!0,Yc=/^-?\d{1,10}$/;cd.prototype.hg=function(a,b){if(null==a.Wa||null==b.Wa)throw Fc("Should only compare child_ events.");return this.g.compare(new F(a.Wa,a.Ja),new F(b.Wa,b.Ja))},g=id.prototype,g.Kf=function(a){return"value"===a},g.createEvent=function(a,b){var c=b.n.g;return new Gb("value",this,new Q(a.Ja,b.Ib(),c))},g.Vb=function(a){var b=this.rb;if("cancel"===a.ze()){K(this.pb,"Raising a cancel event on a listener with no cancel callback");var c=this.pb;return function(){c.call(b,a.error)}}var d=this.Rb;return function(){d.call(b,a.Zd)}},g.gf=function(a,b){return this.pb?new Hb(this,a,b):null},g.matches=function(a){return a instanceof id&&(!a.Rb||!this.Rb||a.Rb===this.Rb&&a.rb===this.rb)},g.tf=function(){return null!==this.Rb},g=jd.prototype,g.Kf=function(a){return("children_removed"===(a="children_added"===a?"child_added":a)?"child_removed":a)in this.ha},g.gf=function(a,b){return this.pb?new Hb(this,a,b):null},g.createEvent=function(a,b){K(null!=a.Wa,"Child events should have a childName.");var c=b.Ib().u(a.Wa);return new Gb(a.type,this,new Q(a.Ja,c,b.n.g),a.Qd)},g.Vb=function(a){var b=this.rb;if("cancel"===a.ze()){K(this.pb,"Raising a cancel event on a listener with no cancel callback");var c=this.pb;return function(){c.call(b,a.error)}}var d=this.ha[a.ud];return function(){d.call(b,a.Zd,a.Qd)}},g.matches=function(a){if(a instanceof jd){if(!this.ha||!a.ha)return!0;if(this.rb===a.rb&&(b=pa(a.ha))===pa(this.ha)){if(1===b){var b=qa(a.ha),c=qa(this.ha);return!(c!==b||a.ha[b]&&this.ha[c]&&a.ha[b]!==this.ha[c])}return oa(this.ha,function(b,c){return a.ha[c]===b})}}return!1},g.tf=function(){return null!==this.ha},g=kd.prototype,g.G=function(a,b,c,d,e,f){return K(a.Jc(this.g),"A node must be indexed if only a child is updated"),(e=a.R(b)).Q(d).ca(c.Q(d))&&e.e()==c.e()?a:(null!=f&&(c.e()?a.Da(b)?hd(f,new D("child_removed",e,b)):K(a.K(),"A child remove without an old child only makes sense on a leaf node"):e.e()?hd(f,new D("child_added",c,b)):hd(f,new D("child_changed",c,b,e))),a.K()&&c.e()?a:a.U(b,c).lb(this.g))},g.xa=function(a,b,c){return null!=c&&(a.K()||a.P(N,function(a,e){b.Da(a)||hd(c,new D("child_removed",e,a))}),b.K()||b.P(N,function(b,e){if(a.Da(b)){var f=a.R(b);f.ca(e)||hd(c,new D("child_changed",e,b,f))}else hd(c,new D("child_added",e,b))})),b.lb(this.g)},g.ga=function(a,b){return a.e()?C:a.ga(b)},g.Na=function(){return!1},g.Wb=function(){return this},g=ld.prototype,g.matches=function(a){return 0>=this.g.compare(this.ed,a)&&0>=this.g.compare(a,this.Gc)},g.G=function(a,b,c,d,e,f){return this.matches(new F(b,c))||(c=C),this.Be.G(a,b,c,d,e,f)},g.xa=function(a,b,c){b.K()&&(b=C);var d=(d=b.lb(this.g)).ga(C),e=this;return b.P(N,function(a,b){e.matches(new F(a,b))||(d=d.U(a,C))}),this.Be.xa(a,d,c)},g.ga=function(a){return a},g.Na=function(){return!0},g.Wb=function(){return this.Be},g=qd.prototype,g.G=function(a,b,c,d,e,f){return this.sa.matches(new F(b,c))||(c=C),a.R(b).ca(c)?a:a.Db()<this.ka?this.sa.Wb().G(a,b,c,d,e,f):sd(this,a,b,c,e,f)},g.xa=function(a,b,c){var d;if(b.K()||b.e())d=C.lb(this.g);else if(2*this.ka<b.Db()&&b.Jc(this.g)){d=C.lb(this.g),b=this.Jb?b.$b(this.sa.Gc,this.g):b.Yb(this.sa.ed,this.g);for(e=0;0<b.Pa.length&&e<this.ka;){var f=J(b);if(!(this.Jb?0>=this.g.compare(this.sa.ed,f):0>=this.g.compare(f,this.sa.Gc)))break;d=d.U(f.name,f.S),e++}}else{d=(d=b.lb(this.g)).ga(C);var k,l,m;if(this.Jb){b=d.sf(this.g),k=this.sa.Gc,l=this.sa.ed;var t=td(this.g);m=function(a,b){return t(b,a)}}else b=d.Xb(this.g),k=this.sa.ed,l=this.sa.Gc,m=td(this.g);for(var e=0,z=!1;0<b.Pa.length;)f=J(b),!z&&0>=m(k,f)&&(z=!0),z&&e<this.ka&&0>=m(f,l)?e++:d=d.U(f.name,C)}return this.sa.Wb().xa(a,d,c)},g.ga=function(a){return a},g.Na=function(){return!0},g.Wb=function(){return this.sa.Wb()},xd.prototype.ab=function(a,b,c,d){var f,e=new gd;if(b.type===Yb)b.source.we?c=yd(this,a,b.path,b.Ga,c,d,e):(K(b.source.pf,"Unknown source."),f=b.source.af||Jb(a.w())&&!b.path.e(),c=Ad(this,a,b.path,b.Ga,c,d,f,e));else if(b.type===Bd)b.source.we?c=Cd(this,a,b.path,b.children,c,d,e):(K(b.source.pf,"Unknown source."),f=b.source.af||Jb(a.w()),c=Dd(this,a,b.path,b.children,c,d,f,e));else if(b.type===Ed)if(b.Vd)if(b=b.path,null!=c.tc(b))c=a;else{if(f=new rb(c,a,d),d=a.O.j(),b.e()||".priority"===E(b))Ib(a.w())?b=c.za(ub(a)):(b=a.w().j(),K(b instanceof R,"serverChildren would be complete if leaf node"),b=c.yc(b)),b=this.V.xa(d,b,e);else{var h=E(b),k=c.xc(h,a.w());null==k&&sb(a.w(),h)&&(k=d.R(h)),(b=null!=k?this.V.G(d,h,k,H(b),f,e):a.O.j().Da(h)?this.V.G(d,h,C,H(b),f,e):d).e()&&Ib(a.w())&&(d=c.za(ub(a))).K()&&(b=this.V.xa(b,d,e))}c=Fd(a,b,d=Ib(a.w())||null!=c.tc(G),this.V.Na())}else c=Gd(this,a,b.path,b.Qb,c,d,e);else{if(b.type!==$b)throw Fc("Unknown operation type: "+b.type);d=b.path,f=(b=a.w()).j(),h=b.ea||d.e(),c=Hd(this,new Id(a.O,new tb(f,h,b.Ub)),d,c,qb,e)}return e=ra(e.bb),d=c,(b=d.O).ea&&(f=b.j().K()||b.j().e(),h=Jd(a),(0<e.length||!a.O.ea||f&&!b.j().ca(h)||!b.j().C().ca(h.C()))&&e.push(Eb(Jd(d)))),new wd(c,e)};var Sd={};Rd.prototype.Ad=function(a,b){return 0!==this.compare(new F("[MIN_NAME]",a),new F("[MIN_NAME]",b))},Rd.prototype.Tc=function(){return Td},ma(Ud,Rd),g=Ud.prototype,g.Ic=function(a){return!a.Q(this.cc).e()},g.compare=function(a,b){var c=a.S.Q(this.cc),d=b.S.Q(this.cc);return 0===(c=c.Dc(d))?Vb(a.name,b.name):c},g.Pc=function(a,b){var c=M(a);return new F(b,c=C.G(this.cc,c))},g.Qc=function(){return new F("[MAX_NAME]",C.G(this.cc,Vd))},g.toString=function(){return this.cc.slice().join("/")},ma(Wd,Rd),g=Wd.prototype,g.compare=function(a,b){var c=a.S.C(),d=b.S.C();return 0===(c=c.Dc(d))?Vb(a.name,b.name):c},g.Ic=function(a){return!a.C().e()},g.Ad=function(a,b){return!a.C().ca(b.C())},g.Tc=function(){return Td},g.Qc=function(){return new F("[MAX_NAME]",new tc("[PRIORITY-POST]",Vd))},g.Pc=function(a,b){return new F(b,new tc("[PRIORITY-POST]",M(a)))},g.toString=function(){return".priority"};var N=new Wd;ma(Xd,Rd),g=Xd.prototype,g.compare=function(a,b){return Vb(a.name,b.name)},g.Ic=function(){throw Fc("KeyIndex.isDefinedOn not expected to be called.")},g.Ad=function(){return!1},g.Tc=function(){return Td},g.Qc=function(){return new F("[MAX_NAME]",C)},g.Pc=function(a){return K(p(a),"KeyIndex indexValue must always be a string."),new F(a,C)},g.toString=function(){return".key"};var Qd=new Xd;ma(Yd,Rd),g=Yd.prototype,g.compare=function(a,b){var c=a.S.Dc(b.S);return 0===c?Vb(a.name,b.name):c},g.Ic=function(){return!0},g.Ad=function(a,b){return!a.ca(b)},g.Tc=function(){return Td},g.Qc=function(){return Zd},g.Pc=function(a,b){return new F(b,M(a))},g.toString=function(){return".value"};var $d=new Yd,be=new ae;g=ae.prototype,g.He=function(a){var b=ce(this);return b.ja=!0,b.ka=a,b.Nb="",b},g.Ie=function(a){var b=ce(this);return b.ja=!0,b.ka=a,b.Nb="l",b},g.Je=function(a){var b=ce(this);return b.ja=!0,b.ka=a,b.Nb="r",b},g.$d=function(a,b){var c=ce(this);return c.ma=!0,n(a)||(a=null),c.ec=a,null!=b?(c.Lb=!0,c.xb=b):(c.Lb=!1,c.xb=""),c},g.td=function(a,b){var c=ce(this);return c.pa=!0,n(a)||(a=null),c.bc=a,n(b)?(c.Tb=!0,c.vb=b):(c.ah=!1,c.vb=""),c},g.toString=function(){return B(ee(this))},he.prototype.get=function(a){var b=w(this.Bd,a);if(!b)throw Error("No index defined for "+a);return b===Sd?null:b};var le=new he({".priority":Sd},{".priority":N}),ne=["object","boolean","number","string"];g=tc.prototype,g.K=function(){return!0},g.C=function(){return this.aa},g.ga=function(a){return new tc(this.B,a)},g.R=function(a){return".priority"===a?this.aa:C},g.Q=function(a){return a.e()?this:".priority"===E(a)?this.aa:C},g.Da=function(){return!1},g.rf=function(){return null},g.U=function(a,b){return".priority"===a?this.ga(b):b.e()&&".priority"!==a?this:C.U(a,b).ga(this.aa)},g.G=function(a,b){var c=E(a);return null===c?b:b.e()&&".priority"!==c?this:(K(".priority"!==c||1===Kd(a),".priority must be the last token in a path"),this.U(c,C.G(H(a),b)))},g.e=function(){return!1},g.Db=function(){return 0},g.P=function(){return!1},g.I=function(a){return a&&!this.C().e()?{".value":this.Ca(),".priority":this.C().I()}:this.Ca()},g.hash=function(){if(null===this.Cb){a="";this.aa.e()||(a+="priority:"+oe(this.aa.I())+":");var b=typeof this.B,a=a+(b+":"),a="number"===b?a+Xc(this.B):a+this.B;this.Cb=Hc(a)}return this.Cb},g.Ca=function(){return this.B},g.Dc=function(a){if(a===C)return 1;if(a instanceof R)return-1;K(a.K(),"Unknown node type");var b=typeof a.B,c=typeof this.B,d=Na(ne,b),e=Na(ne,c);return K(0<=d,"Unknown leaf type: "+b),K(0<=e,"Unknown leaf type: "+c),d===e?"object"===c?0:this.B<a.B?-1:this.B===a.B?0:1:e-d},g.lb=function(){return this},g.Jc=function(){return!0},g.ca=function(a){return a===this||!!a.K()&&(this.B===a.B&&this.aa.ca(a.aa))},g.toString=function(){return B(this.I(!0))},g=R.prototype,g.K=function(){return!1},g.C=function(){return this.aa||C},g.ga=function(a){return this.m.e()?this:new R(this.m,a,this.wb)},g.R=function(a){return".priority"===a?this.C():null===(a=this.m.get(a))?C:a},g.Q=function(a){var b=E(a);return null===b?this:this.R(b).Q(H(a))},g.Da=function(a){return null!==this.m.get(a)},g.U=function(a,b){if(K(b,"We should always be passing snapshot nodes"),".priority"===a)return this.ga(b);var d,e,c=new F(a,b);return b.e()?(d=this.m.remove(a),c=ke(this.wb,c,this.m)):(d=this.m.Oa(a,b),c=ie(this.wb,c,this.m)),e=d.e()?C:this.aa,new R(d,e,c)},g.G=function(a,b){var c=E(a);if(null===c)return b;K(".priority"!==E(a)||1===Kd(a),".priority must be the last token in a path");var d=this.R(c).G(H(a),b);return this.U(c,d)},g.e=function(){return this.m.e()},g.Db=function(){return this.m.count()};var pe=/^(0|[1-9]\d*)$/;g=R.prototype,g.I=function(a){if(this.e())return null;var b={},c=0,d=0,e=!0;if(this.P(N,function(f,h){b[f]=h.I(a),c++,e&&pe.test(f)?d=Math.max(d,Number(f)):e=!1}),!a&&e&&d<2*c){var h,f=[];for(h in b)f[h]=b[h];return f}return a&&!this.C().e()&&(b[".priority"]=this.C().I()),b},g.hash=function(){if(null===this.Cb){var a="";this.C().e()||(a+="priority:"+oe(this.C().I())+":"),this.P(N,function(b,c){var d=c.hash();""!==d&&(a+=":"+b+":"+d)}),this.Cb=""===a?"":Hc(a)}return this.Cb},g.rf=function(a,b,c){return(c=qe(this,c))?(a=cc(c,new F(a,b)))?a.name:null:cc(this.m,a)},g.P=function(a,b){var c=qe(this,a);return c?c.ia(function(a){return b(a.name,a.S)}):this.m.ia(b)},g.Xb=function(a){return this.Yb(a.Tc(),a)},g.Yb=function(a,b){var c=qe(this,b);if(c)return c.Yb(a,function(a){return a});for(var d=ec(c=this.m.Yb(a.name,Tb));null!=d&&0>b.compare(d,a);)J(c),d=ec(c);return c},g.sf=function(a){return this.$b(a.Qc(),a)},g.$b=function(a,b){var c=qe(this,b);if(c)return c.$b(a,function(a){return a});for(var d=ec(c=this.m.$b(a.name,Tb));null!=d&&0<b.compare(d,a);)J(c),d=ec(c);return c},g.Dc=function(a){return this.e()?a.e()?0:-1:a.K()||a.e()?1:a===Vd?-1:0},g.lb=function(a){if(a===Qd||ta(this.wb.dc,a.toString()))return this;var b=this.wb,c=this.m;K(a!==Qd,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var d=[],e=!1,f=J(c=c.Xb(Tb));f;)e=e||a.Ic(f.S),d.push(f),f=J(c);return d=e?je(d,td(a)):Sd,e=a.toString(),c=xa(b.dc),c[e]=a,a=xa(b.Bd),a[e]=d,new R(this.m,this.aa,new he(a,c))},g.Jc=function(a){return a===Qd||ta(this.wb.dc,a.toString())},g.ca=function(a){if(a===this)return!0;if(a.K())return!1;if(this.C().ca(a.C())&&this.m.count()===a.m.count()){var b=this.Xb(N);a=a.Xb(N);for(var c=J(b),d=J(a);c&&d;){if(c.name!==d.name||!c.S.ca(d.S))return!1;c=J(b),d=J(a)}return null===c&&null===d}return!1},g.toString=function(){return B(this.I(!0))};var re=Math.log(2),C=new R(new ac(Wb),null,le);ma(ue,R),g=ue.prototype,g.Dc=function(a){return a===this?0:1},g.ca=function(a){return a===this},g.C=function(){return this},g.R=function(){return C},g.e=function(){return!1};var Vd=new ue,Td=new F("[MIN_NAME]",C),Zd=new F("[MAX_NAME]",Vd);Id.prototype.w=function(){return this.Yd},g=ve.prototype,g.w=function(){return this.Ka.w().j()},g.fb=function(a){var b=ub(this.Ka);return b&&(S(this.W.n)||!a.e()&&!b.R(E(a)).e())?b.Q(a):null},g.e=function(){return 0===this.Xa.length},g.Pb=function(a){this.Xa.push(a)},g.jb=function(a,b){var c=[];if(b){K(null==a,"A cancel should cancel all event registrations.");var d=this.W.path;Oa(this.Xa,function(a){(a=a.gf(b,d))&&c.push(a)})}if(a){for(var e=[],f=0;f<this.Xa.length;++f){var h=this.Xa[f];if(h.matches(a)){if(a.tf()){e=e.concat(this.Xa.slice(f+1));break}}else e.push(h)}this.Xa=e}else this.Xa=[];return c},g.ab=function(a,b,c){a.type===Bd&&null!==a.source.Hb&&(K(ub(this.Ka),"We should always have a full cache before handling merges"),K(Jd(this.Ka),"Missing event cache, even though we have a server cache"));var d=this.Ka;return a=this.Hf.ab(d,a,b,c),b=this.Hf,c=a.je,K(c.O.j().Jc(b.V.g),"Event snap not indexed"),K(c.w().j().Jc(b.V.g),"Server snap not indexed"),K(Ib(a.je.w())||!Ib(d.w()),"Once a server snap is complete, it should never go back"),this.Ka=a.je,xe(this,a.fg,a.je.O.j(),null)},ze.prototype.Xc=function(a){return this.path.e()?(a=this.children.subtree(new L(a))).e()?null:a.value?new Xb(this.source,G,a.value):new ze(this.source,G,a):(K(E(this.path)===a,"Can't get a merge for a child not on the path of the operation"),new ze(this.source,H(this.path),this.children))},ze.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},g=Ae.prototype,g.yf=function(a,b,c,d){var e=a.path.toString();this.f("Listen called for "+e+" "+a.va());var f=Be(a,c),h={};this.$[f]=h,a=ge(a.n);var k=this;Ce(this,e+".json",a,function(a,b){var t=b;404===a&&(a=t=null),null===a&&k.Gb(e,t,!1,c),w(k.$,f)===h&&d(a?401==a?"permission_denied":"rest_error:"+a:"ok",null)})},g.Rf=function(a,b){var c=Be(a,b);delete this.$[c]},g.M=function(a,b){this.Aa=a;var d=(c=$c(a)).data,c=c.Bc&&c.Bc.exp;b&&b("ok",{auth:d,expires:c})},g.ge=function(a){this.Aa=null,a("ok",null)},g.Me=function(){},g.Cf=function(){},g.Jd=function(){},g.put=function(){},g.zf=function(){},g.Ue=function(){},De.prototype.fe=function(a,b){var c,d=(c=this.Oc[a]||[]).length;if(0<d){for(var e=Array(d),f=0;f<d;f++)e[f]=c[f];c=e}else c=[];for(d=0;d<c.length;d++)c[d].zc.apply(c[d].Ma,Array.prototype.slice.call(arguments,1))},De.prototype.Eb=function(a,b,c){Ee(this,a),this.Oc[a]=this.Oc[a]||[],this.Oc[a].push({zc:b,Ma:c}),(a=this.Ae(a))&&b.apply(c,a)},De.prototype.ic=function(a,b,c){Ee(this,a),a=this.Oc[a]||[];for(var d=0;d<a.length;d++)if(a[d].zc===b&&(!c||c===a[d].Ma)){a.splice(d,1);break}};var Fe=function(){var a=0,b=[];return function(c){var d=c===a;a=c;for(var e=Array(8),f=7;0<=f;f--)e[f]="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz".charAt(c%64),c=Math.floor(c/64);if(K(0===c,"Cannot push at time == 0"),c=e.join(""),d){for(f=11;0<=f&&63===b[f];f--)b[f]=0;b[f]++}else for(f=0;12>f;f++)b[f]=Math.floor(64*Math.random());for(f=0;12>f;f++)c+="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz".charAt(b[f]);return K(20===c.length,"nextPushId: Length should be 20."),c}}();ma(Ge,De),Ge.prototype.Ae=function(a){return K("online"===a,"Unknown event type: "+a),[this.kc]},ca(Ge),ma(He,De),He.prototype.Ae=function(a){return K("visible"===a,"Unknown event type: "+a),[this.Ob]},ca(He),g=L.prototype,g.toString=function(){for(var a="",b=this.Z;b<this.o.length;b++)""!==this.o[b]&&(a+="/"+this.o[b]);return a||"/"},g.slice=function(a){return this.o.slice(this.Z+(a||0))},g.parent=function(){if(this.Z>=this.o.length)return null;for(var a=[],b=this.Z;b<this.o.length-1;b++)a.push(this.o[b]);return new L(a,0)},g.u=function(a){for(var b=[],c=this.Z;c<this.o.length;c++)b.push(this.o[c]);if(a instanceof L)for(c=a.Z;c<a.o.length;c++)b.push(a.o[c]);else for(a=a.split("/"),c=0;c<a.length;c++)0<a[c].length&&b.push(a[c]);return new L(b,0)},g.e=function(){return this.Z>=this.o.length},g.ca=function(a){if(Kd(this)!==Kd(a))return!1;for(var b=this.Z,c=a.Z;b<=this.o.length;b++,c++)if(this.o[b]!==a.o[c])return!1;return!0},g.contains=function(a){var b=this.Z,c=a.Z;if(Kd(this)>Kd(a))return!1;for(;b<this.o.length;){if(this.o[b]!==a.o[c])return!1;++b,++c}return!0};var G=new L("");Je.prototype.push=function(a){0<this.Qa.length&&(this.Ha+=1),this.Qa.push(a),this.Ha+=Zc(a),Ke(this)},Je.prototype.pop=function(){var a=this.Qa.pop();this.Ha-=Zc(a),0<this.Qa.length&&--this.Ha};var Ne=new ac(function(a,b){return a===b?0:a<b?-1:1});g=Me.prototype,g.e=function(){return null===this.value&&this.children.e()},g.subtree=function(a){if(a.e())return this;var b=this.children.get(E(a));return null!==b?b.subtree(H(a)):Pd},g.set=function(a,b){if(a.e())return new Me(b,this.children);var c=E(a),d=(this.children.get(c)||Pd).set(H(a),b),c=this.children.Oa(c,d);return new Me(this.value,c)},g.remove=function(a){if(a.e())return this.children.e()?Pd:new Me(null,this.children);var b=E(a),c=this.children.get(b);return c?(a=c.remove(H(a)),b=a.e()?this.children.remove(b):this.children.Oa(b,a),null===this.value&&b.e()?Pd:new Me(this.value,b)):this},g.get=function(a){if(a.e())return this.value;var b=this.children.get(E(a));return b?b.get(H(a)):null};var Pd=new Me(null);Me.prototype.toString=function(){var a={};return Md(this,function(b,c){a[b.toString()]=c.toString()}),B(a)},Ze.prototype.Xc=function(a){return this.path.e()?null!=this.Qb.value?(K(this.Qb.children.e(),"affectedTree should not have overlapping affected paths."),this):(a=this.Qb.subtree(new L(a)),new Ze(G,a,this.Vd)):(K(E(this.path)===a,"operationForChild called for unrelated child."),new Ze(H(this.path),this.Qb,this.Vd))},Ze.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" ack write revert="+this.Vd+" affectedTree="+this.Qb+")"};var Yb=0,Bd=1,Ed=2,$b=3,$e=new af(!0,!1,null,!1),bf=new af(!1,!0,null,!1);af.prototype.toString=function(){return this.we?"user":this.af?"server(queryID="+this.Hb+")":"server"};var df=new cf(new Me(null));cf.prototype.Rd=function(a){return a.e()?df:(a=Od(this.X,a,Pd),new cf(a))},cf.prototype.e=function(){return this.X.e()},cf.prototype.apply=function(a){return kf(G,this.X,a)},g=lf.prototype,g.Rd=function(a){var b=Ua(this.na,function(b){return b.kd===a});K(0<=b,"removeWrite called with nonexistent writeId.");var c=this.na[b];this.na.splice(b,1);for(var d=c.visible,e=!1,f=this.na.length-1;d&&0<=f;){var h=this.na[f];h.visible&&(f>=b&&nf(h,c.path)?d=!1:c.path.contains(h.path)&&(e=!0)),f--}if(d){if(e)this.T=of(this.na,pf,G),this.Mc=0<this.na.length?this.na[this.na.length-1].kd:-1;else if(c.Ga)this.T=this.T.Rd(c.path);else{var k=this;r(c.children,function(a,b){k.T=k.T.Rd(c.path.u(b))})}return!0}return!1},g.za=function(a,b,c,d){if(c||d){var e=jf(this.T,a);return!d&&e.e()?b:d||null!=b||null!=gf(e,G)?(e=of(this.na,function(b){return(b.visible||d)&&(!c||!(0<=Na(c,b.kd)))&&(b.path.contains(a)||a.contains(b.path))},a),b=b||C,e.apply(b)):null}return null!=(e=gf(this.T,a))?e:(e=jf(this.T,a)).e()?b:null!=b||null!=gf(e,G)?(b=b||C,e.apply(b)):null},g.yc=function(a,b){var c=C,d=gf(this.T,a);if(d)d.K()||d.P(N,function(a,b){c=c.U(a,b)});else if(b){var e=jf(this.T,a);b.P(N,function(a,b){var d=jf(e,new L(a)).apply(b);c=c.U(a,d)}),Oa(hf(e),function(a){c=c.U(a.name,a.S)})}else e=jf(this.T,a),Oa(hf(e),function(a){c=c.U(a.name,a.S)});return c},g.ld=function(a,b,c,d){return K(c||d,"Either existingEventSnap or existingServerSnap must exist"),a=a.u(b),null!=gf(this.T,a)?null:(a=jf(this.T,a)).e()?d.Q(b):a.apply(d.Q(b))},g.xc=function(a,b,c){a=a.u(b);var d=gf(this.T,a);return null!=d?d:sb(c,b)?jf(this.T,a).apply(c.j().R(b)):null},g.tc=function(a){return gf(this.T,a)},g.ne=function(a,b,c,d,e,f){var h;if(a=jf(this.T,a),null==(h=gf(a,G))){if(null==b)return[];h=a.apply(b)}if((h=h.lb(f)).e()||h.K())return[];for(b=[],a=td(f),f=J(e=e?h.$b(c,f):h.Yb(c,f));f&&b.length<d;)0!==a(f,c)&&b.push(f),f=J(e);return b},g=qf.prototype,g.za=function(a,b,c){return this.X.za(this.Mb,a,b,c)},g.yc=function(a){return this.X.yc(this.Mb,a)},g.ld=function(a,b,c){return this.X.ld(this.Mb,a,b,c)},g.tc=function(a){return this.X.tc(this.Mb.u(a))},g.ne=function(a,b,c,d,e){return this.X.ne(this.Mb,a,b,c,d,e)},g.xc=function(a,b){return this.X.xc(this.Mb,a,b)},g.u=function(a){return new qf(this.Mb.u(a),this.X)},g=rf.prototype,g.e=function(){return wa(this.ya)},g.ab=function(a,b,c){var d=a.source.Hb;if(null!==d)return d=w(this.ya,d),K(null!=d,"SyncTree gave us an op for an invalid query."),d.ab(a,b,c);var e=[];return r(this.ya,function(d){e=e.concat(d.ab(a,b,c))}),e},g.Pb=function(a,b,c,d,e){var f=a.va(),h=w(this.ya,f);if(!h){var k=!1;(h=c.za(e?d:null))?k=!0:(h=d instanceof R?c.yc(d):C,k=!1),h=new ve(a,new Id(new tb(h,k,!1),new tb(d,e,!1))),this.ya[f]=h}return h.Pb(b),ye(h,b)},g.jb=function(a,b,c){var d=a.va(),e=[],f=[],h=null!=sf(this);if("default"===d){var k=this;r(this.ya,function(a,d){f=f.concat(a.jb(b,c)),a.e()&&(delete k.ya[d],S(a.W.n)||e.push(a.W))})}else{var l=w(this.ya,d);l&&(f=f.concat(l.jb(b,c)),l.e()&&(delete this.ya[d],S(l.W.n)||e.push(l.W)))}return h&&null==sf(this)&&e.push(new U(a.k,a.path)),{Kg:e,mg:f}},g.fb=function(a){var b=null;return r(this.ya,function(c){b=b||c.fb(a)}),b},vf.prototype.Pb=function(a,b){var c=a.path,d=null,e=!1;Ve(this.ta,c,function(a,b){var f=T(a,c);return d=b.fb(f),e=e||null!=sf(b),!d});var f=this.ta.get(c);f?(e=e||null!=sf(f),d=d||f.fb(G)):(f=new rf,this.ta=this.ta.set(c,f));var h;null!=d?h=!0:(h=!1,d=C,Ye(this.ta.subtree(c),function(a,b){var c=b.fb(G);c&&(d=d.U(a,c))}));var k=null!=uf(f,a);if(!k&&!S(a.n)){var l=Gf(a);K(!(l in this.mc),"View does not exist, but we have a tag");var m=Hf++;this.mc[l]=m,this.$e["_"+m]=l}return h=f.Pb(a,b,new qf(c,this.ib),d,h),k||e||(f=uf(f,a),h=h.concat(If(this,a,f))),h},vf.prototype.jb=function(a,b,c){var d=a.path,e=this.ta.get(d),f=[];if(e&&("default"===a.va()||null!=uf(e,a))){f=e.jb(a,b,c),e.e()&&(this.ta=this.ta.remove(d)),e=f.Kg,f=f.mg,b=-1!==Ua(e,function(a){return S(a.n)});var h=Te(this.ta,d,function(a,b){return null!=sf(b)});if(b&&!h&&!(d=this.ta.subtree(d)).e())for(var d=Jf(d),k=0;k<d.length;++k){var m=(l=d[k]).W,l=Kf(this,l);this.Nc.Xe(Lf(m),Mf(this,m),l.xd,l.H)}if(!h&&0<e.length&&!c)if(b)this.Nc.ae(Lf(a),null);else{var t=this;Oa(e,function(a){a.va();var b=t.mc[Gf(a)];t.Nc.ae(Lf(a),b)})}Nf(this,e)}return f},vf.prototype.za=function(a,b){var c=this.ib,d=Te(this.ta,a,function(b,c){var d=T(b,a);if(d=c.fb(d))return d});return c.za(a,d,b,!0)};var Hf=1;g=Rf.prototype,g.Ca=function(){return this.A.value},g.clear=function(){this.A.value=null,this.A.children={},this.A.nd=0,Uf(this)},g.wd=function(){return 0<this.A.nd},g.e=function(){return null===this.Ca()&&!this.wd()},g.P=function(a){var b=this;r(this.A.children,function(c,d){a(new Rf(d,b,c))})},g.path=function(){return new L(null===this.Zc?this.Gd:this.Zc.path()+"/"+this.Gd)},g.name=function(){return this.Gd},g.parent=function(){return this.Zc};var Xf=/[\[\].#$\/\u0000-\u001F\u007F]/,Yf=/[\[\].#$\u0000-\u001F\u007F]/,Zf=/^[a-zA-Z][a-zA-Z._\-+]+$/;g=pg.prototype,g.add=function(a,b){this.set[a]=null===b||b},g.contains=function(a){return v(this.set,a)},g.get=function(a){return this.contains(a)?this.set[a]:void 0},g.remove=function(a){delete this.set[a]},g.clear=function(){this.set={}},g.e=function(){return wa(this.set)},g.count=function(){return pa(this.set)},g.keys=function(){var a=[];return r(this.set,function(b,c){a.push(c)}),a},qc.prototype.find=function(a){if(null!=this.B)return this.B.Q(a);if(a.e()||null==this.m)return null;var b=E(a);return a=H(a),this.m.contains(b)?this.m.get(b).find(a):null},qc.prototype.nc=function(a,b){if(a.e())this.B=b,this.m=null;else if(null!==this.B)this.B=this.B.G(a,b);else{null==this.m&&(this.m=new pg);var c=E(a);this.m.contains(c)||this.m.add(c,new qc),c=this.m.get(c),a=H(a),c.nc(a,b)}},qc.prototype.P=function(a){null!==this.m&&qg(this.m,function(b,c){a(b,c)})};var sg="auth.firebase.com",ug=["remember","redirectTo"];wg.prototype.set=function(a,b){if(!b){if(!this.be.length)throw Error("fb.login.SessionManager : No storage options available!");b=this.be[0]}b.set(this.Qe,a)},wg.prototype.get=function(){var a=Qa(this.be,q(this.qg,this));return Xa(a=Pa(a,function(a){return null!==a}),function(a,c){return ad(c.token)-ad(a.token)}),0<a.length?a.shift():null},wg.prototype.qg=function(a){try{var b=a.get(this.Qe);if(b&&b.token)return b}catch(c){}return null},wg.prototype.clear=function(){var a=this;Oa(this.be,function(b){b.remove(a.Qe)})},Ig.prototype.jc=function(a){var c,b=this;try{c=nb(a.data)}catch(d){}c&&"request"===c.a&&(Dg(window,"message",this.jc),this.ce=a.origin,this.Ac&&setTimeout(function(){b.Ac(b.ce,c.d,function(a,c){b.dg=!c,b.Ac=void 0,Jg(b,{a:"response",d:a,forceKeepWindowOpen:c})})},0))},Ig.prototype.Bg=function(){try{Dg(this.zd,"message",this.Bf)}catch(a){}this.Ac&&(Jg(this,{a:"error",d:"unknown closed window"}),this.Ac=void 0);try{window.close()}catch(b){}},Ig.prototype.Bf=function(a){if(this.dg&&"die"===a.data)try{window.close()}catch(b){}},Kg.prototype.open=function(a,b){yc.set("redirect_request_id",this.pc),yc.set("redirect_request_id",this.pc),b.requestId=this.pc,b.redirectTo=b.redirectTo||window.location.href,a+=(/\?/.test(a)?"":"?")+kb(b),window.location=a},Kg.isAvailable=function(){return!zg()&&!yg()},Kg.prototype.Cc=function(){return"redirect"};var Lg={NETWORK_ERROR:"Unable to contact the Firebase server.",SERVER_ERROR:"An unknown server error occurred.",TRANSPORT_UNAVAILABLE:"There are no login transports available for the requested method.",REQUEST_INTERRUPTED:"The browser redirected the page before the login request could complete.",USER_CANCELLED:"The user cancelled authentication."};Ng.prototype.open=function(a,b,c){function d(a){if(h&&(document.body.removeChild(h),h=void 0),t&&(t=clearInterval(t)),Dg(window,"message",e),Dg(window,"unload",d),m&&!a)try{m.close()}catch(b){k.postMessage("die",l)}m=k=void 0}function e(a){if(a.origin===l)try{var b=nb(a.data);"ready"===b.a?k.postMessage(z,l):"error"===b.a?(d(!1),c&&(c(b.d),c=null)):"response"===b.a&&(d(b.forceKeepWindowOpen),c&&(c(null,b.d),c=null))}catch(e){}}var h,k,f=Ag(8);if(!this.options.relay_url)return c(Error("invalid arguments: origin of url and relay_url must match"));var l=Eg(a);if(l!==Eg(this.options.relay_url))c&&setTimeout(function(){c(Error("invalid arguments: origin of url and relay_url must match"))},0);else{f&&((h=document.createElement("iframe")).setAttribute("src",this.options.relay_url),h.style.display="none",h.setAttribute("name","__winchan_relay_frame"),document.body.appendChild(h),k=h.contentWindow),a+=(/\?/.test(a)?"":"?")+kb(b);var m=window.open(a,this.options.window_name,this.options.window_features);k||(k=m);var t=setInterval(function(){m&&m.closed&&(d(!1),c&&(c(Mg("USER_CANCELLED")),c=null))},500),z=B({a:"request",d:b});Cg(window,"unload",d),Cg(window,"message",e)}},Ng.isAvailable=function(){var a;return(a="postMessage"in window&&!zg())&&((a=yg()||"undefined"!=typeof navigator&&(!!xg().match(/Windows Phone/)||!!window.Windows&&/^ms-appx:/.test(location.href)))||(a=xg(),a="undefined"!=typeof navigator&&"undefined"!=typeof window&&!!(a.match(/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i)||a.match(/CriOS/)||a.match(/Twitter for iPhone/)||a.match(/FBAN\/FBIOS/)||window.navigator.standalone)),a=!a),a&&!xg().match(/PhantomJS/)},Ng.prototype.Cc=function(){return"popup"},Og.prototype.open=function(a,b,c){function d(){c&&(c(Mg("REQUEST_INTERRUPTED")),c=null)}var h,e=new XMLHttpRequest,f=this.options.method.toUpperCase();if(Cg(window,"beforeunload",d),e.onreadystatechange=function(){if(c&&4===e.readyState){var a;if(200<=e.status&&300>e.status){try{a=nb(e.responseText)}catch(b){}c(null,a)}else c(500<=e.status&&600>e.status?Mg("SERVER_ERROR"):Mg("NETWORK_ERROR"));c=null,Dg(window,"beforeunload",d)}},"GET"===f)a+=(/\?/.test(a)?"":"?")+kb(b),h=null;else{var k=this.options.headers.content_type;"application/json"===k&&(h=B(b)),"application/x-www-form-urlencoded"===k&&(h=kb(b))}e.open(f,a,!0),za(a={"X-Requested-With":"XMLHttpRequest",Accept:"application/json;text/plain"},this.options.headers);for(var l in a)e.setRequestHeader(l,a[l]);e.send(h)},Og.isAvailable=function(){var a;return(a=!!window.XMLHttpRequest)&&(a=xg(),a=!(a.match(/MSIE/)||a.match(/Trident/))||Ag(10)),a},Og.prototype.Cc=function(){return"json"},Pg.prototype.open=function(a,b,c){function d(){c&&(c(Mg("USER_CANCELLED")),c=null)}var h,e=this,f=Pc(sg);b.requestId=this.pc,b.redirectTo=f.scheme+"://"+f.host+"/blank/page.html",a+=/\?/.test(a)?"":"?",a+=kb(b),(h=window.open(a,"_blank","location=no"))&&ha(h.addEventListener)?(h.addEventListener("loadstart",function(a){var b;if(b=a&&a.url)a:{try{var m=document.createElement("a");m.href=a.url,b=m.host===f.host&&"/blank/page.html"===m.pathname;break a}catch(t){}b=!1}b&&(a=Fg(a.url),h.removeEventListener("exit",d),h.close(),a=new tg(null,null,{requestId:e.pc,requestKey:a}),e.Ef.requestWithCredential("/auth/session",a,c),c=null)}),h.addEventListener("exit",d)):c(Mg("TRANSPORT_UNAVAILABLE"))},Pg.isAvailable=function(){return yg()},Pg.prototype.Cc=function(){return"redirect"},Qg.prototype.open=function(a,b,c){function d(){c&&(c(Mg("REQUEST_INTERRUPTED")),c=null)}function e(){setTimeout(function(){window.__firebase_auth_jsonp[f]=void 0,wa(window.__firebase_auth_jsonp)&&(window.__firebase_auth_jsonp=void 0);try{var a=document.getElementById(f);a&&a.parentNode.removeChild(a)}catch(b){}},1),Dg(window,"beforeunload",d)}var f="fn"+(new Date).getTime()+Math.floor(99999*Math.random());b[this.options.callback_parameter]="__firebase_auth_jsonp."+f,a+=(/\?/.test(a)?"":"?")+kb(b),Cg(window,"beforeunload",d),window.__firebase_auth_jsonp[f]=function(a){c&&(c(null,a),c=null),e()},Rg(f,a,c)},Qg.isAvailable=function(){return"undefined"!=typeof document&&null!=document.createElement},Qg.prototype.Cc=function(){return"json"},ma(Sg,De),g=Sg.prototype,g.xe=function(){return this.mb||null},g.se=function(a,b){ah(this);var c=vg(a);c.$a._method="POST",this.qc("/users",c,function(a,c){a?P(b,a):P(b,a,c)})},g.Te=function(a,b){var c=this;ah(this);var d="/users/"+encodeURIComponent(a.email),e=vg(a);e.$a._method="DELETE",this.qc(d,e,function(a,d){!a&&d&&d.uid&&c.mb&&c.mb.uid&&c.mb.uid===d.uid&&Zg(c),P(b,a)})},g.pe=function(a,b){ah(this);var c="/users/"+encodeURIComponent(a.email)+"/password",d=vg(a);d.$a._method="PUT",d.$a.password=a.newPassword,this.qc(c,d,function(a){P(b,a)})},g.oe=function(a,b){ah(this);var c="/users/"+encodeURIComponent(a.oldEmail)+"/email",d=vg(a);d.$a._method="PUT",d.$a.email=a.newEmail,d.$a.password=a.password,this.qc(c,d,function(a){P(b,a)})},g.Ve=function(a,b){ah(this);var c="/users/"+encodeURIComponent(a.email)+"/password",d=vg(a);d.$a._method="POST",this.qc(c,d,function(a){P(b,a)})},g.qc=function(a,b,c){dh(this,[Og,Qg],a,b,c)},g.Ae=function(a){return K("auth_status"===a,'initial event must be of type "auth_status"'),this.Se?null:[this.mb]};var Cc="websocket",Dc="long_polling",ih,jh;hh.prototype.open=function(a,b){this.hf=0,this.la=b,this.Af=new eh(a),this.zb=!1;var c=this;this.qb=setTimeout(function(){c.f("Timed out trying to connect."),c.gb(),c.qb=null},Math.floor(3e4)),Rc(function(){if(!c.zb){c.Sa=new kh(function(a,b,d,k,l){if(lh(c,arguments),c.Sa)if(c.qb&&(clearTimeout(c.qb),c.qb=null),c.Hc=!0,"start"==a)c.id=b,c.Gf=d;else{if("close"!==a)throw Error("Unrecognized command received: "+a);b?(c.Sa.Xd=!1,fh(c.Af,b,function(){c.gb()})):c.gb()}},function(a,b){lh(c,arguments),gh(c.Af,a,b)},function(){c.gb()},c.jd);var a={start:"t"};a.ser=Math.floor(1e8*Math.random()),c.Sa.he&&(a.cb=c.Sa.he),a.v="5",c.Qf&&(a.s=c.Qf),c.Bb&&(a.ls=c.Bb),"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf("firebaseio.com")&&(a.r="f"),a=c.jd(a),c.f("Connecting via long-poll to "+a),mh(c.Sa,a,function(){})}})},hh.prototype.start=function(){var a=this.Sa,b=this.Gf;for(a.ug=this.id,a.vg=b,a.le=!0;nh(a););a=this.id,b=this.Gf,this.gc=document.createElement("iframe");var c={dframe:"t"};c.id=a,c.pw=b,this.gc.src=this.jd(c),this.gc.style.display="none",document.body.appendChild(this.gc)},hh.isAvailable=function(){return ih||!jh&&"undefined"!=typeof document&&null!=document.createElement&&!("object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!("object"==typeof Windows&&"object"==typeof Windows.Xg)&&!0},g=hh.prototype,g.Ed=function(){},g.dd=function(){this.zb=!0,this.Sa&&(this.Sa.close(),this.Sa=null),this.gc&&(document.body.removeChild(this.gc),this.gc=null),this.qb&&(clearTimeout(this.qb),this.qb=null)},g.gb=function(){this.zb||(this.f("Longpoll is closing itself"),this.dd(),this.la&&(this.la(this.Hc),this.la=null))},g.close=function(){this.zb||(this.f("Longpoll is being closed."),this.dd())},g.send=function(a){a=B(a),this.ob+=a.length,Ob(this.Ua,"bytes_sent",a.length),a=Vc(a=fb(a=Ic(a),!0),1840);for(var b=0;b<a.length;b++){var c=this.Sa;c.ad.push({Mg:this.hf,Ug:a.length,kf:a[b]}),c.le&&nh(c),this.hf++}},kh.prototype.close=function(){if(this.le=!1,this.Ea){this.Ea.eb.body.innerHTML="";var a=this;setTimeout(function(){null!==a.Ea&&(document.body.removeChild(a.Ea),a.Ea=null)},Math.floor(0))}var b=this.hb;b&&(this.hb=null,b())};var ph=null;"undefined"!=typeof MozWebSocket?ph=MozWebSocket:"undefined"!=typeof WebSocket&&(ph=WebSocket);var rh;qh.prototype.open=function(a,b){this.hb=b,this.zg=a,this.f("Websocket connecting to "+this.ef),this.Hc=!1,xc.set("previous_websocket_failure",!0);try{this.ua=new ph(this.ef)}catch(c){this.f("Error instantiating WebSocket.");var d=c.message||c.data;return d&&this.f(d),void this.gb()}var e=this;this.ua.onopen=function(){e.f("Websocket connected."),e.Hc=!0},this.ua.onclose=function(){e.f("Websocket connection was disconnected."),e.ua=null,e.gb()},this.ua.onmessage=function(a){if(null!==e.ua)if(a=a.data,e.nb+=a.length,Ob(e.Ua,"bytes_received",a.length),sh(e),null!==e.frames)th(e,a);else{a:{if(K(null===e.frames,"We already have a frame buffer"),6>=a.length){var b=Number(a);if(!isNaN(b)){e.bf=b,e.frames=[],a=null;break a}}e.bf=1,e.frames=[]}null!==a&&th(e,a)}},this.ua.onerror=function(a){e.f("WebSocket error.  Closing connection."),(a=a.message||a.data)&&e.f(a),e.gb()}},qh.prototype.start=function(){},qh.isAvailable=function(){var a=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var b=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);b&&1<b.length&&4.4>parseFloat(b[1])&&(a=!0)}return!a&&null!==ph&&!rh},qh.responsesRequiredToBeHealthy=2,qh.healthyTimeout=3e4,g=qh.prototype,g.Ed=function(){xc.remove("previous_websocket_failure")},g.send=function(a){sh(this),a=B(a),this.ob+=a.length,Ob(this.Ua,"bytes_sent",a.length),1<(a=Vc(a,16384)).length&&this.ua.send(String(a.length));for(var b=0;b<a.length;b++)this.ua.send(a[b])},g.dd=function(){this.zb=!0,this.Kc&&(clearInterval(this.Kc),this.Kc=null),this.ua&&(this.ua.close(),this.ua=null)},g.gb=function(){this.zb||(this.f("WebSocket is closing itself"),this.dd(),this.hb&&(this.hb(this.Hc),this.hb=null))},g.close=function(){this.zb||(this.f("WebSocket is being closed"),this.dd())};var wh=[hh,qh];yh.prototype.Fa=function(a){Jh(this,{t:"d",d:a})},yh.prototype.Id=function(a){Gh(this),this.jc(a)},yh.prototype.close=function(){2!==this.Ta&&(this.f("Closing realtime connection."),this.Ta=2,Fh(this),this.la&&(this.la(),this.la=null))};var Lh=0,Nh=0;g=Kh.prototype,g.Fa=function(a,b,c){var d=++this.Lg;a={r:d,a:a,b:b},this.f(B(a)),K(this.oa,"sendRequest call when we're not connected not allowed."),this.Ia.Fa(a),c&&(this.Td[d]=c)},g.yf=function(a,b,c,d){var e=a.va(),f=a.path.toString();this.f("Listen called for "+f+" "+e),this.$[f]=this.$[f]||{},K(fe(a.n)||!S(a.n),"listen() called for non-default but complete query"),K(!this.$[f][e],"listen() called twice for same path/queryId."),a={H:d,xd:b,Ig:a,tag:c},this.$[f][e]=a,this.oa&&Oh(this,a)},g.M=function(a,b,c){this.Aa={ig:a,of:!1,zc:b,md:c},this.f("Authenticating using credential: "+a),Qh(this),(b=40==a.length)||(a=$c(a).Bc,b="object"==typeof a&&!0===w(a,"admin")),b&&(this.f("Admin auth credential detected.  Reducing max reconnect time."),this.Fd=3e4)},g.ge=function(a){delete this.Aa,this.oa&&this.Fa("unauth",{},function(b){a(b.s,b.d)})},g.Rf=function(a,b){var c=a.path.toString(),d=a.va();if(this.f("Unlisten called for "+c+" "+d),K(fe(a.n)||!S(a.n),"unlisten() called for non-default but complete query"),Ph(this,c,d)&&this.oa){var e=ee(a.n);this.f("Unlisten on "+c+" for "+d),c={p:c},b&&(c.q=e,c.t=b),this.Fa("n",c)}},g.Me=function(a,b,c){this.oa?Rh(this,"o",a,b,c):this.Vc.push({$c:a,action:"o",data:b,H:c})},g.Cf=function(a,b,c){this.oa?Rh(this,"om",a,b,c):this.Vc.push({$c:a,action:"om",data:b,H:c})},g.Jd=function(a,b){this.oa?Rh(this,"oc",a,null,b):this.Vc.push({$c:a,action:"oc",data:null,H:b})},g.put=function(a,b,c,d){Sh(this,"p",a,b,c,d)},g.zf=function(a,b,c,d){Sh(this,"m",a,b,c,d)},g.Ue=function(a){this.oa&&(a={c:a},this.f("reportStats",a),this.Fa("s",a,function(a){"ok"!==a.s&&this.f("reportStats","Error sending stats: "+a.d)}))},g.Id=function(a){if("r"in a){this.f("from server: "+B(a));var b=a.r,c=this.Td[b];c&&(delete this.Td[b],c(a.b))}else{if("error"in a)throw"A server-side error has occurred: "+a.error;"a"in a&&(b=a.a,c=a.b,this.f("handleServerMessage",b,c),"d"===b?this.Gb(c.p,c.d,!1,c.t):"m"===b?this.Gb(c.p,c.d,!0,c.t):"c"===b?Uh(this,c.p,c.q):"ac"===b?(a=c.s,b=c.d,c=this.Aa,delete this.Aa,c&&c.md&&c.md(a,b)):"sd"===b?this.We?this.We(c):"msg"in c&&"undefined"!=typeof console&&console.log("FIREBASE: "+c.msg.replace("\n","\nFIREBASE: ")):Nc("Unrecognized action received from server: "+B(b)+"\nAre you using the latest client?"))}},g.Wc=function(a,b){if(this.f("connection ready"),this.oa=!0,this.Lc=(new Date).getTime(),this.Oe({serverTimeOffset:a-(new Date).getTime()}),this.Bb=b,this.nf){var c={};c["sdk.js."+hb.replace(/\./g,"-")]=1,yg()&&(c["framework.cordova"]=1),this.Ue(c)}Vh(this),this.nf=!1,this.Uc(!0)},g.Cg=function(a){a&&!this.Ob&&this.Za===this.Fd&&(this.f("Window became visible.  Reducing delay."),this.Za=1e3,this.Ia||Mh(this,0)),this.Ob=a},g.Ag=function(a){a?(this.f("Browser went online."),this.Za=1e3,this.Ia||Mh(this,0)):(this.f("Browser went offline.  Killing connection."),this.Ia&&this.Ia.close())},g.Df=function(){this.f("data client disconnected"),this.oa=!1,this.Ia=null;for(var a=0;a<this.qa.length;a++){var b=this.qa[a];b&&"h"in b.Jf&&b.Jg&&(b.H&&b.H("disconnect"),delete this.qa[a],this.Yc--)}0===this.Yc&&(this.qa=[]),this.Td={},Xh(this)&&(this.Ob?this.Lc&&(3e4<(new Date).getTime()-this.Lc&&(this.Za=1e3),this.Lc=null):(this.f("Window isn't visible.  Delaying reconnect."),this.Za=this.Fd,this.Ge=(new Date).getTime()),a=Math.max(0,this.Za-((new Date).getTime()-this.Ge)),a*=Math.random(),this.f("Trying to reconnect in "+a+"ms"),Mh(this,a),this.Za=Math.min(this.Fd,1.3*this.Za)),this.Uc(!1)},g.yb=function(){this.Ee=!0,this.Ia?this.Ia.close():(this.sb&&(clearTimeout(this.sb),this.sb=null),this.oa&&this.Df())},g.rc=function(){this.Ee=!1,this.Za=1e3,this.Ia||Mh(this,0)};var V={og:function(){ih=rh=!0}};V.forceLongPolling=V.og,V.pg=function(){jh=!0},V.forceWebSockets=V.pg,V.Pg=function(a,b){a.k.Ra.We=b},V.setSecurityDebugCallback=V.Pg,V.Ye=function(a,b){a.k.Ye(b)},V.stats=V.Ye,V.Ze=function(a,b){a.k.Ze(b)},V.statsIncrementCounter=V.Ze,V.sd=function(a){return a.k.sd},V.dataUpdateCount=V.sd,V.sg=function(a,b){a.k.De=b},V.interceptServerData=V.sg,V.yg=function(a){new Ig(a)},V.onPopupOpen=V.yg,V.Ng=function(a){sg=a},V.setAuthenticationServer=V.Ng,Q.prototype.I=function(){return x("Firebase.DataSnapshot.val",0,0,arguments.length),this.A.I()},Q.prototype.val=Q.prototype.I,Q.prototype.mf=function(){return x("Firebase.DataSnapshot.exportVal",0,0,arguments.length),this.A.I(!0)},Q.prototype.exportVal=Q.prototype.mf,Q.prototype.ng=function(){return x("Firebase.DataSnapshot.exists",0,0,arguments.length),!this.A.e()},Q.prototype.exists=Q.prototype.ng,Q.prototype.u=function(a){x("Firebase.DataSnapshot.child",0,1,arguments.length),ga(a)&&(a=String(a)),ig("Firebase.DataSnapshot.child",a);var b=new L(a),c=this.W.u(b);return new Q(this.A.Q(b),c,N)},Q.prototype.child=Q.prototype.u,Q.prototype.Da=function(a){x("Firebase.DataSnapshot.hasChild",1,1,arguments.length),ig("Firebase.DataSnapshot.hasChild",a);var b=new L(a);return!this.A.Q(b).e()},Q.prototype.hasChild=Q.prototype.Da,Q.prototype.C=function(){return x("Firebase.DataSnapshot.getPriority",0,0,arguments.length),this.A.C().I()},Q.prototype.getPriority=Q.prototype.C,Q.prototype.forEach=function(a){if(x("Firebase.DataSnapshot.forEach",1,1,arguments.length),A("Firebase.DataSnapshot.forEach",1,a,!1),this.A.K())return!1;var b=this;return!!this.A.P(this.g,function(c,d){return a(new Q(d,b.W.u(c),N))})},Q.prototype.forEach=Q.prototype.forEach,Q.prototype.wd=function(){return x("Firebase.DataSnapshot.hasChildren",0,0,arguments.length),!this.A.K()&&!this.A.e()},Q.prototype.hasChildren=Q.prototype.wd,Q.prototype.name=function(){return O("Firebase.DataSnapshot.name() being deprecated. Please use Firebase.DataSnapshot.key() instead."),x("Firebase.DataSnapshot.name",0,0,arguments.length),this.key()},Q.prototype.name=Q.prototype.name,Q.prototype.key=function(){return x("Firebase.DataSnapshot.key",0,0,arguments.length),this.W.key()},Q.prototype.key=Q.prototype.key,Q.prototype.Db=function(){return x("Firebase.DataSnapshot.numChildren",0,0,arguments.length),this.A.Db()},Q.prototype.numChildren=Q.prototype.Db,Q.prototype.Ib=function(){return x("Firebase.DataSnapshot.ref",0,0,arguments.length),this.W},Q.prototype.ref=Q.prototype.Ib,g=Yh.prototype,g.toString=function(){return(this.F.kb?"https://":"http://")+this.F.host},g.name=function(){return this.F.hc},g.Gb=function(a,b,c,d){this.sd++;var e=new L(a);b=this.De?this.De(a,b):b,a=[],d?c?(b=na(b,function(a){return M(a)}),a=Ff(this.L,e,b,d)):(b=M(b),a=Bf(this.L,e,b,d)):c?(d=na(b,function(a){return M(a)}),a=Af(this.L,e,d)):(d=M(b),a=xf(this.L,new Xb(bf,e,d))),d=e,0<a.length&&(d=bi(this,e)),Ab(this.da,d,a)},g.Uc=function(a){Zh(this,"connected",a),!1===a&&ci(this)},g.Oe=function(a){var b=this;Wc(a,function(a,d){Zh(b,d,a)})},g.Le=function(a){Zh(this,"authenticated",a)},g.Kb=function(a,b,c,d){this.f("set",{path:a.toString(),value:b,$g:c});var e=ai(this),e=sc(b=M(b,c),e),f=this.Hd++,e=wf(this.L,a,e,f,!0);wb(this.da,e);var h=this;this.ba.put(a.toString(),b.I(!0),function(b,c){var e="ok"===b;e||O("set at "+a+" failed: "+b),e=zf(h.L,f,!e),Ab(h.da,a,e),di(d,b,c)}),bi(this,e=ei(this,a)),Ab(this.da,e,[])},g.update=function(a,b,c){this.f("update",{path:a.toString(),value:b});var d=!0,e=ai(this),f={};if(r(b,function(a,b){d=!1;var c=M(a);f[b]=sc(c,e)}),d)Cb("update() called with empty data.  Don't do anything."),di(c,"ok");else{var h=this.Hd++,k=yf(this.L,a,f,h);wb(this.da,k);var l=this;this.ba.zf(a.toString(),b,function(b,d){(e="ok"===b)||O("update at "+a+" failed: "+b);var e=zf(l.L,h,!e),f=a;0<e.length&&(f=bi(l,a)),Ab(l.da,f,e),di(c,b,d)}),bi(this,b=ei(this,a)),Ab(this.da,a,[])}},g.Jd=function(a,b){var c=this;this.ba.Jd(a.toString(),function(d,e){"ok"===d&&rg(c.la,a),di(b,d,e)})},g.yb=function(){this.Ra&&this.Ra.yb()},g.rc=function(){this.Ra&&this.Ra.rc()},g.Ye=function(a){if("undefined"!=typeof console){a?(this.fd||(this.fd=new Lb(this.Ua)),a=this.fd.get()):a=this.Ua.get();var c,b=Ra(sa(a),function(a,b){return Math.max(b.length,a)},0);for(c in a){for(var d=a[c],e=c.length;e<b+2;e++)c+=" ";console.log(c+d)}}},g.Ze=function(a){Ob(this.Ua,a),this.Sg.Of[a]=!0},g.f=function(a){var b="";this.Ra&&(b=this.Ra.id+":"),Cb(b,arguments)},W.prototype.yb=function(){for(var a in this.oc)this.oc[a].yb()},W.prototype.rc=function(){for(var a in this.oc)this.oc[a].rc()},W.prototype.ve=function(){this.Sf=!0},ca(W),W.prototype.interrupt=W.prototype.yb,W.prototype.resume=W.prototype.rc,X.prototype.cancel=function(a){x("Firebase.onDisconnect().cancel",0,1,arguments.length),A("Firebase.onDisconnect().cancel",1,a,!0),this.bd.Jd(this.ra,a||null)},X.prototype.cancel=X.prototype.cancel,X.prototype.remove=function(a){x("Firebase.onDisconnect().remove",0,1,arguments.length),jg("Firebase.onDisconnect().remove",this.ra),A("Firebase.onDisconnect().remove",1,a,!0),fi(this.bd,this.ra,null,a)},X.prototype.remove=X.prototype.remove,X.prototype.set=function(a,b){x("Firebase.onDisconnect().set",1,2,arguments.length),jg("Firebase.onDisconnect().set",this.ra),bg("Firebase.onDisconnect().set",a,this.ra,!1),A("Firebase.onDisconnect().set",2,b,!0),fi(this.bd,this.ra,a,b)},X.prototype.set=X.prototype.set,X.prototype.Kb=function(a,b,c){x("Firebase.onDisconnect().setWithPriority",2,3,arguments.length),jg("Firebase.onDisconnect().setWithPriority",this.ra),bg("Firebase.onDisconnect().setWithPriority",a,this.ra,!1),fg("Firebase.onDisconnect().setWithPriority",2,b),A("Firebase.onDisconnect().setWithPriority",3,c,!0),gi(this.bd,this.ra,a,b,c)},X.prototype.setWithPriority=X.prototype.Kb,X.prototype.update=function(a,b){if(x("Firebase.onDisconnect().update",1,2,arguments.length),jg("Firebase.onDisconnect().update",this.ra),ea(a)){for(var c={},d=0;d<a.length;++d)c[""+d]=a[d];a=c,O("Passing an Array to Firebase.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}eg("Firebase.onDisconnect().update",a,this.ra),A("Firebase.onDisconnect().update",2,b,!0),hi(this.bd,this.ra,a,b)},X.prototype.update=X.prototype.update,g=Y.prototype,g.Ib=function(){return x("Query.ref",0,0,arguments.length),new U(this.k,this.path)},g.Eb=function(a,b,c,d){x("Query.on",2,4,arguments.length),gg("Query.on",a,!1),A("Query.on",2,b,!1);var e=vi("Query.on",c,d);if("value"===a)ii(this.k,this,new id(b,e.cancel||null,e.Ma||null));else{var f={};f[a]=b,ii(this.k,this,new jd(f,e.cancel,e.Ma))}return b},g.ic=function(a,b,c){x("Query.off",0,3,arguments.length),gg("Query.off",a,!0),A("Query.off",2,b,!0),mb("Query.off",3,c);var d=null,e=null;"value"===a?d=new id(b||null,null,c||null):a&&(b&&(e={},e[a]=b),d=new jd(e,null,c||null)),e=this.k,d=".info"===E(this.path)?e.Cd.jb(this,d):e.L.jb(this,d),yb(e.da,this.path,d)},g.Dg=function(a,b){function c(h){f&&(f=!1,e.ic(a,c),b.call(d.Ma,h))}x("Query.once",2,4,arguments.length),gg("Query.once",a,!1),A("Query.once",2,b,!1);var d=vi("Query.once",arguments[2],arguments[3]),e=this,f=!0;this.Eb(a,c,function(b){e.ic(a,c),d.cancel&&d.cancel.call(d.Ma,b)})},g.He=function(a){if(O("Query.limit() being deprecated. Please use Query.limitToFirst() or Query.limitToLast() instead."),x("Query.limit",1,1,arguments.length),!ga(a)||Math.floor(a)!==a||0>=a)throw Error("Query.limit: First argument must be a positive integer.");if(this.n.ja)throw Error("Query.limit: Limit was already set (by another call to limit, limitToFirst, orlimitToLast.");var b=this.n.He(a);return ti(b),new Y(this.k,this.path,b,this.lc)},g.Ie=function(a){if(x("Query.limitToFirst",1,1,arguments.length),!ga(a)||Math.floor(a)!==a||0>=a)throw Error("Query.limitToFirst: First argument must be a positive integer.");if(this.n.ja)throw Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new Y(this.k,this.path,this.n.Ie(a),this.lc)},g.Je=function(a){if(x("Query.limitToLast",1,1,arguments.length),!ga(a)||Math.floor(a)!==a||0>=a)throw Error("Query.limitToLast: First argument must be a positive integer.");if(this.n.ja)throw Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new Y(this.k,this.path,this.n.Je(a),this.lc)},g.Eg=function(a){if(x("Query.orderByChild",1,1,arguments.length),"$key"===a)throw Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===a)throw Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===a)throw Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');ig("Query.orderByChild",a),ui(this,"Query.orderByChild");var b=new L(a);if(b.e())throw Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");return b=new Ud(b),b=de(this.n,b),si(b),new Y(this.k,this.path,b,!0)},g.Fg=function(){x("Query.orderByKey",0,0,arguments.length),ui(this,"Query.orderByKey");var a=de(this.n,Qd);return si(a),new Y(this.k,this.path,a,!0)},g.Gg=function(){x("Query.orderByPriority",0,0,arguments.length),ui(this,"Query.orderByPriority");var a=de(this.n,N);return si(a),new Y(this.k,this.path,a,!0)},g.Hg=function(){x("Query.orderByValue",0,0,arguments.length),ui(this,"Query.orderByValue");var a=de(this.n,$d);return si(a),new Y(this.k,this.path,a,!0)},g.$d=function(a,b){x("Query.startAt",0,2,arguments.length),bg("Query.startAt",a,this.path,!0),hg("Query.startAt",b);var c=this.n.$d(a,b);if(ti(c),si(c),this.n.ma)throw Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return n(a)||(b=a=null),new Y(this.k,this.path,c,this.lc)},g.td=function(a,b){x("Query.endAt",0,2,arguments.length),bg("Query.endAt",a,this.path,!0),hg("Query.endAt",b);var c=this.n.td(a,b);if(ti(c),si(c),this.n.pa)throw Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new Y(this.k,this.path,c,this.lc)},g.kg=function(a,b){if(x("Query.equalTo",1,2,arguments.length),bg("Query.equalTo",a,this.path,!1),hg("Query.equalTo",b),this.n.ma)throw Error("Query.equalTo: Starting point was already set (by another call to endAt or equalTo).");if(this.n.pa)throw Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.$d(a,b).td(a,b)},g.toString=function(){x("Query.toString",0,0,arguments.length);for(var a=this.path,b="",c=a.Z;c<a.o.length;c++)""!==a.o[c]&&(b+="/"+encodeURIComponent(String(a.o[c])));return this.k.toString()+(b||"/")},g.va=function(){var a=Uc(ee(this.n));return"{}"===a?"default":a},Y.prototype.ref=Y.prototype.Ib,Y.prototype.on=Y.prototype.Eb,Y.prototype.off=Y.prototype.ic,Y.prototype.once=Y.prototype.Dg,Y.prototype.limit=Y.prototype.He,Y.prototype.limitToFirst=Y.prototype.Ie,Y.prototype.limitToLast=Y.prototype.Je,Y.prototype.orderByChild=Y.prototype.Eg,Y.prototype.orderByKey=Y.prototype.Fg,Y.prototype.orderByPriority=Y.prototype.Gg,Y.prototype.orderByValue=Y.prototype.Hg,Y.prototype.startAt=Y.prototype.$d,Y.prototype.endAt=Y.prototype.td,Y.prototype.equalTo=Y.prototype.kg,Y.prototype.toString=Y.prototype.toString;var Z={};Z.vc=Kh,Z.DataConnection=Z.vc,Kh.prototype.Rg=function(a,b){this.Fa("q",{p:a},b)},Z.vc.prototype.simpleListen=Z.vc.prototype.Rg,Kh.prototype.jg=function(a,b){this.Fa("echo",{d:a},b)},Z.vc.prototype.echo=Z.vc.prototype.jg,Kh.prototype.interrupt=Kh.prototype.yb,Z.Vf=yh,Z.RealTimeConnection=Z.Vf,yh.prototype.sendRequest=yh.prototype.Fa,yh.prototype.close=yh.prototype.close,Z.rg=function(a){var b=Kh.prototype.put;return Kh.prototype.put=function(c,d,e,f){n(f)&&(f=a()),b.call(this,c,d,e,f)},function(){Kh.prototype.put=b}},Z.hijackHash=Z.rg,Z.Uf=zc,Z.ConnectionTarget=Z.Uf,Z.va=function(a){return a.va()},Z.queryIdentifier=Z.va,Z.tg=function(a){return a.k.Ra.$},Z.listens=Z.tg,Z.ve=function(a){a.ve()},Z.forceRestClient=Z.ve,ma(U,Y);var wi=U,xi=["Firebase"],yi=aa;xi[0]in yi||!yi.execScript||yi.execScript("var "+xi[0]);for(var zi;xi.length&&(zi=xi.shift());)!xi.length&&n(wi)?yi[zi]=wi:yi=yi[zi]?yi[zi]:yi[zi]={};U.goOffline=function(){x("Firebase.goOffline",0,0,arguments.length),W.ub().yb()},U.goOnline=function(){x("Firebase.goOnline",0,0,arguments.length),W.ub().rc()},U.enableLogging=Lc,U.ServerValue={TIMESTAMP:{".sv":"timestamp"}},U.SDK_VERSION=hb,U.INTERNAL=V,U.Context=W,U.TEST_ACCESS=Z,U.prototype.name=function(){return O("Firebase.name() being deprecated. Please use Firebase.key() instead."),x("Firebase.name",0,0,arguments.length),this.key()},U.prototype.name=U.prototype.name,U.prototype.key=function(){return x("Firebase.key",0,0,arguments.length),this.path.e()?null:Ld(this.path)},U.prototype.key=U.prototype.key,U.prototype.u=function(a){if(x("Firebase.child",1,1,arguments.length),ga(a))a=String(a);else if(!(a instanceof L))if(null===E(this.path)){var b=a;b&&(b=b.replace(/^\/*\.info(\/|$)/,"/")),ig("Firebase.child",b)}else ig("Firebase.child",a);return new U(this.k,this.path.u(a))},U.prototype.child=U.prototype.u,U.prototype.parent=function(){x("Firebase.parent",0,0,arguments.length);var a=this.path.parent();return null===a?null:new U(this.k,a)},U.prototype.parent=U.prototype.parent,U.prototype.root=function(){x("Firebase.ref",0,0,arguments.length);for(var a=this;null!==a.parent();)a=a.parent();return a},U.prototype.root=U.prototype.root,U.prototype.set=function(a,b){x("Firebase.set",1,2,arguments.length),jg("Firebase.set",this.path),bg("Firebase.set",a,this.path,!1),A("Firebase.set",2,b,!0),this.k.Kb(this.path,a,null,b||null)},U.prototype.set=U.prototype.set,U.prototype.update=function(a,b){if(x("Firebase.update",1,2,arguments.length),jg("Firebase.update",this.path),ea(a)){for(var c={},d=0;d<a.length;++d)c[""+d]=a[d];a=c,O("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}eg("Firebase.update",a,this.path),A("Firebase.update",2,b,!0),this.k.update(this.path,a,b||null)},U.prototype.update=U.prototype.update,U.prototype.Kb=function(a,b,c){if(x("Firebase.setWithPriority",2,3,arguments.length),jg("Firebase.setWithPriority",this.path),bg("Firebase.setWithPriority",a,this.path,!1),fg("Firebase.setWithPriority",2,b),A("Firebase.setWithPriority",3,c,!0),".length"===this.key()||".keys"===this.key())throw"Firebase.setWithPriority failed: "+this.key()+" is a read-only object.";this.k.Kb(this.path,a,b,c||null)},U.prototype.setWithPriority=U.prototype.Kb,U.prototype.remove=function(a){x("Firebase.remove",0,1,arguments.length),jg("Firebase.remove",this.path),A("Firebase.remove",1,a,!0),this.set(null,a)},U.prototype.remove=U.prototype.remove,U.prototype.transaction=function(a,b,c){if(x("Firebase.transaction",1,3,arguments.length),jg("Firebase.transaction",this.path),A("Firebase.transaction",1,a,!1),A("Firebase.transaction",2,b,!0),n(c)&&"boolean"!=typeof c)throw Error(y("Firebase.transaction",3,!0)+"must be a boolean.");if(".length"===this.key()||".keys"===this.key())throw"Firebase.transaction failed: "+this.key()+" is a read-only object.";void 0===c&&(c=!0),ji(this.k,this.path,a,b||null,c)},U.prototype.transaction=U.prototype.transaction,U.prototype.Og=function(a,b){x("Firebase.setPriority",1,2,arguments.length),jg("Firebase.setPriority",this.path),fg("Firebase.setPriority",1,a),A("Firebase.setPriority",2,b,!0),this.k.Kb(this.path.u(".priority"),a,null,b)},U.prototype.setPriority=U.prototype.Og,U.prototype.push=function(a,b){x("Firebase.push",0,2,arguments.length),jg("Firebase.push",this.path),bg("Firebase.push",a,this.path,!0),A("Firebase.push",2,b,!0);var c=$h(this.k),c=Fe(c),c=this.u(c);return void 0!==a&&null!==a&&c.set(a,b),c},U.prototype.push=U.prototype.push,U.prototype.hb=function(){return jg("Firebase.onDisconnect",this.path),new X(this.k,this.path)},U.prototype.onDisconnect=U.prototype.hb,U.prototype.M=function(a,b,c){O("FirebaseRef.auth() being deprecated. Please use FirebaseRef.authWithCustomToken() instead."),x("Firebase.auth",1,3,arguments.length),kg("Firebase.auth",a),A("Firebase.auth",2,b,!0),A("Firebase.auth",3,b,!0),Yg(this.k.M,a,{},{remember:"none"},b,c)},U.prototype.auth=U.prototype.M,U.prototype.ge=function(a){x("Firebase.unauth",0,1,arguments.length),A("Firebase.unauth",1,a,!0),Zg(this.k.M,a)},U.prototype.unauth=U.prototype.ge,U.prototype.xe=function(){return x("Firebase.getAuth",0,0,arguments.length),this.k.M.xe()},U.prototype.getAuth=U.prototype.xe,U.prototype.xg=function(a,b){x("Firebase.onAuth",1,2,arguments.length),A("Firebase.onAuth",1,a,!1),mb("Firebase.onAuth",2,b),this.k.M.Eb("auth_status",a,b)},U.prototype.onAuth=U.prototype.xg,U.prototype.wg=function(a,b){x("Firebase.offAuth",1,2,arguments.length),A("Firebase.offAuth",1,a,!1),mb("Firebase.offAuth",2,b),this.k.M.ic("auth_status",a,b)},U.prototype.offAuth=U.prototype.wg,U.prototype.Zf=function(a,b,c){x("Firebase.authWithCustomToken",2,3,arguments.length),kg("Firebase.authWithCustomToken",a),A("Firebase.authWithCustomToken",2,b,!1),ng("Firebase.authWithCustomToken",3,c,!0),Yg(this.k.M,a,{},c||{},b)},U.prototype.authWithCustomToken=U.prototype.Zf,U.prototype.$f=function(a,b,c){x("Firebase.authWithOAuthPopup",2,3,arguments.length),mg("Firebase.authWithOAuthPopup",a),A("Firebase.authWithOAuthPopup",2,b,!1),ng("Firebase.authWithOAuthPopup",3,c,!0),ch(this.k.M,a,c,b)},U.prototype.authWithOAuthPopup=U.prototype.$f,U.prototype.ag=function(a,b,c){x("Firebase.authWithOAuthRedirect",2,3,arguments.length),mg("Firebase.authWithOAuthRedirect",a),A("Firebase.authWithOAuthRedirect",2,b,!1),ng("Firebase.authWithOAuthRedirect",3,c,!0);var d=this.k.M;ah(d);var e=[Kg],f=vg(c);"anonymous"===a||"firebase"===a?P(b,Mg("TRANSPORT_UNAVAILABLE")):(yc.set("redirect_client_options",f.od),bh(d,e,"/auth/"+a,f,b))},U.prototype.authWithOAuthRedirect=U.prototype.ag,U.prototype.bg=function(a,b,c,d){x("Firebase.authWithOAuthToken",3,4,arguments.length),mg("Firebase.authWithOAuthToken",a),A("Firebase.authWithOAuthToken",3,c,!1),ng("Firebase.authWithOAuthToken",4,d,!0),p(b)?(lg("Firebase.authWithOAuthToken",2,b),$g(this.k.M,a+"/token",{access_token:b},d,c)):(ng("Firebase.authWithOAuthToken",2,b,!1),$g(this.k.M,a+"/token",b,d,c))},U.prototype.authWithOAuthToken=U.prototype.bg,U.prototype.Yf=function(a,b){x("Firebase.authAnonymously",1,2,arguments.length),A("Firebase.authAnonymously",1,a,!1),ng("Firebase.authAnonymously",2,b,!0),$g(this.k.M,"anonymous",{},b,a)},U.prototype.authAnonymously=U.prototype.Yf,U.prototype.cg=function(a,b,c){x("Firebase.authWithPassword",2,3,arguments.length),ng("Firebase.authWithPassword",1,a,!1),og("Firebase.authWithPassword",a,"email"),og("Firebase.authWithPassword",a,"password"),A("Firebase.authWithPassword",2,b,!1),ng("Firebase.authWithPassword",3,c,!0),$g(this.k.M,"password",a,c,b)},U.prototype.authWithPassword=U.prototype.cg,U.prototype.se=function(a,b){x("Firebase.createUser",2,2,arguments.length),ng("Firebase.createUser",1,a,!1),og("Firebase.createUser",a,"email"),og("Firebase.createUser",a,"password"),A("Firebase.createUser",2,b,!1),this.k.M.se(a,b)},U.prototype.createUser=U.prototype.se,U.prototype.Te=function(a,b){x("Firebase.removeUser",2,2,arguments.length),ng("Firebase.removeUser",1,a,!1),og("Firebase.removeUser",a,"email"),og("Firebase.removeUser",a,"password"),A("Firebase.removeUser",2,b,!1),this.k.M.Te(a,b)},U.prototype.removeUser=U.prototype.Te,U.prototype.pe=function(a,b){x("Firebase.changePassword",2,2,arguments.length),ng("Firebase.changePassword",1,a,!1),og("Firebase.changePassword",a,"email"),og("Firebase.changePassword",a,"oldPassword"),og("Firebase.changePassword",a,"newPassword"),A("Firebase.changePassword",2,b,!1),this.k.M.pe(a,b)},U.prototype.changePassword=U.prototype.pe,U.prototype.oe=function(a,b){x("Firebase.changeEmail",2,2,arguments.length),ng("Firebase.changeEmail",1,a,!1),og("Firebase.changeEmail",a,"oldEmail"),og("Firebase.changeEmail",a,"newEmail"),og("Firebase.changeEmail",a,"password"),A("Firebase.changeEmail",2,b,!1),this.k.M.oe(a,b)},U.prototype.changeEmail=U.prototype.oe,U.prototype.Ve=function(a,b){x("Firebase.resetPassword",2,2,arguments.length),ng("Firebase.resetPassword",1,a,!1),og("Firebase.resetPassword",a,"email"),A("Firebase.resetPassword",2,b,!1),this.k.M.Ve(a,b)},U.prototype.resetPassword=U.prototype.Ve}();
var m=function app(window,undefined){"use strict";function isFunction(object){return"function"==typeof object}function isObject(object){return"[object Object]"===type.call(object)}function isString(object){return"[object String]"===type.call(object)}function initialize(window){$document=window.document,$location=window.location,$cancelAnimationFrame=window.cancelAnimationFrame||window.clearTimeout,$requestAnimationFrame=window.requestAnimationFrame||window.setTimeout}function m(tag,pairs){for(var args=[],i=1;i<arguments.length;i++)args[i-1]=arguments[i];if(isObject(tag))return parameterize(tag,args);var match,hasAttrs=null!=pairs&&isObject(pairs)&&!("tag"in pairs||"view"in pairs||"subtree"in pairs),attrs=hasAttrs?pairs:{},classAttrName="class"in attrs?"class":"className",cell={tag:"div",attrs:{}},classes=[];if(!isString(tag))throw new Error("selector in m(selector, attrs, children) should be a string");for(;null!=(match=parser.exec(tag));)if(""===match[1]&&match[2])cell.tag=match[2];else if("#"===match[1])cell.attrs.id=match[2];else if("."===match[1])classes.push(match[2]);else if("["===match[3][0]){var pair=attrParser.exec(match[3]);cell.attrs[pair[1]]=pair[3]||!pair[2]||""}var children=hasAttrs?args.slice(1):args;1===children.length&&isArray(children[0])?cell.children=children[0]:cell.children=children;for(var attrName in attrs)attrs.hasOwnProperty(attrName)&&(attrName===classAttrName&&null!=attrs[attrName]&&""!==attrs[attrName]?(classes.push(attrs[attrName]),cell.attrs[attrName]=""):cell.attrs[attrName]=attrs[attrName]);return classes.length&&(cell.attrs[classAttrName]=classes.join(" ")),cell}function forEach(list,f){for(var i=0;i<list.length&&!f(list[i],i++););}function forKeys(list,f){forEach(list,function(attrs,i){return(attrs=attrs&&attrs.attrs)&&null!=attrs.key&&f(attrs,i)})}function dataToString(data){try{if(null==data||null==data.toString())return""}catch(e){return""}return data}function injectTextNode(parentElement,first,index,data){try{insertNode(parentElement,first,index),first.nodeValue=data}catch(e){}}function flatten(list){for(var i=0;i<list.length;i++)isArray(list[i])&&(list=list.concat.apply([],list),i--);return list}function insertNode(parentElement,node,index){parentElement.insertBefore(node,parentElement.childNodes[index]||null)}function handleKeysDiffer(data,existing,cached,parentElement){forKeys(data,function(key,i){existing[key=key.key]=existing[key]?{action:MOVE,index:i,from:existing[key].index,element:cached.nodes[existing[key].index]||$document.createElement("div")}:{action:INSERTION,index:i}});var actions=[];for(var prop in existing)actions.push(existing[prop]);var changes=actions.sort(sortChanges),newCached=new Array(cached.length);return newCached.nodes=cached.nodes.slice(),forEach(changes,function(change){var index=change.index;if(change.action===DELETION&&(clear(cached[index].nodes,cached[index]),newCached.splice(index,1)),change.action===INSERTION){var dummy=$document.createElement("div");dummy.key=data[index].attrs.key,insertNode(parentElement,dummy,index),newCached.splice(index,0,{attrs:{key:data[index].attrs.key},nodes:[dummy]}),newCached.nodes[index]=dummy}if(change.action===MOVE){var changeElement=change.element,maybeChanged=parentElement.childNodes[index];maybeChanged!==changeElement&&null!==changeElement&&parentElement.insertBefore(changeElement,maybeChanged||null),newCached[index]=cached[change.from],newCached.nodes[index]=changeElement}}),newCached}function diffKeys(data,cached,existing,parentElement){var keysDiffer=data.length!==cached.length;return keysDiffer||forKeys(data,function(attrs,i){var cachedCell=cached[i];return keysDiffer=cachedCell&&cachedCell.attrs&&cachedCell.attrs.key!==attrs.key}),keysDiffer?handleKeysDiffer(data,existing,cached,parentElement):cached}function diffArray(data,cached,nodes){forEach(data,function(_,i){null!=cached[i]&&nodes.push.apply(nodes,cached[i].nodes)}),forEach(cached.nodes,function(node,i){null!=node.parentNode&&nodes.indexOf(node)<0&&clear([node],[cached[i]])}),data.length<cached.length&&(cached.length=data.length),cached.nodes=nodes}function buildArrayKeys(data){var guid=0;forKeys(data,function(){return forEach(data,function(attrs){(attrs=attrs&&attrs.attrs)&&null==attrs.key&&(attrs.key="__mithril__"+guid++)}),1})}function maybeRecreateObject(data,cached,dataAttrKeys){(data.tag!==cached.tag||dataAttrKeys.sort().join()!==Object.keys(cached.attrs).sort().join()||data.attrs.id!==cached.attrs.id||data.attrs.key!==cached.attrs.key||"all"===m.redraw.strategy()&&(!cached.configContext||!0!==cached.configContext.retain)||"diff"===m.redraw.strategy()&&cached.configContext&&!1===cached.configContext.retain)&&(cached.nodes.length&&clear(cached.nodes),cached.configContext&&isFunction(cached.configContext.onunload)&&cached.configContext.onunload(),cached.controllers&&forEach(cached.controllers,function(controller){controller.unload&&controller.onunload({preventDefault:noop})}))}function getObjectNamespace(data,namespace){return data.attrs.xmlns?data.attrs.xmlns:"svg"===data.tag?"http://www.w3.org/2000/svg":"math"===data.tag?"http://www.w3.org/1998/Math/MathML":namespace}function unloadCachedControllers(cached,views,controllers){controllers.length&&(cached.views=views,cached.controllers=controllers,forEach(controllers,function(controller){if(controller.onunload&&controller.onunload.$old&&(controller.onunload=controller.onunload.$old),pendingRequests&&controller.onunload){var onunload=controller.onunload;controller.onunload=noop,controller.onunload.$old=onunload}}))}function scheduleConfigsToBeCalled(configs,data,node,isNew,cached){if(isFunction(data.attrs.config)){var context=cached.configContext=cached.configContext||{};configs.push(function(){return data.attrs.config.call(data,node,!isNew,context,cached)})}}function buildUpdatedNode(cached,data,editable,hasKeys,namespace,views,configs,controllers){var node=cached.nodes[0];return hasKeys&&setAttributes(node,data.tag,data.attrs,cached.attrs,namespace),cached.children=build(node,data.tag,undefined,undefined,data.children,cached.children,!1,0,data.attrs.contenteditable?node:editable,namespace,configs),cached.nodes.intact=!0,controllers.length&&(cached.views=views,cached.controllers=controllers),node}function handleNonexistentNodes(data,parentElement,index){var nodes;data.$trusted?nodes=injectHTML(parentElement,index,data):(nodes=[$document.createTextNode(data)],parentElement.nodeName.match(voidElements)||insertNode(parentElement,nodes[0],index));var cached="string"==typeof data||"number"==typeof data||"boolean"==typeof data?new data.constructor(data):data;return cached.nodes=nodes,cached}function reattachNodes(data,cached,parentElement,editable,index,parentTag){var nodes=cached.nodes;return editable&&editable===$document.activeElement||(data.$trusted?(clear(nodes,cached),nodes=injectHTML(parentElement,index,data)):"textarea"===parentTag?parentElement.value=data:editable?editable.innerHTML=data:((1===nodes[0].nodeType||nodes.length>1)&&(clear(cached.nodes,cached),nodes=[$document.createTextNode(data)]),injectTextNode(parentElement,nodes[0],index,data))),cached=new data.constructor(data),cached.nodes=nodes,cached}function handleText(cached,data,index,parentElement,shouldReattach,editable,parentTag){return 0===cached.nodes.length?handleNonexistentNodes(data,parentElement,index):cached.valueOf()!==data.valueOf()||!0===shouldReattach?reattachNodes(data,cached,parentElement,editable,index,parentTag):(cached.nodes.intact=!0,cached)}function getSubArrayCount(item){if(item.$trusted){var match=item.match(/<[^\/]|\>\s*[^<]/g);if(null!=match)return match.length}else if(isArray(item))return item.length;return 1}function buildArray(data,cached,parentElement,index,parentTag,shouldReattach,editable,namespace,configs){data=flatten(data);var nodes=[],intact=cached.length===data.length,subArrayCount=0,existing={},shouldMaintainIdentities=!1;forKeys(cached,function(attrs,i){shouldMaintainIdentities=!0,existing[cached[i].attrs.key]={action:DELETION,index:i}}),buildArrayKeys(data),shouldMaintainIdentities&&(cached=diffKeys(data,cached,existing,parentElement));for(var cacheCount=0,i=0,len=data.length;i<len;i++){var item=build(parentElement,parentTag,cached,index,data[i],cached[cacheCount],shouldReattach,index+subArrayCount||subArrayCount,editable,namespace,configs);item!==undefined&&(intact=intact&&item.nodes.intact,subArrayCount+=getSubArrayCount(item),cached[cacheCount++]=item)}return intact||diffArray(data,cached,nodes),cached}function makeCache(data,cached,index,parentIndex,parentCache){if(null!=cached){if(type.call(cached)===type.call(data))return cached;if(parentCache&&parentCache.nodes){var offset=index-parentIndex,end=offset+(isArray(data)?data:cached.nodes).length;clear(parentCache.nodes.slice(offset,end),parentCache.slice(offset,end))}else cached.nodes&&clear(cached.nodes,cached)}return(cached=new data.constructor).tag&&(cached={}),cached.nodes=[],cached}function constructNode(data,namespace){return namespace===undefined?data.attrs.is?$document.createElement(data.tag,data.attrs.is):$document.createElement(data.tag):data.attrs.is?$document.createElementNS(namespace,data.tag,data.attrs.is):$document.createElementNS(namespace,data.tag)}function constructAttrs(data,node,namespace,hasKeys){return hasKeys?setAttributes(node,data.tag,data.attrs,{},namespace):data.attrs}function constructChildren(data,node,cached,editable,namespace,configs){return null!=data.children&&data.children.length>0?build(node,data.tag,undefined,undefined,data.children,cached.children,!0,0,data.attrs.contenteditable?node:editable,namespace,configs):data.children}function reconstructCached(data,attrs,children,node,namespace,views,controllers){var cached={tag:data.tag,attrs:attrs,children:children,nodes:[node]};return unloadCachedControllers(cached,views,controllers),cached.children&&!cached.children.nodes&&(cached.children.nodes=[]),"select"===data.tag&&"value"in data.attrs&&setAttributes(node,data.tag,{value:data.attrs.value},{},namespace),cached}function getController(views,view,cachedControllers,controller){var controllerIndex="diff"===m.redraw.strategy()&&views?views.indexOf(view):-1;return controllerIndex>-1?cachedControllers[controllerIndex]:"function"==typeof controller?new controller:{}}function updateLists(views,controllers,view,controller){null!=controller.onunload&&unloaders.push({controller:controller,handler:controller.onunload}),views.push(view),controllers.push(controller)}function checkView(data,view,cached,cachedControllers,controllers,views){var controller=getController(cached.views,view,cachedControllers,data.controller),key=+(data&&data.attrs&&data.attrs.key);return"retain"===(data=0===pendingRequests||forcing||cachedControllers&&cachedControllers.indexOf(controller)>-1?data.view(controller):{tag:"placeholder"}).subtree?cached:(key===key&&((data.attrs=data.attrs||{}).key=key),updateLists(views,controllers,view,controller),data)}function markViews(data,cached,views,controllers){for(var cachedControllers=cached&&cached.controllers;null!=data.view;)data=checkView(data,data.view.$original||data.view,cached,cachedControllers,controllers,views);return data}function buildObject(data,cached,editable,parentElement,index,shouldReattach,namespace,configs){var views=[],controllers=[];if(!(data=markViews(data,cached,views,controllers)).tag&&controllers.length)throw new Error("Component template must return a virtual element, not an array, string, etc.");data.attrs=data.attrs||{},cached.attrs=cached.attrs||{};var dataAttrKeys=Object.keys(data.attrs),hasKeys=dataAttrKeys.length>("key"in data.attrs?1:0);if(maybeRecreateObject(data,cached,dataAttrKeys),isString(data.tag)){var isNew=0===cached.nodes.length;namespace=getObjectNamespace(data,namespace);var node;return isNew?cached=reconstructCached(data,constructAttrs(data,node=constructNode(data,namespace),namespace,hasKeys),constructChildren(data,node,cached,editable,namespace,configs),node,namespace,views,controllers):node=buildUpdatedNode(cached,data,editable,hasKeys,namespace,views,configs,controllers),(isNew||!0===shouldReattach&&null!=node)&&insertNode(parentElement,node,index),scheduleConfigsToBeCalled(configs,data,node,isNew,cached),cached}}function build(parentElement,parentTag,parentCache,parentIndex,data,cached,shouldReattach,index,editable,namespace,configs){return"retain"===(data=dataToString(data)).subtree?cached:(cached=makeCache(data,cached,index,parentIndex,parentCache),isArray(data)?buildArray(data,cached,parentElement,index,parentTag,shouldReattach,editable,namespace,configs):null!=data&&isObject(data)?buildObject(data,cached,editable,parentElement,index,shouldReattach,namespace,configs):isFunction(data)?cached:handleText(cached,data,index,parentElement,shouldReattach,editable,parentTag))}function sortChanges(a,b){return a.action-b.action||a.index-b.index}function setAttributes(node,tag,dataAttrs,cachedAttrs,namespace){for(var attrName in dataAttrs){var dataAttr=dataAttrs[attrName],cachedAttr=cachedAttrs[attrName];if(attrName in cachedAttrs&&cachedAttr===dataAttr)"value"===attrName&&"input"===tag&&node.value!=dataAttr&&(node.value=dataAttr);else{cachedAttrs[attrName]=dataAttr;try{if("config"===attrName||"key"===attrName)continue;if(isFunction(dataAttr)&&"on"===attrName.slice(0,2))node[attrName]=autoredraw(dataAttr,node);else if("style"===attrName&&null!=dataAttr&&isObject(dataAttr)){for(var rule in dataAttr)null!=cachedAttr&&cachedAttr[rule]===dataAttr[rule]||(node.style[rule]=dataAttr[rule]);for(var rule in cachedAttr)rule in dataAttr||(node.style[rule]="")}else null!=namespace?"href"===attrName?node.setAttributeNS("http://www.w3.org/1999/xlink","href",dataAttr):node.setAttribute("className"===attrName?"class":attrName,dataAttr):attrName in node&&"list"!==attrName&&"style"!==attrName&&"form"!==attrName&&"type"!==attrName&&"width"!==attrName&&"height"!==attrName?"input"===tag&&node[attrName]===dataAttr||(node[attrName]=dataAttr):node.setAttribute(attrName,dataAttr)}catch(e){if(e.message.indexOf("Invalid argument")<0)throw e}}}return cachedAttrs}function clear(nodes,cached){for(var i=nodes.length-1;i>-1;i--)if(nodes[i]&&nodes[i].parentNode){try{nodes[i].parentNode.removeChild(nodes[i])}catch(e){}(cached=[].concat(cached))[i]&&unload(cached[i])}nodes.length&&(nodes.length=0)}function unload(cached){cached.configContext&&isFunction(cached.configContext.onunload)&&(cached.configContext.onunload(),cached.configContext.onunload=null),cached.controllers&&forEach(cached.controllers,function(controller){isFunction(controller.onunload)&&controller.onunload({preventDefault:noop})}),cached.children&&(isArray(cached.children)?forEach(cached.children,unload):cached.children.tag&&unload(cached.children))}function injectHTML(parentElement,index,data){var nextSibling=parentElement.childNodes[index];if(nextSibling){var isElement=1!==nextSibling.nodeType,placeholder=$document.createElement("span");isElement?(parentElement.insertBefore(placeholder,nextSibling||null),placeholder.insertAdjacentHTML("beforebegin",data),parentElement.removeChild(placeholder)):nextSibling.insertAdjacentHTML("beforebegin",data)}else insertAdjacentBeforeEnd(parentElement,data);for(var nodes=[];parentElement.childNodes[index]!==nextSibling;)nodes.push(parentElement.childNodes[index]),index++;return nodes}function autoredraw(callback,object){return function(e){e=e||event,m.redraw.strategy("diff"),m.startComputation();try{return callback.call(object,e)}finally{endFirstComputation()}}}function getCellCacheKey(element){var index=nodeCache.indexOf(element);return index<0?nodeCache.push(element)-1:index}function gettersetter(store){var prop=function(){return arguments.length&&(store=arguments[0]),store};return prop.toJSON=function(){return store},prop}function parameterize(component,args){var controller=function(){return(component.controller||noop).apply(this,args)||this};component.controller&&(controller.prototype=component.controller.prototype);var view=function(ctrl){var currentArgs=arguments.length>1?args.concat([].slice.call(arguments,1)):args;return component.view.apply(component,currentArgs?[ctrl].concat(currentArgs):[ctrl])};view.$original=component.view;var output={controller:controller,view:view};return args[0]&&null!=args[0].key&&(output.attrs={key:args[0].key}),output}function removeRootElement(root,index){roots.splice(index,1),controllers.splice(index,1),components.splice(index,1),reset(root),nodeCache.splice(getCellCacheKey(root),1)}function redraw(){computePreRedrawHook&&(computePreRedrawHook(),computePreRedrawHook=null),forEach(roots,function(root,i){var component=components[i];if(controllers[i]){var args=[controllers[i]];m.render(root,component.view?component.view(controllers[i],args):"")}}),computePostRedrawHook&&(computePostRedrawHook(),computePostRedrawHook=null),lastRedrawId=null,lastRedrawCallTime=new Date,m.redraw.strategy("diff")}function endFirstComputation(){"none"===m.redraw.strategy()?(pendingRequests--,m.redraw.strategy("diff")):m.endComputation()}function normalizeRoute(route){return route.slice(modes[m.route.mode].length)}function routeByValue(root,router,path){routeParams={};var queryStart=path.indexOf("?");-1!==queryStart&&(routeParams=parseQueryString(path.substr(queryStart+1,path.length)),path=path.substr(0,queryStart));var keys=Object.keys(router),index=keys.indexOf(path);if(-1!==index)return m.mount(root,router[keys[index]]),!0;for(var route in router){if(route===path)return m.mount(root,router[route]),!0;var matcher=new RegExp("^"+route.replace(/:[^\/]+?\.{3}/g,"(.*?)").replace(/:[^\/]+/g,"([^\\/]+)")+"/?$");if(matcher.test(path))return path.replace(matcher,function(){var keys=route.match(/:[^\/]+/g)||[],values=[].slice.call(arguments,1,-2);forEach(keys,function(key,i){routeParams[key.replace(/:|\./g,"")]=decodeURIComponent(values[i])}),m.mount(root,router[route])}),!0}}function routeUnobtrusive(e){if(!(e=e||event).ctrlKey&&!e.metaKey&&2!==e.which){e.preventDefault?e.preventDefault():e.returnValue=!1;for(var currentTarget=e.currentTarget||e.srcElement,args="pathname"===m.route.mode&&currentTarget.search?parseQueryString(currentTarget.search.slice(1)):{};currentTarget&&"A"!==currentTarget.nodeName.toUpperCase();)currentTarget=currentTarget.parentNode;m.route(currentTarget[m.route.mode].slice(modes[m.route.mode].length),args)}}function setScroll(){"hash"!==m.route.mode&&$location.hash?$location.hash=$location.hash:window.scrollTo(0,0)}function buildQueryString(object,prefix){var duplicates={},str=[];for(var prop in object){var key=prefix?prefix+"["+prop+"]":prop,value=object[prop];if(null===value)str.push(encodeURIComponent(key));else if(isObject(value))str.push(buildQueryString(value,key));else if(isArray(value)){var keys=[];duplicates[key]=duplicates[key]||{},forEach(value,function(item){duplicates[key][item]||(duplicates[key][item]=!0,keys.push(encodeURIComponent(key)+"="+encodeURIComponent(item)))}),str.push(keys.join("&"))}else value!==undefined&&str.push(encodeURIComponent(key)+"="+encodeURIComponent(value))}return str.join("&")}function parseQueryString(str){if(""===str||null==str)return{};"?"===str.charAt(0)&&(str=str.slice(1));var params={};return forEach(str.split("&"),function(string){var pair=string.split("="),key=decodeURIComponent(pair[0]),value=2===pair.length?decodeURIComponent(pair[1]):null;null!=params[key]?(isArray(params[key])||(params[key]=[params[key]]),params[key].push(value)):params[key]=value}),params}function reset(root){var cacheKey=getCellCacheKey(root);clear(root.childNodes,cellCache[cacheKey]),cellCache[cacheKey]=undefined}function propify(promise,initialValue){var prop=m.prop(initialValue);return promise.then(prop),prop.then=function(resolve,reject){return propify(promise.then(resolve,reject),initialValue)},prop.catch=prop.then.bind(null,null),prop.finally=function(callback){var _callback=function(){return m.deferred().resolve(callback()).promise};return prop.then(function(value){return propify(_callback().then(function(){return value}),initialValue)},function(reason){return propify(_callback().then(function(){throw new Error(reason)}),initialValue)})},prop}function Deferred(successCallback,failureCallback){function finish(type){state=type||REJECTED,next.map(function(deferred){state===RESOLVED?deferred.resolve(promiseValue):deferred.reject(promiseValue)})}function thennable(then,successCallback,failureCallback,notThennableCallback){if((null!=promiseValue&&isObject(promiseValue)||isFunction(promiseValue))&&isFunction(then))try{var count=0;then.call(promiseValue,function(value){count++||(promiseValue=value,successCallback())},function(value){count++||(promiseValue=value,failureCallback())})}catch(e){m.deferred.onerror(e),promiseValue=e,failureCallback()}else notThennableCallback()}function fire(){var then;try{then=promiseValue&&promiseValue.then}catch(e){return m.deferred.onerror(e),promiseValue=e,state=REJECTING,fire()}thennable(then,function(){state=RESOLVING,fire()},function(){state=REJECTING,fire()},function(){try{state===RESOLVING&&isFunction(successCallback)?promiseValue=successCallback(promiseValue):state===REJECTING&&isFunction(failureCallback)&&(promiseValue=failureCallback(promiseValue),state=RESOLVING)}catch(e){return m.deferred.onerror(e),promiseValue=e,finish()}promiseValue===self?(promiseValue=TypeError(),finish()):thennable(then,function(){finish(RESOLVED)},finish,function(){finish(state===RESOLVING&&RESOLVED)})})}var RESOLVING=1,REJECTING=2,RESOLVED=3,REJECTED=4,self=this,state=0,promiseValue=0,next=[];self.promise={},self.resolve=function(value){return state||(promiseValue=value,state=RESOLVING,fire()),this},self.reject=function(value){return state||(promiseValue=value,state=REJECTING,fire()),this},self.promise.then=function(successCallback,failureCallback){var deferred=new Deferred(successCallback,failureCallback);return state===RESOLVED?deferred.resolve(promiseValue):state===REJECTED?deferred.reject(promiseValue):next.push(deferred),deferred.promise}}function identity(value){return value}function ajax(options){if(!options.dataType||"jsonp"!==options.dataType.toLowerCase()){var xhr=new window.XMLHttpRequest;if(xhr.open(options.method,options.url,!0,options.user,options.password),xhr.onreadystatechange=function(){4===xhr.readyState&&(xhr.status>=200&&xhr.status<300?options.onload({type:"load",target:xhr}):options.onerror({type:"error",target:xhr}))},options.serialize===JSON.stringify&&options.data&&"GET"!==options.method&&xhr.setRequestHeader("Content-Type","application/json; charset=utf-8"),options.deserialize===JSON.parse&&xhr.setRequestHeader("Accept","application/json, text/*"),isFunction(options.config)){var maybeXhr=options.config(xhr,options);null!=maybeXhr&&(xhr=maybeXhr)}var data="GET"!==options.method&&options.data?options.data:"";if(data&&!isString(data)&&data.constructor!==window.FormData)throw new Error("Request data should be either be a string or FormData. Check the `serialize` option in `m.request`");return xhr.send(data),xhr}var callbackKey="mithril_callback_"+(new Date).getTime()+"_"+Math.round(1e16*Math.random()).toString(36),script=$document.createElement("script");window[callbackKey]=function(resp){script.parentNode.removeChild(script),options.onload({type:"load",target:{responseText:resp}}),window[callbackKey]=undefined},script.onerror=function(){return script.parentNode.removeChild(script),options.onerror({type:"error",target:{status:500,responseText:JSON.stringify({error:"Error making jsonp request"})}}),window[callbackKey]=undefined,!1},script.onload=function(){return!1},script.src=options.url+(options.url.indexOf("?")>0?"&":"?")+(options.callbackKey?options.callbackKey:"callback")+"="+callbackKey+"&"+buildQueryString(options.data||{}),$document.body.appendChild(script)}function bindData(xhrOptions,data,serialize){if("GET"===xhrOptions.method&&"jsonp"!==xhrOptions.dataType){var prefix=xhrOptions.url.indexOf("?")<0?"?":"&",querystring=buildQueryString(data);xhrOptions.url=xhrOptions.url+(querystring?prefix+querystring:"")}else xhrOptions.data=serialize(data);return xhrOptions}function parameterizeUrl(url,data){var tokens=url.match(/:[a-z]\w+/gi);return tokens&&data&&forEach(tokens,function(token){var key=token.slice(1);url=url.replace(token,data[key]),delete data[key]}),url}var $document,$location,$requestAnimationFrame,$cancelAnimationFrame,isArray=Array.isArray||function(object){return"[object Array]"===type.call(object)},type={}.toString,parser=/(?:(^|#|\.)([^#\.\[\]]+))|(\[.+?\])/g,attrParser=/\[(.+?)(?:=("|'|)(.*?)\2)?\]/,voidElements=/^(AREA|BASE|BR|COL|COMMAND|EMBED|HR|IMG|INPUT|KEYGEN|LINK|META|PARAM|SOURCE|TRACK|WBR)$/,noop=function(){};initialize(window),m.version=function(){return"v0.2.1"};var html,DELETION=1,INSERTION=2,MOVE=3,insertAdjacentBeforeEnd=function(){try{return $document.createRange().createContextualFragment("x"),function(parentElement,data){parentElement.appendChild($document.createRange().createContextualFragment(data))}}catch(e){return function(parentElement,data){parentElement.insertAdjacentHTML("beforeend",data)}}}(),documentNode={appendChild:function(node){html===undefined&&(html=$document.createElement("html")),$document.documentElement&&$document.documentElement!==node?$document.replaceChild(node,$document.documentElement):$document.appendChild(node),this.childNodes=$document.childNodes},insertBefore:function(node){this.appendChild(node)},childNodes:[]},nodeCache=[],cellCache={};m.render=function(root,cell,forceRecreation){var configs=[];if(!root)throw new Error("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.");var id=getCellCacheKey(root),isDocumentRoot=root===$document,node=isDocumentRoot||root===$document.documentElement?documentNode:root;isDocumentRoot&&"html"!==cell.tag&&(cell={tag:"html",attrs:{},children:cell}),cellCache[id]===undefined&&clear(node.childNodes),!0===forceRecreation&&reset(root),cellCache[id]=build(node,null,undefined,undefined,cell,cellCache[id],!1,0,null,undefined,configs),forEach(configs,function(config){config()})},m.trust=function(value){return value=new String(value),value.$trusted=!0,value},m.prop=function(store){return(null!=store&&isObject(store)||isFunction(store))&&isFunction(store.then)?propify(store):gettersetter(store)};var topComponent,roots=[],components=[],controllers=[],lastRedrawId=null,lastRedrawCallTime=0,computePreRedrawHook=null,computePostRedrawHook=null,unloaders=[];m.component=function(component){for(var args=[],i=1;i<arguments.length;i++)args.push(arguments[i]);return parameterize(component,args)},m.mount=m.module=function(root,component){if(!root)throw new Error("Please ensure the DOM element exists before rendering a template into it.");var index=roots.indexOf(root);index<0&&(index=roots.length);var isPrevented=!1,event={preventDefault:function(){isPrevented=!0,computePreRedrawHook=computePostRedrawHook=null}};forEach(unloaders,function(unloader){unloader.handler.call(unloader.controller,event),unloader.controller.onunload=null}),isPrevented?forEach(unloaders,function(unloader){unloader.controller.onunload=unloader.handler}):unloaders=[],controllers[index]&&isFunction(controllers[index].onunload)&&controllers[index].onunload(event);var isNullComponent=null===component;if(!isPrevented){m.redraw.strategy("all"),m.startComputation(),roots[index]=root;var currentComponent=topComponent=component||(component={controller:noop}),controller=new(component.controller||noop);return currentComponent===topComponent&&(controllers[index]=controller,components[index]=component),endFirstComputation(),isNullComponent&&removeRootElement(root,index),controllers[index]}isNullComponent&&removeRootElement(root,index)};var redrawing=!1,forcing=!1;m.redraw=function(force){if(!redrawing){redrawing=!0,force&&(forcing=!0);try{lastRedrawId&&!force?($requestAnimationFrame===window.requestAnimationFrame||new Date-lastRedrawCallTime>16)&&(lastRedrawId>0&&$cancelAnimationFrame(lastRedrawId),lastRedrawId=$requestAnimationFrame(redraw,16)):(redraw(),lastRedrawId=$requestAnimationFrame(function(){lastRedrawId=null},16))}finally{redrawing=forcing=!1}}},m.redraw.strategy=m.prop();var pendingRequests=0;m.startComputation=function(){pendingRequests++},m.endComputation=function(){pendingRequests>1?pendingRequests--:(pendingRequests=0,m.redraw())},m.withAttr=function(prop,withAttrCallback,callbackThis){return function(e){var currentTarget=(e=e||event).currentTarget||this,_this=callbackThis||this;withAttrCallback.call(_this,prop in currentTarget?currentTarget[prop]:currentTarget.getAttribute(prop))}};var routeParams,currentRoute,modes={pathname:"",hash:"#",search:"?"},redirect=noop,isDefaultRoute=!1;return m.route=function(root,arg1,arg2,vdom){if(0===arguments.length)return currentRoute;if(3===arguments.length&&isString(arg1)){redirect=function(source){var path=currentRoute=normalizeRoute(source);if(!routeByValue(root,arg2,path)){if(isDefaultRoute)throw new Error("Ensure the default route matches one of the routes defined in m.route");isDefaultRoute=!0,m.route(arg1,!0),isDefaultRoute=!1}};var listener="hash"===m.route.mode?"onhashchange":"onpopstate";window[listener]=function(){var path=$location[m.route.mode];"pathname"===m.route.mode&&(path+=$location.search),currentRoute!==normalizeRoute(path)&&redirect(path)},computePreRedrawHook=setScroll,window[listener]()}else if(root.addEventListener||root.attachEvent)root.href=("pathname"!==m.route.mode?$location.pathname:"")+modes[m.route.mode]+vdom.attrs.href,root.addEventListener?(root.removeEventListener("click",routeUnobtrusive),root.addEventListener("click",routeUnobtrusive)):(root.detachEvent("onclick",routeUnobtrusive),root.attachEvent("onclick",routeUnobtrusive));else if(isString(root)){var oldRoute=currentRoute;currentRoute=root;var args=arg1||{},queryIndex=currentRoute.indexOf("?"),params=queryIndex>-1?parseQueryString(currentRoute.slice(queryIndex+1)):{};for(var i in args)params[i]=args[i];var querystring=buildQueryString(params),currentPath=queryIndex>-1?currentRoute.slice(0,queryIndex):currentRoute;querystring&&(currentRoute=currentPath+(-1===currentPath.indexOf("?")?"?":"&")+querystring);var shouldReplaceHistoryEntry=!0===(3===arguments.length?arg2:arg1)||oldRoute===root;window.history.pushState?(computePreRedrawHook=setScroll,computePostRedrawHook=function(){window.history[shouldReplaceHistoryEntry?"replaceState":"pushState"](null,$document.title,modes[m.route.mode]+currentRoute)},redirect(modes[m.route.mode]+currentRoute)):($location[m.route.mode]=currentRoute,redirect(modes[m.route.mode]+currentRoute))}},m.route.param=function(key){if(!routeParams)throw new Error("You must call m.route(element, defaultRoute, routes) before calling m.route.param()");return key?routeParams[key]:routeParams},m.route.mode="search",m.route.buildQueryString=buildQueryString,m.route.parseQueryString=parseQueryString,m.deferred=function(){var deferred=new Deferred;return deferred.promise=propify(deferred.promise),deferred},m.deferred.onerror=function(e){if("[object Error]"===type.call(e)&&!e.constructor.toString().match(/ Error/))throw pendingRequests=0,e},m.sync=function(args){function synchronizer(pos,resolved){return function(value){return results[pos]=value,resolved||(method="reject"),0==--outstanding&&(deferred.promise(results),deferred[method](results)),value}}var method="resolve",deferred=m.deferred(),outstanding=args.length,results=new Array(outstanding);return args.length>0?forEach(args,function(arg,i){arg.then(synchronizer(i,!0),synchronizer(i,!1))}):deferred.resolve([]),deferred.promise},m.request=function(xhrOptions){!0!==xhrOptions.background&&m.startComputation();var deferred=new Deferred,isJSONP=xhrOptions.dataType&&"jsonp"===xhrOptions.dataType.toLowerCase(),serialize=xhrOptions.serialize=isJSONP?identity:xhrOptions.serialize||JSON.stringify,deserialize=xhrOptions.deserialize=isJSONP?identity:xhrOptions.deserialize||JSON.parse,extract=isJSONP?function(jsonp){return jsonp.responseText}:xhrOptions.extract||function(xhr){return 0===xhr.responseText.length&&deserialize===JSON.parse?null:xhr.responseText};return xhrOptions.method=(xhrOptions.method||"GET").toUpperCase(),xhrOptions.url=parameterizeUrl(xhrOptions.url,xhrOptions.data),xhrOptions=bindData(xhrOptions,xhrOptions.data,serialize),xhrOptions.onload=xhrOptions.onerror=function(e){try{var response=(("load"===(e=e||event).type?xhrOptions.unwrapSuccess:xhrOptions.unwrapError)||identity)(deserialize(extract(e.target,xhrOptions)),e.target);"load"===e.type&&(isArray(response)&&xhrOptions.type?forEach(response,function(res,i){response[i]=new xhrOptions.type(res)}):xhrOptions.type&&(response=new xhrOptions.type(response))),deferred["load"===e.type?"resolve":"reject"](response)}catch(e){m.deferred.onerror(e),deferred.reject(e)}!0!==xhrOptions.background&&m.endComputation()},ajax(xhrOptions),deferred.promise=propify(deferred.promise,xhrOptions.initialValue),deferred.promise},m.deps=function(mock){return initialize(window=mock||window),window},m.deps.factory=app,m}("undefined"!=typeof window?window:{});"object"==typeof module&&null!=module&&module.exports?module.exports=m:"function"==typeof define&&define.amd&&define(function(){return m});
(function(a){a.ui=a.ui||{};if(!a.ui.version){a.extend(a.ui,{version:"1.8.2",plugin:{add:function(f,c,h){f=a.ui[f].prototype;for(var g in h){f.plugins[g]=f.plugins[g]||[];f.plugins[g].push([c,h[g]])}},call:function(f,c,h){if((c=f.plugins[c])&&f.element[0].parentNode){for(var g=0;g<c.length;g++){f.options[c[g][0]]&&c[g][1].apply(f.element,h)}}}},contains:function(d,c){return document.compareDocumentPosition?d.compareDocumentPosition(c)&16:d!==c&&d.contains(c)},hasScroll:function(e,c){if(a(e).css("overflow")=="hidden"){return false}c=c&&c=="left"?"scrollLeft":"scrollTop";var f=false;if(e[c]>0){return true}e[c]=1;f=e[c]>0;e[c]=0;return f},isOverAxis:function(e,c,f){return e>c&&e<c+f},isOver:function(h,c,l,k,j,i){return a.ui.isOverAxis(h,l,j)&&a.ui.isOverAxis(c,k,i)},keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}});a.fn.extend({_focus:a.fn.focus,focus:function(d,c){return typeof d==="number"?this.each(function(){var b=this;setTimeout(function(){a(b).focus();c&&c.call(b)},d)}):this._focus.apply(this,arguments)},enableSelection:function(){return this.attr("unselectable","off").css("MozUserSelect","")},disableSelection:function(){return this.attr("unselectable","on").css("MozUserSelect","none")},scrollParent:function(){var b;b=a.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.curCSS(this,"position",1))&&/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0);return/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(d){if(d!==undefined){return this.css("zIndex",d)}if(this.length){d=a(this[0]);for(var c;d.length&&d[0]!==document;){c=d.css("position");if(c=="absolute"||c=="relative"||c=="fixed"){c=parseInt(d.css("zIndex"));if(!isNaN(c)&&c!=0){return c}}d=d.parent()}}return 0}});a.extend(a.expr[":"],{data:function(e,c,f){return !!a.data(e,f[3])},focusable:function(e){var c=e.nodeName.toLowerCase(),f=a.attr(e,"tabindex");return(/input|select|textarea|button|object/.test(c)?!e.disabled:"a"==c||"area"==c?e.href||!isNaN(f):!isNaN(f))&&!a(e)["area"==c?"parents":"closest"](":hidden").length},tabbable:function(d){var c=a.attr(d,"tabindex");return(isNaN(c)||c>=0)&&a(d).is(":focusable")}})}})(jQuery);(function(a){var c=a.fn.remove;a.fn.remove=function(b,d){return this.each(function(){if(!d){if(!b||a.filter(b,[this]).length){a("*",this).add(this).each(function(){a(this).triggerHandler("remove")})}}return c.call(a(this),b,d)})};a.widget=function(b,j,i){var h=b.split(".")[0],g;b=b.split(".")[1];g=h+"-"+b;if(!i){i=j;j=a.Widget}a.expr[":"][g]=function(d){return !!a.data(d,b)};a[h]=a[h]||{};a[h][b]=function(d,e){arguments.length&&this._createWidget(d,e)};j=new j;j.options=a.extend({},j.options);a[h][b].prototype=a.extend(true,j,{namespace:h,widgetName:b,widgetEventPrefix:a[h][b].prototype.widgetEventPrefix||b,widgetBaseClass:g},i);a.widget.bridge(b,a[h][b])};a.widget.bridge=function(b,d){a.fn[b]=function(k){var j=typeof k==="string",i=Array.prototype.slice.call(arguments,1),g=this;k=!j&&i.length?a.extend.apply(null,[true,k].concat(i)):k;if(j&&k.substring(0,1)==="_"){return g}j?this.each(function(){var f=a.data(this,b),e=f&&a.isFunction(f[k])?f[k].apply(f,i):f;if(e!==f&&e!==undefined){g=e;return false}}):this.each(function(){var e=a.data(this,b);if(e){k&&e.option(k);e._init()}else{a.data(this,b,new d(k,this))}});return g}};a.Widget=function(b,d){arguments.length&&this._createWidget(b,d)};a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:false},_createWidget:function(b,f){this.element=a(f).data(this.widgetName,this);this.options=a.extend(true,{},this.options,a.metadata&&a.metadata.get(f)[this.widgetName],b);var e=this;this.element.bind("remove."+this.widgetName,function(){e.destroy()});this._create();this._init()},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled")},widget:function(){return this.element},option:function(b,h){var g=b,f=this;if(arguments.length===0){return a.extend({},f.options)}if(typeof b==="string"){if(h===undefined){return this.options[b]}g={};g[b]=h}a.each(g,function(e,d){f._setOption(e,d)});return f},_setOption:function(b,d){this.options[b]=d;if(b==="disabled"){this.widget()[d?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",d)}return this},enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_trigger:function(b,j,i){var h=this.options[b];j=a.Event(j);j.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase();i=i||{};if(j.originalEvent){b=a.event.props.length;for(var g;b;){g=a.event.props[--b];j[g]=j.originalEvent[g]}}this.element.trigger(j,i);return !(a.isFunction(h)&&h.call(this.element[0],j,i)===false||j.isDefaultPrevented())}}})(jQuery);(function(a){a.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(c){return b._mouseDown(c)}).bind("click."+this.widgetName,function(c){if(b._preventClickEvent){b._preventClickEvent=false;c.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+this.widgetName)},_mouseDown:function(d){d.originalEvent=d.originalEvent||{};if(!d.originalEvent.mouseHandled){this._mouseStarted&&this._mouseUp(d);this._mouseDownEvent=d;var c=this,h=d.which==1,g=typeof this.options.cancel=="string"?a(d.target).parents().add(d.target).filter(this.options.cancel).length:false;if(!h||g||!this._mouseCapture(d)){return true}this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){c.mouseDelayMet=true},this.options.delay)}if(this._mouseDistanceMet(d)&&this._mouseDelayMet(d)){this._mouseStarted=this._mouseStart(d)!==false;if(!this._mouseStarted){d.preventDefault();return true}}this._mouseMoveDelegate=function(b){return c._mouseMove(b)};this._mouseUpDelegate=function(b){return c._mouseUp(b)};a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);a.browser.safari||d.preventDefault();return d.originalEvent.mouseHandled=true}},_mouseMove:function(b){if(a.browser.msie&&!b.button){return this._mouseUp(b)}if(this._mouseStarted){this._mouseDrag(b);return b.preventDefault()}if(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)){(this._mouseStarted=this._mouseStart(this._mouseDownEvent,b)!==false)?this._mouseDrag(b):this._mouseUp(b)}return !this._mouseStarted},_mouseUp:function(b){a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;this._preventClickEvent=b.target==this._mouseDownEvent.target;this._mouseStop(b)}return false},_mouseDistanceMet:function(b){return Math.max(Math.abs(this._mouseDownEvent.pageX-b.pageX),Math.abs(this._mouseDownEvent.pageY-b.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return true}})})(jQuery);(function(a){a.widget("ui.draggable",a.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false},_create:function(){if(this.options.helper=="original"&&!/^(?:r|a|f)/.test(this.element.css("position"))){this.element[0].style.position="relative"}this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},destroy:function(){if(this.element.data("draggable")){this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy();return this}},_mouseCapture:function(d){var c=this.options;if(this.helper||c.disabled||a(d.target).is(".ui-resizable-handle")){return false}this.handle=this._getHandle(d);if(!this.handle){return false}return true},_mouseStart:function(d){var c=this.options;this.helper=this._createHelper(d);this._cacheHelperProportions();if(a.ui.ddmanager){a.ui.ddmanager.current=this}this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};a.extend(this.offset,{click:{left:d.pageX-this.offset.left,top:d.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(d);this.originalPageX=d.pageX;this.originalPageY=d.pageY;c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt);c.containment&&this._setContainment();if(this._trigger("start",d)===false){this._clear();return false}this._cacheHelperProportions();a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,d);this.helper.addClass("ui-draggable-dragging");this._mouseDrag(d,true);return true},_mouseDrag:function(d,c){this.position=this._generatePosition(d);this.positionAbs=this._convertPositionTo("absolute");if(!c){c=this._uiHash();if(this._trigger("drag",d,c)===false){this._mouseUp({});return false}this.position=c.position}if(!this.options.axis||this.options.axis!="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!="x"){this.helper[0].style.top=this.position.top+"px"}a.ui.ddmanager&&a.ui.ddmanager.drag(this,d);return false},_mouseStop:function(e){var d=false;if(a.ui.ddmanager&&!this.options.dropBehaviour){d=a.ui.ddmanager.drop(this,e)}if(this.dropped){d=this.dropped;this.dropped=false}if(!this.element[0]||!this.element[0].parentNode){return false}if(this.options.revert=="invalid"&&!d||this.options.revert=="valid"&&d||this.options.revert===true||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,d)){var f=this;a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){f._trigger("stop",e)!==false&&f._clear()})}else{this._trigger("stop",e)!==false&&this._clear()}return false},cancel:function(){this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear();return this},_getHandle:function(d){var c=!this.options.handle||!a(this.options.handle,this.element).length?true:false;a(this.options.handle,this.element).find("*").andSelf().each(function(){if(this==d.target){c=true}});return c},_createHelper:function(d){var c=this.options;d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[d])):c.helper=="clone"?this.element.clone():this.element;d.parents("body").length||d.appendTo(c.appendTo=="parent"?this.element[0].parentNode:c.appendTo);d[0]!=this.element[0]&&!/(fixed|absolute)/.test(d.css("position"))&&d.css("position","absolute");return d},_adjustOffsetFromHelper:function(b){if(typeof b=="string"){b=b.split(" ")}if(a.isArray(b)){b={left:+b[0],top:+b[1]||0}}if("left" in b){this.offset.click.left=b.left+this.margins.left}if("right" in b){this.offset.click.left=this.helperProportions.width-b.right+this.margins.left}if("top" in b){this.offset.click.top=b.top+this.margins.top}if("bottom" in b){this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();if(this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0])){b.left+=this.scrollParent.scrollLeft();b.top+=this.scrollParent.scrollTop()}if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&a.browser.msie){b={top:0,left:0}}return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var b=this.element.position();return{top:b.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:b.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else{return{top:0,left:0}}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e=this.options;if(e.containment=="parent"){e.containment=this.helper[0].parentNode}if(e.containment=="document"||e.containment=="window"){this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,a(e.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(a(e.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]}if(!/^(document|window|parent)$/.test(e.containment)&&e.containment.constructor!=Array){var d=a(e.containment)[0];if(d){e=a(e.containment).offset();var f=a(d).css("overflow")!="hidden";this.containment=[e.left+(parseInt(a(d).css("borderLeftWidth"),10)||0)+(parseInt(a(d).css("paddingLeft"),10)||0)-this.margins.left,e.top+(parseInt(a(d).css("borderTopWidth"),10)||0)+(parseInt(a(d).css("paddingTop"),10)||0)-this.margins.top,e.left+(f?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(a(d).css("borderLeftWidth"),10)||0)-(parseInt(a(d).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,e.top+(f?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(a(d).css("borderTopWidth"),10)||0)-(parseInt(a(d).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}}else{if(e.containment.constructor==Array){this.containment=e.containment}}},_convertPositionTo:function(e,d){if(!d){d=this.position}e=e=="absolute"?1:-1;var h=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,g=/(html|body)/i.test(h[0].tagName);return{top:d.top+this.offset.relative.top*e+this.offset.parent.top*e-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():g?0:h.scrollTop())*e),left:d.left+this.offset.relative.left*e+this.offset.parent.left*e-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():g?0:h.scrollLeft())*e)}},_generatePosition:function(h){var d=this.options,l=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,j=/(html|body)/i.test(l[0].tagName),k=h.pageX,i=h.pageY;if(this.originalPosition){if(this.containment){if(h.pageX-this.offset.click.left<this.containment[0]){k=this.containment[0]+this.offset.click.left}if(h.pageY-this.offset.click.top<this.containment[1]){i=this.containment[1]+this.offset.click.top}if(h.pageX-this.offset.click.left>this.containment[2]){k=this.containment[2]+this.offset.click.left}if(h.pageY-this.offset.click.top>this.containment[3]){i=this.containment[3]+this.offset.click.top}}if(d.grid){i=this.originalPageY+Math.round((i-this.originalPageY)/d.grid[1])*d.grid[1];i=this.containment?!(i-this.offset.click.top<this.containment[1]||i-this.offset.click.top>this.containment[3])?i:!(i-this.offset.click.top<this.containment[1])?i-d.grid[1]:i+d.grid[1]:i;k=this.originalPageX+Math.round((k-this.originalPageX)/d.grid[0])*d.grid[0];k=this.containment?!(k-this.offset.click.left<this.containment[0]||k-this.offset.click.left>this.containment[2])?k:!(k-this.offset.click.left<this.containment[0])?k-d.grid[0]:k+d.grid[0]:k}}return{top:i-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():j?0:l.scrollTop()),left:k-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():j?0:l.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove();this.helper=null;this.cancelHelperRemoval=false},_trigger:function(e,d,f){f=f||this._uiHash();a.ui.plugin.call(this,e,[d,f]);if(e=="drag"){this.positionAbs=this._convertPositionTo("absolute")}return a.Widget.prototype._trigger.call(this,e,d,f)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});a.extend(a.ui.draggable,{version:"1.8.2"});a.ui.plugin.add("draggable","connectToSortable",{start:function(g,d){var j=a(this).data("draggable"),h=j.options,i=a.extend({},d,{item:j.element});j.sortables=[];a(h.connectToSortable).each(function(){var b=a.data(this,"sortable");if(b&&!b.options.disabled){j.sortables.push({instance:b,shouldRevert:b.options.revert});b._refreshItems();b._trigger("activate",g,i)}})},stop:function(e,d){var h=a(this).data("draggable"),g=a.extend({},d,{item:h.element});a.each(h.sortables,function(){if(this.instance.isOver){this.instance.isOver=0;h.cancelHelperRemoval=true;this.instance.cancelHelperRemoval=false;if(this.shouldRevert){this.instance.options.revert=true}this.instance._mouseStop(e);this.instance.options.helper=this.instance.options._helper;h.options.helper=="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})}else{this.instance.cancelHelperRemoval=false;this.instance._trigger("deactivate",e,g)}})},drag:function(e,d){var h=a(this).data("draggable"),g=this;a.each(h.sortables,function(){this.instance.positionAbs=h.positionAbs;this.instance.helperProportions=h.helperProportions;this.instance.offset.click=h.offset.click;if(this.instance._intersectsWith(this.instance.containerCache)){if(!this.instance.isOver){this.instance.isOver=1;this.instance.currentItem=a(g).clone().appendTo(this.instance.element).data("sortable-item",true);this.instance.options._helper=this.instance.options.helper;this.instance.options.helper=function(){return d.helper[0]};e.target=this.instance.currentItem[0];this.instance._mouseCapture(e,true);this.instance._mouseStart(e,true,true);this.instance.offset.click.top=h.offset.click.top;this.instance.offset.click.left=h.offset.click.left;this.instance.offset.parent.left-=h.offset.parent.left-this.instance.offset.parent.left;this.instance.offset.parent.top-=h.offset.parent.top-this.instance.offset.parent.top;h._trigger("toSortable",e);h.dropped=this.instance.element;h.currentItem=h.element;this.instance.fromOutside=h}this.instance.currentItem&&this.instance._mouseDrag(e)}else{if(this.instance.isOver){this.instance.isOver=0;this.instance.cancelHelperRemoval=true;this.instance.options.revert=false;this.instance._trigger("out",e,this.instance._uiHash(this.instance));this.instance._mouseStop(e,true);this.instance.options.helper=this.instance.options._helper;this.instance.currentItem.remove();this.instance.placeholder&&this.instance.placeholder.remove();h._trigger("fromSortable",e);h.dropped=false}}})}});a.ui.plugin.add("draggable","cursor",{start:function(){var d=a("body"),c=a(this).data("draggable").options;if(d.css("cursor")){c._cursor=d.css("cursor")}d.css("cursor",c.cursor)},stop:function(){var b=a(this).data("draggable").options;b._cursor&&a("body").css("cursor",b._cursor)}});a.ui.plugin.add("draggable","iframeFix",{start:function(){var b=a(this).data("draggable").options;a(b.iframeFix===true?"iframe":b.iframeFix).each(function(){a('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1000}).css(a(this).offset()).appendTo("body")})},stop:function(){a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)})}});a.ui.plugin.add("draggable","opacity",{start:function(d,c){d=a(c.helper);c=a(this).data("draggable").options;if(d.css("opacity")){c._opacity=d.css("opacity")}d.css("opacity",c.opacity)},stop:function(d,c){d=a(this).data("draggable").options;d._opacity&&a(c.helper).css("opacity",d._opacity)}});a.ui.plugin.add("draggable","scroll",{start:function(){var b=a(this).data("draggable");if(b.scrollParent[0]!=document&&b.scrollParent[0].tagName!="HTML"){b.overflowOffset=b.scrollParent.offset()}},drag:function(e){var d=a(this).data("draggable"),h=d.options,g=false;if(d.scrollParent[0]!=document&&d.scrollParent[0].tagName!="HTML"){if(!h.axis||h.axis!="x"){if(d.overflowOffset.top+d.scrollParent[0].offsetHeight-e.pageY<h.scrollSensitivity){d.scrollParent[0].scrollTop=g=d.scrollParent[0].scrollTop+h.scrollSpeed}else{if(e.pageY-d.overflowOffset.top<h.scrollSensitivity){d.scrollParent[0].scrollTop=g=d.scrollParent[0].scrollTop-h.scrollSpeed}}}if(!h.axis||h.axis!="y"){if(d.overflowOffset.left+d.scrollParent[0].offsetWidth-e.pageX<h.scrollSensitivity){d.scrollParent[0].scrollLeft=g=d.scrollParent[0].scrollLeft+h.scrollSpeed}else{if(e.pageX-d.overflowOffset.left<h.scrollSensitivity){d.scrollParent[0].scrollLeft=g=d.scrollParent[0].scrollLeft-h.scrollSpeed}}}}else{if(!h.axis||h.axis!="x"){if(e.pageY-a(document).scrollTop()<h.scrollSensitivity){g=a(document).scrollTop(a(document).scrollTop()-h.scrollSpeed)}else{if(a(window).height()-(e.pageY-a(document).scrollTop())<h.scrollSensitivity){g=a(document).scrollTop(a(document).scrollTop()+h.scrollSpeed)}}}if(!h.axis||h.axis!="y"){if(e.pageX-a(document).scrollLeft()<h.scrollSensitivity){g=a(document).scrollLeft(a(document).scrollLeft()-h.scrollSpeed)}else{if(a(window).width()-(e.pageX-a(document).scrollLeft())<h.scrollSensitivity){g=a(document).scrollLeft(a(document).scrollLeft()+h.scrollSpeed)}}}}g!==false&&a.ui.ddmanager&&!h.dropBehaviour&&a.ui.ddmanager.prepareOffsets(d,e)}});a.ui.plugin.add("draggable","snap",{start:function(){var d=a(this).data("draggable"),c=d.options;d.snapElements=[];a(c.snap.constructor!=String?c.snap.items||":data(draggable)":c.snap).each(function(){var e=a(this),b=e.offset();this!=d.element[0]&&d.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:b.top,left:b.left})})},drag:function(L,K){for(var J=a(this).data("draggable"),H=J.options,I=H.snapTolerance,G=K.offset.left,z=G+J.helperProportions.width,A=K.offset.top,y=A+J.helperProportions.height,F=J.snapElements.length-1;F>=0;F--){var E=J.snapElements[F].left,C=E+J.snapElements[F].width,D=J.snapElements[F].top,B=D+J.snapElements[F].height;if(E-I<G&&G<C+I&&D-I<A&&A<B+I||E-I<G&&G<C+I&&D-I<y&&y<B+I||E-I<z&&z<C+I&&D-I<A&&A<B+I||E-I<z&&z<C+I&&D-I<y&&y<B+I){if(H.snapMode!="inner"){var x=Math.abs(D-y)<=I,w=Math.abs(B-A)<=I,v=Math.abs(E-z)<=I,u=Math.abs(C-G)<=I;if(x){K.position.top=J._convertPositionTo("relative",{top:D-J.helperProportions.height,left:0}).top-J.margins.top}if(w){K.position.top=J._convertPositionTo("relative",{top:B,left:0}).top-J.margins.top}if(v){K.position.left=J._convertPositionTo("relative",{top:0,left:E-J.helperProportions.width}).left-J.margins.left}if(u){K.position.left=J._convertPositionTo("relative",{top:0,left:C}).left-J.margins.left}}var d=x||w||v||u;if(H.snapMode!="outer"){x=Math.abs(D-A)<=I;w=Math.abs(B-y)<=I;v=Math.abs(E-G)<=I;u=Math.abs(C-z)<=I;if(x){K.position.top=J._convertPositionTo("relative",{top:D,left:0}).top-J.margins.top}if(w){K.position.top=J._convertPositionTo("relative",{top:B-J.helperProportions.height,left:0}).top-J.margins.top}if(v){K.position.left=J._convertPositionTo("relative",{top:0,left:E}).left-J.margins.left}if(u){K.position.left=J._convertPositionTo("relative",{top:0,left:C-J.helperProportions.width}).left-J.margins.left}}if(!J.snapElements[F].snapping&&(x||w||v||u||d)){J.options.snap.snap&&J.options.snap.snap.call(J.element,L,a.extend(J._uiHash(),{snapItem:J.snapElements[F].item}))}J.snapElements[F].snapping=x||w||v||u||d}else{J.snapElements[F].snapping&&J.options.snap.release&&J.options.snap.release.call(J.element,L,a.extend(J._uiHash(),{snapItem:J.snapElements[F].item}));J.snapElements[F].snapping=false}}}});a.ui.plugin.add("draggable","stack",{start:function(){var d=a(this).data("draggable").options;d=a.makeArray(a(d.stack)).sort(function(e,b){return(parseInt(a(e).css("zIndex"),10)||0)-(parseInt(a(b).css("zIndex"),10)||0)});if(d.length){var c=parseInt(d[0].style.zIndex)||0;a(d).each(function(b){this.style.zIndex=c+b});this[0].style.zIndex=c+d.length}}});a.ui.plugin.add("draggable","zIndex",{start:function(d,c){d=a(c.helper);c=a(this).data("draggable").options;if(d.css("zIndex")){c._zIndex=d.css("zIndex")}d.css("zIndex",c.zIndex)},stop:function(d,c){d=a(this).data("draggable").options;d._zIndex&&a(c.helper).css("zIndex",d._zIndex)}})})(jQuery);(function(a){a.widget("ui.droppable",{widgetEventPrefix:"drop",options:{accept:"*",activeClass:false,addClasses:true,greedy:false,hoverClass:false,scope:"default",tolerance:"intersect"},_create:function(){var d=this.options,c=d.accept;this.isover=0;this.isout=1;this.accept=a.isFunction(c)?c:function(b){return b.is(c)};this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};a.ui.ddmanager.droppables[d.scope]=a.ui.ddmanager.droppables[d.scope]||[];a.ui.ddmanager.droppables[d.scope].push(this);d.addClasses&&this.element.addClass("ui-droppable")},destroy:function(){for(var d=a.ui.ddmanager.droppables[this.options.scope],c=0;c<d.length;c++){d[c]==this&&d.splice(c,1)}this.element.removeClass("ui-droppable ui-droppable-disabled").removeData("droppable").unbind(".droppable");return this},_setOption:function(d,c){if(d=="accept"){this.accept=a.isFunction(c)?c:function(b){return b.is(c)}}a.Widget.prototype._setOption.apply(this,arguments)},_activate:function(d){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass);c&&this._trigger("activate",d,this.ui(c))},_deactivate:function(d){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass);c&&this._trigger("deactivate",d,this.ui(c))},_over:function(d){var c=a.ui.ddmanager.current;if(!(!c||(c.currentItem||c.element)[0]==this.element[0])){if(this.accept.call(this.element[0],c.currentItem||c.element)){this.options.hoverClass&&this.element.addClass(this.options.hoverClass);this._trigger("over",d,this.ui(c))}}},_out:function(d){var c=a.ui.ddmanager.current;if(!(!c||(c.currentItem||c.element)[0]==this.element[0])){if(this.accept.call(this.element[0],c.currentItem||c.element)){this.options.hoverClass&&this.element.removeClass(this.options.hoverClass);this._trigger("out",d,this.ui(c))}}},_drop:function(f,d){var h=d||a.ui.ddmanager.current;if(!h||(h.currentItem||h.element)[0]==this.element[0]){return false}var g=false;this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var b=a.data(this,"droppable");if(b.options.greedy&&!b.options.disabled&&b.options.scope==h.options.scope&&b.accept.call(b.element[0],h.currentItem||h.element)&&a.ui.intersect(h,a.extend(b,{offset:b.element.offset()}),b.options.tolerance)){g=true;return false}});if(g){return false}if(this.accept.call(this.element[0],h.currentItem||h.element)){this.options.activeClass&&this.element.removeClass(this.options.activeClass);this.options.hoverClass&&this.element.removeClass(this.options.hoverClass);this._trigger("drop",f,this.ui(h));return this.element}return false},ui:function(b){return{draggable:b.currentItem||b.element,helper:b.helper,position:b.position,offset:b.positionAbs}}});a.extend(a.ui.droppable,{version:"1.8.2"});a.ui.intersect=function(w,v,u){if(!v.offset){return false}var s=(w.positionAbs||w.position.absolute).left,q=s+w.helperProportions.width,r=(w.positionAbs||w.position.absolute).top,p=r+w.helperProportions.height,o=v.offset.left,m=o+v.proportions.width,n=v.offset.top,d=n+v.proportions.height;switch(u){case"fit":return o<s&&q<m&&n<r&&p<d;case"intersect":return o<s+w.helperProportions.width/2&&q-w.helperProportions.width/2<m&&n<r+w.helperProportions.height/2&&p-w.helperProportions.height/2<d;case"pointer":return a.ui.isOver((w.positionAbs||w.position.absolute).top+(w.clickOffset||w.offset.click).top,(w.positionAbs||w.position.absolute).left+(w.clickOffset||w.offset.click).left,n,o,v.proportions.height,v.proportions.width);case"touch":return(r>=n&&r<=d||p>=n&&p<=d||r<n&&p>d)&&(s>=o&&s<=m||q>=o&&q<=m||s<o&&q>m);default:return false}};a.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(i,d){var n=a.ui.ddmanager.droppables[i.options.scope]||[],m=d?d.type:null,k=(i.currentItem||i.element).find(":data(droppable)").andSelf(),l=0;i:for(;l<n.length;l++){if(!(n[l].options.disabled||i&&!n[l].accept.call(n[l].element[0],i.currentItem||i.element))){for(var j=0;j<k.length;j++){if(k[j]==n[l].element[0]){n[l].proportions.height=0;continue i}}n[l].visible=n[l].element.css("display")!="none";if(n[l].visible){n[l].offset=n[l].element.offset();n[l].proportions={width:n[l].element[0].offsetWidth,height:n[l].element[0].offsetHeight};m=="mousedown"&&n[l]._activate.call(n[l],d)}}}},drop:function(e,d){var f=false;a.each(a.ui.ddmanager.droppables[e.options.scope]||[],function(){if(this.options){if(!this.options.disabled&&this.visible&&a.ui.intersect(e,this,this.options.tolerance)){f=f||this._drop.call(this,d)}if(!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)){this.isout=1;this.isover=0;this._deactivate.call(this,d)}}});return f},drag:function(d,c){d.options.refreshPositions&&a.ui.ddmanager.prepareOffsets(d,c);a.each(a.ui.ddmanager.droppables[d.options.scope]||[],function(){if(!(this.options.disabled||this.greedyChild||!this.visible)){var h=a.ui.intersect(d,this,this.options.tolerance);if(h=!h&&this.isover==1?"isout":h&&this.isover==0?"isover":null){var f;if(this.options.greedy){var b=this.element.parents(":data(droppable):eq(0)");if(b.length){f=a.data(b[0],"droppable");f.greedyChild=h=="isover"?1:0}}if(f&&h=="isover"){f.isover=0;f.isout=1;f._out.call(f,c)}this[h]=1;this[h=="isout"?"isover":"isout"]=0;this[h=="isover"?"_over":"_out"].call(this,c);if(f&&h=="isout"){f.isout=0;f.isover=1;f._over.call(f,c)}}}})}}})(jQuery);(function(c){c.widget("ui.resizable",c.ui.mouse,{widgetEventPrefix:"resize",options:{alsoResize:false,animate:false,animateDuration:"slow",animateEasing:"swing",aspectRatio:false,autoHide:false,containment:false,ghost:false,grid:false,handles:"e,s,se",helper:false,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1000},_create:function(){var d=this,h=this.options;this.element.addClass("ui-resizable");c.extend(this,{_aspectRatio:!!h.aspectRatio,aspectRatio:h.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:h.helper||h.ghost||h.animate?h.helper||"ui-resizable-helper":null});if(this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)){/relative/.test(this.element.css("position"))&&c.browser.opera&&this.element.css({position:"relative",top:"auto",left:"auto"});this.element.wrap(c('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")}));this.element=this.element.parent().data("resizable",this.element.data("resizable"));this.elementIsWrapper=true;this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")});this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0});this.originalResizeStyle=this.originalElement.css("resize");this.originalElement.css("resize","none");this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"}));this.originalElement.css({margin:this.originalElement.css("margin")});this._proportionallyResize()}this.handles=h.handles||(!c(".ui-resizable-handle",this.element).length?"e,s,se":{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"});if(this.handles.constructor==String){if(this.handles=="all"){this.handles="n,e,s,w,se,sw,ne,nw"}var l=this.handles.split(",");this.handles={};for(var k=0;k<l.length;k++){var i=c.trim(l[k]),j=c('<div class="ui-resizable-handle '+("ui-resizable-"+i)+'"></div>');/sw|se|ne|nw/.test(i)&&j.css({zIndex:++h.zIndex});"se"==i&&j.addClass("ui-icon ui-icon-gripsmall-diagonal-se");this.handles[i]=".ui-resizable-"+i;this.element.append(j)}}this._renderAxis=function(m){m=m||this.element;for(var g in this.handles){if(this.handles[g].constructor==String){this.handles[g]=c(this.handles[g],this.element).show()}if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var f=c(this.handles[g],this.element),e=0;e=/sw|ne|nw|se|n|s/.test(g)?f.outerHeight():f.outerWidth();f=["padding",/ne|nw|n/.test(g)?"Top":/se|sw|s/.test(g)?"Bottom":/^e$/.test(g)?"Right":"Left"].join("");m.css(f,e);this._proportionallyResize()}c(this.handles[g])}};this._renderAxis(this.element);this._handles=c(".ui-resizable-handle",this.element).disableSelection();this._handles.mouseover(function(){if(!d.resizing){if(this.className){var e=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)}d.axis=e&&e[1]?e[1]:"se"}});if(h.autoHide){this._handles.hide();c(this.element).addClass("ui-resizable-autohide").hover(function(){c(this).removeClass("ui-resizable-autohide");d._handles.show()},function(){if(!d.resizing){c(this).addClass("ui-resizable-autohide");d._handles.hide()}})}this._mouseInit()},destroy:function(){this._mouseDestroy();var d=function(f){c(f).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){d(this.element);var e=this.element;e.after(this.originalElement.css({position:e.css("position"),width:e.outerWidth(),height:e.outerHeight(),top:e.css("top"),left:e.css("left")})).remove()}this.originalElement.css("resize",this.originalResizeStyle);d(this.originalElement);return this},_mouseCapture:function(d){var e=false;for(var f in this.handles){if(c(this.handles[f])[0]==d.target){e=true}}return !this.options.disabled&&e},_mouseStart:function(d){var f=this.options,j=this.element.position(),i=this.element;this.resizing=true;this.documentScroll={top:c(document).scrollTop(),left:c(document).scrollLeft()};if(i.is(".ui-draggable")||/absolute/.test(i.css("position"))){i.css({position:"absolute",top:j.top,left:j.left})}c.browser.opera&&/relative/.test(i.css("position"))&&i.css({position:"relative",top:"auto",left:"auto"});this._renderProxy();j=a(this.helper.css("left"));var h=a(this.helper.css("top"));if(f.containment){j+=c(f.containment).scrollLeft()||0;h+=c(f.containment).scrollTop()||0}this.offset=this.helper.offset();this.position={left:j,top:h};this.size=this._helper?{width:i.outerWidth(),height:i.outerHeight()}:{width:i.width(),height:i.height()};this.originalSize=this._helper?{width:i.outerWidth(),height:i.outerHeight()}:{width:i.width(),height:i.height()};this.originalPosition={left:j,top:h};this.sizeDiff={width:i.outerWidth()-i.width(),height:i.outerHeight()-i.height()};this.originalMousePosition={left:d.pageX,top:d.pageY};this.aspectRatio=typeof f.aspectRatio=="number"?f.aspectRatio:this.originalSize.width/this.originalSize.height||1;f=c(".ui-resizable-"+this.axis).css("cursor");c("body").css("cursor",f=="auto"?this.axis+"-resize":f);i.addClass("ui-resizable-resizing");this._propagate("start",d);return true},_mouseDrag:function(d){var f=this.helper,h=this.originalMousePosition,g=this._change[this.axis];if(!g){return false}h=g.apply(this,[d,d.pageX-h.left||0,d.pageY-h.top||0]);if(this._aspectRatio||d.shiftKey){h=this._updateRatio(h,d)}h=this._respectSize(h,d);this._propagate("resize",d);f.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"});!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize();this._updateCache(h);this._trigger("resize",d,this.ui());return false},_mouseStop:function(d){this.resizing=false;var h=this.options,l=this;if(this._helper){var k=this._proportionallyResizeElements,i=k.length&&/textarea/i.test(k[0].nodeName);k=i&&c.ui.hasScroll(k[0],"left")?0:l.sizeDiff.height;i={width:l.size.width-(i?0:l.sizeDiff.width),height:l.size.height-k};k=parseInt(l.element.css("left"),10)+(l.position.left-l.originalPosition.left)||null;var j=parseInt(l.element.css("top"),10)+(l.position.top-l.originalPosition.top)||null;h.animate||this.element.css(c.extend(i,{top:j,left:k}));l.helper.height(l.size.height);l.helper.width(l.size.width);this._helper&&!h.animate&&this._proportionallyResize()}c("body").css("cursor","auto");this.element.removeClass("ui-resizable-resizing");this._propagate("stop",d);this._helper&&this.helper.remove();return false},_updateCache:function(d){this.offset=this.helper.offset();if(b(d.left)){this.position.left=d.left}if(b(d.top)){this.position.top=d.top}if(b(d.height)){this.size.height=d.height}if(b(d.width)){this.size.width=d.width}},_updateRatio:function(d){var f=this.position,h=this.size,g=this.axis;if(d.height){d.width=h.height*this.aspectRatio}else{if(d.width){d.height=h.width/this.aspectRatio}}if(g=="sw"){d.left=f.left+(h.width-d.width);d.top=null}if(g=="nw"){d.top=f.top+(h.height-d.height);d.left=f.left+(h.width-d.width)}return d},_respectSize:function(s){var u=this.options,r=this.axis,q=b(s.width)&&u.maxWidth&&u.maxWidth<s.width,o=b(s.height)&&u.maxHeight&&u.maxHeight<s.height,p=b(s.width)&&u.minWidth&&u.minWidth>s.width,n=b(s.height)&&u.minHeight&&u.minHeight>s.height;if(p){s.width=u.minWidth}if(n){s.height=u.minHeight}if(q){s.width=u.maxWidth}if(o){s.height=u.maxHeight}var m=this.originalPosition.left+this.originalSize.width,k=this.position.top+this.size.height,d=/sw|nw|w/.test(r);r=/nw|ne|n/.test(r);if(p&&d){s.left=m-u.minWidth}if(q&&d){s.left=m-u.maxWidth}if(n&&r){s.top=k-u.minHeight}if(o&&r){s.top=k-u.maxHeight}if((u=!s.width&&!s.height)&&!s.left&&s.top){s.top=null}else{if(u&&!s.top&&s.left){s.left=null}}return s},_proportionallyResize:function(){if(this._proportionallyResizeElements.length){for(var d=this.helper||this.element,f=0;f<this._proportionallyResizeElements.length;f++){var j=this._proportionallyResizeElements[f];if(!this.borderDif){var i=[j.css("borderTopWidth"),j.css("borderRightWidth"),j.css("borderBottomWidth"),j.css("borderLeftWidth")],h=[j.css("paddingTop"),j.css("paddingRight"),j.css("paddingBottom"),j.css("paddingLeft")];this.borderDif=c.map(i,function(g,e){g=parseInt(g,10)||0;e=parseInt(h[e],10)||0;return g+e})}c.browser.msie&&(c(d).is(":hidden")||c(d).parents(":hidden").length)||j.css({height:d.height()-this.borderDif[0]-this.borderDif[2]||0,width:d.width()-this.borderDif[1]-this.borderDif[3]||0})}}},_renderProxy:function(){var d=this.options;this.elementOffset=this.element.offset();if(this._helper){this.helper=this.helper||c('<div style="overflow:hidden;"></div>');var e=c.browser.msie&&c.browser.version<7,f=e?1:0;e=e?2:-1;this.helper.addClass(this._helper).css({width:this.element.outerWidth()+e,height:this.element.outerHeight()+e,position:"absolute",left:this.elementOffset.left-f+"px",top:this.elementOffset.top-f+"px",zIndex:++d.zIndex});this.helper.appendTo("body").disableSelection()}else{this.helper=this.element}},_change:{e:function(d,e){return{width:this.originalSize.width+e}},w:function(d,e){return{left:this.originalPosition.left+e,width:this.originalSize.width-e}},n:function(d,e,f){return{top:this.originalPosition.top+f,height:this.originalSize.height-f}},s:function(d,e,f){return{height:this.originalSize.height+f}},se:function(d,e,f){return c.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[d,e,f]))},sw:function(d,e,f){return c.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[d,e,f]))},ne:function(d,e,f){return c.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[d,e,f]))},nw:function(d,e,f){return c.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[d,e,f]))}},_propagate:function(d,e){c.ui.plugin.call(this,d,[e,this.ui()]);d!="resize"&&this._trigger(d,e,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}});c.extend(c.ui.resizable,{version:"1.8.2"});c.ui.plugin.add("resizable","alsoResize",{start:function(){var d=c(this).data("resizable").options,e=function(f){c(f).each(function(){c(this).data("resizable-alsoresize",{width:parseInt(c(this).width(),10),height:parseInt(c(this).height(),10),left:parseInt(c(this).css("left"),10),top:parseInt(c(this).css("top"),10)})})};if(typeof d.alsoResize=="object"&&!d.alsoResize.parentNode){if(d.alsoResize.length){d.alsoResize=d.alsoResize[0];e(d.alsoResize)}else{c.each(d.alsoResize,function(f){e(f)})}}else{e(d.alsoResize)}},resize:function(){var d=c(this).data("resizable"),h=d.options,l=d.originalSize,k=d.originalPosition,i={height:d.size.height-l.height||0,width:d.size.width-l.width||0,top:d.position.top-k.top||0,left:d.position.left-k.left||0},j=function(f,e){c(f).each(function(){var m=c(this),g=c(this).data("resizable-alsoresize"),n={};c.each((e&&e.length?e:["width","height","top","left"])||["width","height","top","left"],function(q,p){if((q=(g[p]||0)+(i[p]||0))&&q>=0){n[p]=q||null}});if(/relative/.test(m.css("position"))&&c.browser.opera){d._revertToRelativePosition=true;m.css({position:"absolute",top:"auto",left:"auto"})}m.css(n)})};typeof h.alsoResize=="object"&&!h.alsoResize.nodeType?c.each(h.alsoResize,function(f,e){j(f,e)}):j(h.alsoResize)},stop:function(){var d=c(this).data("resizable");if(d._revertToRelativePosition&&c.browser.opera){d._revertToRelativePosition=false;el.css({position:"relative"})}c(this).removeData("resizable-alsoresize-start")}});c.ui.plugin.add("resizable","animate",{stop:function(d){var i=c(this).data("resizable"),n=i.options,m=i._proportionallyResizeElements,k=m.length&&/textarea/i.test(m[0].nodeName),l=k&&c.ui.hasScroll(m[0],"left")?0:i.sizeDiff.height;k={width:i.size.width-(k?0:i.sizeDiff.width),height:i.size.height-l};l=parseInt(i.element.css("left"),10)+(i.position.left-i.originalPosition.left)||null;var j=parseInt(i.element.css("top"),10)+(i.position.top-i.originalPosition.top)||null;i.element.animate(c.extend(k,j&&l?{top:j,left:l}:{}),{duration:n.animateDuration,easing:n.animateEasing,step:function(){var e={width:parseInt(i.element.css("width"),10),height:parseInt(i.element.css("height"),10),top:parseInt(i.element.css("top"),10),left:parseInt(i.element.css("left"),10)};m&&m.length&&c(m[0]).css({width:e.width,height:e.height});i._updateCache(e);i._propagate("resize",d)}})}});c.ui.plugin.add("resizable","containment",{start:function(){var d=c(this).data("resizable"),i=d.element,n=d.options.containment;if(i=n instanceof c?n.get(0):/parent/.test(n)?i.parent().get(0):n){d.containerElement=c(i);if(/document/.test(n)||n==document){d.containerOffset={left:0,top:0};d.containerPosition={left:0,top:0};d.parentData={element:c(document),left:0,top:0,width:c(document).width(),height:c(document).height()||document.body.parentNode.scrollHeight}}else{var m=c(i),k=[];c(["Top","Right","Left","Bottom"]).each(function(f,e){k[f]=a(m.css("padding"+e))});d.containerOffset=m.offset();d.containerPosition=m.position();d.containerSize={height:m.innerHeight()-k[3],width:m.innerWidth()-k[1]};n=d.containerOffset;var l=d.containerSize.height,j=d.containerSize.width;j=c.ui.hasScroll(i,"left")?i.scrollWidth:j;l=c.ui.hasScroll(i)?i.scrollHeight:l;d.parentData={element:i,left:n.left,top:n.top,width:j,height:l}}}},resize:function(d){var i=c(this).data("resizable"),n=i.options,m=i.containerOffset,k=i.position;d=i._aspectRatio||d.shiftKey;var l={top:0,left:0},j=i.containerElement;if(j[0]!=document&&/static/.test(j.css("position"))){l=m}if(k.left<(i._helper?m.left:0)){i.size.width+=i._helper?i.position.left-m.left:i.position.left-l.left;if(d){i.size.height=i.size.width/n.aspectRatio}i.position.left=n.helper?m.left:0}if(k.top<(i._helper?m.top:0)){i.size.height+=i._helper?i.position.top-m.top:i.position.top;if(d){i.size.width=i.size.height*n.aspectRatio}i.position.top=i._helper?m.top:0}i.offset.left=i.parentData.left+i.position.left;i.offset.top=i.parentData.top+i.position.top;n=Math.abs((i._helper?i.offset.left-l.left:i.offset.left-l.left)+i.sizeDiff.width);m=Math.abs((i._helper?i.offset.top-l.top:i.offset.top-m.top)+i.sizeDiff.height);k=i.containerElement.get(0)==i.element.parent().get(0);l=/relative|absolute/.test(i.containerElement.css("position"));if(k&&l){n-=i.parentData.left}if(n+i.size.width>=i.parentData.width){i.size.width=i.parentData.width-n;if(d){i.size.height=i.size.width/i.aspectRatio}}if(m+i.size.height>=i.parentData.height){i.size.height=i.parentData.height-m;if(d){i.size.width=i.size.height*i.aspectRatio}}},stop:function(){var d=c(this).data("resizable"),j=d.options,p=d.containerOffset,o=d.containerPosition,m=d.containerElement,n=c(d.helper),l=n.offset(),k=n.outerWidth()-d.sizeDiff.width;n=n.outerHeight()-d.sizeDiff.height;d._helper&&!j.animate&&/relative/.test(m.css("position"))&&c(this).css({left:l.left-o.left-p.left,width:k,height:n});d._helper&&!j.animate&&/static/.test(m.css("position"))&&c(this).css({left:l.left-o.left-p.left,width:k,height:n})}});c.ui.plugin.add("resizable","ghost",{start:function(){var d=c(this).data("resizable"),e=d.options,f=d.size;d.ghost=d.originalElement.clone();d.ghost.css({opacity:0.25,display:"block",position:"relative",height:f.height,width:f.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof e.ghost=="string"?e.ghost:"");d.ghost.appendTo(d.helper)},resize:function(){var d=c(this).data("resizable");d.ghost&&d.ghost.css({position:"relative",height:d.size.height,width:d.size.width})},stop:function(){var d=c(this).data("resizable");d.ghost&&d.helper&&d.helper.get(0).removeChild(d.ghost.get(0))}});c.ui.plugin.add("resizable","grid",{resize:function(){var d=c(this).data("resizable"),i=d.options,n=d.size,m=d.originalSize,k=d.originalPosition,l=d.axis;i.grid=typeof i.grid=="number"?[i.grid,i.grid]:i.grid;var j=Math.round((n.width-m.width)/(i.grid[0]||1))*(i.grid[0]||1);i=Math.round((n.height-m.height)/(i.grid[1]||1))*(i.grid[1]||1);if(/^(se|s|e)$/.test(l)){d.size.width=m.width+j;d.size.height=m.height+i}else{if(/^(ne)$/.test(l)){d.size.width=m.width+j;d.size.height=m.height+i;d.position.top=k.top-i}else{if(/^(sw)$/.test(l)){d.size.width=m.width+j;d.size.height=m.height+i}else{d.size.width=m.width+j;d.size.height=m.height+i;d.position.top=k.top-i}d.position.left=k.left-j}}}});var a=function(d){return parseInt(d,10)||0},b=function(d){return !isNaN(parseInt(d,10))}})(jQuery);(function(a){a.widget("ui.selectable",a.ui.mouse,{options:{appendTo:"body",autoRefresh:true,distance:0,filter:"*",tolerance:"touch"},_create:function(){var d=this;this.element.addClass("ui-selectable");this.dragged=false;var b;this.refresh=function(){b=a(d.options.filter,d.element[0]);b.each(function(){var e=a(this),c=e.offset();a.data(this,"selectable-item",{element:this,$element:e,left:c.left,top:c.top,right:c.left+e.outerWidth(),bottom:c.top+e.outerHeight(),startselected:false,selected:e.hasClass("ui-selected"),selecting:e.hasClass("ui-selecting"),unselecting:e.hasClass("ui-unselecting")})})};this.refresh();this.selectees=b.addClass("ui-selectee");this._mouseInit();this.helper=a("<div class='ui-selectable-helper'></div>")},destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item");this.element.removeClass("ui-selectable ui-selectable-disabled").removeData("selectable").unbind(".selectable");this._mouseDestroy();return this},_mouseStart:function(g){var b=this;this.opos=[g.pageX,g.pageY];if(!this.options.disabled){var e=this.options;this.selectees=a(e.filter,this.element[0]);this._trigger("start",g);a(e.appendTo).append(this.helper);this.helper.css({"z-index":100,position:"absolute",left:g.clientX,top:g.clientY,width:0,height:0});e.autoRefresh&&this.refresh();this.selectees.filter(".ui-selected").each(function(){var c=a.data(this,"selectable-item");c.startselected=true;if(!g.metaKey){c.$element.removeClass("ui-selected");c.selected=false;c.$element.addClass("ui-unselecting");c.unselecting=true;b._trigger("unselecting",g,{unselecting:c.element})}});a(g.target).parents().andSelf().each(function(){var c=a.data(this,"selectable-item");if(c){var d=!g.metaKey||!c.$element.hasClass("ui-selected");c.$element.removeClass(d?"ui-unselecting":"ui-selected").addClass(d?"ui-selecting":"ui-unselecting");c.unselecting=!d;c.selecting=d;(c.selected=d)?b._trigger("selecting",g,{selecting:c.element}):b._trigger("unselecting",g,{unselecting:c.element});return false}})}},_mouseDrag:function(q){var o=this;this.dragged=true;if(!this.options.disabled){var p=this.options,e=this.opos[0],n=this.opos[1],m=q.pageX,l=q.pageY;if(e>m){var k=m;m=e;e=k}if(n>l){k=l;l=n;n=k}this.helper.css({left:e,top:n,width:m-e,height:l-n});this.selectees.each(function(){var b=a.data(this,"selectable-item");if(!(!b||b.element==o.element[0])){var c=false;if(p.tolerance=="touch"){c=!(b.left>m||b.right<e||b.top>l||b.bottom<n)}else{if(p.tolerance=="fit"){c=b.left>e&&b.right<m&&b.top>n&&b.bottom<l}}if(c){if(b.selected){b.$element.removeClass("ui-selected");b.selected=false}if(b.unselecting){b.$element.removeClass("ui-unselecting");b.unselecting=false}if(!b.selecting){b.$element.addClass("ui-selecting");b.selecting=true;o._trigger("selecting",q,{selecting:b.element})}}else{if(b.selecting){if(q.metaKey&&b.startselected){b.$element.removeClass("ui-selecting");b.selecting=false;b.$element.addClass("ui-selected");b.selected=true}else{b.$element.removeClass("ui-selecting");b.selecting=false;if(b.startselected){b.$element.addClass("ui-unselecting");b.unselecting=true}o._trigger("unselecting",q,{unselecting:b.element})}}if(b.selected){if(!q.metaKey&&!b.startselected){b.$element.removeClass("ui-selected");b.selected=false;b.$element.addClass("ui-unselecting");b.unselecting=true;o._trigger("unselecting",q,{unselecting:b.element})}}}}});return false}},_mouseStop:function(d){var b=this;this.dragged=false;a(".ui-unselecting",this.element[0]).each(function(){var c=a.data(this,"selectable-item");c.$element.removeClass("ui-unselecting");c.unselecting=false;c.startselected=false;b._trigger("unselected",d,{unselected:c.element})});a(".ui-selecting",this.element[0]).each(function(){var c=a.data(this,"selectable-item");c.$element.removeClass("ui-selecting").addClass("ui-selected");c.selecting=false;c.selected=true;c.startselected=true;b._trigger("selected",d,{selected:c.element})});this._trigger("stop",d);this.helper.remove();return false}});a.extend(a.ui.selectable,{version:"1.8.2"})})(jQuery);(function(a){a.widget("ui.sortable",a.ui.mouse,{widgetEventPrefix:"sort",options:{appendTo:"parent",axis:false,connectWith:false,containment:false,cursor:"auto",cursorAt:false,dropOnEmpty:true,forcePlaceholderSize:false,forceHelperSize:false,grid:false,handle:false,helper:"original",items:"> *",opacity:false,placeholder:false,revert:false,scroll:true,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1000},_create:function(){this.containerCache={};this.element.addClass("ui-sortable");this.refresh();this.floating=this.items.length?/left|right/.test(this.items[0].item.css("float")):false;this.offset=this.element.offset();this._mouseInit()},destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").removeData("sortable").unbind(".sortable");this._mouseDestroy();for(var b=this.items.length-1;b>=0;b--){this.items[b].item.removeData("sortable-item")}return this},_setOption:function(d,c){if(d==="disabled"){this.options[d]=c;this.widget()[c?"addClass":"removeClass"]("ui-sortable-disabled")}else{a.Widget.prototype._setOption.apply(this,arguments)}},_mouseCapture:function(g,d){if(this.reverting){return false}if(this.options.disabled||this.options.type=="static"){return false}this._refreshItems(g);var j=null,i=this;a(g.target).parents().each(function(){if(a.data(this,"sortable-item")==i){j=a(this);return false}});if(a.data(g.target,"sortable-item")==i){j=a(g.target)}if(!j){return false}if(this.options.handle&&!d){var h=false;a(this.options.handle,j).find("*").andSelf().each(function(){if(this==g.target){h=true}});if(!h){return false}}this.currentItem=j;this._removeCurrentsFromItems();return true},_mouseStart:function(f,d,h){d=this.options;var g=this;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(f);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");a.extend(this.offset,{click:{left:f.pageX-this.offset.left,top:f.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this._generatePosition(f);this.originalPageX=f.pageX;this.originalPageY=f.pageY;d.cursorAt&&this._adjustOffsetFromHelper(d.cursorAt);this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};this.helper[0]!=this.currentItem[0]&&this.currentItem.hide();this._createPlaceholder();d.containment&&this._setContainment();if(d.cursor){if(a("body").css("cursor")){this._storedCursor=a("body").css("cursor")}a("body").css("cursor",d.cursor)}if(d.opacity){if(this.helper.css("opacity")){this._storedOpacity=this.helper.css("opacity")}this.helper.css("opacity",d.opacity)}if(d.zIndex){if(this.helper.css("zIndex")){this._storedZIndex=this.helper.css("zIndex")}this.helper.css("zIndex",d.zIndex)}if(this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"){this.overflowOffset=this.scrollParent.offset()}this._trigger("start",f,this._uiHash());this._preserveHelperProportions||this._cacheHelperProportions();if(!h){for(h=this.containers.length-1;h>=0;h--){this.containers[h]._trigger("activate",f,g._uiHash(this))}}if(a.ui.ddmanager){a.ui.ddmanager.current=this}a.ui.ddmanager&&!d.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,f);this.dragging=true;this.helper.addClass("ui-sortable-helper");this._mouseDrag(f);return true},_mouseDrag:function(g){this.position=this._generatePosition(g);this.positionAbs=this._convertPositionTo("absolute");if(!this.lastPositionAbs){this.lastPositionAbs=this.positionAbs}if(this.options.scroll){var d=this.options,j=false;if(this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"){if(this.overflowOffset.top+this.scrollParent[0].offsetHeight-g.pageY<d.scrollSensitivity){this.scrollParent[0].scrollTop=j=this.scrollParent[0].scrollTop+d.scrollSpeed}else{if(g.pageY-this.overflowOffset.top<d.scrollSensitivity){this.scrollParent[0].scrollTop=j=this.scrollParent[0].scrollTop-d.scrollSpeed}}if(this.overflowOffset.left+this.scrollParent[0].offsetWidth-g.pageX<d.scrollSensitivity){this.scrollParent[0].scrollLeft=j=this.scrollParent[0].scrollLeft+d.scrollSpeed}else{if(g.pageX-this.overflowOffset.left<d.scrollSensitivity){this.scrollParent[0].scrollLeft=j=this.scrollParent[0].scrollLeft-d.scrollSpeed}}}else{if(g.pageY-a(document).scrollTop()<d.scrollSensitivity){j=a(document).scrollTop(a(document).scrollTop()-d.scrollSpeed)}else{if(a(window).height()-(g.pageY-a(document).scrollTop())<d.scrollSensitivity){j=a(document).scrollTop(a(document).scrollTop()+d.scrollSpeed)}}if(g.pageX-a(document).scrollLeft()<d.scrollSensitivity){j=a(document).scrollLeft(a(document).scrollLeft()-d.scrollSpeed)}else{if(a(window).width()-(g.pageX-a(document).scrollLeft())<d.scrollSensitivity){j=a(document).scrollLeft(a(document).scrollLeft()+d.scrollSpeed)}}}j!==false&&a.ui.ddmanager&&!d.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,g)}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!="x"){this.helper[0].style.top=this.position.top+"px"}for(d=this.items.length-1;d>=0;d--){j=this.items[d];var i=j.item[0],h=this._intersectsWithPointer(j);if(h){if(i!=this.currentItem[0]&&this.placeholder[h==1?"next":"prev"]()[0]!=i&&!a.ui.contains(this.placeholder[0],i)&&(this.options.type=="semi-dynamic"?!a.ui.contains(this.element[0],i):true)){this.direction=h==1?"down":"up";if(this.options.tolerance=="pointer"||this._intersectsWithSides(j)){this._rearrange(g,j)}else{break}this._trigger("change",g,this._uiHash());break}}}this._contactContainers(g);a.ui.ddmanager&&a.ui.ddmanager.drag(this,g);this._trigger("sort",g,this._uiHash());this.lastPositionAbs=this.positionAbs;return false},_mouseStop:function(e,d){if(e){a.ui.ddmanager&&!this.options.dropBehaviour&&a.ui.ddmanager.drop(this,e);if(this.options.revert){var f=this;d=f.placeholder.offset();f.reverting=true;a(this.helper).animate({left:d.left-this.offset.parent.left-f.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:d.top-this.offset.parent.top-f.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){f._clear(e)})}else{this._clear(e,d)}return false}},cancel:function(){var d=this;if(this.dragging){this._mouseUp();this.options.helper=="original"?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var c=this.containers.length-1;c>=0;c--){this.containers[c]._trigger("deactivate",null,d._uiHash(this));if(this.containers[c].containerCache.over){this.containers[c]._trigger("out",null,d._uiHash(this));this.containers[c].containerCache.over=0}}}this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]);this.options.helper!="original"&&this.helper&&this.helper[0].parentNode&&this.helper.remove();a.extend(this,{helper:null,dragging:false,reverting:false,_noFinalSort:null});this.domPosition.prev?a(this.domPosition.prev).after(this.currentItem):a(this.domPosition.parent).prepend(this.currentItem);return this},serialize:function(e){var d=this._getItemsAsjQuery(e&&e.connected),f=[];e=e||{};a(d).each(function(){var b=(a(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[-=_](.+)/);if(b){f.push((e.key||b[1]+"[]")+"="+(e.key&&e.expression?b[1]:b[2]))}});return f.join("&")},toArray:function(e){var d=this._getItemsAsjQuery(e&&e.connected),f=[];e=e||{};d.each(function(){f.push(a(e.item||this).attr(e.attribute||"id")||"")});return f},_intersectsWith:function(w){var v=this.positionAbs.left,u=v+this.helperProportions.width,s=this.positionAbs.top,r=s+this.helperProportions.height,q=w.left,p=q+w.width,o=w.top,m=o+w.height,n=this.offset.click.top,d=this.offset.click.left;n=s+n>o&&s+n<m&&v+d>q&&v+d<p;return this.options.tolerance=="pointer"||this.options.forcePointerForContainers||this.options.tolerance!="pointer"&&this.helperProportions[this.floating?"width":"height"]>w[this.floating?"width":"height"]?n:q<v+this.helperProportions.width/2&&u-this.helperProportions.width/2<p&&o<s+this.helperProportions.height/2&&r-this.helperProportions.height/2<m},_intersectsWithPointer:function(e){var d=a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height);e=a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width);d=d&&e;e=this._getDragVerticalDirection();var f=this._getDragHorizontalDirection();if(!d){return false}return this.floating?f&&f=="right"||e=="down"?2:1:e&&(e=="down"?2:1)},_intersectsWithSides:function(f){var d=a.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,f.top+f.height/2,f.height);f=a.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,f.left+f.width/2,f.width);var h=this._getDragVerticalDirection(),g=this._getDragHorizontalDirection();return this.floating&&g?g=="right"&&f||g=="left"&&!f:h&&(h=="down"&&d||h=="up"&&!d)},_getDragVerticalDirection:function(){var b=this.positionAbs.top-this.lastPositionAbs.top;return b!=0&&(b>0?"down":"up")},_getDragHorizontalDirection:function(){var b=this.positionAbs.left-this.lastPositionAbs.left;return b!=0&&(b>0?"right":"left")},refresh:function(b){this._refreshItems(b);this.refreshPositions();return this},_connectWith:function(){var b=this.options;return b.connectWith.constructor==String?[b.connectWith]:b.connectWith},_getItemsAsjQuery:function(i){var d=[],n=[],m=this._connectWith();if(m&&i){for(i=m.length-1;i>=0;i--){for(var l=a(m[i]),k=l.length-1;k>=0;k--){var j=a.data(l[k],"sortable");if(j&&j!=this&&!j.options.disabled){n.push([a.isFunction(j.options.items)?j.options.items.call(j.element):a(j.options.items,j.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),j])}}}}n.push([a.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):a(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(i=n.length-1;i>=0;i--){n[i][0].each(function(){d.push(this)})}return a(d)},_removeCurrentsFromItems:function(){for(var e=this.currentItem.find(":data(sortable-item)"),d=0;d<this.items.length;d++){for(var f=0;f<e.length;f++){e[f]==this.items[d].item[0]&&this.items.splice(d,1)}}},_refreshItems:function(j){this.items=[];this.containers=[this];var d=this.items,p=[[a.isFunction(this.options.items)?this.options.items.call(this.element[0],j,{item:this.currentItem}):a(this.options.items,this.element),this]],o=this._connectWith();if(o){for(var n=o.length-1;n>=0;n--){for(var m=a(o[n]),l=m.length-1;l>=0;l--){var k=a.data(m[l],"sortable");if(k&&k!=this&&!k.options.disabled){p.push([a.isFunction(k.options.items)?k.options.items.call(k.element[0],j,{item:this.currentItem}):a(k.options.items,k.element),k]);this.containers.push(k)}}}}for(n=p.length-1;n>=0;n--){j=p[n][1];o=p[n][0];l=0;for(m=o.length;l<m;l++){k=a(o[l]);k.data("sortable-item",j);d.push({item:k,instance:j,width:0,height:0,left:0,top:0})}}},refreshPositions:function(f){if(this.offsetParent&&this.helper){this.offset.parent=this._getParentOffset()}for(var d=this.items.length-1;d>=0;d--){var h=this.items[d],g=this.options.toleranceElement?a(this.options.toleranceElement,h.item):h.item;if(!f){h.width=g.outerWidth();h.height=g.outerHeight()}g=g.offset();h.left=g.left;h.top=g.top}if(this.options.custom&&this.options.custom.refreshContainers){this.options.custom.refreshContainers.call(this)}else{for(d=this.containers.length-1;d>=0;d--){g=this.containers[d].element.offset();this.containers[d].containerCache.left=g.left;this.containers[d].containerCache.top=g.top;this.containers[d].containerCache.width=this.containers[d].element.outerWidth();this.containers[d].containerCache.height=this.containers[d].element.outerHeight()}}return this},_createPlaceholder:function(f){var d=f||this,h=d.options;if(!h.placeholder||h.placeholder.constructor==String){var g=h.placeholder;h.placeholder={element:function(){var b=a(document.createElement(d.currentItem[0].nodeName)).addClass(g||d.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];if(!g){b.style.visibility="hidden"}return b},update:function(c,b){if(!(g&&!h.forcePlaceholderSize)){b.height()||b.height(d.currentItem.innerHeight()-parseInt(d.currentItem.css("paddingTop")||0,10)-parseInt(d.currentItem.css("paddingBottom")||0,10));b.width()||b.width(d.currentItem.innerWidth()-parseInt(d.currentItem.css("paddingLeft")||0,10)-parseInt(d.currentItem.css("paddingRight")||0,10))}}}}d.placeholder=a(h.placeholder.element.call(d.element,d.currentItem));d.currentItem.after(d.placeholder);h.placeholder.update(d,d.placeholder)},_contactContainers:function(i){for(var d=null,n=null,m=this.containers.length-1;m>=0;m--){if(!a.ui.contains(this.currentItem[0],this.containers[m].element[0])){if(this._intersectsWith(this.containers[m].containerCache)){if(!(d&&a.ui.contains(this.containers[m].element[0],d.element[0]))){d=this.containers[m];n=m}}else{if(this.containers[m].containerCache.over){this.containers[m]._trigger("out",i,this._uiHash(this));this.containers[m].containerCache.over=0}}}}if(d){if(this.containers.length===1){this.containers[n]._trigger("over",i,this._uiHash(this));this.containers[n].containerCache.over=1}else{if(this.currentContainer!=this.containers[n]){d=10000;m=null;for(var l=this.positionAbs[this.containers[n].floating?"left":"top"],k=this.items.length-1;k>=0;k--){if(a.ui.contains(this.containers[n].element[0],this.items[k].item[0])){var j=this.items[k][this.containers[n].floating?"left":"top"];if(Math.abs(j-l)<d){d=Math.abs(j-l);m=this.items[k]}}}if(m||this.options.dropOnEmpty){this.currentContainer=this.containers[n];m?this._rearrange(i,m,null,true):this._rearrange(i,null,this.containers[n].element,true);this._trigger("change",i,this._uiHash());this.containers[n]._trigger("change",i,this._uiHash(this));this.options.placeholder.update(this.currentContainer,this.placeholder);this.containers[n]._trigger("over",i,this._uiHash(this));this.containers[n].containerCache.over=1}}}}},_createHelper:function(d){var c=this.options;d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[d,this.currentItem])):c.helper=="clone"?this.currentItem.clone():this.currentItem;d.parents("body").length||a(c.appendTo!="parent"?c.appendTo:this.currentItem[0].parentNode)[0].appendChild(d[0]);if(d[0]==this.currentItem[0]){this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}}if(d[0].style.width==""||c.forceHelperSize){d.width(this.currentItem.width())}if(d[0].style.height==""||c.forceHelperSize){d.height(this.currentItem.height())}return d},_adjustOffsetFromHelper:function(b){if(typeof b=="string"){b=b.split(" ")}if(a.isArray(b)){b={left:+b[0],top:+b[1]||0}}if("left" in b){this.offset.click.left=b.left+this.margins.left}if("right" in b){this.offset.click.left=this.helperProportions.width-b.right+this.margins.left}if("top" in b){this.offset.click.top=b.top+this.margins.top}if("bottom" in b){this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();if(this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0])){b.left+=this.scrollParent.scrollLeft();b.top+=this.scrollParent.scrollTop()}if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&a.browser.msie){b={top:0,left:0}}return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var b=this.currentItem.position();return{top:b.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:b.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else{return{top:0,left:0}}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e=this.options;if(e.containment=="parent"){e.containment=this.helper[0].parentNode}if(e.containment=="document"||e.containment=="window"){this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,a(e.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(a(e.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]}if(!/^(document|window|parent)$/.test(e.containment)){var d=a(e.containment)[0];e=a(e.containment).offset();var f=a(d).css("overflow")!="hidden";this.containment=[e.left+(parseInt(a(d).css("borderLeftWidth"),10)||0)+(parseInt(a(d).css("paddingLeft"),10)||0)-this.margins.left,e.top+(parseInt(a(d).css("borderTopWidth"),10)||0)+(parseInt(a(d).css("paddingTop"),10)||0)-this.margins.top,e.left+(f?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(a(d).css("borderLeftWidth"),10)||0)-(parseInt(a(d).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,e.top+(f?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(a(d).css("borderTopWidth"),10)||0)-(parseInt(a(d).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(f,d){if(!d){d=this.position}f=f=="absolute"?1:-1;var h=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,g=/(html|body)/i.test(h[0].tagName);return{top:d.top+this.offset.relative.top*f+this.offset.parent.top*f-(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():g?0:h.scrollTop())*f),left:d.left+this.offset.relative.left*f+this.offset.parent.left*f-(a.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():g?0:h.scrollLeft())*f)}},_generatePosition:function(h){var d=this.options,l=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,k=/(html|body)/i.test(l[0].tagName);if(this.cssPosition=="relative"&&!(this.scrollParent[0]!=document&&this.scrollParent[0]!=this.offsetParent[0])){this.offset.relative=this._getRelativeOffset()}var j=h.pageX,i=h.pageY;if(this.originalPosition){if(this.containment){if(h.pageX-this.offset.click.left<this.containment[0]){j=this.containment[0]+this.offset.click.left}if(h.pageY-this.offset.click.top<this.containment[1]){i=this.containment[1]+this.offset.click.top}if(h.pageX-this.offset.click.left>this.containment[2]){j=this.containment[2]+this.offset.click.left}if(h.pageY-this.offset.click.top>this.containment[3]){i=this.containment[3]+this.offset.click.top}}if(d.grid){i=this.originalPageY+Math.round((i-this.originalPageY)/d.grid[1])*d.grid[1];i=this.containment?!(i-this.offset.click.top<this.containment[1]||i-this.offset.click.top>this.containment[3])?i:!(i-this.offset.click.top<this.containment[1])?i-d.grid[1]:i+d.grid[1]:i;j=this.originalPageX+Math.round((j-this.originalPageX)/d.grid[0])*d.grid[0];j=this.containment?!(j-this.offset.click.left<this.containment[0]||j-this.offset.click.left>this.containment[2])?j:!(j-this.offset.click.left<this.containment[0])?j-d.grid[0]:j+d.grid[0]:j}}return{top:i-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():k?0:l.scrollTop()),left:j-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():k?0:l.scrollLeft())}},_rearrange:function(h,d,l,k){l?l[0].appendChild(this.placeholder[0]):d.item[0].parentNode.insertBefore(this.placeholder[0],this.direction=="down"?d.item[0]:d.item[0].nextSibling);this.counter=this.counter?++this.counter:1;var j=this,i=this.counter;window.setTimeout(function(){i==j.counter&&j.refreshPositions(!k)},0)},_clear:function(f,d){this.reverting=false;var h=[];!this._noFinalSort&&this.currentItem[0].parentNode&&this.placeholder.before(this.currentItem);this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var g in this._storedCSS){if(this._storedCSS[g]=="auto"||this._storedCSS[g]=="static"){this._storedCSS[g]=""}}this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else{this.currentItem.show()}this.fromOutside&&!d&&h.push(function(b){this._trigger("receive",b,this._uiHash(this.fromOutside))});if((this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!d){h.push(function(b){this._trigger("update",b,this._uiHash())})}if(!a.ui.contains(this.element[0],this.currentItem[0])){d||h.push(function(b){this._trigger("remove",b,this._uiHash())});for(g=this.containers.length-1;g>=0;g--){if(a.ui.contains(this.containers[g].element[0],this.currentItem[0])&&!d){h.push(function(b){return function(c){b._trigger("receive",c,this._uiHash(this))}}.call(this,this.containers[g]));h.push(function(b){return function(c){b._trigger("update",c,this._uiHash(this))}}.call(this,this.containers[g]))}}}for(g=this.containers.length-1;g>=0;g--){d||h.push(function(b){return function(c){b._trigger("deactivate",c,this._uiHash(this))}}.call(this,this.containers[g]));if(this.containers[g].containerCache.over){h.push(function(b){return function(c){b._trigger("out",c,this._uiHash(this))}}.call(this,this.containers[g]));this.containers[g].containerCache.over=0}}this._storedCursor&&a("body").css("cursor",this._storedCursor);this._storedOpacity&&this.helper.css("opacity",this._storedOpacity);if(this._storedZIndex){this.helper.css("zIndex",this._storedZIndex=="auto"?"":this._storedZIndex)}this.dragging=false;if(this.cancelHelperRemoval){if(!d){this._trigger("beforeStop",f,this._uiHash());for(g=0;g<h.length;g++){h[g].call(this,f)}this._trigger("stop",f,this._uiHash())}return false}d||this._trigger("beforeStop",f,this._uiHash());this.placeholder[0].parentNode.removeChild(this.placeholder[0]);this.helper[0]!=this.currentItem[0]&&this.helper.remove();this.helper=null;if(!d){for(g=0;g<h.length;g++){h[g].call(this,f)}this._trigger("stop",f,this._uiHash())}this.fromOutside=false;return true},_trigger:function(){a.Widget.prototype._trigger.apply(this,arguments)===false&&this.cancel()},_uiHash:function(d){var c=d||this;return{helper:c.helper,placeholder:c.placeholder||a([]),position:c.position,originalPosition:c.originalPosition,offset:c.positionAbs,item:c.currentItem,sender:d?d.element:null}}});a.extend(a.ui.sortable,{version:"1.8.2"})})(jQuery);jQuery.effects||function(p){function h(j){var f;if(j&&j.constructor==Array&&j.length==3){return j}if(f=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(j)){return[parseInt(f[1],10),parseInt(f[2],10),parseInt(f[3],10)]}if(f=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(j)){return[parseFloat(f[1])*2.55,parseFloat(f[2])*2.55,parseFloat(f[3])*2.55]}if(f=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(j)){return[parseInt(f[1],16),parseInt(f[2],16),parseInt(f[3],16)]}if(f=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(j)){return[parseInt(f[1]+f[1],16),parseInt(f[2]+f[2],16),parseInt(f[3]+f[3],16)]}if(/rgba\(0, 0, 0, 0\)/.exec(j)){return g.transparent}return g[p.trim(j).toLowerCase()]}function b(k,j){var f;do{f=p.curCSS(k,j);if(f!=""&&f!="transparent"||p.nodeName(k,"body")){break}j="backgroundColor"}while(k=k.parentNode);return h(f)}function e(){var m=document.defaultView?document.defaultView.getComputedStyle(this,null):this.currentStyle,j={},f,l;if(m&&m.length&&m[0]&&m[m[0]]){for(var k=m.length;k--;){f=m[k];if(typeof m[f]=="string"){l=f.replace(/\-(\w)/g,function(o,n){return n.toUpperCase()});j[l]=m[f]}}}else{for(f in m){if(typeof m[f]==="string"){j[f]=m[f]}}}return j}function d(k){var j,f;for(j in k){f=k[j];if(f==null||p.isFunction(f)||j in a||/scrollbar/.test(j)||!/color/i.test(j)&&isNaN(parseFloat(f))){delete k[j]}}return k}function u(l,j){var f={_:0},k;for(k in j){if(l[k]!=j[k]){f[k]=j[k]}}return f}function i(l,j,f,k){if(typeof l=="object"){k=j;f=null;j=l;l=j.effect}if(p.isFunction(j)){k=j;f=null;j={}}if(p.isFunction(f)){k=f;f=null}if(typeof j=="number"||p.fx.speeds[j]){k=f;f=j;j={}}j=j||{};f=f||j.duration;f=p.fx.off?0:typeof f=="number"?f:p.fx.speeds[f]||p.fx.speeds._default;k=k||j.complete;return[l,j,f,k]}p.effects={};p.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","color","outlineColor"],function(j,f){p.fx.step[f]=function(k){if(!k.colorInit){k.start=b(k.elem,f);k.end=h(k.end);k.colorInit=true}k.elem.style[f]="rgb("+Math.max(Math.min(parseInt(k.pos*(k.end[0]-k.start[0])+k.start[0],10),255),0)+","+Math.max(Math.min(parseInt(k.pos*(k.end[1]-k.start[1])+k.start[1],10),255),0)+","+Math.max(Math.min(parseInt(k.pos*(k.end[2]-k.start[2])+k.start[2],10),255),0)+")"}});var g={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]},c=["add","remove","toggle"],a={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};p.effects.animateClass=function(l,j,f,k){if(p.isFunction(f)){k=f;f=null}return this.each(function(){var r=p(this),o=r.attr("style")||" ",n=d(e.call(this)),q,m=r.attr("className");p.each(c,function(s,v){l[v]&&r[v+"Class"](l[v])});q=d(e.call(this));r.attr("className",m);r.animate(u(n,q),j,f,function(){p.each(c,function(s,v){l[v]&&r[v+"Class"](l[v])});if(typeof r.attr("style")=="object"){r.attr("style").cssText="";r.attr("style").cssText=o}else{r.attr("style",o)}k&&k.apply(this,arguments)})})};p.fn.extend({_addClass:p.fn.addClass,addClass:function(l,j,f,k){return j?p.effects.animateClass.apply(this,[{add:l},j,f,k]):this._addClass(l)},_removeClass:p.fn.removeClass,removeClass:function(l,j,f,k){return j?p.effects.animateClass.apply(this,[{remove:l},j,f,k]):this._removeClass(l)},_toggleClass:p.fn.toggleClass,toggleClass:function(m,j,f,l,k){return typeof j=="boolean"||j===undefined?f?p.effects.animateClass.apply(this,[j?{add:m}:{remove:m},f,l,k]):this._toggleClass(m,j):p.effects.animateClass.apply(this,[{toggle:m},j,f,l])},switchClass:function(m,j,f,l,k){return p.effects.animateClass.apply(this,[{add:j,remove:m},f,l,k])}});p.extend(p.effects,{version:"1.8.2",save:function(k,j){for(var f=0;f<j.length;f++){j[f]!==null&&k.data("ec.storage."+j[f],k[0].style[j[f]])}},restore:function(k,j){for(var f=0;f<j.length;f++){j[f]!==null&&k.css(j[f],k.data("ec.storage."+j[f]))}},setMode:function(j,f){if(f=="toggle"){f=j.is(":hidden")?"show":"hide"}return f},getBaseline:function(k,j){var f;switch(k[0]){case"top":f=0;break;case"middle":f=0.5;break;case"bottom":f=1;break;default:f=k[0]/j.height}switch(k[1]){case"left":k=0;break;case"center":k=0.5;break;case"right":k=1;break;default:k=k[1]/j.width}return{x:k,y:f}},createWrapper:function(k){if(k.parent().is(".ui-effects-wrapper")){return k.parent()}var j={width:k.outerWidth(true),height:k.outerHeight(true),"float":k.css("float")},f=p("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0});k.wrap(f);f=k.parent();if(k.css("position")=="static"){f.css({position:"relative"});k.css({position:"relative"})}else{p.extend(j,{position:k.css("position"),zIndex:k.css("z-index")});p.each(["top","left","bottom","right"],function(m,l){j[l]=k.css(l);if(isNaN(parseInt(j[l],10))){j[l]="auto"}});k.css({position:"relative",top:0,left:0})}return f.css(j).show()},removeWrapper:function(f){if(f.parent().is(".ui-effects-wrapper")){return f.parent().replaceWith(f)}return f},setTransition:function(l,j,f,k){k=k||{};p.each(j,function(n,m){unit=l.cssUnit(m);if(unit[0]>0){k[m]=unit[0]*f+unit[1]}});return k}});p.fn.extend({effect:function(k){var j=i.apply(this,arguments);j={options:j[1],duration:j[2],callback:j[3]};var f=p.effects[k];return f&&!p.fx.off?f.call(this,j):this},_show:p.fn.show,show:function(j){if(!j||typeof j=="number"||p.fx.speeds[j]){return this._show.apply(this,arguments)}else{var f=i.apply(this,arguments);f[1].mode="show";return this.effect.apply(this,f)}},_hide:p.fn.hide,hide:function(j){if(!j||typeof j=="number"||p.fx.speeds[j]){return this._hide.apply(this,arguments)}else{var f=i.apply(this,arguments);f[1].mode="hide";return this.effect.apply(this,f)}},__toggle:p.fn.toggle,toggle:function(j){if(!j||typeof j=="number"||p.fx.speeds[j]||typeof j=="boolean"||p.isFunction(j)){return this.__toggle.apply(this,arguments)}else{var f=i.apply(this,arguments);f[1].mode="toggle";return this.effect.apply(this,f)}},cssUnit:function(k){var j=this.css(k),f=[];p.each(["em","px","%","pt"],function(m,l){if(j.indexOf(l)>0){f=[parseFloat(j),l]}});return f}});p.easing.jswing=p.easing.swing;p.extend(p.easing,{def:"easeOutQuad",swing:function(m,j,f,l,k){return p.easing[p.easing.def](m,j,f,l,k)},easeInQuad:function(m,j,f,l,k){return l*(j/=k)*j+f},easeOutQuad:function(m,j,f,l,k){return -l*(j/=k)*(j-2)+f},easeInOutQuad:function(m,j,f,l,k){if((j/=k/2)<1){return l/2*j*j+f}return -l/2*(--j*(j-2)-1)+f},easeInCubic:function(m,j,f,l,k){return l*(j/=k)*j*j+f},easeOutCubic:function(m,j,f,l,k){return l*((j=j/k-1)*j*j+1)+f},easeInOutCubic:function(m,j,f,l,k){if((j/=k/2)<1){return l/2*j*j*j+f}return l/2*((j-=2)*j*j+2)+f},easeInQuart:function(m,j,f,l,k){return l*(j/=k)*j*j*j+f},easeOutQuart:function(m,j,f,l,k){return -l*((j=j/k-1)*j*j*j-1)+f},easeInOutQuart:function(m,j,f,l,k){if((j/=k/2)<1){return l/2*j*j*j*j+f}return -l/2*((j-=2)*j*j*j-2)+f},easeInQuint:function(m,j,f,l,k){return l*(j/=k)*j*j*j*j+f},easeOutQuint:function(m,j,f,l,k){return l*((j=j/k-1)*j*j*j*j+1)+f},easeInOutQuint:function(m,j,f,l,k){if((j/=k/2)<1){return l/2*j*j*j*j*j+f}return l/2*((j-=2)*j*j*j*j+2)+f},easeInSine:function(m,j,f,l,k){return -l*Math.cos(j/k*(Math.PI/2))+l+f},easeOutSine:function(m,j,f,l,k){return l*Math.sin(j/k*(Math.PI/2))+f},easeInOutSine:function(m,j,f,l,k){return -l/2*(Math.cos(Math.PI*j/k)-1)+f},easeInExpo:function(m,j,f,l,k){return j==0?f:l*Math.pow(2,10*(j/k-1))+f},easeOutExpo:function(m,j,f,l,k){return j==k?f+l:l*(-Math.pow(2,-10*j/k)+1)+f},easeInOutExpo:function(m,j,f,l,k){if(j==0){return f}if(j==k){return f+l}if((j/=k/2)<1){return l/2*Math.pow(2,10*(j-1))+f}return l/2*(-Math.pow(2,-10*--j)+2)+f},easeInCirc:function(m,j,f,l,k){return -l*(Math.sqrt(1-(j/=k)*j)-1)+f},easeOutCirc:function(m,j,f,l,k){return l*Math.sqrt(1-(j=j/k-1)*j)+f},easeInOutCirc:function(m,j,f,l,k){if((j/=k/2)<1){return -l/2*(Math.sqrt(1-j*j)-1)+f}return l/2*(Math.sqrt(1-(j-=2)*j)+1)+f},easeInElastic:function(o,j,f,n,m){o=1.70158;var l=0,k=n;if(j==0){return f}if((j/=m)==1){return f+n}l||(l=m*0.3);if(k<Math.abs(n)){k=n;o=l/4}else{o=l/(2*Math.PI)*Math.asin(n/k)}return -(k*Math.pow(2,10*(j-=1))*Math.sin((j*m-o)*2*Math.PI/l))+f},easeOutElastic:function(o,j,f,n,m){o=1.70158;var l=0,k=n;if(j==0){return f}if((j/=m)==1){return f+n}l||(l=m*0.3);if(k<Math.abs(n)){k=n;o=l/4}else{o=l/(2*Math.PI)*Math.asin(n/k)}return k*Math.pow(2,-10*j)*Math.sin((j*m-o)*2*Math.PI/l)+n+f},easeInOutElastic:function(o,j,f,n,m){o=1.70158;var l=0,k=n;if(j==0){return f}if((j/=m/2)==2){return f+n}l||(l=m*0.3*1.5);if(k<Math.abs(n)){k=n;o=l/4}else{o=l/(2*Math.PI)*Math.asin(n/k)}if(j<1){return -0.5*k*Math.pow(2,10*(j-=1))*Math.sin((j*m-o)*2*Math.PI/l)+f}return k*Math.pow(2,-10*(j-=1))*Math.sin((j*m-o)*2*Math.PI/l)*0.5+n+f},easeInBack:function(n,j,f,m,l,k){if(k==undefined){k=1.70158}return m*(j/=l)*j*((k+1)*j-k)+f},easeOutBack:function(n,j,f,m,l,k){if(k==undefined){k=1.70158}return m*((j=j/l-1)*j*((k+1)*j+k)+1)+f},easeInOutBack:function(n,j,f,m,l,k){if(k==undefined){k=1.70158}if((j/=l/2)<1){return m/2*j*j*(((k*=1.525)+1)*j-k)+f}return m/2*((j-=2)*j*(((k*=1.525)+1)*j+k)+2)+f},easeInBounce:function(m,j,f,l,k){return l-p.easing.easeOutBounce(m,k-j,0,l,k)+f},easeOutBounce:function(m,j,f,l,k){return(j/=k)<1/2.75?l*7.5625*j*j+f:j<2/2.75?l*(7.5625*(j-=1.5/2.75)*j+0.75)+f:j<2.5/2.75?l*(7.5625*(j-=2.25/2.75)*j+0.9375)+f:l*(7.5625*(j-=2.625/2.75)*j+0.984375)+f},easeInOutBounce:function(m,j,f,l,k){if(j<k/2){return p.easing.easeInBounce(m,j*2,0,l,k)*0.5+f}return p.easing.easeOutBounce(m,j*2-k,0,l,k)*0.5+l*0.5+f}})}(jQuery);(function(a){a.effects.blind=function(b){return this.queue(function(){var c=a(this),l=["position","top","left"],m=a.effects.setMode(c,b.options.mode||"hide"),o=b.options.direction||"vertical";a.effects.save(c,l);c.show();var n=a.effects.createWrapper(c).css({overflow:"hidden"}),k=o=="vertical"?"height":"width";o=o=="vertical"?n.height():n.width();m=="show"&&n.css(k,0);var j={};j[k]=m=="show"?o:0;n.animate(j,b.duration,b.options.easing,function(){m=="hide"&&c.hide();a.effects.restore(c,l);a.effects.removeWrapper(c);b.callback&&b.callback.apply(c[0],arguments);c.dequeue()})})}})(jQuery);(function(a){a.effects.bounce=function(c){return this.queue(function(){var w=a(this),e=["position","top","left"],q=a.effects.setMode(w,c.options.mode||"effect"),u=c.options.direction||"up",v=c.options.distance||20,b=c.options.times||5,p=c.duration||250;/show|hide/.test(q)&&e.push("opacity");a.effects.save(w,e);w.show();a.effects.createWrapper(w);var s=u=="up"||u=="down"?"top":"left";u=u=="up"||u=="left"?"pos":"neg";v=c.options.distance||(s=="top"?w.outerHeight({margin:true})/3:w.outerWidth({margin:true})/3);if(q=="show"){w.css("opacity",0).css(s,u=="pos"?-v:v)}if(q=="hide"){v/=b*2}q!="hide"&&b--;if(q=="show"){var r={opacity:1};r[s]=(u=="pos"?"+=":"-=")+v;w.animate(r,p/2,c.options.easing);v/=2;b--}for(r=0;r<b;r++){var o={},n={};o[s]=(u=="pos"?"-=":"+=")+v;n[s]=(u=="pos"?"+=":"-=")+v;w.animate(o,p/2,c.options.easing).animate(n,p/2,c.options.easing);v=q=="hide"?v*2:v/2}if(q=="hide"){r={opacity:0};r[s]=(u=="pos"?"-=":"+=")+v;w.animate(r,p/2,c.options.easing,function(){w.hide();a.effects.restore(w,e);a.effects.removeWrapper(w);c.callback&&c.callback.apply(this,arguments)})}else{o={};n={};o[s]=(u=="pos"?"-=":"+=")+v;n[s]=(u=="pos"?"+=":"-=")+v;w.animate(o,p/2,c.options.easing).animate(n,p/2,c.options.easing,function(){a.effects.restore(w,e);a.effects.removeWrapper(w);c.callback&&c.callback.apply(this,arguments)})}w.queue("fx",function(){w.dequeue()});w.dequeue()})}})(jQuery);(function(a){a.effects.clip=function(b){return this.queue(function(){var e=a(this),j=["position","top","left","height","width"],m=a.effects.setMode(e,b.options.mode||"hide"),o=b.options.direction||"vertical";a.effects.save(e,j);e.show();var n=a.effects.createWrapper(e).css({overflow:"hidden"});n=e[0].tagName=="IMG"?n:e;var l={size:o=="vertical"?"height":"width",position:o=="vertical"?"top":"left"};o=o=="vertical"?n.height():n.width();if(m=="show"){n.css(l.size,0);n.css(l.position,o/2)}var k={};k[l.size]=m=="show"?o:0;k[l.position]=m=="show"?0:o/2;n.animate(k,{queue:false,duration:b.duration,easing:b.options.easing,complete:function(){m=="hide"&&e.hide();a.effects.restore(e,j);a.effects.removeWrapper(e);b.callback&&b.callback.apply(e[0],arguments);e.dequeue()}})})}})(jQuery);(function(a){a.effects.drop=function(b){return this.queue(function(){var d=a(this),k=["position","top","left","opacity"],n=a.effects.setMode(d,b.options.mode||"hide"),c=b.options.direction||"left";a.effects.save(d,k);d.show();a.effects.createWrapper(d);var m=c=="up"||c=="down"?"top":"left";c=c=="up"||c=="left"?"pos":"neg";var l=b.options.distance||(m=="top"?d.outerHeight({margin:true})/2:d.outerWidth({margin:true})/2);if(n=="show"){d.css("opacity",0).css(m,c=="pos"?-l:l)}var j={opacity:n=="show"?1:0};j[m]=(n=="show"?c=="pos"?"+=":"-=":c=="pos"?"-=":"+=")+l;d.animate(j,{queue:false,duration:b.duration,easing:b.options.easing,complete:function(){n=="hide"&&d.hide();a.effects.restore(d,k);a.effects.removeWrapper(d);b.callback&&b.callback.apply(this,arguments);d.dequeue()}})})}})(jQuery);(function(a){a.effects.explode=function(b){return this.queue(function(){var q=b.options.pieces?Math.round(Math.sqrt(b.options.pieces)):3,p=b.options.pieces?Math.round(Math.sqrt(b.options.pieces)):3;b.options.mode=b.options.mode=="toggle"?a(this).is(":visible")?"hide":"show":b.options.mode;var j=a(this).show().css("visibility","hidden"),m=j.offset();m.top-=parseInt(j.css("marginTop"),10)||0;m.left-=parseInt(j.css("marginLeft"),10)||0;for(var l=j.outerWidth(true),k=j.outerHeight(true),o=0;o<q;o++){for(var n=0;n<p;n++){j.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-n*(l/p),top:-o*(k/q)}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:l/p,height:k/q,left:m.left+n*(l/p)+(b.options.mode=="show"?(n-Math.floor(p/2))*(l/p):0),top:m.top+o*(k/q)+(b.options.mode=="show"?(o-Math.floor(q/2))*(k/q):0),opacity:b.options.mode=="show"?0:1}).animate({left:m.left+n*(l/p)+(b.options.mode=="show"?0:(n-Math.floor(p/2))*(l/p)),top:m.top+o*(k/q)+(b.options.mode=="show"?0:(o-Math.floor(q/2))*(k/q)),opacity:b.options.mode=="show"?1:0},b.duration||500)}}setTimeout(function(){b.options.mode=="show"?j.css({visibility:"visible"}):j.css({visibility:"visible"}).hide();b.callback&&b.callback.apply(j[0]);j.dequeue();a("div.ui-effects-explode").remove()},b.duration||500)})}})(jQuery);(function(a){a.effects.fade=function(b){return this.queue(function(){var f=a(this),e=a.effects.setMode(f,b.options.mode||"hide");f.animate({opacity:e},{queue:false,duration:b.duration,easing:b.options.easing,complete:function(){b.callback&&b.callback.apply(this,arguments);f.dequeue()}})})}})(jQuery);(function(a){a.effects.fold=function(b){return this.queue(function(){var v=a(this),n=["position","top","left"],u=a.effects.setMode(v,b.options.mode||"hide"),q=b.options.size||15,p=!!b.options.horizFirst,m=b.duration?b.duration/2:a.fx.speeds._default/2;a.effects.save(v,n);v.show();var s=a.effects.createWrapper(v).css({overflow:"hidden"}),r=u=="show"!=p,c=r?["width","height"]:["height","width"];r=r?[s.width(),s.height()]:[s.height(),s.width()];var o=/([0-9]+)%/.exec(q);if(o){q=parseInt(o[1],10)/100*r[u=="hide"?0:1]}if(u=="show"){s.css(p?{height:0,width:q}:{height:q,width:0})}p={};o={};p[c[0]]=u=="show"?r[0]:q;o[c[1]]=u=="show"?r[1]:0;s.animate(p,m,b.options.easing).animate(o,m,b.options.easing,function(){u=="hide"&&v.hide();a.effects.restore(v,n);a.effects.removeWrapper(v);b.callback&&b.callback.apply(v[0],arguments);v.dequeue()})})}})(jQuery);(function(a){a.effects.highlight=function(b){return this.queue(function(){var c=a(this),h=["backgroundImage","backgroundColor","opacity"],i=a.effects.setMode(c,b.options.mode||"show"),g={backgroundColor:c.css("backgroundColor")};if(i=="hide"){g.opacity=0}a.effects.save(c,h);c.show().css({backgroundImage:"none",backgroundColor:b.options.color||"#ffff99"}).animate(g,{queue:false,duration:b.duration,easing:b.options.easing,complete:function(){i=="hide"&&c.hide();a.effects.restore(c,h);i=="show"&&!a.support.opacity&&this.style.removeAttribute("filter");b.callback&&b.callback.apply(this,arguments);c.dequeue()}})})}})(jQuery);(function(a){a.effects.pulsate=function(b){return this.queue(function(){var d=a(this),e=a.effects.setMode(d,b.options.mode||"show");times=(b.options.times||5)*2-1;duration=b.duration?b.duration/2:a.fx.speeds._default/2;isVisible=d.is(":visible");animateTo=0;if(!isVisible){d.css("opacity",0).show();animateTo=1}if(e=="hide"&&isVisible||e=="show"&&!isVisible){times--}for(e=0;e<times;e++){d.animate({opacity:animateTo},duration,b.options.easing);animateTo=(animateTo+1)%2}d.animate({opacity:animateTo},duration,b.options.easing,function(){animateTo==0&&d.hide();b.callback&&b.callback.apply(this,arguments)});d.queue("fx",function(){d.dequeue()}).dequeue()})}})(jQuery);(function(a){a.effects.puff=function(c){return this.queue(function(){var b=a(this),k=a.effects.setMode(b,c.options.mode||"hide"),j=parseInt(c.options.percent,10)||150,f=j/100,d={height:b.height(),width:b.width()};a.extend(c.options,{fade:true,mode:k,percent:k=="hide"?j:100,from:k=="hide"?d:{height:d.height*f,width:d.width*f}});b.effect("scale",c.options,c.duration,c.callback);b.dequeue()})};a.effects.scale=function(c){return this.queue(function(){var b=a(this),m=a.extend(true,{},c.options),k=a.effects.setMode(b,c.options.mode||"effect"),j=parseInt(c.options.percent,10)||(parseInt(c.options.percent,10)==0?0:k=="hide"?0:100),d=c.options.direction||"both",l=c.options.origin;if(k!="effect"){m.origin=l||["middle","center"];m.restore=true}l={height:b.height(),width:b.width()};b.from=c.options.from||(k=="show"?{height:0,width:0}:l);j={y:d!="horizontal"?j/100:1,x:d!="vertical"?j/100:1};b.to={height:l.height*j.y,width:l.width*j.x};if(c.options.fade){if(k=="show"){b.from.opacity=0;b.to.opacity=1}if(k=="hide"){b.from.opacity=1;b.to.opacity=0}}m.from=b.from;m.to=b.to;m.mode=k;b.effect("size",m,c.duration,c.callback);b.dequeue()})};a.effects.size=function(c){return this.queue(function(){var B=a(this),z=["position","top","left","width","height","overflow","opacity"],x=["position","top","left","overflow","opacity"],w=["width","height","overflow"],v=["fontSize"],y=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],s=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],b=a.effects.setMode(B,c.options.mode||"effect"),o=c.options.restore||false,q=c.options.scale||"both",r=c.options.origin,u={height:B.height(),width:B.width()};B.from=c.options.from||u;B.to=c.options.to||u;if(r){r=a.effects.getBaseline(r,u);B.from.top=(u.height-B.from.height)*r.y;B.from.left=(u.width-B.from.width)*r.x;B.to.top=(u.height-B.to.height)*r.y;B.to.left=(u.width-B.to.width)*r.x}var A={from:{y:B.from.height/u.height,x:B.from.width/u.width},to:{y:B.to.height/u.height,x:B.to.width/u.width}};if(q=="box"||q=="both"){if(A.from.y!=A.to.y){z=z.concat(y);B.from=a.effects.setTransition(B,y,A.from.y,B.from);B.to=a.effects.setTransition(B,y,A.to.y,B.to)}if(A.from.x!=A.to.x){z=z.concat(s);B.from=a.effects.setTransition(B,s,A.from.x,B.from);B.to=a.effects.setTransition(B,s,A.to.x,B.to)}}if(q=="content"||q=="both"){if(A.from.y!=A.to.y){z=z.concat(v);B.from=a.effects.setTransition(B,v,A.from.y,B.from);B.to=a.effects.setTransition(B,v,A.to.y,B.to)}}a.effects.save(B,o?z:x);B.show();a.effects.createWrapper(B);B.css("overflow","hidden").css(B.from);if(q=="content"||q=="both"){y=y.concat(["marginTop","marginBottom"]).concat(v);s=s.concat(["marginLeft","marginRight"]);w=z.concat(y).concat(s);B.find("*[width]").each(function(){child=a(this);o&&a.effects.save(child,w);var d={height:child.height(),width:child.width()};child.from={height:d.height*A.from.y,width:d.width*A.from.x};child.to={height:d.height*A.to.y,width:d.width*A.to.x};if(A.from.y!=A.to.y){child.from=a.effects.setTransition(child,y,A.from.y,child.from);child.to=a.effects.setTransition(child,y,A.to.y,child.to)}if(A.from.x!=A.to.x){child.from=a.effects.setTransition(child,s,A.from.x,child.from);child.to=a.effects.setTransition(child,s,A.to.x,child.to)}child.css(child.from);child.animate(child.to,c.duration,c.options.easing,function(){o&&a.effects.restore(child,w)})})}B.animate(B.to,{queue:false,duration:c.duration,easing:c.options.easing,complete:function(){B.to.opacity===0&&B.css("opacity",B.from.opacity);b=="hide"&&B.hide();a.effects.restore(B,o?z:x);a.effects.removeWrapper(B);c.callback&&c.callback.apply(this,arguments);B.dequeue()}})})}})(jQuery);(function(a){a.effects.shake=function(b){return this.queue(function(){var v=a(this),n=["position","top","left"];a.effects.setMode(v,b.options.mode||"effect");var u=b.options.direction||"left",s=b.options.distance||20,d=b.options.times||3,r=b.duration||b.options.duration||140;a.effects.save(v,n);v.show();a.effects.createWrapper(v);var q=u=="up"||u=="down"?"top":"left",p=u=="up"||u=="left"?"pos":"neg";u={};var o={},m={};u[q]=(p=="pos"?"-=":"+=")+s;o[q]=(p=="pos"?"+=":"-=")+s*2;m[q]=(p=="pos"?"-=":"+=")+s*2;v.animate(u,r,b.options.easing);for(s=1;s<d;s++){v.animate(o,r,b.options.easing).animate(m,r,b.options.easing)}v.animate(o,r,b.options.easing).animate(u,r/2,b.options.easing,function(){a.effects.restore(v,n);a.effects.removeWrapper(v);b.callback&&b.callback.apply(this,arguments)});v.queue("fx",function(){v.dequeue()});v.dequeue()})}})(jQuery);(function(a){a.effects.slide=function(b){return this.queue(function(){var d=a(this),k=["position","top","left"],n=a.effects.setMode(d,b.options.mode||"show"),c=b.options.direction||"left";a.effects.save(d,k);d.show();a.effects.createWrapper(d).css({overflow:"hidden"});var m=c=="up"||c=="down"?"top":"left";c=c=="up"||c=="left"?"pos":"neg";var l=b.options.distance||(m=="top"?d.outerHeight({margin:true}):d.outerWidth({margin:true}));if(n=="show"){d.css(m,c=="pos"?-l:l)}var j={};j[m]=(n=="show"?c=="pos"?"+=":"-=":c=="pos"?"-=":"+=")+l;d.animate(j,{queue:false,duration:b.duration,easing:b.options.easing,complete:function(){n=="hide"&&d.hide();a.effects.restore(d,k);a.effects.removeWrapper(d);b.callback&&b.callback.apply(this,arguments);d.dequeue()}})})}})(jQuery);(function(a){a.effects.transfer=function(b){return this.queue(function(){var e=a(this),i=a(b.options.to),h=i.offset();i={top:h.top,left:h.left,height:i.innerHeight(),width:i.innerWidth()};h=e.offset();var g=a('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(b.options.className).css({top:h.top,left:h.left,height:e.innerHeight(),width:e.innerWidth(),position:"absolute"}).animate(i,b.duration,b.options.easing,function(){g.remove();b.callback&&b.callback.apply(e[0],arguments);e.dequeue()})})}})(jQuery);(function(a){a.widget("ui.accordion",{options:{active:0,animated:"slide",autoHeight:true,clearStyle:false,collapsible:false,event:"click",fillSpace:false,header:"> li > :first-child,> :not(li):even",icons:{header:"ui-icon-triangle-1-e",headerSelected:"ui-icon-triangle-1-s"},navigation:false,navigationFilter:function(){return this.href.toLowerCase()==location.href.toLowerCase()}},_create:function(){var e=this.options,c=this;this.running=0;this.element.addClass("ui-accordion ui-widget ui-helper-reset");this.element.children("li").addClass("ui-accordion-li-fix");this.headers=this.element.find(e.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all").bind("mouseenter.accordion",function(){a(this).addClass("ui-state-hover")}).bind("mouseleave.accordion",function(){a(this).removeClass("ui-state-hover")}).bind("focus.accordion",function(){a(this).addClass("ui-state-focus")}).bind("blur.accordion",function(){a(this).removeClass("ui-state-focus")});this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom");if(e.navigation){var h=this.element.find("a").filter(e.navigationFilter);if(h.length){var g=h.closest(".ui-accordion-header");this.active=g.length?g:h.closest(".ui-accordion-content").prev()}}this.active=this._findActive(this.active||e.active).toggleClass("ui-state-default").toggleClass("ui-state-active").toggleClass("ui-corner-all").toggleClass("ui-corner-top");this.active.next().addClass("ui-accordion-content-active");this._createIcons();this.resize();this.element.attr("role","tablist");this.headers.attr("role","tab").bind("keydown",function(b){return c._keydown(b)}).next().attr("role","tabpanel");this.headers.not(this.active||"").attr("aria-expanded","false").attr("tabIndex","-1").next().hide();this.active.length?this.active.attr("aria-expanded","true").attr("tabIndex","0"):this.headers.eq(0).attr("tabIndex","0");a.browser.safari||this.headers.find("a").attr("tabIndex","-1");e.event&&this.headers.bind(e.event+".accordion",function(b){c._clickHandler.call(c,b,this);b.preventDefault()})},_createIcons:function(){var b=this.options;if(b.icons){a("<span/>").addClass("ui-icon "+b.icons.header).prependTo(this.headers);this.active.find(".ui-icon").toggleClass(b.icons.header).toggleClass(b.icons.headerSelected);this.element.addClass("ui-accordion-icons")}},_destroyIcons:function(){this.headers.children(".ui-icon").remove();this.element.removeClass("ui-accordion-icons")},destroy:function(){var d=this.options;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role").unbind(".accordion").removeData("accordion");this.headers.unbind(".accordion").removeClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("tabIndex");this.headers.find("a").removeAttr("tabIndex");this._destroyIcons();var c=this.headers.next().css("display","").removeAttr("role").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active");if(d.autoHeight||d.fillHeight){c.css("height","")}return this},_setOption:function(d,c){a.Widget.prototype._setOption.apply(this,arguments);d=="active"&&this.activate(c);if(d=="icons"){this._destroyIcons();c&&this._createIcons()}},_keydown:function(e){var c=a.ui.keyCode;if(!(this.options.disabled||e.altKey||e.ctrlKey)){var j=this.headers.length,i=this.headers.index(e.target),h=false;switch(e.keyCode){case c.RIGHT:case c.DOWN:h=this.headers[(i+1)%j];break;case c.LEFT:case c.UP:h=this.headers[(i-1+j)%j];break;case c.SPACE:case c.ENTER:this._clickHandler({target:e.target},e.target);e.preventDefault()}if(h){a(e.target).attr("tabIndex","-1");a(h).attr("tabIndex","0");h.focus();return false}return true}},resize:function(){var e=this.options,c;if(e.fillSpace){if(a.browser.msie){var f=this.element.parent().css("overflow");this.element.parent().css("overflow","hidden")}c=this.element.parent().height();a.browser.msie&&this.element.parent().css("overflow",f);this.headers.each(function(){c-=a(this).outerHeight(true)});this.headers.next().each(function(){a(this).height(Math.max(0,c-a(this).innerHeight()+a(this).height()))}).css("overflow","auto")}else{if(e.autoHeight){c=0;this.headers.next().each(function(){c=Math.max(c,a(this).height())}).height(c)}}return this},activate:function(b){this.options.active=b;b=this._findActive(b)[0];this._clickHandler({target:b},b);return this},_findActive:function(b){return b?typeof b=="number"?this.headers.filter(":eq("+b+")"):this.headers.not(this.headers.not(b)):b===false?a([]):this.headers.filter(":eq(0)")},_clickHandler:function(h,c){var l=this.options;if(!l.disabled){if(h.target){h=a(h.currentTarget||c);c=h[0]==this.active[0];l.active=l.collapsible&&c?false:a(".ui-accordion-header",this.element).index(h);if(!(this.running||!l.collapsible&&c)){this.active.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").find(".ui-icon").removeClass(l.icons.headerSelected).addClass(l.icons.header);if(!c){h.removeClass("ui-state-default ui-corner-all").addClass("ui-state-active ui-corner-top").find(".ui-icon").removeClass(l.icons.header).addClass(l.icons.headerSelected);h.next().addClass("ui-accordion-content-active")}k=h.next();j=this.active.next();i={options:l,newHeader:c&&l.collapsible?a([]):h,oldHeader:this.active,newContent:c&&l.collapsible?a([]):k,oldContent:j};l=this.headers.index(this.active[0])>this.headers.index(h[0]);this.active=c?a([]):h;this._toggle(k,j,i,c,l)}}else{if(l.collapsible){this.active.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").find(".ui-icon").removeClass(l.icons.headerSelected).addClass(l.icons.header);this.active.next().addClass("ui-accordion-content-active");var j=this.active.next(),i={options:l,newHeader:a([]),oldHeader:l.active,newContent:a([]),oldContent:j},k=this.active=a([]);this._toggle(k,j,i)}}}},_toggle:function(u,s,r,p,o){var q=this.options,c=this;this.toShow=u;this.toHide=s;this.data=r;var m=function(){if(c){return c._completed.apply(c,arguments)}};this._trigger("changestart",null,this.data);this.running=s.size()===0?u.size():s.size();if(q.animated){r={};r=q.collapsible&&p?{toShow:a([]),toHide:s,complete:m,down:o,autoHeight:q.autoHeight||q.fillSpace}:{toShow:u,toHide:s,complete:m,down:o,autoHeight:q.autoHeight||q.fillSpace};if(!q.proxied){q.proxied=q.animated}if(!q.proxiedDuration){q.proxiedDuration=q.duration}q.animated=a.isFunction(q.proxied)?q.proxied(r):q.proxied;q.duration=a.isFunction(q.proxiedDuration)?q.proxiedDuration(r):q.proxiedDuration;p=a.ui.accordion.animations;var n=q.duration,l=q.animated;if(l&&!p[l]&&!a.easing[l]){l="slide"}p[l]||(p[l]=function(b){this.slide(b,{easing:l,duration:n||700})});p[l](r)}else{if(q.collapsible&&p){u.toggle()}else{s.hide();u.show()}m(true)}s.prev().attr("aria-expanded","false").attr("tabIndex","-1").blur();u.prev().attr("aria-expanded","true").attr("tabIndex","0").focus()},_completed:function(d){var c=this.options;this.running=d?0:--this.running;if(!this.running){c.clearStyle&&this.toShow.add(this.toHide).css({height:"",overflow:""});this.toHide.removeClass("ui-accordion-content-active");this._trigger("change",null,this.data)}}});a.extend(a.ui.accordion,{version:"1.8.2",animations:{slide:function(h,c){h=a.extend({easing:"swing",duration:300},h,c);if(h.toHide.size()){if(h.toShow.size()){var n=h.toShow.css("overflow"),l=0,j={},m={},i;c=h.toShow;i=c[0].style.width;c.width(parseInt(c.parent().width(),10)-parseInt(c.css("paddingLeft"),10)-parseInt(c.css("paddingRight"),10)-(parseInt(c.css("borderLeftWidth"),10)||0)-(parseInt(c.css("borderRightWidth"),10)||0));a.each(["height","paddingTop","paddingBottom"],function(b,d){m[d]="hide";b=(""+a.css(h.toShow[0],d)).match(/^([\d+-.]+)(.*)$/);j[d]={value:b[1],unit:b[2]||"px"}});h.toShow.css({height:0,overflow:"hidden"}).show();h.toHide.filter(":hidden").each(h.complete).end().filter(":visible").animate(m,{step:function(b,d){if(d.prop=="height"){l=d.end-d.start===0?0:(d.now-d.start)/(d.end-d.start)}h.toShow[0].style[d.prop]=l*j[d.prop].value+j[d.prop].unit},duration:h.duration,easing:h.easing,complete:function(){h.autoHeight||h.toShow.css("height","");h.toShow.css("width",i);h.toShow.css({overflow:n});h.complete()}})}else{h.toHide.animate({height:"hide"},h)}}else{h.toShow.animate({height:"show"},h)}},bounceslide:function(b){this.slide(b,{easing:b.down?"easeOutBounce":"swing",duration:b.down?1000:200})}}})})(jQuery);(function(a){a.widget("ui.autocomplete",{options:{minLength:1,delay:300},_create:function(){var b=this,d=this.element[0].ownerDocument;this.element.addClass("ui-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(e){var c=a.ui.keyCode;switch(e.keyCode){case c.PAGE_UP:b._move("previousPage",e);break;case c.PAGE_DOWN:b._move("nextPage",e);break;case c.UP:b._move("previous",e);e.preventDefault();break;case c.DOWN:b._move("next",e);e.preventDefault();break;case c.ENTER:case c.NUMPAD_ENTER:b.menu.active&&e.preventDefault();case c.TAB:if(!b.menu.active){return}b.menu.select(e);break;case c.ESCAPE:b.element.val(b.term);b.close(e);break;case c.LEFT:case c.RIGHT:case c.SHIFT:case c.CONTROL:case c.ALT:case c.COMMAND:case c.COMMAND_RIGHT:case c.INSERT:case c.CAPS_LOCK:case c.END:case c.HOME:break;default:clearTimeout(b.searching);b.searching=setTimeout(function(){b.search(null,e)},b.options.delay);break}}).bind("focus.autocomplete",function(){b.selectedItem=null;b.previous=b.element.val()}).bind("blur.autocomplete",function(c){clearTimeout(b.searching);b.closing=setTimeout(function(){b.close(c);b._change(c)},150)});this._initSource();this.response=function(){return b._response.apply(b,arguments)};this.menu=a("<ul></ul>").addClass("ui-autocomplete").appendTo("body",d).mousedown(function(){setTimeout(function(){clearTimeout(b.closing)},13)}).menu({focus:function(e,c){c=c.item.data("item.autocomplete");false!==b._trigger("focus",null,{item:c})&&/^key/.test(e.originalEvent.type)&&b.element.val(c.value)},selected:function(e,c){c=c.item.data("item.autocomplete");false!==b._trigger("select",e,{item:c})&&b.element.val(c.value);b.close(e);e=b.previous;if(b.element[0]!==d.activeElement){b.element.focus();b.previous=e}b.selectedItem=c},blur:function(){b.menu.element.is(":visible")&&b.element.val(b.term)}}).zIndex(this.element.zIndex()+1).css({top:0,left:0}).hide().data("menu");a.fn.bgiframe&&this.menu.element.bgiframe()},destroy:function(){this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup");this.menu.element.remove();a.Widget.prototype.destroy.call(this)},_setOption:function(b){a.Widget.prototype._setOption.apply(this,arguments);b==="source"&&this._initSource()},_initSource:function(){var b,d;if(a.isArray(this.options.source)){b=this.options.source;this.source=function(e,c){c(a.ui.autocomplete.filter(b,e.term))}}else{if(typeof this.options.source==="string"){d=this.options.source;this.source=function(e,c){a.getJSON(d,e,c)}}else{this.source=this.options.source}}},search:function(b,d){b=b!=null?b:this.element.val();if(b.length<this.options.minLength){return this.close(d)}clearTimeout(this.closing);if(this._trigger("search")!==false){return this._search(b)}},_search:function(b){this.term=this.element.addClass("ui-autocomplete-loading").val();this.source({term:b},this.response)},_response:function(b){if(b.length){b=this._normalize(b);this._suggest(b);this._trigger("open")}else{this.close()}this.element.removeClass("ui-autocomplete-loading")},close:function(b){clearTimeout(this.closing);if(this.menu.element.is(":visible")){this._trigger("close",b);this.menu.element.hide();this.menu.deactivate()}},_change:function(b){this.previous!==this.element.val()&&this._trigger("change",b,{item:this.selectedItem})},_normalize:function(b){if(b.length&&b[0].label&&b[0].value){return b}return a.map(b,function(d){if(typeof d==="string"){return{label:d,value:d}}return a.extend({label:d.label||d.value,value:d.value||d.label},d)})},_suggest:function(b){var f=this.menu.element.empty().zIndex(this.element.zIndex()+1),e;this._renderMenu(f,b);this.menu.deactivate();this.menu.refresh();this.menu.element.show().position({my:"left top",at:"left bottom",of:this.element,collision:"none"});b=f.width("").width();e=this.element.width();f.width(Math.max(b,e))},_renderMenu:function(b,f){var e=this;a.each(f,function(c,d){e._renderItem(b,d)})},_renderItem:function(b,d){return a("<li></li>").data("item.autocomplete",d).append("<a>"+d.label+"</a>").appendTo(b)},_move:function(b,d){if(this.menu.element.is(":visible")){if(this.menu.first()&&/^previous/.test(b)||this.menu.last()&&/^next/.test(b)){this.element.val(this.term);this.menu.deactivate()}else{this.menu[b](d)}}else{this.search(null,d)}},widget:function(){return this.menu.element}});a.extend(a.ui.autocomplete,{escapeRegex:function(b){return b.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")},filter:function(b,f){var e=new RegExp(a.ui.autocomplete.escapeRegex(f),"i");return a.grep(b,function(c){return e.test(c.label||c.value||c)})}})})(jQuery);(function(a){a.widget("ui.menu",{_create:function(){var b=this;this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({role:"listbox","aria-activedescendant":"ui-active-menuitem"}).click(function(d){if(a(d.target).closest(".ui-menu-item a").length){d.preventDefault();b.select(d)}});this.refresh()},refresh:function(){var b=this;this.element.children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","menuitem").children("a").addClass("ui-corner-all").attr("tabindex",-1).mouseenter(function(d){b.activate(d,a(this).parent())}).mouseleave(function(){b.deactivate()})},activate:function(g,j){this.deactivate();if(this.hasScroll()){var i=j.offset().top-this.element.offset().top,e=this.element.attr("scrollTop"),h=this.element.height();if(i<0){this.element.attr("scrollTop",e+i)}else{i>h&&this.element.attr("scrollTop",e+i-h+j.height())}}this.active=j.eq(0).children("a").addClass("ui-state-hover").attr("id","ui-active-menuitem").end();this._trigger("focus",g,{item:j})},deactivate:function(){if(this.active){this.active.children("a").removeClass("ui-state-hover").removeAttr("id");this._trigger("blur");this.active=null}},next:function(b){this.move("next",".ui-menu-item:first",b)},previous:function(b){this.move("prev",".ui-menu-item:last",b)},first:function(){return this.active&&!this.active.prev().length},last:function(){return this.active&&!this.active.next().length},move:function(b,f,e){if(this.active){b=this.active[b+"All"](".ui-menu-item").eq(0);b.length?this.activate(e,b):this.activate(e,this.element.children(f))}else{this.activate(e,this.element.children(f))}},nextPage:function(f){if(this.hasScroll()){if(!this.active||this.last()){this.activate(f,this.element.children(":first"))}else{var h=this.active.offset().top,g=this.element.height(),e=this.element.children("li").filter(function(){var b=a(this).offset().top-h-g+a(this).height();return b<10&&b>-10});e.length||(e=this.element.children(":last"));this.activate(f,e)}}else{this.activate(f,this.element.children(!this.active||this.last()?":first":":last"))}},previousPage:function(b){if(this.hasScroll()){if(!this.active||this.first()){this.activate(b,this.element.children(":last"))}else{var f=this.active.offset().top,e=this.element.height();result=this.element.children("li").filter(function(){var c=a(this).offset().top-f+e-a(this).height();return c<10&&c>-10});result.length||(result=this.element.children(":first"));this.activate(b,result)}}else{this.activate(b,this.element.children(!this.active||this.first()?":last":":first"))}},hasScroll:function(){return this.element.height()<this.element.attr("scrollHeight")},select:function(b){this._trigger("selected",b,{item:this.active})}})})(jQuery);(function(b){var e,c=function(a){b(":ui-button",a.target.form).each(function(){var f=b(this).data("button");setTimeout(function(){f.refresh()},1)})},d=function(a){var h=a.name,g=a.form,f=b([]);if(h){f=g?b(g).find("[name='"+h+"']"):b("[name='"+h+"']",a.ownerDocument).filter(function(){return !this.form})}return f};b.widget("ui.button",{options:{text:true,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset.button").bind("reset.button",c);this._determineButtonType();this.hasTitle=!!this.buttonElement.attr("title");var a=this,h=this.options,g=this.type==="checkbox"||this.type==="radio",f="ui-state-hover"+(!g?" ui-state-active":"");if(h.label===null){h.label=this.buttonElement.html()}if(this.element.is(":disabled")){h.disabled=true}this.buttonElement.addClass("ui-button ui-widget ui-state-default ui-corner-all").attr("role","button").bind("mouseenter.button",function(){if(!h.disabled){b(this).addClass("ui-state-hover");this===e&&b(this).addClass("ui-state-active")}}).bind("mouseleave.button",function(){h.disabled||b(this).removeClass(f)}).bind("focus.button",function(){b(this).addClass("ui-state-focus")}).bind("blur.button",function(){b(this).removeClass("ui-state-focus")});g&&this.element.bind("change.button",function(){a.refresh()});if(this.type==="checkbox"){this.buttonElement.bind("click.button",function(){if(h.disabled){return false}b(this).toggleClass("ui-state-active");a.buttonElement.attr("aria-pressed",a.element[0].checked)})}else{if(this.type==="radio"){this.buttonElement.bind("click.button",function(){if(h.disabled){return false}b(this).addClass("ui-state-active");a.buttonElement.attr("aria-pressed",true);var i=a.element[0];d(i).not(i).map(function(){return b(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed",false)})}else{this.buttonElement.bind("mousedown.button",function(){if(h.disabled){return false}b(this).addClass("ui-state-active");e=this;b(document).one("mouseup",function(){e=null})}).bind("mouseup.button",function(){if(h.disabled){return false}b(this).removeClass("ui-state-active")}).bind("keydown.button",function(i){if(h.disabled){return false}if(i.keyCode==b.ui.keyCode.SPACE||i.keyCode==b.ui.keyCode.ENTER){b(this).addClass("ui-state-active")}}).bind("keyup.button",function(){b(this).removeClass("ui-state-active")});this.buttonElement.is("a")&&this.buttonElement.keyup(function(i){i.keyCode===b.ui.keyCode.SPACE&&b(this).click()})}}this._setOption("disabled",h.disabled)},_determineButtonType:function(){this.type=this.element.is(":checkbox")?"checkbox":this.element.is(":radio")?"radio":this.element.is("input")?"input":"button";if(this.type==="checkbox"||this.type==="radio"){this.buttonElement=this.element.parents().last().find("[for="+this.element.attr("id")+"]");this.element.addClass("ui-helper-hidden-accessible");var a=this.element.is(":checked");a&&this.buttonElement.addClass("ui-state-active");this.buttonElement.attr("aria-pressed",a)}else{this.buttonElement=this.element}},widget:function(){return this.buttonElement},destroy:function(){this.element.removeClass("ui-helper-hidden-accessible");this.buttonElement.removeClass("ui-button ui-widget ui-state-default ui-corner-all ui-state-hover ui-state-active  ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon ui-button-text-only").removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html());this.hasTitle||this.buttonElement.removeAttr("title");b.Widget.prototype.destroy.call(this)},_setOption:function(a,f){b.Widget.prototype._setOption.apply(this,arguments);if(a==="disabled"){f?this.element.attr("disabled",true):this.element.removeAttr("disabled")}this._resetButton()},refresh:function(){var a=this.element.is(":disabled");a!==this.options.disabled&&this._setOption("disabled",a);if(this.type==="radio"){d(this.element[0]).each(function(){b(this).is(":checked")?b(this).button("widget").addClass("ui-state-active").attr("aria-pressed",true):b(this).button("widget").removeClass("ui-state-active").attr("aria-pressed",false)})}else{if(this.type==="checkbox"){this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed",true):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed",false)}}},_resetButton:function(){if(this.type==="input"){this.options.label&&this.element.val(this.options.label)}else{var a=this.buttonElement.removeClass("ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon ui-button-text-only"),h=b("<span></span>").addClass("ui-button-text").html(this.options.label).appendTo(a.empty()).text(),g=this.options.icons,f=g.primary&&g.secondary;if(g.primary||g.secondary){a.addClass("ui-button-text-icon"+(f?"s":""));g.primary&&a.prepend("<span class='ui-button-icon-primary ui-icon "+g.primary+"'></span>");g.secondary&&a.append("<span class='ui-button-icon-secondary ui-icon "+g.secondary+"'></span>");if(!this.options.text){a.addClass(f?"ui-button-icons-only":"ui-button-icon-only").removeClass("ui-button-text-icons ui-button-text-icon");this.hasTitle||a.attr("title",h)}}else{a.addClass("ui-button-text-only")}}}});b.widget("ui.buttonset",{_create:function(){this.element.addClass("ui-buttonset");this._init()},_init:function(){this.refresh()},_setOption:function(a,f){a==="disabled"&&this.buttons.button("option",a,f);b.Widget.prototype._setOption.apply(this,arguments)},refresh:function(){this.buttons=this.element.find(":button, :submit, :reset, :checkbox, :radio, a, :data(button)").filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return b(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass("ui-corner-left").end().filter(":last").addClass("ui-corner-right").end().end()},destroy:function(){this.element.removeClass("ui-buttonset");this.buttons.map(function(){return b(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy");b.Widget.prototype.destroy.call(this)}})})(jQuery);(function(d){function J(){this.debug=false;this._curInst=null;this._keyEvent=false;this._disabledInputs=[];this._inDialog=this._datepickerShowing=false;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass="ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:false,showMonthAfterYear:false,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:false,hideIfNoPrevNext:false,navigationAsDateFormat:false,gotoCurrent:false,changeMonth:false,changeYear:false,yearRange:"c-10:c+10",showOtherMonths:false,selectOtherMonths:false,showWeek:false,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:true,showButtonPanel:false,autoSize:false};d.extend(this._defaults,this.regional[""]);this.dpDiv=d('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all ui-helper-hidden-accessible"></div>')}function E(a,b){d.extend(a,b);for(var c in b){if(b[c]==null||b[c]==undefined){a[c]=b[c]}}return a}d.extend(d.ui,{datepicker:{version:"1.8.2"}});var y=(new Date).getTime();d.extend(J.prototype,{markerClassName:"hasDatepicker",log:function(){this.debug&&console.log.apply("",arguments)},_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(a){E(this._defaults,a||{});return this},_attachDatepicker:function(a,b){var c=null;for(var e in this._defaults){var f=a.getAttribute("date:"+e);if(f){c=c||{};try{c[e]=eval(f)}catch(h){c[e]=f}}}e=a.nodeName.toLowerCase();f=e=="div"||e=="span";if(!a.id){this.uuid+=1;a.id="dp"+this.uuid}var i=this._newInst(d(a),f);i.settings=d.extend({},b||{},c||{});if(e=="input"){this._connectDatepicker(a,i)}else{f&&this._inlineDatepicker(a,i)}},_newInst:function(a,b){return{id:a[0].id.replace(/([^A-Za-z0-9_])/g,"\\\\$1"),input:a,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:b,dpDiv:!b?this.dpDiv:d('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>')}},_connectDatepicker:function(a,b){var c=d(a);b.append=d([]);b.trigger=d([]);if(!c.hasClass(this.markerClassName)){this._attachments(c,b);c.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",function(e,f,h){b.settings[f]=h}).bind("getData.datepicker",function(e,f){return this._get(b,f)});this._autoSize(b);d.data(a,"datepicker",b)}},_attachments:function(a,b){var c=this._get(b,"appendText"),e=this._get(b,"isRTL");b.append&&b.append.remove();if(c){b.append=d('<span class="'+this._appendClass+'">'+c+"</span>");a[e?"before":"after"](b.append)}a.unbind("focus",this._showDatepicker);b.trigger&&b.trigger.remove();c=this._get(b,"showOn");if(c=="focus"||c=="both"){a.focus(this._showDatepicker)}if(c=="button"||c=="both"){c=this._get(b,"buttonText");var f=this._get(b,"buttonImage");b.trigger=d(this._get(b,"buttonImageOnly")?d("<img/>").addClass(this._triggerClass).attr({src:f,alt:c,title:c}):d('<button type="button"></button>').addClass(this._triggerClass).html(f==""?c:d("<img/>").attr({src:f,alt:c,title:c})));a[e?"before":"after"](b.trigger);b.trigger.click(function(){d.datepicker._datepickerShowing&&d.datepicker._lastInput==a[0]?d.datepicker._hideDatepicker():d.datepicker._showDatepicker(a[0]);return false})}},_autoSize:function(a){if(this._get(a,"autoSize")&&!a.inline){var b=new Date(2009,11,20),c=this._get(a,"dateFormat");if(c.match(/[DM]/)){var e=function(f){for(var h=0,i=0,g=0;g<f.length;g++){if(f[g].length>h){h=f[g].length;i=g}}return i};b.setMonth(e(this._get(a,c.match(/MM/)?"monthNames":"monthNamesShort")));b.setDate(e(this._get(a,c.match(/DD/)?"dayNames":"dayNamesShort"))+20-b.getDay())}a.input.attr("size",this._formatDate(a,b).length)}},_inlineDatepicker:function(a,b){var c=d(a);if(!c.hasClass(this.markerClassName)){c.addClass(this.markerClassName).append(b.dpDiv).bind("setData.datepicker",function(e,f,h){b.settings[f]=h}).bind("getData.datepicker",function(e,f){return this._get(b,f)});d.data(a,"datepicker",b);this._setDate(b,this._getDefaultDate(b),true);this._updateDatepicker(b);this._updateAlternate(b)}},_dialogDatepicker:function(a,b,c,e,f){a=this._dialogInst;if(!a){this.uuid+=1;this._dialogInput=d('<input type="text" id="'+("dp"+this.uuid)+'" style="position: absolute; top: -100px; width: 0px; z-index: -10;"/>');this._dialogInput.keydown(this._doKeyDown);d("body").append(this._dialogInput);a=this._dialogInst=this._newInst(this._dialogInput,false);a.settings={};d.data(this._dialogInput[0],"datepicker",a)}E(a.settings,e||{});b=b&&b.constructor==Date?this._formatDate(a,b):b;this._dialogInput.val(b);this._pos=f?f.length?f:[f.pageX,f.pageY]:null;if(!this._pos){this._pos=[document.documentElement.clientWidth/2-100+(document.documentElement.scrollLeft||document.body.scrollLeft),document.documentElement.clientHeight/2-150+(document.documentElement.scrollTop||document.body.scrollTop)]}this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px");a.settings.onSelect=c;this._inDialog=true;this.dpDiv.addClass(this._dialogClass);this._showDatepicker(this._dialogInput[0]);d.blockUI&&d.blockUI(this.dpDiv);d.data(this._dialogInput[0],"datepicker",a);return this},_destroyDatepicker:function(a){var b=d(a),c=d.data(a,"datepicker");if(b.hasClass(this.markerClassName)){var e=a.nodeName.toLowerCase();d.removeData(a,"datepicker");if(e=="input"){c.append.remove();c.trigger.remove();b.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)}else{if(e=="div"||e=="span"){b.removeClass(this.markerClassName).empty()}}}},_enableDatepicker:function(a){var b=d(a),c=d.data(a,"datepicker");if(b.hasClass(this.markerClassName)){var e=a.nodeName.toLowerCase();if(e=="input"){a.disabled=false;c.trigger.filter("button").each(function(){this.disabled=false}).end().filter("img").css({opacity:"1.0",cursor:""})}else{if(e=="div"||e=="span"){b.children("."+this._inlineClass).children().removeClass("ui-state-disabled")}}this._disabledInputs=d.map(this._disabledInputs,function(f){return f==a?null:f})}},_disableDatepicker:function(a){var b=d(a),c=d.data(a,"datepicker");if(b.hasClass(this.markerClassName)){var e=a.nodeName.toLowerCase();if(e=="input"){a.disabled=true;c.trigger.filter("button").each(function(){this.disabled=true}).end().filter("img").css({opacity:"0.5",cursor:"default"})}else{if(e=="div"||e=="span"){b.children("."+this._inlineClass).children().addClass("ui-state-disabled")}}this._disabledInputs=d.map(this._disabledInputs,function(f){return f==a?null:f});this._disabledInputs[this._disabledInputs.length]=a}},_isDisabledDatepicker:function(a){if(!a){return false}for(var b=0;b<this._disabledInputs.length;b++){if(this._disabledInputs[b]==a){return true}}return false},_getInst:function(a){try{return d.data(a,"datepicker")}catch(b){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(a,b,c){var e=this._getInst(a);if(arguments.length==2&&typeof b=="string"){return b=="defaults"?d.extend({},d.datepicker._defaults):e?b=="all"?d.extend({},e.settings):this._get(e,b):null}var f=b||{};if(typeof b=="string"){f={};f[b]=c}if(e){this._curInst==e&&this._hideDatepicker();var h=this._getDateDatepicker(a,true);E(e.settings,f);this._attachments(d(a),e);this._autoSize(e);this._setDateDatepicker(a,h);this._updateDatepicker(e)}},_changeDatepicker:function(a,b,c){this._optionDatepicker(a,b,c)},_refreshDatepicker:function(a){(a=this._getInst(a))&&this._updateDatepicker(a)},_setDateDatepicker:function(a,b){if(a=this._getInst(a)){this._setDate(a,b);this._updateDatepicker(a);this._updateAlternate(a)}},_getDateDatepicker:function(a,b){(a=this._getInst(a))&&!a.inline&&this._setDateFromField(a,b);return a?this._getDate(a):null},_doKeyDown:function(a){var b=d.datepicker._getInst(a.target),c=true,e=b.dpDiv.is(".ui-datepicker-rtl");b._keyEvent=true;if(d.datepicker._datepickerShowing){switch(a.keyCode){case 9:d.datepicker._hideDatepicker();c=false;break;case 13:c=d("td."+d.datepicker._dayOverClass,b.dpDiv).add(d("td."+d.datepicker._currentClass,b.dpDiv));c[0]?d.datepicker._selectDay(a.target,b.selectedMonth,b.selectedYear,c[0]):d.datepicker._hideDatepicker();return false;case 27:d.datepicker._hideDatepicker();break;case 33:d.datepicker._adjustDate(a.target,a.ctrlKey?-d.datepicker._get(b,"stepBigMonths"):-d.datepicker._get(b,"stepMonths"),"M");break;case 34:d.datepicker._adjustDate(a.target,a.ctrlKey?+d.datepicker._get(b,"stepBigMonths"):+d.datepicker._get(b,"stepMonths"),"M");break;case 35:if(a.ctrlKey||a.metaKey){d.datepicker._clearDate(a.target)}c=a.ctrlKey||a.metaKey;break;case 36:if(a.ctrlKey||a.metaKey){d.datepicker._gotoToday(a.target)}c=a.ctrlKey||a.metaKey;break;case 37:if(a.ctrlKey||a.metaKey){d.datepicker._adjustDate(a.target,e?+1:-1,"D")}c=a.ctrlKey||a.metaKey;if(a.originalEvent.altKey){d.datepicker._adjustDate(a.target,a.ctrlKey?-d.datepicker._get(b,"stepBigMonths"):-d.datepicker._get(b,"stepMonths"),"M")}break;case 38:if(a.ctrlKey||a.metaKey){d.datepicker._adjustDate(a.target,-7,"D")}c=a.ctrlKey||a.metaKey;break;case 39:if(a.ctrlKey||a.metaKey){d.datepicker._adjustDate(a.target,e?-1:+1,"D")}c=a.ctrlKey||a.metaKey;if(a.originalEvent.altKey){d.datepicker._adjustDate(a.target,a.ctrlKey?+d.datepicker._get(b,"stepBigMonths"):+d.datepicker._get(b,"stepMonths"),"M")}break;case 40:if(a.ctrlKey||a.metaKey){d.datepicker._adjustDate(a.target,+7,"D")}c=a.ctrlKey||a.metaKey;break;default:c=false}}else{if(a.keyCode==36&&a.ctrlKey){d.datepicker._showDatepicker(this)}else{c=false}}if(c){a.preventDefault();a.stopPropagation()}},_doKeyPress:function(a){var b=d.datepicker._getInst(a.target);if(d.datepicker._get(b,"constrainInput")){b=d.datepicker._possibleChars(d.datepicker._get(b,"dateFormat"));var c=String.fromCharCode(a.charCode==undefined?a.keyCode:a.charCode);return a.ctrlKey||c<" "||!b||b.indexOf(c)>-1}},_doKeyUp:function(a){a=d.datepicker._getInst(a.target);if(a.input.val()!=a.lastVal){try{if(d.datepicker.parseDate(d.datepicker._get(a,"dateFormat"),a.input?a.input.val():null,d.datepicker._getFormatConfig(a))){d.datepicker._setDateFromField(a);d.datepicker._updateAlternate(a);d.datepicker._updateDatepicker(a)}}catch(b){d.datepicker.log(b)}}return true},_showDatepicker:function(a){a=a.target||a;if(a.nodeName.toLowerCase()!="input"){a=d("input",a.parentNode)[0]}if(!(d.datepicker._isDisabledDatepicker(a)||d.datepicker._lastInput==a)){var b=d.datepicker._getInst(a);d.datepicker._curInst&&d.datepicker._curInst!=b&&d.datepicker._curInst.dpDiv.stop(true,true);var c=d.datepicker._get(b,"beforeShow");E(b.settings,c?c.apply(a,[a,b]):{});b.lastVal=null;d.datepicker._lastInput=a;d.datepicker._setDateFromField(b);if(d.datepicker._inDialog){a.value=""}if(!d.datepicker._pos){d.datepicker._pos=d.datepicker._findPos(a);d.datepicker._pos[1]+=a.offsetHeight}var e=false;d(a).parents().each(function(){e|=d(this).css("position")=="fixed";return !e});if(e&&d.browser.opera){d.datepicker._pos[0]-=document.documentElement.scrollLeft;d.datepicker._pos[1]-=document.documentElement.scrollTop}c={left:d.datepicker._pos[0],top:d.datepicker._pos[1]};d.datepicker._pos=null;b.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});d.datepicker._updateDatepicker(b);c=d.datepicker._checkOffset(b,c,e);b.dpDiv.css({position:d.datepicker._inDialog&&d.blockUI?"static":e?"fixed":"absolute",display:"none",left:c.left+"px",top:c.top+"px"});if(!b.inline){c=d.datepicker._get(b,"showAnim");var f=d.datepicker._get(b,"duration"),h=function(){d.datepicker._datepickerShowing=true;var i=d.datepicker._getBorders(b.dpDiv);b.dpDiv.find("iframe.ui-datepicker-cover").css({left:-i[0],top:-i[1],width:b.dpDiv.outerWidth(),height:b.dpDiv.outerHeight()})};b.dpDiv.zIndex(d(a).zIndex()+1);d.effects&&d.effects[c]?b.dpDiv.show(c,d.datepicker._get(b,"showOptions"),f,h):b.dpDiv[c||"show"](c?f:null,h);if(!c||!f){h()}b.input.is(":visible")&&!b.input.is(":disabled")&&b.input.focus();d.datepicker._curInst=b}}},_updateDatepicker:function(a){var b=this,c=d.datepicker._getBorders(a.dpDiv);a.dpDiv.empty().append(this._generateHTML(a)).find("iframe.ui-datepicker-cover").css({left:-c[0],top:-c[1],width:a.dpDiv.outerWidth(),height:a.dpDiv.outerHeight()}).end().find("button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a").bind("mouseout",function(){d(this).removeClass("ui-state-hover");this.className.indexOf("ui-datepicker-prev")!=-1&&d(this).removeClass("ui-datepicker-prev-hover");this.className.indexOf("ui-datepicker-next")!=-1&&d(this).removeClass("ui-datepicker-next-hover")}).bind("mouseover",function(){if(!b._isDisabledDatepicker(a.inline?a.dpDiv.parent()[0]:a.input[0])){d(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover");d(this).addClass("ui-state-hover");this.className.indexOf("ui-datepicker-prev")!=-1&&d(this).addClass("ui-datepicker-prev-hover");this.className.indexOf("ui-datepicker-next")!=-1&&d(this).addClass("ui-datepicker-next-hover")}}).end().find("."+this._dayOverClass+" a").trigger("mouseover").end();c=this._getNumberOfMonths(a);var e=c[1];e>1?a.dpDiv.addClass("ui-datepicker-multi-"+e).css("width",17*e+"em"):a.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");a.dpDiv[(c[0]!=1||c[1]!=1?"add":"remove")+"Class"]("ui-datepicker-multi");a.dpDiv[(this._get(a,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");a==d.datepicker._curInst&&d.datepicker._datepickerShowing&&a.input&&a.input.is(":visible")&&!a.input.is(":disabled")&&a.input.focus()},_getBorders:function(a){var b=function(c){return{thin:1,medium:2,thick:3}[c]||c};return[parseFloat(b(a.css("border-left-width"))),parseFloat(b(a.css("border-top-width")))]},_checkOffset:function(a,b,c){var e=a.dpDiv.outerWidth(),f=a.dpDiv.outerHeight(),h=a.input?a.input.outerWidth():0,i=a.input?a.input.outerHeight():0,g=document.documentElement.clientWidth+d(document).scrollLeft(),k=document.documentElement.clientHeight+d(document).scrollTop();b.left-=this._get(a,"isRTL")?e-h:0;b.left-=c&&b.left==a.input.offset().left?d(document).scrollLeft():0;b.top-=c&&b.top==a.input.offset().top+i?d(document).scrollTop():0;b.left-=Math.min(b.left,b.left+e>g&&g>e?Math.abs(b.left+e-g):0);b.top-=Math.min(b.top,b.top+f>k&&k>f?Math.abs(f+i):0);return b},_findPos:function(a){for(var b=this._get(this._getInst(a),"isRTL");a&&(a.type=="hidden"||a.nodeType!=1);){a=a[b?"previousSibling":"nextSibling"]}a=d(a).offset();return[a.left,a.top]},_hideDatepicker:function(a){var b=this._curInst;if(!(!b||a&&b!=d.data(a,"datepicker"))){if(this._datepickerShowing){a=this._get(b,"showAnim");var c=this._get(b,"duration"),e=function(){d.datepicker._tidyDialog(b);this._curInst=null};d.effects&&d.effects[a]?b.dpDiv.hide(a,d.datepicker._get(b,"showOptions"),c,e):b.dpDiv[a=="slideDown"?"slideUp":a=="fadeIn"?"fadeOut":"hide"](a?c:null,e);a||e();if(a=this._get(b,"onClose")){a.apply(b.input?b.input[0]:null,[b.input?b.input.val():"",b])}this._datepickerShowing=false;this._lastInput=null;if(this._inDialog){this._dialogInput.css({position:"absolute",left:"0",top:"-100px"});if(d.blockUI){d.unblockUI();d("body").append(this.dpDiv)}}this._inDialog=false}}},_tidyDialog:function(a){a.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(a){if(d.datepicker._curInst){a=d(a.target);a[0].id!=d.datepicker._mainDivId&&a.parents("#"+d.datepicker._mainDivId).length==0&&!a.hasClass(d.datepicker.markerClassName)&&!a.hasClass(d.datepicker._triggerClass)&&d.datepicker._datepickerShowing&&!(d.datepicker._inDialog&&d.blockUI)&&d.datepicker._hideDatepicker()}},_adjustDate:function(a,b,c){a=d(a);var e=this._getInst(a[0]);if(!this._isDisabledDatepicker(a[0])){this._adjustInstDate(e,b+(c=="M"?this._get(e,"showCurrentAtPos"):0),c);this._updateDatepicker(e)}},_gotoToday:function(a){a=d(a);var b=this._getInst(a[0]);if(this._get(b,"gotoCurrent")&&b.currentDay){b.selectedDay=b.currentDay;b.drawMonth=b.selectedMonth=b.currentMonth;b.drawYear=b.selectedYear=b.currentYear}else{var c=new Date;b.selectedDay=c.getDate();b.drawMonth=b.selectedMonth=c.getMonth();b.drawYear=b.selectedYear=c.getFullYear()}this._notifyChange(b);this._adjustDate(a)},_selectMonthYear:function(a,b,c){a=d(a);var e=this._getInst(a[0]);e._selectingMonthYear=false;e["selected"+(c=="M"?"Month":"Year")]=e["draw"+(c=="M"?"Month":"Year")]=parseInt(b.options[b.selectedIndex].value,10);this._notifyChange(e);this._adjustDate(a)},_clickMonthYear:function(a){a=this._getInst(d(a)[0]);a.input&&a._selectingMonthYear&&!d.browser.msie&&a.input.focus();a._selectingMonthYear=!a._selectingMonthYear},_selectDay:function(a,b,c,e){var f=d(a);if(!(d(e).hasClass(this._unselectableClass)||this._isDisabledDatepicker(f[0]))){f=this._getInst(f[0]);f.selectedDay=f.currentDay=d("a",e).html();f.selectedMonth=f.currentMonth=b;f.selectedYear=f.currentYear=c;this._selectDate(a,this._formatDate(f,f.currentDay,f.currentMonth,f.currentYear))}},_clearDate:function(a){a=d(a);this._getInst(a[0]);this._selectDate(a,"")},_selectDate:function(a,b){a=this._getInst(d(a)[0]);b=b!=null?b:this._formatDate(a);a.input&&a.input.val(b);this._updateAlternate(a);var c=this._get(a,"onSelect");if(c){c.apply(a.input?a.input[0]:null,[b,a])}else{a.input&&a.input.trigger("change")}if(a.inline){this._updateDatepicker(a)}else{this._hideDatepicker();this._lastInput=a.input[0];typeof a.input[0]!="object"&&a.input.focus();this._lastInput=null}},_updateAlternate:function(a){var b=this._get(a,"altField");if(b){var c=this._get(a,"altFormat")||this._get(a,"dateFormat"),e=this._getDate(a),f=this.formatDate(c,e,this._getFormatConfig(a));d(b).each(function(){d(this).val(f)})}},noWeekends:function(a){a=a.getDay();return[a>0&&a<6,""]},iso8601Week:function(a){a=new Date(a.getTime());a.setDate(a.getDate()+4-(a.getDay()||7));var b=a.getTime();a.setMonth(0);a.setDate(1);return Math.floor(Math.round((b-a)/86400000)/7)+1},parseDate:function(a,b,c){if(a==null||b==null){throw"Invalid arguments"}b=typeof b=="object"?b.toString():b+"";if(b==""){return null}for(var e=(c?c.shortYearCutoff:null)||this._defaults.shortYearCutoff,f=(c?c.dayNamesShort:null)||this._defaults.dayNamesShort,h=(c?c.dayNames:null)||this._defaults.dayNames,i=(c?c.monthNamesShort:null)||this._defaults.monthNamesShort,g=(c?c.monthNames:null)||this._defaults.monthNames,k=c=-1,l=-1,u=-1,j=false,o=function(p){(p=z+1<a.length&&a.charAt(z+1)==p)&&z++;return p},m=function(p){o(p);p=new RegExp("^\\d{1,"+(p=="@"?14:p=="!"?20:p=="y"?4:p=="o"?3:2)+"}");p=b.substring(s).match(p);if(!p){throw"Missing number at position "+s}s+=p[0].length;return parseInt(p[0],10)},n=function(p,w,G){p=o(p)?G:w;for(w=0;w<p.length;w++){if(b.substr(s,p[w].length)==p[w]){s+=p[w].length;return w+1}}throw"Unknown name at position "+s},r=function(){if(b.charAt(s)!=a.charAt(z)){throw"Unexpected literal at position "+s}s++},s=0,z=0;z<a.length;z++){if(j){if(a.charAt(z)=="'"&&!o("'")){j=false}else{r()}}else{switch(a.charAt(z)){case"d":l=m("d");break;case"D":n("D",f,h);break;case"o":u=m("o");break;case"m":k=m("m");break;case"M":k=n("M",i,g);break;case"y":c=m("y");break;case"@":var v=new Date(m("@"));c=v.getFullYear();k=v.getMonth()+1;l=v.getDate();break;case"!":v=new Date((m("!")-this._ticksTo1970)/10000);c=v.getFullYear();k=v.getMonth()+1;l=v.getDate();break;case"'":if(o("'")){r()}else{j=true}break;default:r()}}}if(c==-1){c=(new Date).getFullYear()}else{if(c<100){c+=(new Date).getFullYear()-(new Date).getFullYear()%100+(c<=e?0:-100)}}if(u>-1){k=1;l=u;do{e=this._getDaysInMonth(c,k-1);if(l<=e){break}k++;l-=e}while(1)}v=this._daylightSavingAdjust(new Date(c,k-1,l));if(v.getFullYear()!=c||v.getMonth()+1!=k||v.getDate()!=l){throw"Invalid date"}return v},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*24*60*60*10000000,formatDate:function(a,b,c){if(!b){return""}var e=(c?c.dayNamesShort:null)||this._defaults.dayNamesShort,f=(c?c.dayNames:null)||this._defaults.dayNames,h=(c?c.monthNamesShort:null)||this._defaults.monthNamesShort;c=(c?c.monthNames:null)||this._defaults.monthNames;var i=function(o){(o=j+1<a.length&&a.charAt(j+1)==o)&&j++;return o},g=function(o,m,n){m=""+m;if(i(o)){for(;m.length<n;){m="0"+m}}return m},k=function(o,m,n,r){return i(o)?r[m]:n[m]},l="",u=false;if(b){for(var j=0;j<a.length;j++){if(u){if(a.charAt(j)=="'"&&!i("'")){u=false}else{l+=a.charAt(j)}}else{switch(a.charAt(j)){case"d":l+=g("d",b.getDate(),2);break;case"D":l+=k("D",b.getDay(),e,f);break;case"o":l+=g("o",(b.getTime()-(new Date(b.getFullYear(),0,0)).getTime())/86400000,3);break;case"m":l+=g("m",b.getMonth()+1,2);break;case"M":l+=k("M",b.getMonth(),h,c);break;case"y":l+=i("y")?b.getFullYear():(b.getYear()%100<10?"0":"")+b.getYear()%100;break;case"@":l+=b.getTime();break;case"!":l+=b.getTime()*10000+this._ticksTo1970;break;case"'":if(i("'")){l+="'"}else{u=true}break;default:l+=a.charAt(j)}}}}return l},_possibleChars:function(a){for(var b="",c=false,e=function(h){(h=f+1<a.length&&a.charAt(f+1)==h)&&f++;return h},f=0;f<a.length;f++){if(c){if(a.charAt(f)=="'"&&!e("'")){c=false}else{b+=a.charAt(f)}}else{switch(a.charAt(f)){case"d":case"m":case"y":case"@":b+="0123456789";break;case"D":case"M":return null;case"'":if(e("'")){b+="'"}else{c=true}break;default:b+=a.charAt(f)}}}return b},_get:function(a,b){return a.settings[b]!==undefined?a.settings[b]:this._defaults[b]},_setDateFromField:function(a,b){if(a.input.val()!=a.lastVal){var c=this._get(a,"dateFormat"),e=a.lastVal=a.input?a.input.val():null,f,h;f=h=this._getDefaultDate(a);var i=this._getFormatConfig(a);try{f=this.parseDate(c,e,i)||h}catch(g){this.log(g);e=b?"":e}a.selectedDay=f.getDate();a.drawMonth=a.selectedMonth=f.getMonth();a.drawYear=a.selectedYear=f.getFullYear();a.currentDay=e?f.getDate():0;a.currentMonth=e?f.getMonth():0;a.currentYear=e?f.getFullYear():0;this._adjustInstDate(a)}},_getDefaultDate:function(a){return this._restrictMinMax(a,this._determineDate(a,this._get(a,"defaultDate"),new Date))},_determineDate:function(a,b,c){var e=function(h){var i=new Date;i.setDate(i.getDate()+h);return i},f=function(h){try{return d.datepicker.parseDate(d.datepicker._get(a,"dateFormat"),h,d.datepicker._getFormatConfig(a))}catch(i){}var g=(h.toLowerCase().match(/^c/)?d.datepicker._getDate(a):null)||new Date,k=g.getFullYear(),l=g.getMonth();g=g.getDate();for(var u=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,j=u.exec(h);j;){switch(j[2]||"d"){case"d":case"D":g+=parseInt(j[1],10);break;case"w":case"W":g+=parseInt(j[1],10)*7;break;case"m":case"M":l+=parseInt(j[1],10);g=Math.min(g,d.datepicker._getDaysInMonth(k,l));break;case"y":case"Y":k+=parseInt(j[1],10);g=Math.min(g,d.datepicker._getDaysInMonth(k,l));break}j=u.exec(h)}return new Date(k,l,g)};if(b=(b=b==null?c:typeof b=="string"?f(b):typeof b=="number"?isNaN(b)?c:e(b):b)&&b.toString()=="Invalid Date"?c:b){b.setHours(0);b.setMinutes(0);b.setSeconds(0);b.setMilliseconds(0)}return this._daylightSavingAdjust(b)},_daylightSavingAdjust:function(a){if(!a){return null}a.setHours(a.getHours()>12?a.getHours()+2:0);return a},_setDate:function(a,b,c){var e=!b,f=a.selectedMonth,h=a.selectedYear;b=this._restrictMinMax(a,this._determineDate(a,b,new Date));a.selectedDay=a.currentDay=b.getDate();a.drawMonth=a.selectedMonth=a.currentMonth=b.getMonth();a.drawYear=a.selectedYear=a.currentYear=b.getFullYear();if((f!=a.selectedMonth||h!=a.selectedYear)&&!c){this._notifyChange(a)}this._adjustInstDate(a);if(a.input){a.input.val(e?"":this._formatDate(a))}},_getDate:function(a){return !a.currentYear||a.input&&a.input.val()==""?null:this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay))},_generateHTML:function(a){var b=new Date;b=this._daylightSavingAdjust(new Date(b.getFullYear(),b.getMonth(),b.getDate()));var c=this._get(a,"isRTL"),e=this._get(a,"showButtonPanel"),f=this._get(a,"hideIfNoPrevNext"),h=this._get(a,"navigationAsDateFormat"),i=this._getNumberOfMonths(a),g=this._get(a,"showCurrentAtPos"),k=this._get(a,"stepMonths"),l=i[0]!=1||i[1]!=1,u=this._daylightSavingAdjust(!a.currentDay?new Date(9999,9,9):new Date(a.currentYear,a.currentMonth,a.currentDay)),j=this._getMinMaxDate(a,"min"),o=this._getMinMaxDate(a,"max");g=a.drawMonth-g;var m=a.drawYear;if(g<0){g+=12;m--}if(o){var n=this._daylightSavingAdjust(new Date(o.getFullYear(),o.getMonth()-i[0]*i[1]+1,o.getDate()));for(n=j&&n<j?j:n;this._daylightSavingAdjust(new Date(m,g,1))>n;){g--;if(g<0){g=11;m--}}}a.drawMonth=g;a.drawYear=m;n=this._get(a,"prevText");n=!h?n:this.formatDate(n,this._daylightSavingAdjust(new Date(m,g-k,1)),this._getFormatConfig(a));n=this._canAdjustMonth(a,-1,m,g)?'<a class="ui-datepicker-prev ui-corner-all" onclick="DP_jQuery_'+y+".datepicker._adjustDate('#"+a.id+"', -"+k+", 'M');\" title=\""+n+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"e":"w")+'">'+n+"</span></a>":f?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+n+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"e":"w")+'">'+n+"</span></a>";var r=this._get(a,"nextText");r=!h?r:this.formatDate(r,this._daylightSavingAdjust(new Date(m,g+k,1)),this._getFormatConfig(a));f=this._canAdjustMonth(a,+1,m,g)?'<a class="ui-datepicker-next ui-corner-all" onclick="DP_jQuery_'+y+".datepicker._adjustDate('#"+a.id+"', +"+k+", 'M');\" title=\""+r+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"w":"e")+'">'+r+"</span></a>":f?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+r+'"><span class="ui-icon ui-icon-circle-triangle-'+(c?"w":"e")+'">'+r+"</span></a>";k=this._get(a,"currentText");r=this._get(a,"gotoCurrent")&&a.currentDay?u:b;k=!h?k:this.formatDate(k,r,this._getFormatConfig(a));h=!a.inline?'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" onclick="DP_jQuery_'+y+'.datepicker._hideDatepicker();">'+this._get(a,"closeText")+"</button>":"";e=e?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(c?h:"")+(this._isInRange(a,r)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" onclick="DP_jQuery_'+y+".datepicker._gotoToday('#"+a.id+"');\">"+k+"</button>":"")+(c?"":h)+"</div>":"";h=parseInt(this._get(a,"firstDay"),10);h=isNaN(h)?0:h;k=this._get(a,"showWeek");r=this._get(a,"dayNames");this._get(a,"dayNamesShort");var s=this._get(a,"dayNamesMin"),z=this._get(a,"monthNames"),v=this._get(a,"monthNamesShort"),p=this._get(a,"beforeShowDay"),w=this._get(a,"showOtherMonths"),G=this._get(a,"selectOtherMonths");this._get(a,"calculateWeek");for(var K=this._getDefaultDate(a),H="",C=0;C<i[0];C++){for(var L="",D=0;D<i[1];D++){var M=this._daylightSavingAdjust(new Date(m,g,a.selectedDay)),t=" ui-corner-all",x="";if(l){x+='<div class="ui-datepicker-group';if(i[1]>1){switch(D){case 0:x+=" ui-datepicker-group-first";t=" ui-corner-"+(c?"right":"left");break;case i[1]-1:x+=" ui-datepicker-group-last";t=" ui-corner-"+(c?"left":"right");break;default:x+=" ui-datepicker-group-middle";t="";break}}x+='">'}x+='<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+t+'">'+(/all|left/.test(t)&&C==0?c?f:n:"")+(/all|right/.test(t)&&C==0?c?n:f:"")+this._generateMonthYearHeader(a,g,m,j,o,C>0||D>0,z,v)+'</div><table class="ui-datepicker-calendar"><thead><tr>';var A=k?'<th class="ui-datepicker-week-col">'+this._get(a,"weekHeader")+"</th>":"";for(t=0;t<7;t++){var q=(t+h)%7;A+="<th"+((t+h+6)%7>=5?' class="ui-datepicker-week-end"':"")+'><span title="'+r[q]+'">'+s[q]+"</span></th>"}x+=A+"</tr></thead><tbody>";A=this._getDaysInMonth(m,g);if(m==a.selectedYear&&g==a.selectedMonth){a.selectedDay=Math.min(a.selectedDay,A)}t=(this._getFirstDayOfMonth(m,g)-h+7)%7;A=l?6:Math.ceil((t+A)/7);q=this._daylightSavingAdjust(new Date(m,g,1-t));for(var N=0;N<A;N++){x+="<tr>";var O=!k?"":'<td class="ui-datepicker-week-col">'+this._get(a,"calculateWeek")(q)+"</td>";for(t=0;t<7;t++){var F=p?p.apply(a.input?a.input[0]:null,[q]):[true,""],B=q.getMonth()!=g,I=B&&!G||!F[0]||j&&q<j||o&&q>o;O+='<td class="'+((t+h+6)%7>=5?" ui-datepicker-week-end":"")+(B?" ui-datepicker-other-month":"")+(q.getTime()==M.getTime()&&g==a.selectedMonth&&a._keyEvent||K.getTime()==q.getTime()&&K.getTime()==M.getTime()?" "+this._dayOverClass:"")+(I?" "+this._unselectableClass+" ui-state-disabled":"")+(B&&!w?"":" "+F[1]+(q.getTime()==u.getTime()?" "+this._currentClass:"")+(q.getTime()==b.getTime()?" ui-datepicker-today":""))+'"'+((!B||w)&&F[2]?' title="'+F[2]+'"':"")+(I?"":' onclick="DP_jQuery_'+y+".datepicker._selectDay('#"+a.id+"',"+q.getMonth()+","+q.getFullYear()+', this);return false;"')+">"+(B&&!w?"&#xa0;":I?'<span class="ui-state-default">'+q.getDate()+"</span>":'<a class="ui-state-default'+(q.getTime()==b.getTime()?" ui-state-highlight":"")+(q.getTime()==u.getTime()?" ui-state-active":"")+(B?" ui-priority-secondary":"")+'" href="#">'+q.getDate()+"</a>")+"</td>";q.setDate(q.getDate()+1);q=this._daylightSavingAdjust(q)}x+=O+"</tr>"}g++;if(g>11){g=0;m++}x+="</tbody></table>"+(l?"</div>"+(i[0]>0&&D==i[1]-1?'<div class="ui-datepicker-row-break"></div>':""):"");L+=x}H+=L}H+=e+(d.browser.msie&&parseInt(d.browser.version,10)<7&&!a.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':"");a._keyEvent=false;return H},_generateMonthYearHeader:function(a,b,c,e,f,h,i,g){var k=this._get(a,"changeMonth"),l=this._get(a,"changeYear"),u=this._get(a,"showMonthAfterYear"),j='<div class="ui-datepicker-title">',o="";if(h||!k){o+='<span class="ui-datepicker-month">'+i[b]+"</span>"}else{i=e&&e.getFullYear()==c;var m=f&&f.getFullYear()==c;o+='<select class="ui-datepicker-month" onchange="DP_jQuery_'+y+".datepicker._selectMonthYear('#"+a.id+"', this, 'M');\" onclick=\"DP_jQuery_"+y+".datepicker._clickMonthYear('#"+a.id+"');\">";for(var n=0;n<12;n++){if((!i||n>=e.getMonth())&&(!m||n<=f.getMonth())){o+='<option value="'+n+'"'+(n==b?' selected="selected"':"")+">"+g[n]+"</option>"}}o+="</select>"}u||(j+=o+(h||!(k&&l)?"&#xa0;":""));if(h||!l){j+='<span class="ui-datepicker-year">'+c+"</span>"}else{g=this._get(a,"yearRange").split(":");var r=(new Date).getFullYear();i=function(s){s=s.match(/c[+-].*/)?c+parseInt(s.substring(1),10):s.match(/[+-].*/)?r+parseInt(s,10):parseInt(s,10);return isNaN(s)?r:s};b=i(g[0]);g=Math.max(b,i(g[1]||""));b=e?Math.max(b,e.getFullYear()):b;g=f?Math.min(g,f.getFullYear()):g;for(j+='<select class="ui-datepicker-year" onchange="DP_jQuery_'+y+".datepicker._selectMonthYear('#"+a.id+"', this, 'Y');\" onclick=\"DP_jQuery_"+y+".datepicker._clickMonthYear('#"+a.id+"');\">";b<=g;b++){j+='<option value="'+b+'"'+(b==c?' selected="selected"':"")+">"+b+"</option>"}j+="</select>"}j+=this._get(a,"yearSuffix");if(u){j+=(h||!(k&&l)?"&#xa0;":"")+o}j+="</div>";return j},_adjustInstDate:function(a,b,c){var e=a.drawYear+(c=="Y"?b:0),f=a.drawMonth+(c=="M"?b:0);b=Math.min(a.selectedDay,this._getDaysInMonth(e,f))+(c=="D"?b:0);e=this._restrictMinMax(a,this._daylightSavingAdjust(new Date(e,f,b)));a.selectedDay=e.getDate();a.drawMonth=a.selectedMonth=e.getMonth();a.drawYear=a.selectedYear=e.getFullYear();if(c=="M"||c=="Y"){this._notifyChange(a)}},_restrictMinMax:function(a,b){var c=this._getMinMaxDate(a,"min");a=this._getMinMaxDate(a,"max");b=c&&b<c?c:b;return b=a&&b>a?a:b},_notifyChange:function(a){var b=this._get(a,"onChangeMonthYear");if(b){b.apply(a.input?a.input[0]:null,[a.selectedYear,a.selectedMonth+1,a])}},_getNumberOfMonths:function(a){a=this._get(a,"numberOfMonths");return a==null?[1,1]:typeof a=="number"?[1,a]:a},_getMinMaxDate:function(a,b){return this._determineDate(a,this._get(a,b+"Date"),null)},_getDaysInMonth:function(a,b){return 32-(new Date(a,b,32)).getDate()},_getFirstDayOfMonth:function(a,b){return(new Date(a,b,1)).getDay()},_canAdjustMonth:function(a,b,c,e){var f=this._getNumberOfMonths(a);c=this._daylightSavingAdjust(new Date(c,e+(b<0?b:f[0]*f[1]),1));b<0&&c.setDate(this._getDaysInMonth(c.getFullYear(),c.getMonth()));return this._isInRange(a,c)},_isInRange:function(a,b){var c=this._getMinMaxDate(a,"min");a=this._getMinMaxDate(a,"max");return(!c||b.getTime()>=c.getTime())&&(!a||b.getTime()<=a.getTime())},_getFormatConfig:function(a){var b=this._get(a,"shortYearCutoff");b=typeof b!="string"?b:(new Date).getFullYear()%100+parseInt(b,10);return{shortYearCutoff:b,dayNamesShort:this._get(a,"dayNamesShort"),dayNames:this._get(a,"dayNames"),monthNamesShort:this._get(a,"monthNamesShort"),monthNames:this._get(a,"monthNames")}},_formatDate:function(a,b,c,e){if(!b){a.currentDay=a.selectedDay;a.currentMonth=a.selectedMonth;a.currentYear=a.selectedYear}b=b?typeof b=="object"?b:this._daylightSavingAdjust(new Date(e,c,b)):this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay));return this.formatDate(this._get(a,"dateFormat"),b,this._getFormatConfig(a))}});d.fn.datepicker=function(a){if(!d.datepicker.initialized){d(document).mousedown(d.datepicker._checkExternalClick).find("body").append(d.datepicker.dpDiv);d.datepicker.initialized=true}var b=Array.prototype.slice.call(arguments,1);if(typeof a=="string"&&(a=="isDisabled"||a=="getDate"||a=="widget")){return d.datepicker["_"+a+"Datepicker"].apply(d.datepicker,[this[0]].concat(b))}if(a=="option"&&arguments.length==2&&typeof arguments[1]=="string"){return d.datepicker["_"+a+"Datepicker"].apply(d.datepicker,[this[0]].concat(b))}return this.each(function(){typeof a=="string"?d.datepicker["_"+a+"Datepicker"].apply(d.datepicker,[this].concat(b)):d.datepicker._attachDatepicker(this,a)})};d.datepicker=new J;d.datepicker.initialized=false;d.datepicker.uuid=(new Date).getTime();d.datepicker.version="1.8.2";window["DP_jQuery_"+y]=d})(jQuery);(function(a){a.widget("ui.dialog",{options:{autoOpen:true,buttons:{},closeOnEscape:true,closeText:"close",dialogClass:"",draggable:true,hide:null,height:"auto",maxHeight:false,maxWidth:false,minHeight:150,minWidth:150,modal:false,position:"center",resizable:true,show:null,stack:true,title:"",width:300,zIndex:1000},_create:function(){this.originalTitle=this.element.attr("title");var i=this,c=i.options,n=c.title||i.originalTitle||"&#160;",m=a.ui.dialog.getTitleId(i.element),k=(i.uiDialog=a("<div></div>")).appendTo(document.body).hide().addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+c.dialogClass).css({zIndex:c.zIndex}).attr("tabIndex",-1).css("outline",0).keydown(function(b){if(c.closeOnEscape&&b.keyCode&&b.keyCode===a.ui.keyCode.ESCAPE){i.close(b);b.preventDefault()}}).attr({role:"dialog","aria-labelledby":m}).mousedown(function(b){i.moveToTop(false,b)});i.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(k);var l=(i.uiDialogTitlebar=a("<div></div>")).addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(k),j=a('<a href="#"></a>').addClass("ui-dialog-titlebar-close ui-corner-all").attr("role","button").hover(function(){j.addClass("ui-state-hover")},function(){j.removeClass("ui-state-hover")}).focus(function(){j.addClass("ui-state-focus")}).blur(function(){j.removeClass("ui-state-focus")}).click(function(b){i.close(b);return false}).appendTo(l);(i.uiDialogTitlebarCloseText=a("<span></span>")).addClass("ui-icon ui-icon-closethick").text(c.closeText).appendTo(j);a("<span></span>").addClass("ui-dialog-title").attr("id",m).html(n).prependTo(l);if(a.isFunction(c.beforeclose)&&!a.isFunction(c.beforeClose)){c.beforeClose=c.beforeclose}l.find("*").add(l).disableSelection();c.draggable&&a.fn.draggable&&i._makeDraggable();c.resizable&&a.fn.resizable&&i._makeResizable();i._createButtons(c.buttons);i._isOpen=false;a.fn.bgiframe&&k.bgiframe()},_init:function(){this.options.autoOpen&&this.open()},destroy:function(){var b=this;b.overlay&&b.overlay.destroy();b.uiDialog.hide();b.element.unbind(".dialog").removeData("dialog").removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body");b.uiDialog.remove();b.originalTitle&&b.element.attr("title",b.originalTitle);return b},widget:function(){return this.uiDialog},close:function(e){var c=this,f;if(false!==c._trigger("beforeClose",e)){c.overlay&&c.overlay.destroy();c.uiDialog.unbind("keypress.ui-dialog");c._isOpen=false;if(c.options.hide){c.uiDialog.hide(c.options.hide,function(){c._trigger("close",e)})}else{c.uiDialog.hide();c._trigger("close",e)}a.ui.dialog.overlay.resize();if(c.options.modal){f=0;a(".ui-dialog").each(function(){if(this!==c.uiDialog[0]){f=Math.max(f,a(this).css("z-index"))}});a.ui.dialog.maxZ=f}return c}},isOpen:function(){return this._isOpen},moveToTop:function(f,c){var h=this,g=h.options;if(g.modal&&!f||!g.stack&&!g.modal){return h._trigger("focus",c)}if(g.zIndex>a.ui.dialog.maxZ){a.ui.dialog.maxZ=g.zIndex}if(h.overlay){a.ui.dialog.maxZ+=1;h.overlay.$el.css("z-index",a.ui.dialog.overlay.maxZ=a.ui.dialog.maxZ)}f={scrollTop:h.element.attr("scrollTop"),scrollLeft:h.element.attr("scrollLeft")};a.ui.dialog.maxZ+=1;h.uiDialog.css("z-index",a.ui.dialog.maxZ);h.element.attr(f);h._trigger("focus",c);return h},open:function(){if(!this._isOpen){var e=this,c=e.options,f=e.uiDialog;e.overlay=c.modal?new a.ui.dialog.overlay(e):null;f.next().length&&f.appendTo("body");e._size();e._position(c.position);f.show(c.show);e.moveToTop(true);c.modal&&f.bind("keypress.ui-dialog",function(h){if(h.keyCode===a.ui.keyCode.TAB){var b=a(":tabbable",this),d=b.filter(":first");b=b.filter(":last");if(h.target===b[0]&&!h.shiftKey){d.focus(1);return false}else{if(h.target===d[0]&&h.shiftKey){b.focus(1);return false}}}});a([]).add(f.find(".ui-dialog-content :tabbable:first")).add(f.find(".ui-dialog-buttonpane :tabbable:first")).add(f).filter(":first").focus();e._trigger("open");e._isOpen=true;return e}},_createButtons:function(f){var c=this,h=false,g=a("<div></div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix");c.uiDialog.find(".ui-dialog-buttonpane").remove();typeof f==="object"&&f!==null&&a.each(f,function(){return !(h=true)});if(h){a.each(f,function(b,d){b=a('<button type="button"></button>').text(b).click(function(){d.apply(c.element[0],arguments)}).appendTo(g);a.fn.button&&b.button()});g.appendTo(c.uiDialog)}},_makeDraggable:function(){function f(b){return{position:b.position,offset:b.offset}}var c=this,j=c.options,i=a(document),h;c.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(d,b){h=j.height==="auto"?"auto":a(this).height();a(this).height(a(this).height()).addClass("ui-dialog-dragging");c._trigger("dragStart",d,f(b))},drag:function(d,b){c._trigger("drag",d,f(b))},stop:function(d,b){j.position=[b.position.left-i.scrollLeft(),b.position.top-i.scrollTop()];a(this).removeClass("ui-dialog-dragging").height(h);c._trigger("dragStop",d,f(b));a.ui.dialog.overlay.resize()}})},_makeResizable:function(f){function c(b){return{originalPosition:b.originalPosition,originalSize:b.originalSize,position:b.position,size:b.size}}f=f===undefined?this.options.resizable:f;var j=this,i=j.options,h=j.uiDialog.css("position");f=typeof f==="string"?f:"n,e,s,w,se,sw,ne,nw";j.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:j.element,maxWidth:i.maxWidth,maxHeight:i.maxHeight,minWidth:i.minWidth,minHeight:j._minHeight(),handles:f,start:function(d,b){a(this).addClass("ui-dialog-resizing");j._trigger("resizeStart",d,c(b))},resize:function(d,b){j._trigger("resize",d,c(b))},stop:function(d,b){a(this).removeClass("ui-dialog-resizing");i.height=a(this).height();i.width=a(this).width();j._trigger("resizeStop",d,c(b));a.ui.dialog.overlay.resize()}}).css("position",h).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var b=this.options;return b.height==="auto"?b.minHeight:Math.min(b.minHeight,b.height)},_position:function(e){var c=[],f=[0,0];e=e||a.ui.dialog.prototype.options.position;if(typeof e==="string"||typeof e==="object"&&"0" in e){c=e.split?e.split(" "):[e[0],e[1]];if(c.length===1){c[1]=c[0]}a.each(["left","top"],function(d,b){if(+c[d]===c[d]){f[d]=c[d];c[d]=b}})}else{if(typeof e==="object"){if("left" in e){c[0]="left";f[0]=e.left}else{if("right" in e){c[0]="right";f[0]=-e.right}}if("top" in e){c[1]="top";f[1]=e.top}else{if("bottom" in e){c[1]="bottom";f[1]=-e.bottom}}}}(e=this.uiDialog.is(":visible"))||this.uiDialog.show();this.uiDialog.css({top:0,left:0}).position({my:c.join(" "),at:c.join(" "),offset:f.join(" "),of:window,collision:"fit",using:function(d){var b=a(this).css(d).offset().top;b<0&&a(this).css("top",d.top-b)}});e||this.uiDialog.hide()},_setOption:function(h,c){var l=this,k=l.uiDialog,i=k.is(":data(resizable)"),j=false;switch(h){case"beforeclose":h="beforeClose";break;case"buttons":l._createButtons(c);break;case"closeText":l.uiDialogTitlebarCloseText.text(""+c);break;case"dialogClass":k.removeClass(l.options.dialogClass).addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+c);break;case"disabled":c?k.addClass("ui-dialog-disabled"):k.removeClass("ui-dialog-disabled");break;case"draggable":c?l._makeDraggable():k.draggable("destroy");break;case"height":j=true;break;case"maxHeight":i&&k.resizable("option","maxHeight",c);j=true;break;case"maxWidth":i&&k.resizable("option","maxWidth",c);j=true;break;case"minHeight":i&&k.resizable("option","minHeight",c);j=true;break;case"minWidth":i&&k.resizable("option","minWidth",c);j=true;break;case"position":l._position(c);break;case"resizable":i&&!c&&k.resizable("destroy");i&&typeof c==="string"&&k.resizable("option","handles",c);!i&&c!==false&&l._makeResizable(c);break;case"title":a(".ui-dialog-title",l.uiDialogTitlebar).html(""+(c||"&#160;"));break;case"width":j=true;break}a.Widget.prototype._setOption.apply(l,arguments);j&&l._size()},_size:function(){var d=this.options,c;this.element.css({width:"auto",minHeight:0,height:0});c=this.uiDialog.css({height:"auto",width:d.width}).height();this.element.css(d.height==="auto"?{minHeight:Math.max(d.minHeight-c,0),height:"auto"}:{minHeight:0,height:Math.max(d.height-c,0)}).show();this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())}});a.extend(a.ui.dialog,{version:"1.8.2",uuid:0,maxZ:0,getTitleId:function(b){b=b.attr("id");if(!b){this.uuid+=1;b=this.uuid}return"ui-dialog-title-"+b},overlay:function(b){this.$el=a.ui.dialog.overlay.create(b)}});a.extend(a.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:a.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(b){return b+".dialog-overlay"}).join(" "),create:function(d){if(this.instances.length===0){setTimeout(function(){a.ui.dialog.overlay.instances.length&&a(document).bind(a.ui.dialog.overlay.events,function(b){return a(b.target).zIndex()>=a.ui.dialog.overlay.maxZ})},1);a(document).bind("keydown.dialog-overlay",function(b){if(d.options.closeOnEscape&&b.keyCode&&b.keyCode===a.ui.keyCode.ESCAPE){d.close(b);b.preventDefault()}});a(window).bind("resize.dialog-overlay",a.ui.dialog.overlay.resize)}var c=(this.oldInstances.pop()||a("<div></div>").addClass("ui-widget-overlay")).appendTo(document.body).css({width:this.width(),height:this.height()});a.fn.bgiframe&&c.bgiframe();this.instances.push(c);return c},destroy:function(d){this.oldInstances.push(this.instances.splice(a.inArray(d,this.instances),1)[0]);this.instances.length===0&&a([document,window]).unbind(".dialog-overlay");d.remove();var c=0;a.each(this.instances,function(){c=Math.max(c,this.css("z-index"))});this.maxZ=c},height:function(){var d,c;if(a.browser.msie&&a.browser.version<7){d=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight);c=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight);return d<c?a(window).height()+"px":d+"px"}else{return a(document).height()+"px"}},width:function(){var d,c;if(a.browser.msie&&a.browser.version<7){d=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth);c=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth);return d<c?a(window).width()+"px":d+"px"}else{return a(document).width()+"px"}},resize:function(){var b=a([]);a.each(a.ui.dialog.overlay.instances,function(){b=b.add(this)});b.css({width:0,height:0}).css({width:a.ui.dialog.overlay.width(),height:a.ui.dialog.overlay.height()})}});a.extend(a.ui.dialog.overlay.prototype,{destroy:function(){a.ui.dialog.overlay.destroy(this.$el)}})})(jQuery);(function(f){f.ui=f.ui||{};var a=/left|center|right/,e=/top|center|bottom/,d=f.fn.position,b=f.fn.offset;f.fn.position=function(j){if(!j||!j.of){return d.apply(this,arguments)}j=f.extend({},j);var c=f(j.of),o=(j.collision||"flip").split(" "),n=j.offset?j.offset.split(" "):[0,0],m,l,k;if(j.of.nodeType===9){m=c.width();l=c.height();k={top:0,left:0}}else{if(j.of.scrollTo&&j.of.document){m=c.width();l=c.height();k={top:c.scrollTop(),left:c.scrollLeft()}}else{if(j.of.preventDefault){j.at="left top";m=l=0;k={top:j.of.pageY,left:j.of.pageX}}else{m=c.outerWidth();l=c.outerHeight();k=c.offset()}}}f.each(["my","at"],function(){var g=(j[this]||"").split(" ");if(g.length===1){g=a.test(g[0])?g.concat(["center"]):e.test(g[0])?["center"].concat(g):["center","center"]}g[0]=a.test(g[0])?g[0]:"center";g[1]=e.test(g[1])?g[1]:"center";j[this]=g});if(o.length===1){o[1]=o[0]}n[0]=parseInt(n[0],10)||0;if(n.length===1){n[1]=n[0]}n[1]=parseInt(n[1],10)||0;if(j.at[0]==="right"){k.left+=m}else{if(j.at[0]==="center"){k.left+=m/2}}if(j.at[1]==="bottom"){k.top+=l}else{if(j.at[1]==="center"){k.top+=l/2}}k.left+=n[0];k.top+=n[1];return this.each(function(){var p=f(this),h=p.outerWidth(),g=p.outerHeight(),i=f.extend({},k);if(j.my[0]==="right"){i.left-=h}else{if(j.my[0]==="center"){i.left-=h/2}}if(j.my[1]==="bottom"){i.top-=g}else{if(j.my[1]==="center"){i.top-=g/2}}i.left=parseInt(i.left);i.top=parseInt(i.top);f.each(["left","top"],function(s,q){f.ui.position[o[s]]&&f.ui.position[o[s]][q](i,{targetWidth:m,targetHeight:l,elemWidth:h,elemHeight:g,offset:n,my:j.my,at:j.at})});f.fn.bgiframe&&p.bgiframe();p.offset(f.extend(i,{using:j.using}))})};f.ui.position={fit:{left:function(g,c){var h=f(window);c=g.left+c.elemWidth-h.width()-h.scrollLeft();g.left=c>0?g.left-c:Math.max(0,g.left)},top:function(g,c){var h=f(window);c=g.top+c.elemHeight-h.height()-h.scrollTop();g.top=c>0?g.top-c:Math.max(0,g.top)}},flip:{left:function(h,c){if(c.at[0]!=="center"){var k=f(window);k=h.left+c.elemWidth-k.width()-k.scrollLeft();var j=c.my[0]==="left"?-c.elemWidth:c.my[0]==="right"?c.elemWidth:0,i=-2*c.offset[0];h.left+=h.left<0?j+c.targetWidth+i:k>0?j-c.targetWidth+i:0}},top:function(i,c){if(c.at[1]!=="center"){var m=f(window);m=i.top+c.elemHeight-m.height()-m.scrollTop();var l=c.my[1]==="top"?-c.elemHeight:c.my[1]==="bottom"?c.elemHeight:0,k=c.at[1]==="top"?c.targetHeight:-c.targetHeight,j=-2*c.offset[1];i.top+=i.top<0?l+c.targetHeight+j:m>0?l+k+j:0}}}};if(!f.offset.setOffset){f.offset.setOffset=function(i,c){if(/static/.test(f.curCSS(i,"position"))){i.style.position="relative"}var m=f(i),l=m.offset(),k=parseInt(f.curCSS(i,"top",true),10)||0,j=parseInt(f.curCSS(i,"left",true),10)||0;l={top:c.top-l.top+k,left:c.left-l.left+j};"using" in c?c.using.call(i,l):m.css(l)};f.fn.offset=function(g){var c=this[0];if(!c||!c.ownerDocument){return null}if(g){return this.each(function(){f.offset.setOffset(this,g)})}return b.call(this)}}})(jQuery);(function(a){a.widget("ui.progressbar",{options:{value:0},_create:function(){this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this._valueMin(),"aria-valuemax":this._valueMax(),"aria-valuenow":this._value()});this.valueDiv=a("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element);this._refreshValue()},destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");this.valueDiv.remove();a.Widget.prototype.destroy.apply(this,arguments)},value:function(b){if(b===undefined){return this._value()}this._setOption("value",b);return this},_setOption:function(b,d){switch(b){case"value":this.options.value=d;this._refreshValue();this._trigger("change");break}a.Widget.prototype._setOption.apply(this,arguments)},_value:function(){var b=this.options.value;if(typeof b!=="number"){b=0}if(b<this._valueMin()){b=this._valueMin()}if(b>this._valueMax()){b=this._valueMax()}return b},_valueMin:function(){return 0},_valueMax:function(){return 100},_refreshValue:function(){var b=this.value();this.valueDiv[b===this._valueMax()?"addClass":"removeClass"]("ui-corner-right").width(b+"%");this.element.attr("aria-valuenow",b)}});a.extend(a.ui.progressbar,{version:"1.8.2"})})(jQuery);(function(a){a.widget("ui.slider",a.ui.mouse,{widgetEventPrefix:"slide",options:{animate:false,distance:0,max:100,min:0,orientation:"horizontal",range:false,step:1,value:0,values:null},_create:function(){var d=this,c=this.options;this._mouseSliding=this._keySliding=false;this._animateOff=true;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all");c.disabled&&this.element.addClass("ui-slider-disabled ui-disabled");this.range=a([]);if(c.range){if(c.range===true){this.range=a("<div></div>");if(!c.values){c.values=[this._valueMin(),this._valueMin()]}if(c.values.length&&c.values.length!==2){c.values=[c.values[0],c.values[0]]}}else{this.range=a("<div></div>")}this.range.appendTo(this.element).addClass("ui-slider-range");if(c.range==="min"||c.range==="max"){this.range.addClass("ui-slider-range-"+c.range)}this.range.addClass("ui-widget-header")}a(".ui-slider-handle",this.element).length===0&&a("<a href='#'></a>").appendTo(this.element).addClass("ui-slider-handle");if(c.values&&c.values.length){for(;a(".ui-slider-handle",this.element).length<c.values.length;){a("<a href='#'></a>").appendTo(this.element).addClass("ui-slider-handle")}}this.handles=a(".ui-slider-handle",this.element).addClass("ui-state-default ui-corner-all");this.handle=this.handles.eq(0);this.handles.add(this.range).filter("a").click(function(b){b.preventDefault()}).hover(function(){c.disabled||a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")}).focus(function(){if(c.disabled){a(this).blur()}else{a(".ui-slider .ui-state-focus").removeClass("ui-state-focus");a(this).addClass("ui-state-focus")}}).blur(function(){a(this).removeClass("ui-state-focus")});this.handles.each(function(b){a(this).data("index.ui-slider-handle",b)});this.handles.keydown(function(n){var m=true,l=a(this).data("index.ui-slider-handle"),k,j,b;if(!d.options.disabled){switch(n.keyCode){case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:m=false;if(!d._keySliding){d._keySliding=true;a(this).addClass("ui-state-active");k=d._start(n,l);if(k===false){return}}break}b=d.options.step;k=d.options.values&&d.options.values.length?(j=d.values(l)):(j=d.value());switch(n.keyCode){case a.ui.keyCode.HOME:j=d._valueMin();break;case a.ui.keyCode.END:j=d._valueMax();break;case a.ui.keyCode.PAGE_UP:j=d._trimAlignValue(k+(d._valueMax()-d._valueMin())/5);break;case a.ui.keyCode.PAGE_DOWN:j=d._trimAlignValue(k-(d._valueMax()-d._valueMin())/5);break;case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:if(k===d._valueMax()){return}j=d._trimAlignValue(k+b);break;case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(k===d._valueMin()){return}j=d._trimAlignValue(k-b);break}d._slide(n,l,j);return m}}).keyup(function(f){var b=a(this).data("index.ui-slider-handle");if(d._keySliding){d._keySliding=false;d._stop(f,b);d._change(f,b);a(this).removeClass("ui-state-active")}});this._refreshValue();this._animateOff=false},destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider");this._mouseDestroy();return this},_mouseCapture:function(j){var d=this.options,p,o,n,m,l,k;if(d.disabled){return false}this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();p={x:j.pageX,y:j.pageY};o=this._normValueFromMouse(p);n=this._valueMax()-this._valueMin()+1;l=this;this.handles.each(function(c){var b=Math.abs(o-l.values(c));if(n>b){n=b;m=a(this);k=c}});if(d.range===true&&this.values(1)===d.min){k+=1;m=a(this.handles[k])}if(this._start(j,k)===false){return false}this._mouseSliding=true;l._handleIndex=k;m.addClass("ui-state-active").focus();d=m.offset();this._clickOffset=!a(j.target).parents().andSelf().is(".ui-slider-handle")?{left:0,top:0}:{left:j.pageX-d.left-m.width()/2,top:j.pageY-d.top-m.height()/2-(parseInt(m.css("borderTopWidth"),10)||0)-(parseInt(m.css("borderBottomWidth"),10)||0)+(parseInt(m.css("marginTop"),10)||0)};o=this._normValueFromMouse(p);this._slide(j,k,o);return this._animateOff=true},_mouseStart:function(){return true},_mouseDrag:function(d){var c=this._normValueFromMouse({x:d.pageX,y:d.pageY});this._slide(d,this._handleIndex,c);return false},_mouseStop:function(b){this.handles.removeClass("ui-state-active");this._mouseSliding=false;this._stop(b,this._handleIndex);this._change(b,this._handleIndex);this._clickOffset=this._handleIndex=null;return this._animateOff=false},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(d){var c;if(this.orientation==="horizontal"){c=this.elementSize.width;d=d.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)}else{c=this.elementSize.height;d=d.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)}c=d/c;if(c>1){c=1}if(c<0){c=0}if(this.orientation==="vertical"){c=1-c}d=this._valueMax()-this._valueMin();return this._trimAlignValue(this._valueMin()+c*d)},_start:function(e,d){var f={handle:this.handles[d],value:this.value()};if(this.options.values&&this.options.values.length){f.value=this.values(d);f.values=this.values()}return this._trigger("start",e,f)},_slide:function(f,d,h){var g;if(this.options.values&&this.options.values.length){g=this.values(d?0:1);if(this.options.values.length===2&&this.options.range===true&&(d===0&&h>g||d===1&&h<g)){h=g}if(h!==this.values(d)){g=this.values();g[d]=h;f=this._trigger("slide",f,{handle:this.handles[d],value:h,values:g});this.values(d?0:1);f!==false&&this.values(d,h,true)}}else{if(h!==this.value()){f=this._trigger("slide",f,{handle:this.handles[d],value:h});f!==false&&this.value(h)}}},_stop:function(e,d){var f={handle:this.handles[d],value:this.value()};if(this.options.values&&this.options.values.length){f.value=this.values(d);f.values=this.values()}this._trigger("stop",e,f)},_change:function(e,d){if(!this._keySliding&&!this._mouseSliding){var f={handle:this.handles[d],value:this.value()};if(this.options.values&&this.options.values.length){f.value=this.values(d);f.values=this.values()}this._trigger("change",e,f)}},value:function(b){if(arguments.length){this.options.value=this._trimAlignValue(b);this._refreshValue();this._change(null,0)}return this._value()},values:function(g,d){var j,i,h;if(arguments.length>1){this.options.values[g]=this._trimAlignValue(d);this._refreshValue();this._change(null,g)}if(arguments.length){if(a.isArray(arguments[0])){j=this.options.values;i=arguments[0];for(h=0;h<j.length;h+=1){j[h]=this._trimAlignValue(i[h]);this._change(null,h)}this._refreshValue()}else{return this.options.values&&this.options.values.length?this._values(g):this.value()}}else{return this._values()}},_setOption:function(f,d){var h,g=0;if(a.isArray(this.options.values)){g=this.options.values.length}a.Widget.prototype._setOption.apply(this,arguments);switch(f){case"disabled":if(d){this.handles.filter(".ui-state-focus").blur();this.handles.removeClass("ui-state-hover");this.handles.attr("disabled","disabled");this.element.addClass("ui-disabled")}else{this.handles.removeAttr("disabled");this.element.removeClass("ui-disabled")}break;case"orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();break;case"value":this._animateOff=true;this._refreshValue();this._change(null,0);this._animateOff=false;break;case"values":this._animateOff=true;this._refreshValue();for(h=0;h<g;h+=1){this._change(null,h)}this._animateOff=false;break}},_value:function(){var b=this.options.value;return b=this._trimAlignValue(b)},_values:function(e){var d,f;if(arguments.length){d=this.options.values[e];return d=this._trimAlignValue(d)}else{d=this.options.values.slice();for(f=0;f<d.length;f+=1){d[f]=this._trimAlignValue(d[f])}return d}},_trimAlignValue:function(e){if(e<this._valueMin()){return this._valueMin()}if(e>this._valueMax()){return this._valueMax()}var d=this.options.step>0?this.options.step:1,f=e%d;e=e-f;if(Math.abs(f)*2>=d){e+=f>0?d:-d}return parseFloat(e.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var u=this.options.range,s=this.options,r=this,q=!this._animateOff?s.animate:false,p,o={},n,m,l,d;if(this.options.values&&this.options.values.length){this.handles.each(function(b){p=(r.values(b)-r._valueMin())/(r._valueMax()-r._valueMin())*100;o[r.orientation==="horizontal"?"left":"bottom"]=p+"%";a(this).stop(1,1)[q?"animate":"css"](o,s.animate);if(r.options.range===true){if(r.orientation==="horizontal"){if(b===0){r.range.stop(1,1)[q?"animate":"css"]({left:p+"%"},s.animate)}if(b===1){r.range[q?"animate":"css"]({width:p-n+"%"},{queue:false,duration:s.animate})}}else{if(b===0){r.range.stop(1,1)[q?"animate":"css"]({bottom:p+"%"},s.animate)}if(b===1){r.range[q?"animate":"css"]({height:p-n+"%"},{queue:false,duration:s.animate})}}}n=p})}else{m=this.value();l=this._valueMin();d=this._valueMax();p=d!==l?(m-l)/(d-l)*100:0;o[r.orientation==="horizontal"?"left":"bottom"]=p+"%";this.handle.stop(1,1)[q?"animate":"css"](o,s.animate);if(u==="min"&&this.orientation==="horizontal"){this.range.stop(1,1)[q?"animate":"css"]({width:p+"%"},s.animate)}if(u==="max"&&this.orientation==="horizontal"){this.range[q?"animate":"css"]({width:100-p+"%"},{queue:false,duration:s.animate})}if(u==="min"&&this.orientation==="vertical"){this.range.stop(1,1)[q?"animate":"css"]({height:p+"%"},s.animate)}if(u==="max"&&this.orientation==="vertical"){this.range[q?"animate":"css"]({height:100-p+"%"},{queue:false,duration:s.animate})}}}});a.extend(a.ui.slider,{version:"1.8.2"})})(jQuery);(function(f){function e(){return ++c}function b(){return ++a}var c=0,a=0;f.widget("ui.tabs",{options:{add:null,ajaxOptions:null,cache:false,cookie:null,collapsible:false,disable:null,disabled:[],enable:null,event:"click",fx:null,idPrefix:"ui-tabs-",load:null,panelTemplate:"<div></div>",remove:null,select:null,show:null,spinner:"<em>Loading&#8230;</em>",tabTemplate:'<li><a href="#{href}"><span>#{label}</span></a></li>'},_create:function(){this._tabify(true)},_setOption:function(g,d){if(g=="selected"){this.options.collapsible&&d==this.options.selected||this.select(d)}else{this.options[g]=d;this._tabify()}},_tabId:function(d){return d.title&&d.title.replace(/\s/g,"_").replace(/[^A-Za-z0-9\-_:\.]/g,"")||this.options.idPrefix+e()},_sanitizeSelector:function(d){return d.replace(/:/g,"\\:")},_cookie:function(){var d=this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+b());return f.cookie.apply(null,[d].concat(f.makeArray(arguments)))},_ui:function(g,d){return{tab:g,panel:d,index:this.anchors.index(g)}},_cleanup:function(){this.lis.filter(".ui-state-processing").removeClass("ui-state-processing").find("span:data(label.tabs)").each(function(){var d=f(this);d.html(d.data("label.tabs")).removeData("label.tabs")})},_tabify:function(x){function w(h,i){h.css({display:""});!f.support.opacity&&i.opacity&&h[0].style.removeAttribute("filter")}this.list=this.element.find("ol,ul").eq(0);this.lis=f("li:has(a[href])",this.list);this.anchors=this.lis.map(function(){return f("a",this)[0]});this.panels=f([]);var z=this,y=this.options,v=/^#.+/;this.anchors.each(function(k,m){var i=f(m).attr("href"),h=i.split("#")[0],n;if(h&&(h===location.toString().split("#")[0]||(n=f("base")[0])&&h===n.href)){i=m.hash;m.href=i}if(v.test(i)){z.panels=z.panels.add(z._sanitizeSelector(i))}else{if(i!="#"){f.data(m,"href.tabs",i);f.data(m,"load.tabs",i.replace(/#.*$/,""));i=z._tabId(m);m.href="#"+i;m=f("#"+i);if(!m.length){m=f(y.panelTemplate).attr("id",i).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").insertAfter(z.panels[k-1]||z.list);m.data("destroy.tabs",true)}z.panels=z.panels.add(m)}else{y.disabled.push(k)}}});if(x){this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all");this.list.addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.lis.addClass("ui-state-default ui-corner-top");this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom");if(y.selected===undefined){location.hash&&this.anchors.each(function(h,i){if(i.hash==location.hash){y.selected=h;return false}});if(typeof y.selected!="number"&&y.cookie){y.selected=parseInt(z._cookie(),10)}if(typeof y.selected!="number"&&this.lis.filter(".ui-tabs-selected").length){y.selected=this.lis.index(this.lis.filter(".ui-tabs-selected"))}y.selected=y.selected||(this.lis.length?0:-1)}else{if(y.selected===null){y.selected=-1}}y.selected=y.selected>=0&&this.anchors[y.selected]||y.selected<0?y.selected:0;y.disabled=f.unique(y.disabled.concat(f.map(this.lis.filter(".ui-state-disabled"),function(h){return z.lis.index(h)}))).sort();f.inArray(y.selected,y.disabled)!=-1&&y.disabled.splice(f.inArray(y.selected,y.disabled),1);this.panels.addClass("ui-tabs-hide");this.lis.removeClass("ui-tabs-selected ui-state-active");if(y.selected>=0&&this.anchors.length){this.panels.eq(y.selected).removeClass("ui-tabs-hide");this.lis.eq(y.selected).addClass("ui-tabs-selected ui-state-active");z.element.queue("tabs",function(){z._trigger("show",null,z._ui(z.anchors[y.selected],z.panels[y.selected]))});this.load(y.selected)}f(window).bind("unload",function(){z.lis.add(z.anchors).unbind(".tabs");z.lis=z.anchors=z.panels=null})}else{y.selected=this.lis.index(this.lis.filter(".ui-tabs-selected"))}this.element[y.collapsible?"addClass":"removeClass"]("ui-tabs-collapsible");y.cookie&&this._cookie(y.selected,y.cookie);x=0;for(var u;u=this.lis[x];x++){f(u)[f.inArray(x,y.disabled)!=-1&&!f(u).hasClass("ui-tabs-selected")?"addClass":"removeClass"]("ui-state-disabled")}y.cache===false&&this.anchors.removeData("cache.tabs");this.lis.add(this.anchors).unbind(".tabs");if(y.event!="mouseover"){var s=function(h,i){i.is(":not(.ui-state-disabled)")&&i.addClass("ui-state-"+h)},l=function(h,i){i.removeClass("ui-state-"+h)};this.lis.bind("mouseover.tabs",function(){s("hover",f(this))});this.lis.bind("mouseout.tabs",function(){l("hover",f(this))});this.anchors.bind("focus.tabs",function(){s("focus",f(this).closest("li"))});this.anchors.bind("blur.tabs",function(){l("focus",f(this).closest("li"))})}var p,j;if(y.fx){if(f.isArray(y.fx)){p=y.fx[0];j=y.fx[1]}else{p=j=y.fx}}var g=j?function(h,i){f(h).closest("li").addClass("ui-tabs-selected ui-state-active");i.hide().removeClass("ui-tabs-hide").animate(j,j.duration||"normal",function(){w(i,j);z._trigger("show",null,z._ui(h,i[0]))})}:function(h,i){f(h).closest("li").addClass("ui-tabs-selected ui-state-active");i.removeClass("ui-tabs-hide");z._trigger("show",null,z._ui(h,i[0]))},d=p?function(h,i){i.animate(p,p.duration||"normal",function(){z.lis.removeClass("ui-tabs-selected ui-state-active");i.addClass("ui-tabs-hide");w(i,p);z.element.dequeue("tabs")})}:function(h,i){z.lis.removeClass("ui-tabs-selected ui-state-active");i.addClass("ui-tabs-hide");z.element.dequeue("tabs")};this.anchors.bind(y.event+".tabs",function(){var k=this,m=f(this).closest("li"),i=z.panels.filter(":not(.ui-tabs-hide)"),h=f(z._sanitizeSelector(this.hash));if(m.hasClass("ui-tabs-selected")&&!y.collapsible||m.hasClass("ui-state-disabled")||m.hasClass("ui-state-processing")||z._trigger("select",null,z._ui(this,h[0]))===false){this.blur();return false}y.selected=z.anchors.index(this);z.abort();if(y.collapsible){if(m.hasClass("ui-tabs-selected")){y.selected=-1;y.cookie&&z._cookie(y.selected,y.cookie);z.element.queue("tabs",function(){d(k,i)}).dequeue("tabs");this.blur();return false}else{if(!i.length){y.cookie&&z._cookie(y.selected,y.cookie);z.element.queue("tabs",function(){g(k,h)});z.load(z.anchors.index(this));this.blur();return false}}}y.cookie&&z._cookie(y.selected,y.cookie);if(h.length){i.length&&z.element.queue("tabs",function(){d(k,i)});z.element.queue("tabs",function(){g(k,h)});z.load(z.anchors.index(this))}else{throw"jQuery UI Tabs: Mismatching fragment identifier."}f.browser.msie&&this.blur()});this.anchors.bind("click.tabs",function(){return false})},destroy:function(){var d=this.options;this.abort();this.element.unbind(".tabs").removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible").removeData("tabs");this.list.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all");this.anchors.each(function(){var h=f.data(this,"href.tabs");if(h){this.href=h}var g=f(this).unbind(".tabs");f.each(["href","load","cache"],function(i,j){g.removeData(j+".tabs")})});this.lis.unbind(".tabs").add(this.panels).each(function(){f.data(this,"destroy.tabs")?f(this).remove():f(this).removeClass("ui-state-default ui-corner-top ui-tabs-selected ui-state-active ui-state-hover ui-state-focus ui-state-disabled ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide")});d.cookie&&this._cookie(null,d.cookie);return this},add:function(m,l,g){if(g===undefined){g=this.anchors.length}var d=this,k=this.options;l=f(k.tabTemplate.replace(/#\{href\}/g,m).replace(/#\{label\}/g,l));m=!m.indexOf("#")?m.replace("#",""):this._tabId(f("a",l)[0]);l.addClass("ui-state-default ui-corner-top").data("destroy.tabs",true);var j=f("#"+m);j.length||(j=f(k.panelTemplate).attr("id",m).data("destroy.tabs",true));j.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide");if(g>=this.lis.length){l.appendTo(this.list);j.appendTo(this.list[0].parentNode)}else{l.insertBefore(this.lis[g]);j.insertBefore(this.panels[g])}k.disabled=f.map(k.disabled,function(h){return h>=g?++h:h});this._tabify();if(this.anchors.length==1){k.selected=0;l.addClass("ui-tabs-selected ui-state-active");j.removeClass("ui-tabs-hide");this.element.queue("tabs",function(){d._trigger("show",null,d._ui(d.anchors[0],d.panels[0]))});this.load(0)}this._trigger("add",null,this._ui(this.anchors[g],this.panels[g]));return this},remove:function(i){var h=this.options,g=this.lis.eq(i).remove(),d=this.panels.eq(i).remove();if(g.hasClass("ui-tabs-selected")&&this.anchors.length>1){this.select(i+(i+1<this.anchors.length?1:-1))}h.disabled=f.map(f.grep(h.disabled,function(j){return j!=i}),function(j){return j>=i?--j:j});this._tabify();this._trigger("remove",null,this._ui(g.find("a")[0],d[0]));return this},enable:function(g){var d=this.options;if(f.inArray(g,d.disabled)!=-1){this.lis.eq(g).removeClass("ui-state-disabled");d.disabled=f.grep(d.disabled,function(h){return h!=g});this._trigger("enable",null,this._ui(this.anchors[g],this.panels[g]));return this}},disable:function(g){var d=this.options;if(g!=d.selected){this.lis.eq(g).addClass("ui-state-disabled");d.disabled.push(g);d.disabled.sort();this._trigger("disable",null,this._ui(this.anchors[g],this.panels[g]))}return this},select:function(d){if(typeof d=="string"){d=this.anchors.index(this.anchors.filter("[href$="+d+"]"))}else{if(d===null){d=-1}}if(d==-1&&this.options.collapsible){d=this.options.selected}this.anchors.eq(d).trigger(this.options.event+".tabs");return this},load:function(m){var l=this,g=this.options,d=this.anchors.eq(m)[0],k=f.data(d,"load.tabs");this.abort();if(!k||this.element.queue("tabs").length!==0&&f.data(d,"cache.tabs")){this.element.dequeue("tabs")}else{this.lis.eq(m).addClass("ui-state-processing");if(g.spinner){var j=f("span",d);j.data("label.tabs",j.html()).html(g.spinner)}this.xhr=f.ajax(f.extend({},g.ajaxOptions,{url:k,success:function(i,o){f(l._sanitizeSelector(d.hash)).html(i);l._cleanup();g.cache&&f.data(d,"cache.tabs",true);l._trigger("load",null,l._ui(l.anchors[m],l.panels[m]));try{g.ajaxOptions.success(i,o)}catch(h){}},error:function(i,o){l._cleanup();l._trigger("load",null,l._ui(l.anchors[m],l.panels[m]));try{g.ajaxOptions.error(i,o,m,d)}catch(h){}}}));l.element.dequeue("tabs");return this}},abort:function(){this.element.queue([]);this.panels.stop(false,true);this.element.queue("tabs",this.element.queue("tabs").splice(-2,2));if(this.xhr){this.xhr.abort();delete this.xhr}this._cleanup();return this},url:function(g,d){this.anchors.eq(g).removeData("cache.tabs").data("load.tabs",d);return this},length:function(){return this.anchors.length}});f.extend(f.ui.tabs,{version:"1.8.2"});f.extend(f.ui.tabs.prototype,{rotation:null,rotate:function(k,j){var g=this,d=this.options,i=g._rotate||(g._rotate=function(h){clearTimeout(g.rotation);g.rotation=setTimeout(function(){var l=d.selected;g.select(++l<g.anchors.length?l:0)},k);h&&h.stopPropagation()});j=g._unrotate||(g._unrotate=!j?function(h){h.clientX&&g.rotate(null)}:function(){t=d.selected;i()});if(k){this.element.bind("tabsshow",i);this.anchors.bind(d.event+".tabs",j);i()}else{clearTimeout(g.rotation);this.element.unbind("tabsshow",i);this.anchors.unbind(d.event+".tabs",j);delete this._rotate;delete this._unrotate}return this}})})(jQuery);
(function(b){b.fn.ajaxSubmit=function(s){if(!this.length){a("ajaxSubmit: skipping submit process - no element selected");return this}if(typeof s=="function"){s={success:s}}var e=b.trim(this.attr("action"));if(e){e=(e.match(/^([^#]+)/)||[])[1]}e=e||window.location.href||"";s=b.extend({url:e,type:this.attr("method")||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},s||{});var u={};this.trigger("form-pre-serialize",[this,s,u]);if(u.veto){a("ajaxSubmit: submit vetoed via form-pre-serialize trigger");return this}if(s.beforeSerialize&&s.beforeSerialize(this,s)===false){a("ajaxSubmit: submit aborted via beforeSerialize callback");return this}var m=this.formToArray(s.semantic);if(s.data){s.extraData=s.data;for(var f in s.data){if(s.data[f] instanceof Array){for(var g in s.data[f]){m.push({name:f,value:s.data[f][g]})}}else{m.push({name:f,value:s.data[f]})}}}if(s.beforeSubmit&&s.beforeSubmit(m,this,s)===false){a("ajaxSubmit: submit aborted via beforeSubmit callback");return this}this.trigger("form-submit-validate",[m,this,s,u]);if(u.veto){a("ajaxSubmit: submit vetoed via form-submit-validate trigger");return this}var d=b.param(m);if(s.type.toUpperCase()=="GET"){s.url+=(s.url.indexOf("?")>=0?"&":"?")+d;s.data=null}else{s.data=d}var t=this,l=[];if(s.resetForm){l.push(function(){t.resetForm()})}if(s.clearForm){l.push(function(){t.clearForm()})}if(!s.dataType&&s.target){var p=s.success||function(){};l.push(function(k){var j=s.replaceTarget?"replaceWith":"html";b(s.target)[j](k).each(p,arguments)})}else{if(s.success){l.push(s.success)}}s.success=function(q,k,v){for(var n=0,j=l.length;n<j;n++){l[n].apply(s,[q,k,v||t,t])}};var c=b("input:file",this).fieldValue();var r=false;for(var i=0;i<c.length;i++){if(c[i]){r=true}}var h=false;if((c.length&&s.iframe!==false)||s.iframe||r||h){if(s.closeKeepAlive){b.get(s.closeKeepAlive,o)}else{o()}}else{b.ajax(s)}this.trigger("form-submit-notify",[this,s]);return this;function o(){var w=t[0];if(b(":input[name=submit]",w).length){alert('Error: Form elements must not be named "submit".');return}var q=b.extend({},b.ajaxSettings,s);var H=b.extend(true,{},b.extend(true,{},b.ajaxSettings),q);var v="jqFormIO"+(new Date().getTime());var D=b('<iframe id="'+v+'" name="'+v+'" src="'+q.iframeSrc+'" onload="(jQuery(this).data(\'form-plugin-onload\'))()" />');var F=D[0];D.css({position:"absolute",top:"-1000px",left:"-1000px"});var G={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(){this.aborted=1;D.attr("src",q.iframeSrc)}};var E=q.global;if(E&&!b.active++){b.event.trigger("ajaxStart")}if(E){b.event.trigger("ajaxSend",[G,q])}if(H.beforeSend&&H.beforeSend(G,H)===false){H.global&&b.active--;return}if(G.aborted){return}var k=false;var A=0;var j=w.clk;if(j){var y=j.name;if(y&&!j.disabled){q.extraData=q.extraData||{};q.extraData[y]=j.value;if(j.type=="image"){q.extraData[y+".x"]=w.clk_x;q.extraData[y+".y"]=w.clk_y}}}function x(){var K=t.attr("target"),I=t.attr("action");w.setAttribute("target",v);if(w.getAttribute("method")!="POST"){w.setAttribute("method","POST")}if(w.getAttribute("action")!=q.url){w.setAttribute("action",q.url)}if(!q.skipEncodingOverride){t.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"})}if(q.timeout){setTimeout(function(){A=true;B()},q.timeout)}var J=[];try{if(q.extraData){for(var L in q.extraData){J.push(b('<input type="hidden" name="'+L+'" value="'+q.extraData[L]+'" />').appendTo(w)[0])}}D.appendTo("body");D.data("form-plugin-onload",B);w.submit()}finally{w.setAttribute("action",I);K?w.setAttribute("target",K):t.removeAttr("target");b(J).remove()}}if(q.forceSync){x()}else{setTimeout(x,10)}var z=100;function B(){if(k){return}var I=true;try{if(A){throw"timeout"}var J,M;M=F.contentWindow?F.contentWindow.document:F.contentDocument?F.contentDocument:F.document;var N=q.dataType=="xml"||M.XMLDocument||b.isXMLDoc(M);a("isXml="+N);if(!N&&(M.body==null||M.body.innerHTML=="")){if(--z){a("requeing onLoad callback, DOM not available");setTimeout(B,250);return}a("Could not access iframe DOM after 100 tries.");return}a("response detected");k=true;G.responseText=M.body?M.body.innerHTML:null;G.responseXML=M.XMLDocument?M.XMLDocument:M;G.getResponseHeader=function(P){var O={"content-type":q.dataType};return O[P]};if(q.dataType=="json"||q.dataType=="script"){var n=M.getElementsByTagName("textarea")[0];if(n){G.responseText=n.value}else{var L=M.getElementsByTagName("pre")[0];if(L){G.responseText=L.innerHTML}}}else{if(q.dataType=="xml"&&!G.responseXML&&G.responseText!=null){G.responseXML=C(G.responseText)}}J=b.httpData(G,q.dataType)}catch(K){a("error caught:",K);I=false;G.error=K;b.handleError(q,G,"error",K)}if(I){q.success(J,"success");if(E){b.event.trigger("ajaxSuccess",[G,q])}}if(E){b.event.trigger("ajaxComplete",[G,q])}if(E&&!--b.active){b.event.trigger("ajaxStop")}if(q.complete){q.complete(G,I?"success":"error")}setTimeout(function(){D.removeData("form-plugin-onload");D.remove();G.responseXML=null},100)}function C(n,I){if(window.ActiveXObject){I=new ActiveXObject("Microsoft.XMLDOM");I.async="false";I.loadXML(n)}else{I=(new DOMParser()).parseFromString(n,"text/xml")}return(I&&I.documentElement&&I.documentElement.tagName!="parsererror")?I:null}}};b.fn.ajaxForm=function(c){return this.ajaxFormUnbind().bind("submit.form-plugin",function(d){d.preventDefault();b(this).ajaxSubmit(c)}).bind("click.form-plugin",function(i){var h=i.target;var f=b(h);if(!(f.is(":submit,input:image"))){var d=f.closest(":submit");if(d.length==0){return}h=d[0]}var g=this;g.clk=h;if(h.type=="image"){if(i.offsetX!=undefined){g.clk_x=i.offsetX;g.clk_y=i.offsetY}else{if(typeof b.fn.offset=="function"){var j=f.offset();g.clk_x=i.pageX-j.left;g.clk_y=i.pageY-j.top}else{g.clk_x=i.pageX-h.offsetLeft;g.clk_y=i.pageY-h.offsetTop}}}setTimeout(function(){g.clk=g.clk_x=g.clk_y=null},100)})};b.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};b.fn.formToArray=function(q){var p=[];if(this.length==0){return p}var d=this[0];var h=q?d.getElementsByTagName("*"):d.elements;if(!h){return p}for(var k=0,m=h.length;k<m;k++){var e=h[k];var f=e.name;if(!f){continue}if(q&&d.clk&&e.type=="image"){if(!e.disabled&&d.clk==e){p.push({name:f,value:b(e).val()});p.push({name:f+".x",value:d.clk_x},{name:f+".y",value:d.clk_y})}continue}var r=b.fieldValue(e,true);if(r&&r.constructor==Array){for(var g=0,c=r.length;g<c;g++){p.push({name:f,value:r[g]})}}else{if(r!==null&&typeof r!="undefined"){p.push({name:f,value:r})}}}if(!q&&d.clk){var l=b(d.clk),o=l[0],f=o.name;if(f&&!o.disabled&&o.type=="image"){p.push({name:f,value:l.val()});p.push({name:f+".x",value:d.clk_x},{name:f+".y",value:d.clk_y})}}return p};b.fn.formSerialize=function(c){return b.param(this.formToArray(c))};b.fn.fieldSerialize=function(d){var c=[];this.each(function(){var h=this.name;if(!h){return}var f=b.fieldValue(this,d);if(f&&f.constructor==Array){for(var g=0,e=f.length;g<e;g++){c.push({name:h,value:f[g]})}}else{if(f!==null&&typeof f!="undefined"){c.push({name:this.name,value:f})}}});return b.param(c)};b.fn.fieldValue=function(h){for(var g=[],e=0,c=this.length;e<c;e++){var f=this[e];var d=b.fieldValue(f,h);if(d===null||typeof d=="undefined"||(d.constructor==Array&&!d.length)){continue}d.constructor==Array?b.merge(g,d):g.push(d)}return g};b.fieldValue=function(c,j){var e=c.name,p=c.type,q=c.tagName.toLowerCase();if(typeof j=="undefined"){j=true}if(j&&(!e||c.disabled||p=="reset"||p=="button"||(p=="checkbox"||p=="radio")&&!c.checked||(p=="submit"||p=="image")&&c.form&&c.form.clk!=c||q=="select"&&c.selectedIndex==-1)){return null}if(q=="select"){var k=c.selectedIndex;if(k<0){return null}var m=[],d=c.options;var g=(p=="select-one");var l=(g?k+1:d.length);for(var f=(g?k:0);f<l;f++){var h=d[f];if(h.selected){var o=h.value;if(!o){o=(h.attributes&&h.attributes.value&&!(h.attributes.value.specified))?h.text:h.value}if(g){return o}m.push(o)}}return m}return c.value};b.fn.clearForm=function(){return this.each(function(){b("input,select,textarea",this).clearFields()})};b.fn.clearFields=b.fn.clearInputs=function(){return this.each(function(){var d=this.type,c=this.tagName.toLowerCase();if(d=="text"||d=="password"||c=="textarea"){this.value=""}else{if(d=="checkbox"||d=="radio"){this.checked=false}else{if(c=="select"){this.selectedIndex=-1}}}})};b.fn.resetForm=function(){return this.each(function(){if(typeof this.reset=="function"||(typeof this.reset=="object"&&!this.reset.nodeType)){this.reset()}})};b.fn.enable=function(c){if(c==undefined){c=true}return this.each(function(){this.disabled=!c})};b.fn.selected=function(c){if(c==undefined){c=true}return this.each(function(){var d=this.type;if(d=="checkbox"||d=="radio"){this.checked=c}else{if(this.tagName.toLowerCase()=="option"){var e=b(this).parent("select");if(c&&e[0]&&e[0].type=="select-one"){e.find("option").selected(false)}this.selected=c}}})};function a(){if(b.fn.ajaxSubmit.debug){var c="[jquery.form] "+Array.prototype.join.call(arguments,"");if(window.console&&window.console.log){window.console.log(c)}else{if(window.opera&&window.opera.postError){window.opera.postError(c)}}}}})(jQuery);
(function($j) {
    $j.fn.textfill = function(options) {
        var defaults = {
            maxFontPixels: 40,
            innerTag: 'span'
        };
        var Opts = jQuery.extend(defaults, options);
        return this.each(function() {
            var fontSize = Opts.maxFontPixels;
            var ourText = $j(Opts.innerTag + ':visible:first', this);
            var maxHeight = $j(this).height();
            var maxWidth = $j(this).width();
            var textHeight;
            var textWidth;
            do {
                ourText.css('font-size', fontSize);
                textHeight = ourText.height();
                textWidth = ourText.width();
                fontSize = fontSize - 1;
            } while ((textHeight > maxHeight || textWidth > maxWidth) && fontSize > 3);
        });
    };
})(jQuery);
/*! jQuery & Zepto Lazy v1.7.7 - http://jquery.eisbehr.de/lazy - MIT&GPL-2.0 license - Copyright 2012-2017 Daniel 'Eisbehr' Kern */
!function(t,e){"use strict";function r(r,a,i,u,l){function f(){L=t.devicePixelRatio>1,i=c(i),a.delay>=0&&setTimeout(function(){s(!0)},a.delay),(a.delay<0||a.combined)&&(u.e=v(a.throttle,function(t){"resize"===t.type&&(w=B=-1),s(t.all)}),u.a=function(t){t=c(t),i.push.apply(i,t)},u.g=function(){return i=n(i).filter(function(){return!n(this).data(a.loadedName)})},u.f=function(t){for(var e=0;e<t.length;e++){var r=i.filter(function(){return this===t[e]});r.length&&s(!1,r)}},s(),n(a.appendScroll).on("scroll."+l+" resize."+l,u.e))}function c(t){var i=a.defaultImage,o=a.placeholder,u=a.imageBase,l=a.srcsetAttribute,f=a.loaderAttribute,c=a._f||{};t=n(t).filter(function(){var t=n(this),r=m(this);return!t.data(a.handledName)&&(t.attr(a.attribute)||t.attr(l)||t.attr(f)||c[r]!==e)}).data("plugin_"+a.name,r);for(var s=0,d=t.length;s<d;s++){var A=n(t[s]),g=m(t[s]),h=A.attr(a.imageBaseAttribute)||u;g===N&&h&&A.attr(l)&&A.attr(l,b(A.attr(l),h)),c[g]===e||A.attr(f)||A.attr(f,c[g]),g===N&&i&&!A.attr(E)?A.attr(E,i):g===N||!o||A.css(O)&&"none"!==A.css(O)||A.css(O,"url('"+o+"')")}return t}function s(t,e){if(!i.length)return void(a.autoDestroy&&r.destroy());for(var o=e||i,u=!1,l=a.imageBase||"",f=a.srcsetAttribute,c=a.handledName,s=0;s<o.length;s++)if(t||e||A(o[s])){var g=n(o[s]),h=m(o[s]),b=g.attr(a.attribute),v=g.attr(a.imageBaseAttribute)||l,p=g.attr(a.loaderAttribute);g.data(c)||a.visibleOnly&&!g.is(":visible")||!((b||g.attr(f))&&(h===N&&(v+b!==g.attr(E)||g.attr(f)!==g.attr(F))||h!==N&&v+b!==g.css(O))||p)||(u=!0,g.data(c,!0),d(g,h,v,p))}u&&(i=n(i).filter(function(){return!n(this).data(c)}))}function d(t,e,r,i){++z;var o=function(){y("onError",t),p(),o=n.noop};y("beforeLoad",t);var u=a.attribute,l=a.srcsetAttribute,f=a.sizesAttribute,c=a.retinaAttribute,s=a.removeAttribute,d=a.loadedName,A=t.attr(c);if(i){var g=function(){s&&t.removeAttr(a.loaderAttribute),t.data(d,!0),y(T,t),setTimeout(p,1),g=n.noop};t.off(I).one(I,o).one(D,g),y(i,t,function(e){e?(t.off(D),g()):(t.off(I),o())})||t.trigger(I)}else{var h=n(new Image);h.one(I,o).one(D,function(){t.hide(),e===N?t.attr(C,h.attr(C)).attr(F,h.attr(F)).attr(E,h.attr(E)):t.css(O,"url('"+h.attr(E)+"')"),t[a.effect](a.effectTime),s&&(t.removeAttr(u+" "+l+" "+c+" "+a.imageBaseAttribute),f!==C&&t.removeAttr(f)),t.data(d,!0),y(T,t),h.remove(),p()});var m=(L&&A?A:t.attr(u))||"";h.attr(C,t.attr(f)).attr(F,t.attr(l)).attr(E,m?r+m:null),h.complete&&h.trigger(D)}}function A(t){var e=t.getBoundingClientRect(),r=a.scrollDirection,n=a.threshold,i=h()+n>e.top&&-n<e.bottom,o=g()+n>e.left&&-n<e.right;return"vertical"===r?i:"horizontal"===r?o:i&&o}function g(){return w>=0?w:w=n(t).width()}function h(){return B>=0?B:B=n(t).height()}function m(t){return t.tagName.toLowerCase()}function b(t,e){if(e){var r=t.split(",");t="";for(var a=0,n=r.length;a<n;a++)t+=e+r[a].trim()+(a!==n-1?",":"")}return t}function v(t,e){var n,i=0;return function(o,u){function l(){i=+new Date,e.call(r,o)}var f=+new Date-i;n&&clearTimeout(n),f>t||!a.enableThrottle||u?l():n=setTimeout(l,t-f)}}function p(){--z,i.length||z||y("onFinishedAll")}function y(t,e,n){return!!(t=a[t])&&(t.apply(r,[].slice.call(arguments,1)),!0)}var z=0,w=-1,B=-1,L=!1,T="afterLoad",D="load",I="error",N="img",E="src",F="srcset",C="sizes",O="background-image";"event"===a.bind||o?f():n(t).on(D+"."+l,f)}function a(a,o){var u=this,l=n.extend({},u.config,o),f={},c=l.name+"-"+ ++i;return u.config=function(t,r){return r===e?l[t]:(l[t]=r,u)},u.addItems=function(t){return f.a&&f.a("string"===n.type(t)?n(t):t),u},u.getItems=function(){return f.g?f.g():{}},u.update=function(t){return f.e&&f.e({},!t),u},u.force=function(t){return f.f&&f.f("string"===n.type(t)?n(t):t),u},u.loadAll=function(){return f.e&&f.e({all:!0},!0),u},u.destroy=function(){return n(l.appendScroll).off("."+c,f.e),n(t).off("."+c),f={},e},r(u,l,a,f,c),l.chainable?a:u}var n=t.jQuery||t.Zepto,i=0,o=!1;n.fn.Lazy=n.fn.lazy=function(t){return new a(this,t)},n.Lazy=n.lazy=function(t,r,i){if(n.isFunction(r)&&(i=r,r=[]),n.isFunction(i)){t=n.isArray(t)?t:[t],r=n.isArray(r)?r:[r];for(var o=a.prototype.config,u=o._f||(o._f={}),l=0,f=t.length;l<f;l++)(o[t[l]]===e||n.isFunction(o[t[l]]))&&(o[t[l]]=i);for(var c=0,s=r.length;c<s;c++)u[r[c]]=t[0]}},a.prototype.config={name:"lazy",chainable:!0,autoDestroy:!0,bind:"load",threshold:500,visibleOnly:!1,appendScroll:t,scrollDirection:"both",imageBase:null,defaultImage:"data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",placeholder:null,delay:-1,combined:!1,attribute:"data-src",srcsetAttribute:"data-srcset",sizesAttribute:"data-sizes",retinaAttribute:"data-retina",loaderAttribute:"data-loader",imageBaseAttribute:"data-imagebase",removeAttribute:!0,handledName:"handled",loadedName:"loaded",effect:"show",effectTime:0,enableThrottle:!0,throttle:250,beforeLoad:e,afterLoad:e,onError:e,onFinishedAll:e},n(t).on("load",function(){o=!0})}(window);
!function(){var root="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||this,previousUnderscore=root._,ArrayProto=Array.prototype,ObjProto=Object.prototype,push=ArrayProto.push,slice=ArrayProto.slice,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty,nativeIsArray=Array.isArray,nativeKeys=Object.keys,nativeCreate=Object.create,Ctor=function(){},_=function(obj){return obj instanceof _?obj:this instanceof _?void(this._wrapped=obj):new _(obj)};"undefined"==typeof exports||exports.nodeType?root._=_:("undefined"!=typeof module&&!module.nodeType&&module.exports&&(exports=module.exports=_),exports._=_),_.VERSION="1.8.3";var optimizeCb=function(func,context,argCount){if(void 0===context)return func;switch(null==argCount?3:argCount){case 1:return function(value){return func.call(context,value)};case 3:return function(value,index,collection){return func.call(context,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(context,accumulator,value,index,collection)}}return function(){return func.apply(context,arguments)}},cb=function(value,context,argCount){return null==value?_.identity:_.isFunction(value)?optimizeCb(value,context,argCount):_.isObject(value)?_.matcher(value):_.property(value)};_.iteratee=function(value,context){return cb(value,context,1/0)};var restArgs=function(func,startIndex){return startIndex=null==startIndex?func.length-1:+startIndex,function(){for(var length=Math.max(arguments.length-startIndex,0),rest=Array(length),index=0;index<length;index++)rest[index]=arguments[index+startIndex];switch(startIndex){case 0:return func.call(this,rest);case 1:return func.call(this,arguments[0],rest);case 2:return func.call(this,arguments[0],arguments[1],rest)}var args=Array(startIndex+1);for(index=0;index<startIndex;index++)args[index]=arguments[index];return args[startIndex]=rest,func.apply(this,args)}},baseCreate=function(prototype){if(!_.isObject(prototype))return{};if(nativeCreate)return nativeCreate(prototype);Ctor.prototype=prototype;var result=new Ctor;return Ctor.prototype=null,result},property=function(key){return function(obj){return null==obj?void 0:obj[key]}},MAX_ARRAY_INDEX=Math.pow(2,53)-1,getLength=property("length"),isArrayLike=function(collection){var length=getLength(collection);return"number"==typeof length&&length>=0&&length<=MAX_ARRAY_INDEX};_.each=_.forEach=function(obj,iteratee,context){iteratee=optimizeCb(iteratee,context);var i,length;if(isArrayLike(obj))for(i=0,length=obj.length;i<length;i++)iteratee(obj[i],i,obj);else{var keys=_.keys(obj);for(i=0,length=keys.length;i<length;i++)iteratee(obj[keys[i]],keys[i],obj)}return obj},_.map=_.collect=function(obj,iteratee,context){iteratee=cb(iteratee,context);for(var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,results=Array(length),index=0;index<length;index++){var currentKey=keys?keys[index]:index;results[index]=iteratee(obj[currentKey],currentKey,obj)}return results};var createReduce=function(dir){var reducer=function(obj,iteratee,memo,initial){var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,index=dir>0?0:length-1;for(initial||(memo=obj[keys?keys[index]:index],index+=dir);index>=0&&index<length;index+=dir){var currentKey=keys?keys[index]:index;memo=iteratee(memo,obj[currentKey],currentKey,obj)}return memo};return function(obj,iteratee,memo,context){var initial=arguments.length>=3;return reducer(obj,optimizeCb(iteratee,context,4),memo,initial)}};_.reduce=_.foldl=_.inject=createReduce(1),_.reduceRight=_.foldr=createReduce(-1),_.find=_.detect=function(obj,predicate,context){var key;if(void 0!==(key=isArrayLike(obj)?_.findIndex(obj,predicate,context):_.findKey(obj,predicate,context))&&-1!==key)return obj[key]},_.filter=_.select=function(obj,predicate,context){var results=[];return predicate=cb(predicate,context),_.each(obj,function(value,index,list){predicate(value,index,list)&&results.push(value)}),results},_.reject=function(obj,predicate,context){return _.filter(obj,_.negate(cb(predicate)),context)},_.every=_.all=function(obj,predicate,context){predicate=cb(predicate,context);for(var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,index=0;index<length;index++){var currentKey=keys?keys[index]:index;if(!predicate(obj[currentKey],currentKey,obj))return!1}return!0},_.some=_.any=function(obj,predicate,context){predicate=cb(predicate,context);for(var keys=!isArrayLike(obj)&&_.keys(obj),length=(keys||obj).length,index=0;index<length;index++){var currentKey=keys?keys[index]:index;if(predicate(obj[currentKey],currentKey,obj))return!0}return!1},_.contains=_.includes=_.include=function(obj,item,fromIndex,guard){return isArrayLike(obj)||(obj=_.values(obj)),("number"!=typeof fromIndex||guard)&&(fromIndex=0),_.indexOf(obj,item,fromIndex)>=0},_.invoke=restArgs(function(obj,method,args){var isFunc=_.isFunction(method);return _.map(obj,function(value){var func=isFunc?method:value[method];return null==func?func:func.apply(value,args)})}),_.pluck=function(obj,key){return _.map(obj,_.property(key))},_.where=function(obj,attrs){return _.filter(obj,_.matcher(attrs))},_.findWhere=function(obj,attrs){return _.find(obj,_.matcher(attrs))},_.max=function(obj,iteratee,context){var value,computed,result=-1/0,lastComputed=-1/0;if(null==iteratee||"number"==typeof iteratee&&"object"!=typeof obj[0]&&null!=obj)for(var i=0,length=(obj=isArrayLike(obj)?obj:_.values(obj)).length;i<length;i++)null!=(value=obj[i])&&value>result&&(result=value);else iteratee=cb(iteratee,context),_.each(obj,function(v,index,list){((computed=iteratee(v,index,list))>lastComputed||computed===-1/0&&result===-1/0)&&(result=v,lastComputed=computed)});return result},_.min=function(obj,iteratee,context){var value,computed,result=1/0,lastComputed=1/0;if(null==iteratee||"number"==typeof iteratee&&"object"!=typeof obj[0]&&null!=obj)for(var i=0,length=(obj=isArrayLike(obj)?obj:_.values(obj)).length;i<length;i++)null!=(value=obj[i])&&value<result&&(result=value);else iteratee=cb(iteratee,context),_.each(obj,function(v,index,list){((computed=iteratee(v,index,list))<lastComputed||computed===1/0&&result===1/0)&&(result=v,lastComputed=computed)});return result},_.shuffle=function(obj){return _.sample(obj,1/0)},_.sample=function(obj,n,guard){if(null==n||guard)return isArrayLike(obj)||(obj=_.values(obj)),obj[_.random(obj.length-1)];var sample=isArrayLike(obj)?_.clone(obj):_.values(obj),length=getLength(sample);n=Math.max(Math.min(n,length),0);for(var last=length-1,index=0;index<n;index++){var rand=_.random(index,last),temp=sample[index];sample[index]=sample[rand],sample[rand]=temp}return sample.slice(0,n)},_.sortBy=function(obj,iteratee,context){var index=0;return iteratee=cb(iteratee,context),_.pluck(_.map(obj,function(value,key,list){return{value:value,index:index++,criteria:iteratee(value,key,list)}}).sort(function(left,right){var a=left.criteria,b=right.criteria;if(a!==b){if(a>b||void 0===a)return 1;if(a<b||void 0===b)return-1}return left.index-right.index}),"value")};var group=function(behavior,partition){return function(obj,iteratee,context){var result=partition?[[],[]]:{};return iteratee=cb(iteratee,context),_.each(obj,function(value,index){var key=iteratee(value,index,obj);behavior(result,value,key)}),result}};_.groupBy=group(function(result,value,key){_.has(result,key)?result[key].push(value):result[key]=[value]}),_.indexBy=group(function(result,value,key){result[key]=value}),_.countBy=group(function(result,value,key){_.has(result,key)?result[key]++:result[key]=1});var reStrSymbol=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;_.toArray=function(obj){return obj?_.isArray(obj)?slice.call(obj):_.isString(obj)?obj.match(reStrSymbol):isArrayLike(obj)?_.map(obj,_.identity):_.values(obj):[]},_.size=function(obj){return null==obj?0:isArrayLike(obj)?obj.length:_.keys(obj).length},_.partition=group(function(result,value,pass){result[pass?0:1].push(value)},!0),_.first=_.head=_.take=function(array,n,guard){if(null!=array)return null==n||guard?array[0]:_.initial(array,array.length-n)},_.initial=function(array,n,guard){return slice.call(array,0,Math.max(0,array.length-(null==n||guard?1:n)))},_.last=function(array,n,guard){if(null!=array)return null==n||guard?array[array.length-1]:_.rest(array,Math.max(0,array.length-n))},_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,null==n||guard?1:n)},_.compact=function(array){return _.filter(array,_.identity)};var flatten=function(input,shallow,strict,output){for(var idx=(output=output||[]).length,i=0,length=getLength(input);i<length;i++){var value=input[i];if(isArrayLike(value)&&(_.isArray(value)||_.isArguments(value)))if(shallow)for(var j=0,len=value.length;j<len;)output[idx++]=value[j++];else flatten(value,shallow,strict,output),idx=output.length;else strict||(output[idx++]=value)}return output};_.flatten=function(array,shallow){return flatten(array,shallow,!1)},_.without=restArgs(function(array,otherArrays){return _.difference(array,otherArrays)}),_.uniq=_.unique=function(array,isSorted,iteratee,context){_.isBoolean(isSorted)||(context=iteratee,iteratee=isSorted,isSorted=!1),null!=iteratee&&(iteratee=cb(iteratee,context));for(var result=[],seen=[],i=0,length=getLength(array);i<length;i++){var value=array[i],computed=iteratee?iteratee(value,i,array):value;isSorted?(i&&seen===computed||result.push(value),seen=computed):iteratee?_.contains(seen,computed)||(seen.push(computed),result.push(value)):_.contains(result,value)||result.push(value)}return result},_.union=restArgs(function(arrays){return _.uniq(flatten(arrays,!0,!0))}),_.intersection=function(array){for(var result=[],argsLength=arguments.length,i=0,length=getLength(array);i<length;i++){var item=array[i];if(!_.contains(result,item)){var j;for(j=1;j<argsLength&&_.contains(arguments[j],item);j++);j===argsLength&&result.push(item)}}return result},_.difference=restArgs(function(array,rest){return rest=flatten(rest,!0,!0),_.filter(array,function(value){return!_.contains(rest,value)})}),_.unzip=function(array){for(var length=array&&_.max(array,getLength).length||0,result=Array(length),index=0;index<length;index++)result[index]=_.pluck(array,index);return result},_.zip=restArgs(_.unzip),_.object=function(list,values){for(var result={},i=0,length=getLength(list);i<length;i++)values?result[list[i]]=values[i]:result[list[i][0]]=list[i][1];return result};var createPredicateIndexFinder=function(dir){return function(array,predicate,context){predicate=cb(predicate,context);for(var length=getLength(array),index=dir>0?0:length-1;index>=0&&index<length;index+=dir)if(predicate(array[index],index,array))return index;return-1}};_.findIndex=createPredicateIndexFinder(1),_.findLastIndex=createPredicateIndexFinder(-1),_.sortedIndex=function(array,obj,iteratee,context){for(var value=(iteratee=cb(iteratee,context,1))(obj),low=0,high=getLength(array);low<high;){var mid=Math.floor((low+high)/2);iteratee(array[mid])<value?low=mid+1:high=mid}return low};var createIndexFinder=function(dir,predicateFind,sortedIndex){return function(array,item,idx){var i=0,length=getLength(array);if("number"==typeof idx)dir>0?i=idx>=0?idx:Math.max(idx+length,i):length=idx>=0?Math.min(idx+1,length):idx+length+1;else if(sortedIndex&&idx&&length)return idx=sortedIndex(array,item),array[idx]===item?idx:-1;if(item!==item)return(idx=predicateFind(slice.call(array,i,length),_.isNaN))>=0?idx+i:-1;for(idx=dir>0?i:length-1;idx>=0&&idx<length;idx+=dir)if(array[idx]===item)return idx;return-1}};_.indexOf=createIndexFinder(1,_.findIndex,_.sortedIndex),_.lastIndexOf=createIndexFinder(-1,_.findLastIndex),_.range=function(start,stop,step){null==stop&&(stop=start||0,start=0),step||(step=stop<start?-1:1);for(var length=Math.max(Math.ceil((stop-start)/step),0),range=Array(length),idx=0;idx<length;idx++,start+=step)range[idx]=start;return range},_.chunk=function(array,count){if(null==count||count<1)return[];for(var result=[],i=0,length=array.length;i<length;)result.push(slice.call(array,i,i+=count));return result};var executeBound=function(sourceFunc,boundFunc,context,callingContext,args){if(!(callingContext instanceof boundFunc))return sourceFunc.apply(context,args);var self=baseCreate(sourceFunc.prototype),result=sourceFunc.apply(self,args);return _.isObject(result)?result:self};_.bind=restArgs(function(func,context,args){if(!_.isFunction(func))throw new TypeError("Bind must be called on a function");var bound=restArgs(function(callArgs){return executeBound(func,bound,context,this,args.concat(callArgs))});return bound}),_.partial=restArgs(function(func,boundArgs){var placeholder=_.partial.placeholder,bound=function(){for(var position=0,length=boundArgs.length,args=Array(length),i=0;i<length;i++)args[i]=boundArgs[i]===placeholder?arguments[position++]:boundArgs[i];for(;position<arguments.length;)args.push(arguments[position++]);return executeBound(func,bound,this,this,args)};return bound}),_.partial.placeholder=_,_.bindAll=restArgs(function(obj,keys){var index=(keys=flatten(keys,!1,!1)).length;if(index<1)throw new Error("bindAll must be passed function names");for(;index--;){var key=keys[index];obj[key]=_.bind(obj[key],obj)}}),_.memoize=function(func,hasher){var memoize=function(key){var cache=memoize.cache,address=""+(hasher?hasher.apply(this,arguments):key);return _.has(cache,address)||(cache[address]=func.apply(this,arguments)),cache[address]};return memoize.cache={},memoize},_.delay=restArgs(function(func,wait,args){return setTimeout(function(){return func.apply(null,args)},wait)}),_.defer=_.partial(_.delay,_,1),_.throttle=function(func,wait,options){var timeout,context,args,result,previous=0;options||(options={});var later=function(){previous=!1===options.leading?0:_.now(),timeout=null,result=func.apply(context,args),timeout||(context=args=null)},throttled=function(){var now=_.now();previous||!1!==options.leading||(previous=now);var remaining=wait-(now-previous);return context=this,args=arguments,remaining<=0||remaining>wait?(timeout&&(clearTimeout(timeout),timeout=null),previous=now,result=func.apply(context,args),timeout||(context=args=null)):timeout||!1===options.trailing||(timeout=setTimeout(later,remaining)),result};return throttled.cancel=function(){clearTimeout(timeout),previous=0,timeout=context=args=null},throttled},_.debounce=function(func,wait,immediate){var timeout,result,later=function(context,args){timeout=null,args&&(result=func.apply(context,args))},debounced=restArgs(function(args){var callNow=immediate&&!timeout;return timeout&&clearTimeout(timeout),callNow?(timeout=setTimeout(later,wait),result=func.apply(this,args)):immediate||(timeout=_.delay(later,wait,this,args)),result});return debounced.cancel=function(){clearTimeout(timeout),timeout=null},debounced},_.wrap=function(func,wrapper){return _.partial(wrapper,func)},_.negate=function(predicate){return function(){return!predicate.apply(this,arguments)}},_.compose=function(){var args=arguments,start=args.length-1;return function(){for(var i=start,result=args[start].apply(this,arguments);i--;)result=args[i].call(this,result);return result}},_.after=function(times,func){return function(){if(--times<1)return func.apply(this,arguments)}},_.before=function(times,func){var memo;return function(){return--times>0&&(memo=func.apply(this,arguments)),times<=1&&(func=null),memo}},_.once=_.partial(_.before,2),_.restArgs=restArgs;var hasEnumBug=!{toString:null}.propertyIsEnumerable("toString"),nonEnumerableProps=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],collectNonEnumProps=function(obj,keys){var nonEnumIdx=nonEnumerableProps.length,constructor=obj.constructor,proto=_.isFunction(constructor)&&constructor.prototype||ObjProto,prop="constructor";for(_.has(obj,prop)&&!_.contains(keys,prop)&&keys.push(prop);nonEnumIdx--;)(prop=nonEnumerableProps[nonEnumIdx])in obj&&obj[prop]!==proto[prop]&&!_.contains(keys,prop)&&keys.push(prop)};_.keys=function(obj){if(!_.isObject(obj))return[];if(nativeKeys)return nativeKeys(obj);var keys=[];for(var key in obj)_.has(obj,key)&&keys.push(key);return hasEnumBug&&collectNonEnumProps(obj,keys),keys},_.allKeys=function(obj){if(!_.isObject(obj))return[];var keys=[];for(var key in obj)keys.push(key);return hasEnumBug&&collectNonEnumProps(obj,keys),keys},_.values=function(obj){for(var keys=_.keys(obj),length=keys.length,values=Array(length),i=0;i<length;i++)values[i]=obj[keys[i]];return values},_.mapObject=function(obj,iteratee,context){iteratee=cb(iteratee,context);for(var keys=_.keys(obj),length=keys.length,results={},index=0;index<length;index++){var currentKey=keys[index];results[currentKey]=iteratee(obj[currentKey],currentKey,obj)}return results},_.pairs=function(obj){for(var keys=_.keys(obj),length=keys.length,pairs=Array(length),i=0;i<length;i++)pairs[i]=[keys[i],obj[keys[i]]];return pairs},_.invert=function(obj){for(var result={},keys=_.keys(obj),i=0,length=keys.length;i<length;i++)result[obj[keys[i]]]=keys[i];return result},_.functions=_.methods=function(obj){var names=[];for(var key in obj)_.isFunction(obj[key])&&names.push(key);return names.sort()};var createAssigner=function(keysFunc,defaults){return function(obj){var length=arguments.length;if(defaults&&(obj=Object(obj)),length<2||null==obj)return obj;for(var index=1;index<length;index++)for(var source=arguments[index],keys=keysFunc(source),l=keys.length,i=0;i<l;i++){var key=keys[i];defaults&&void 0!==obj[key]||(obj[key]=source[key])}return obj}};_.extend=createAssigner(_.allKeys),_.extendOwn=_.assign=createAssigner(_.keys),_.findKey=function(obj,predicate,context){predicate=cb(predicate,context);for(var key,keys=_.keys(obj),i=0,length=keys.length;i<length;i++)if(key=keys[i],predicate(obj[key],key,obj))return key};var keyInObj=function(value,key,obj){return key in obj};_.pick=restArgs(function(obj,keys){var result={},iteratee=keys[0];if(null==obj)return result;_.isFunction(iteratee)?(keys.length>1&&(iteratee=optimizeCb(iteratee,keys[1])),keys=_.allKeys(obj)):(iteratee=keyInObj,keys=flatten(keys,!1,!1),obj=Object(obj));for(var i=0,length=keys.length;i<length;i++){var key=keys[i],value=obj[key];iteratee(value,key,obj)&&(result[key]=value)}return result}),_.omit=restArgs(function(obj,keys){var context,iteratee=keys[0];return _.isFunction(iteratee)?(iteratee=_.negate(iteratee),keys.length>1&&(context=keys[1])):(keys=_.map(flatten(keys,!1,!1),String),iteratee=function(value,key){return!_.contains(keys,key)}),_.pick(obj,iteratee,context)}),_.defaults=createAssigner(_.allKeys,!0),_.create=function(prototype,props){var result=baseCreate(prototype);return props&&_.extendOwn(result,props),result},_.clone=function(obj){return _.isObject(obj)?_.isArray(obj)?obj.slice():_.extend({},obj):obj},_.tap=function(obj,interceptor){return interceptor(obj),obj},_.isMatch=function(object,attrs){var keys=_.keys(attrs),length=keys.length;if(null==object)return!length;for(var obj=Object(object),i=0;i<length;i++){var key=keys[i];if(attrs[key]!==obj[key]||!(key in obj))return!1}return!0};var eq,deepEq;eq=function(a,b,aStack,bStack){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;if(a!==a)return b!==b;var type=typeof a;return("function"===type||"object"===type||"object"==typeof b)&&deepEq(a,b,aStack,bStack)},deepEq=function(a,b,aStack,bStack){a instanceof _&&(a=a._wrapped),b instanceof _&&(b=b._wrapped);var className=toString.call(a);if(className!==toString.call(b))return!1;switch(className){case"[object RegExp]":case"[object String]":return""+a==""+b;case"[object Number]":return+a!=+a?+b!=+b:0==+a?1/+a==1/b:+a==+b;case"[object Date]":case"[object Boolean]":return+a==+b}var areArrays="[object Array]"===className;if(!areArrays){if("object"!=typeof a||"object"!=typeof b)return!1;var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor)&&"constructor"in a&&"constructor"in b)return!1}aStack=aStack||[],bStack=bStack||[];for(var length=aStack.length;length--;)if(aStack[length]===a)return bStack[length]===b;if(aStack.push(a),bStack.push(b),areArrays){if((length=a.length)!==b.length)return!1;for(;length--;)if(!eq(a[length],b[length],aStack,bStack))return!1}else{var key,keys=_.keys(a);if(length=keys.length,_.keys(b).length!==length)return!1;for(;length--;)if(key=keys[length],!_.has(b,key)||!eq(a[key],b[key],aStack,bStack))return!1}return aStack.pop(),bStack.pop(),!0},_.isEqual=function(a,b){return eq(a,b)},_.isEmpty=function(obj){return null==obj||(isArrayLike(obj)&&(_.isArray(obj)||_.isString(obj)||_.isArguments(obj))?0===obj.length:0===_.keys(obj).length)},_.isElement=function(obj){return!(!obj||1!==obj.nodeType)},_.isArray=nativeIsArray||function(obj){return"[object Array]"===toString.call(obj)},_.isObject=function(obj){var type=typeof obj;return"function"===type||"object"===type&&!!obj},_.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(name){_["is"+name]=function(obj){return toString.call(obj)==="[object "+name+"]"}}),_.isArguments(arguments)||(_.isArguments=function(obj){return _.has(obj,"callee")});var nodelist=root.document&&root.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof nodelist&&(_.isFunction=function(obj){return"function"==typeof obj||!1}),_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj))},_.isNaN=function(obj){return _.isNumber(obj)&&isNaN(obj)},_.isBoolean=function(obj){return!0===obj||!1===obj||"[object Boolean]"===toString.call(obj)},_.isNull=function(obj){return null===obj},_.isUndefined=function(obj){return void 0===obj},_.has=function(obj,key){return null!=obj&&hasOwnProperty.call(obj,key)},_.noConflict=function(){return root._=previousUnderscore,this},_.identity=function(value){return value},_.constant=function(value){return function(){return value}},_.noop=function(){},_.property=property,_.propertyOf=function(obj){return null==obj?function(){}:function(key){return obj[key]}},_.matcher=_.matches=function(attrs){return attrs=_.extendOwn({},attrs),function(obj){return _.isMatch(obj,attrs)}},_.times=function(n,iteratee,context){var accum=Array(Math.max(0,n));iteratee=optimizeCb(iteratee,context,1);for(var i=0;i<n;i++)accum[i]=iteratee(i);return accum},_.random=function(min,max){return null==max&&(max=min,min=0),min+Math.floor(Math.random()*(max-min+1))},_.now=Date.now||function(){return(new Date).getTime()};var escapeMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},unescapeMap=_.invert(escapeMap),createEscaper=function(map){var escaper=function(match){return map[match]},source="(?:"+_.keys(map).join("|")+")",testRegexp=RegExp(source),replaceRegexp=RegExp(source,"g");return function(string){return string=null==string?"":""+string,testRegexp.test(string)?string.replace(replaceRegexp,escaper):string}};_.escape=createEscaper(escapeMap),_.unescape=createEscaper(unescapeMap),_.result=function(object,prop,fallback){var value=null==object?void 0:object[prop];return void 0===value&&(value=fallback),_.isFunction(value)?value.call(object):value};var idCounter=0;_.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var noMatch=/(.)^/,escapes={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},escapeRegExp=/\\|'|\r|\n|\u2028|\u2029/g,escapeChar=function(match){return"\\"+escapes[match]};_.template=function(text,settings,oldSettings){!settings&&oldSettings&&(settings=oldSettings),settings=_.defaults({},settings,_.templateSettings);var matcher=RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g"),index=0,source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){return source+=text.slice(index,offset).replace(escapeRegExp,escapeChar),index=offset+match.length,escape?source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'":interpolate?source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'":evaluate&&(source+="';\n"+evaluate+"\n__p+='"),match}),source+="';\n",settings.variable||(source="with(obj||{}){\n"+source+"}\n"),source="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+source+"return __p;\n";var render;try{render=new Function(settings.variable||"obj","_",source)}catch(e){throw e.source=source,e}var template=function(data){return render.call(this,data,_)},argument=settings.variable||"obj";return template.source="function("+argument+"){\n"+source+"}",template},_.chain=function(obj){var instance=_(obj);return instance._chain=!0,instance};var chainResult=function(instance,obj){return instance._chain?_(obj).chain():obj};_.mixin=function(obj){_.each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];return push.apply(args,arguments),chainResult(this,func.apply(_,args))}})},_.mixin(_),_.each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;return method.apply(obj,arguments),"shift"!==name&&"splice"!==name||0!==obj.length||delete obj[0],chainResult(this,obj)}}),_.each(["concat","join","slice"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return chainResult(this,method.apply(this._wrapped,arguments))}}),_.prototype.value=function(){return this._wrapped},_.prototype.valueOf=_.prototype.toJSON=_.prototype.value,_.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return _})}();
!function(){"use strict";try{0()}catch(e){var err=e}if("fileName"in err||"stacktrace"in err||"stack"in err){var write,addEvtListener,remEvtListener,listener,doc=document,anchor=doc.createElement("a"),notReady=!0,writeQueue=[],nativeDocWrite=doc.write,getElemsByTag=function(tag){return doc.getElementsByTagName(tag)},head=getElemsByTag("head")[0],domReady=function(){if(notReady){notReady=!1;for(var writeTo=write.to,item=0,len=writeQueue.length;item<len;item++)write.to=writeQueue[item++],write(writeQueue[item]),delete write.to;writeQueue=null,write.to=writeTo}},getErrorLocation=function(error){var loc,replacer=function(stack,matchedLoc){loc=matchedLoc};return"fileName"in error?loc=error.fileName:"stacktrace"in error?error.stacktrace.replace(/Line \d+ of .+ script (.*)/gm,replacer):"stack"in error&&(error.stack.replace(/at (.*)/gm,replacer),loc=loc.replace(/:\d+:\d+$/,"")),loc},slice=Array.prototype.slice;Object.prototype.toString;doc.addEventListener&&doc.removeEventListener?(addEvtListener=doc.addEventListener,remEvtListener=doc.removeEventListener,listener=function(evt){remEvtListener.call(doc,evt.type,listener,!1),domReady()},addEvtListener.call(doc,"DOMContentLoaded",listener,!1),addEvtListener.call(doc,"load",listener,!1)):doc.attachEvent&&doc.detachEvent&&(addEvtListener=doc.attachEvent,remEvtListener=doc.detachEvent,listener=function(){remEvtListener.call(doc,"onload",listener)},addEvtListener.call(doc,"onload",listener)),write=doc.write=function(){var markup=slice.call(arguments).join(""),body=getElemsByTag("body")[0],writeTo=write.to;if(body)if(writeTo){anchor.href=getErrorLocation(writeTo);var src=anchor.href,scripts=getElemsByTag("script"),node=doc.createElement("span");node.innerHTML=markup;for(var script=0,len=scripts.length;script<len;script++)if(anchor.href=scripts.item(script).src,anchor.href===src){for(var scriptNode=scripts.item(script),parent=scriptNode;parent=parent.parentNode;)if(parent===head)return void body.insertBefore(node,body.firstChild);return void scriptNode.parentNode.insertBefore(node,scriptNode)}}else nativeDocWrite.apply(doc,arguments);else writeQueue.push(writeTo,markup)},doc.writeln=function(){write.apply(this,slice.call(arguments).concat("\n"))},write.START="try{0()}catch(e){document.write.to=e}",write.END="delete document.write.to"}}();
var md5;!function(){function md5cycle(x,k){var a=x[0],b=x[1],c=x[2],d=x[3];b=ii(b=ii(b=ii(b=ii(b=hh(b=hh(b=hh(b=hh(b=gg(b=gg(b=gg(b=gg(b=ff(b=ff(b=ff(b=ff(b,c=ff(c,d=ff(d,a=ff(a,b,c,d,k[0],7,-680876936),b,c,k[1],12,-389564586),a,b,k[2],17,606105819),d,a,k[3],22,-1044525330),c=ff(c,d=ff(d,a=ff(a,b,c,d,k[4],7,-176418897),b,c,k[5],12,1200080426),a,b,k[6],17,-1473231341),d,a,k[7],22,-45705983),c=ff(c,d=ff(d,a=ff(a,b,c,d,k[8],7,1770035416),b,c,k[9],12,-1958414417),a,b,k[10],17,-42063),d,a,k[11],22,-1990404162),c=ff(c,d=ff(d,a=ff(a,b,c,d,k[12],7,1804603682),b,c,k[13],12,-40341101),a,b,k[14],17,-1502002290),d,a,k[15],22,1236535329),c=gg(c,d=gg(d,a=gg(a,b,c,d,k[1],5,-165796510),b,c,k[6],9,-1069501632),a,b,k[11],14,643717713),d,a,k[0],20,-373897302),c=gg(c,d=gg(d,a=gg(a,b,c,d,k[5],5,-701558691),b,c,k[10],9,38016083),a,b,k[15],14,-660478335),d,a,k[4],20,-405537848),c=gg(c,d=gg(d,a=gg(a,b,c,d,k[9],5,568446438),b,c,k[14],9,-1019803690),a,b,k[3],14,-187363961),d,a,k[8],20,1163531501),c=gg(c,d=gg(d,a=gg(a,b,c,d,k[13],5,-1444681467),b,c,k[2],9,-51403784),a,b,k[7],14,1735328473),d,a,k[12],20,-1926607734),c=hh(c,d=hh(d,a=hh(a,b,c,d,k[5],4,-378558),b,c,k[8],11,-2022574463),a,b,k[11],16,1839030562),d,a,k[14],23,-35309556),c=hh(c,d=hh(d,a=hh(a,b,c,d,k[1],4,-1530992060),b,c,k[4],11,1272893353),a,b,k[7],16,-155497632),d,a,k[10],23,-1094730640),c=hh(c,d=hh(d,a=hh(a,b,c,d,k[13],4,681279174),b,c,k[0],11,-358537222),a,b,k[3],16,-722521979),d,a,k[6],23,76029189),c=hh(c,d=hh(d,a=hh(a,b,c,d,k[9],4,-640364487),b,c,k[12],11,-421815835),a,b,k[15],16,530742520),d,a,k[2],23,-995338651),c=ii(c,d=ii(d,a=ii(a,b,c,d,k[0],6,-198630844),b,c,k[7],10,1126891415),a,b,k[14],15,-1416354905),d,a,k[5],21,-57434055),c=ii(c,d=ii(d,a=ii(a,b,c,d,k[12],6,1700485571),b,c,k[3],10,-1894986606),a,b,k[10],15,-1051523),d,a,k[1],21,-2054922799),c=ii(c,d=ii(d,a=ii(a,b,c,d,k[8],6,1873313359),b,c,k[15],10,-30611744),a,b,k[6],15,-1560198380),d,a,k[13],21,1309151649),c=ii(c,d=ii(d,a=ii(a,b,c,d,k[4],6,-145523070),b,c,k[11],10,-1120210379),a,b,k[2],15,718787259),d,a,k[9],21,-343485551),x[0]=add32(a,x[0]),x[1]=add32(b,x[1]),x[2]=add32(c,x[2]),x[3]=add32(d,x[3])}function cmn(q,a,b,x,s,t){return a=add32(add32(a,q),add32(x,t)),add32(a<<s|a>>>32-s,b)}function ff(a,b,c,d,x,s,t){return cmn(b&c|~b&d,a,b,x,s,t)}function gg(a,b,c,d,x,s,t){return cmn(b&d|c&~d,a,b,x,s,t)}function hh(a,b,c,d,x,s,t){return cmn(b^c^d,a,b,x,s,t)}function ii(a,b,c,d,x,s,t){return cmn(c^(b|~d),a,b,x,s,t)}function md51(s){/[\x80-\xFF]/.test(s)&&(s=unescape(encodeURI(s))),txt="";var i,n=s.length,state=[1732584193,-271733879,-1732584194,271733878];for(i=64;i<=s.length;i+=64)md5cycle(state,md5blk(s.substring(i-64,i)));s=s.substring(i-64);var tail=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(i=0;i<s.length;i++)tail[i>>2]|=s.charCodeAt(i)<<(i%4<<3);if(tail[i>>2]|=128<<(i%4<<3),i>55)for(md5cycle(state,tail),i=0;i<16;i++)tail[i]=0;return tail[14]=8*n,md5cycle(state,tail),state}function md5blk(s){var i,md5blks=[];for(i=0;i<64;i+=4)md5blks[i>>2]=s.charCodeAt(i)+(s.charCodeAt(i+1)<<8)+(s.charCodeAt(i+2)<<16)+(s.charCodeAt(i+3)<<24);return md5blks}function rhex(n){for(var s="",j=0;j<4;j++)s+=hex_chr[n>>8*j+4&15]+hex_chr[n>>8*j&15];return s}function hex(x){for(var i=0;i<x.length;i++)x[i]=rhex(x[i]);return x.join("")}function add32(a,b){return a+b&4294967295}function add32(x,y){var lsw=(65535&x)+(65535&y);return(x>>16)+(y>>16)+(lsw>>16)<<16|65535&lsw}var hex_chr="0123456789abcdef".split("");(md5=function(s){return hex(md51(s))})("hello")}();
var Cam4Event={OPENX_AD_LOADED:"openx_ads_loaded",TRANSALTOR_UPDATE:"translatorUpdate",DOCUMENT_KEY_DOWN:"documentKeyDown",KEY_UP:"keyup",WINDOW_ON_BEFORE_UNLOAD:"windowOnBeforeUnload",WINDOW_RESIZED:"windowResized",MODAL_OPENED:"modalOpened",MODAL_CLOSING:"modalClosing",PLAYER_LOADED:"playerLoaded",VIEWER_STREAM_LOADED:"viewerStreamLoaded",FULL_SCREEN_CHANGED:"fullScreenStateChanged",FULLSCREEN_STATE_CHANGED:"fullScreenActiveStateChanged",MULTICAM_DETECTED:"multicam_detected",ON_RTMP_EDGE_RECEIVED:"rtmp_edge_received",STARTING_NEW_SHOW:"starting_new_show",ENDING_NEW_SHOW:"ending_new_show",INTO_GROUP_SHOW:"in_group_show",STARTING_BROADCAST:"starting_broadcast",VIEWER_TIPPING_BAR_LOADED:"viewer_tipping_bar_loaded",broadcastSettings:{SET_BROADCAST_RESOLUTION:"set_broadcast_resolution",SET_CAMERA:"set_camera",SET_MICROPHONE:"set_microphone",ADJUST_FOR_NEW_RESOLUTION:"adjust_for_new_resolution",BACKUP_RTMP_URL_REQUESTED:"backup_rtmp_url_requested",FILTER_VIDEO_CLIENT:"filter_video_client",SET_QUALITY_FACTOR:"set_quality_factor"},hlsPlayer:{ON_FRAGMENT_LOADED:"hls_fragment_loaded",ON_FRAGMENT_ERROR:"hls_fragment_error",ON_LEVEL_LOADED:"hls_level_loaded"},registered:{},dispatchers:{},dispatch:function(eventName){this.dispatchers[eventName]?this.dispatchers[eventName]=this.dispatchers[eventName]+1:this.dispatchers[eventName]=1;for(var gargs=arguments,rargs=[],a=1;a<gargs.length;a++)rargs.push(gargs[a]);if(this.registered[eventName])for(var i=0;i<this.registered[eventName].length;i++)try{this.registered[eventName][i].method.apply(null,rargs)}catch(ex){console.log("unable to dispatch ",eventName," with args ",rargs,ex)}},hasEventListener:function(eventName,uidName){if(!this.registered[eventName])return!1;if(uidName){uidName+="";for(var i=0;i<this.registered[eventName].length;i++)if(this.registered[eventName][i].uid===uidName)return!0}return!1},addEventListener:function(eventName,callback,uidName){uidName||(uidName=callback+""),this.registered[eventName]||(this.registered[eventName]=[]),this.registered[eventName].push({method:callback,uid:uidName})},removeEventListener:function(eventName,uidName){if(!this.registered[eventName])return!1;if(uidName){"function"==typeof uidName&&(uidName+="");for(var i=0;i<this.registered[eventName].length;i++)this.registered[eventName][i].uid===uidName&&this.registered[eventName].splice(i,1)}else this.registered[eventName]=[]}},_documentRoot=document.body||document.documentElement||document.getElementsByTagName("head")[0];_documentRoot.onkeydown=function(event){Cam4Event.dispatch(Cam4Event.DOCUMENT_KEY_DOWN,event)},_documentRoot.onkeyup=function(event){Cam4Event.dispatch(Cam4Event.KEY_UP,event)},window.onbeforeunload=function(event){Cam4Event.dispatch(Cam4Event.WINDOW_ON_BEFORE_UNLOAD,event)},window.onresize=function(event){Cam4Event.dispatch(Cam4Event.WINDOW_RESIZED,event)},Cam4Event.hasEventListener(Cam4Event.DOCUMENT_KEY_DOWN,"closeModals")||Cam4Event.addEventListener(Cam4Event.DOCUMENT_KEY_DOWN,function(event){27!==(event.which?event.which:event.keyCode)||Disclaimer.disclaimerBeingShown||Utils.closeModalPops()},"closeModals");
var JsVar=function(){return{map:function(string,object){console.log(string);for(var regex=/JS_VAR\{(.*?)\}/,matches=string.match(regex);null!==matches;){console.log(matches);var value=matches[1];object&&object[value]&&(value=object[value]),matches=(string=string.replace(matches[0],value)).match(regex)}return string}}}();
var Table2CSV=function(){this.parseObject=function(arrayAsObject){for(var headers=[],lines=[],i=0;i<arrayAsObject.length;i++){var currentObject=arrayAsObject[i],line=[];for(var j in currentObject)headers.indexOf(j)<0&&headers.push(j),line.push((currentObject[j]+"").replace(/,/g,""));lines.push(line.join(","))}return headers.join(",")+"\n"+lines.join("\n")},this.parseTable=function(table,valueSeparator,lineSeparator){for(var _valueSeparator=valueSeparator||",",_lineSeparator=lineSeparator||"\r\n",rows=[],i=0;i<table.rows.length;i++){var line=[];if(table.rows[i].cells)for(var j=0;j<table.rows[i].cells.length;j++){var content=table.rows[i].cells[j].textContent||table.rows[i].cells[j].innerText;line.push('"'+content+'"')}rows.push(line.join(_valueSeparator))}return rows.join(_lineSeparator)},this.html5_download=function(content,filename,contentType){if(navigator.appVersion.indexOf("Chrome")>0){contentType||(contentType="application/octet-stream");var a=document.createElement("a"),blob=new Blob([content],{type:contentType});return a.href=URL.createObjectURL(blob),a.download=filename,a.click(),!0}return!1},this.getName=function(){var name=new Date+"";return name=name.replace(/\s/g,""),name=name.split("+")[0],name+=".csv"},this.openAsPage=function(content){var win=window.open(document.URL);return win.document.write(content),win},this.downloadParsed=function(text,newTab,file_name){return"undefined"!=typeof BrowserDetect&&"Explorer"==BrowserDetect.browser&&11==BrowserDetect.version?this.openAsPage(text):(file_name||(file_name=this.getName()),!1===this.html5_download(text,file_name,"text/plain")?newTab?(window.open("data:text/plain;charset=utf-8,"+encodeURIComponent(text)),3):(window.open("data:application/octet-stream,"+encodeURIComponent(text)),2):1)}};
var Cam4Storage=function(){function setLocal(key,value){try{localStorage.setItem(key,value)}catch(ex){}}function setSession(key,value){try{sessionStorage.setItem(key,value)}catch(ex){}}function getLocal(key){var answ=!1;try{answ=localStorage.getItem(key)}catch(ex){}return answ}function getSession(key){var answ=!1;try{answ=sessionStorage.getItem(key)}catch(ex){}return answ}function clearLocal(key){try{localStorage.removeItem(key)}catch(ex){}}function clearSession(key){try{sessionStorage.removeItem(key)}catch(ex){}}function updateLocal(key,value){try{return localStorage[key]=value,!0}catch(ex){}return!1}function updateSession(key,value){try{return sessionStorage[key]=value,!0}catch(ex){}return!1}return{set:function(key,value){setLocal(key,value),setSession(key,value)},get:function(key){var answ=getLocal(key);return answ||(answ=getSession(key)),answ},setLocal:setLocal,setSession:setSession,getLocal:getLocal,getSession:getSession,clearLocal:clearLocal,clearSession:clearSession,clear:function(key){clearLocal(key),clearSession(key)},eachLocal:function(callback){try{for(var i in localStorage)callback(i,localStorage[i])}catch(ex){}},eachSession:function(callback){try{for(var i in sessionStorage)callback(i,sessionStorage[i])}catch(ex){}},updateLocal:updateLocal,updateSession:updateSession,isEnabled:function(){return"undefined"!=typeof localStorage},update:function(key,value){updateLocal(key,value),updateSession(key,value)}}}();
var UrlDecoder=function(){function decode(url){if(!url)return null;var protocol=!1;0==url.indexOf("http://")&&(protocol="http"),0==url.indexOf("https://")&&(protocol="https");var _urlParts=url.replace(protocol+"://","").split("/"),response={},arr=_urlParts[_urlParts.length-1].split("?"),lastPage=arr[0],parts=arr[arr.length-1].split("&");if(parts.length>1)for(var i=0;i<parts.length;i++){var keyVal=parts[i].split("=");keyVal.length>1?response[keyVal[0]]=keyVal[1]:response[keyVal[0]]=!1}return{lastPage:lastPage,parts:_urlParts,url:url,protocol:protocol,params:response}}function getDomainFromUrl(url){return((url+="").indexOf("://")>-1?url.split("/")[2]:url.split("/")[0]).split(":")[0]}return{getParams:function(url){return console.log(decode(url)),decode(url).params},getDomainFromUrl:getDomainFromUrl,currentDomain:function(){return document.domain||getDomainFromUrl(document.URL)},decode:decode}}();
var SwfUtils=function(){function flashVarsQuery(object){arrArgs=[];for(var i in object)arrArgs.push(i+"="+object[i]);return arrArgs.join("&")}var lastSwfTagText=!1,lastObjectReceived=!1,arrArgs=[];return{generateSwfTag:function(object,params,itemid){itemid||(itemid="Cam4VChat"),lastObjectReceived=object,params||(params={quality:"high",bgcolor:"#ffffff",allowscriptaccess:"always",wmode:"transparent",allowfullscreen:!0,allowfullscreeninteractive:"true"});var flashVarsQueryString=flashVarsQuery(object.flashVars);params.flashvars=flashVarsQueryString,lastSwfTagText='<object width="100%"  height="100%"  align="middle"  data="'+object.playerUrl+'"  name="'+itemid+'"  id="'+itemid+'"  type="application/x-shockwave-flash">';for(var i in params)lastSwfTagText+='<param value="'+params[i]+'" name="'+i+'"/>';return lastSwfTagText+="</object>",this},flashVarsQuery:flashVarsQuery,getLastSwfTag:function(){return lastSwfTagText},getLastObjectReceived:function(){return lastObjectReceived},getLastArgs:function(){return arrArgs},into:function(id){return document.getElementById(id)&&(document.getElementById(id).innerHTML=lastSwfTagText),this}}}();
var DateTimes={overAWeek:new Date((new Date).getTime()+6048e5),threeDays:new Date((new Date).getTime()+2592e5),fiveMinutes:new Date((new Date).getTime()+3e5)},Cam4Cookies={getCookie:function(name){for(var nameEQ=name+"=",ca=document.cookie.split(";"),i=0;i<ca.length;i++){for(var c=ca[i];" "==c.charAt(0);)c=c.substring(1,c.length);if(0==c.indexOf(nameEQ))return c.substring(nameEQ.length,c.length)}return null},setCookie:function(name,value,p_expires,p_path,p_domain,p_secure){var expires=p_expires||null;if("number"==typeof expires){var overToInt=+new Date+expires;expires=new Date(overToInt)}var path=p_path||null,domain=p_domain||null,secure=p_secure||!1,cookieSuffix=(null===expires?"":"; expires="+(expires.toUTCString()||expires.toGMTString()||expires.toString()))+(null===path?"":"; path="+path)+(null===domain?"":"; domain="+domain)+(!0===secure?"; secure":""),cookieStr=name+"="+escape(value)+cookieSuffix;return document.cookie=cookieStr,cookieStr},deleteCookie:function(name,p_path,p_domain){Cam4Cookies.setCookie(name,"",new Date("Thu, 01 Jan 1970 00:00:01 GMT"),p_path,p_domain)}};
var RatingSystem={rateNames:[],rateValue:0,lastVotedUsername:"",lastVoteValue:-1,getIndexFromClass:function(itemClassName){for(var arr=itemClassName.split(" "),i=0;i<arr.length;i++)if("a"===arr[i][0])return parseInt(arr[i][1]);return-1},init:function(rateValue,containerId,ratingStatusOn){"undefined"!=typeof RatingData&&(this.rateNames=RatingData.names),$j("#"+containerId+" .limit").removeClass("limit"),$j("#"+containerId+" span").removeClass("limit"),$j("#"+containerId+" span").removeAttr("style"),rateValue<=0?rateValue=0:rateValue>5&&(rateValue=5);var thnd=(rateValue+"").split(".")[0];thnd=parseInt(thnd)-1,$j("#"+containerId+" .a"+thnd)&&$j("#"+containerId+" .a"+thnd).addClass("limit"),thnd<0&&(thnd=0);var num=(rateValue-Math.floor(rateValue)).toFixed(2),rateValuePrecision=num>.25&&num<.75?5:num<=.25&&0;rateValuePrecision=!1===rateValuePrecision?Math.floor(rateValue)+1:(rateValue+"").split(".")[0]+"."+rateValuePrecision;var backWidth=100*parseFloat(rateValuePrecision)/5;$j("#"+containerId+" .ratingStarsItemBack").width(backWidth+"px"),$j("#"+containerId+" span").mouseover(function(event){event.currentTarget.className.indexOf("limit")>-1||RatingSystem.getIndexFromClass(event.currentTarget.className)>thnd?$j("#"+containerId+" .limit").css("background","url("+WEB_CDN+"/images/RatingStars/starContrast.png)"):$j("#"+containerId+" .limit").css("background","url("+WEB_CDN+"/images/RatingStars/starOn.png)"),ratingStatusOn&&$j("#rating_status").html(RatingSystem.rateNames[event.currentTarget.id[1]])}),$j("#"+containerId+" span").mouseout(function(){$j("#"+containerId+" .limit").css("background","url("+WEB_CDN+"/images/RatingStars/starOn.png)")})},sendUserBasicRating:function(url,amount,broadcast_id,votedusername,votingusername){if(votedusername!==votingusername)if(Cam4User.isLoggedInAsGuest)Registration.activateGuestRegisterModal();else if(RatingSystem.lastVotedUsername!==votedusername||RatingSystem.lastVoteValue!==amount){RatingSystem.lastVotedUsername=votedusername,RatingSystem.lastVoteValue=amount;var data={action:"vote",value:amount,votedusername:votedusername,votingusername:votingusername,broadcastid:broadcast_id};$j.get(url,data,function(response,status,xhr){"success"==status?$j("#rating_status").html(response):$j("#rating_status").text(Cam4Bundles.failedToRate)},"html")}},sendArticleRating:function(url,ratingValue,articleSlug){AjaxSender.send({method:"POST",url:url,data:"ratingValue="+ratingValue+"&articleSlug="+articleSlug,success:function(res){var data=jQuery.parseJSON(res.toString());console.log(data),void 0!==data.userAlreadyVoted&&"true"==data.userAlreadyVoted?alert(Cam4Bundles.alreadyVotedArticle):(document.getElementById("voteCount").innerHTML=data.voteCount,document.getElementById("voteAverage").innerHTML=(1*data.voteAverage).toFixed(1),RatingSystem.init(document.getElementById("voteAverage").innerHTML,"rateArticleDiv"))},onerror:function(err){console.log(err)},onexception:function(ex){console.log(ex)}})},rateNewShow:function(event,url,amount,broadcast_id,votedusername,votingusername){if(votedusername!==votingusername){var data={action:"vote",value:amount,votedusername:votedusername,votingusername:votingusername,broadcastid:broadcast_id};$j.get(url,data,function(response,status,xhr){"success"==status&&RatingSystem.init(amount+1,"rateNSDiv")}),event.preventDefault(),event.stopPropagation()}}};
function initializeRoomLogic(initializeRoomInfo){try{ChatlessPlayer.resize.init()}catch(e){console.log(e.stack),ConnectionLogger.logEvent("CAUGHT_ERROR","resize exp: "+e.stack,cam4WebChatHost)}Chat.initializeRoomBroadcastId(initializeRoomInfo),idVerificationEnabled&&Cam4User.isBroadcaster()&&($("#verification-overlay").length||"undefined"==typeof IdVerificationTemplate||$("#tab1C").append(IdVerificationTemplate),JsReceiver.getVerificationStatus().then(function(response){if(response)switch(response.status){case 1:Chat.setIdVerificationRetry(!0),JsReceiver.roomInfo=initializeRoomInfo,verification.update("takeID"),verificationUI.overlay.retry.hide(),verificationUI.overlay.submit.hide(),verificationUI.overlay.capture.show(),IdVerificationStatus=new IdVerification(JsReceiver.roomInfo,flashObj),verificationUI.overlay.container.detach().appendTo(ChatUI.element.video).show();break;case 5:verification.update("pendingUserAction")}}))}function setAbrResolutionsLogic(jsonData){var jsonObj=JSON.parse(jsonData);jsonObj.push({key:"auto",label:"Auto"}),ChatUIController.updateResolutionMenu(jsonObj,"auto")}function provideBroadcastResolutionsLogic(jsonData){var jsonObj=JSON.parse(jsonData);ChatUIController.populateResolutionMenu(jsonObj)}function flashIsReadyLogic(id){if(Cam4User.isBroadcastingWindow)return flashReady=!0,void(useBroadcasterFirebaseChat&&ControlledFeatures&&!ControlledFeatures.USE_JS_BROADCAST_SETTINGS&&ConnectionLogger.init("webChat"));if("Cam4VChat"==id){flashObj=-1!=navigator.appName.indexOf("Microsoft")?window.Cam4VChat:document.Cam4VChat,JsSender.isReady=!0,ChatlessPlayer.volume.init();var volumeValue=ChatlessPlayer.volume.get();ChatlessPlayer.volume.refreshValues(volumeValue),(Chat.isChatReady()||!1===Cam4Performer.statusModel.isPrivate&&("NORMAL"==Cam4Performer.statusModel.showState||"GROUP_SHOW_SELLING_TICKETS"==Cam4Performer.statusModel.showState))&&(Chat.isCorrectPassword()&&JsSender.reconnectStream(),ChatlessPlayer.setState("connected"))}var idC2C=Cam4User.userName.toLowerCase()+"_cam2cam";id==idC2C&&(-1!=navigator.appName.indexOf("Microsoft")?window[idC2C]:document[idC2C]).enableSound(!0),flashReady=!0}function roomWentOfflineLogic(cb){try{FullScreenApi.playerExitFullScreen(),FullScreenApi.playerStyleReset(),JsReceiver.playerInFs=!1}catch(ex){console.log("Cannot exit fullscreen mode, exception: ",ex)}$j("#broadcastingApp").css({display:"none"}),$j("#tDiv").hide(),$j("#_profilePostroll").fadeIn(3e3),Cam4User.isViewer()&&(ServiceTipViewer.stop(),Overlays.closeAll(),$j("#newTippingViewer").slideUp(200),$j("#NewShowMainBar").slideUp(200));try{PlayerTranslate.animateOut()}catch(ex){console.log("Cannot animate out player translate, exception: ",ex)}cb&&cb()}function pressedStartBroadcastLogic(){"undefined"!=typeof confirmWindowClose&&(confirmWindowClose=!0),$("#chatLoadingWheel").show();try{Cam4Event.dispatch(Cam4Event.STARTING_BROADCAST)}catch(ex){console.log(ex)}}function setResolutionLogic(data){if(void 0!==(data=JSON.parse(data)).flashId&&data.flashId.indexOf("_preview")>=0&&ChatPreview.setPreviewContainerSize(data.flashId,data.selfResolution.width,data.selfResolution.height),Cam4User.userName==Cam4User.performerName){var width=data.selfResolution.width,height=data.selfResolution.height,auto=data.auto;Chat.sendBroadcastResolutionToGA(width+"x"+height),Chat.updateBroadcastSettings(auto,width,height)}if(!useNewChatlessResolution||Cam4User.userName==Cam4User.performerName){if(Cam4User.isBroadcaster()&&(!ControlledFeatures||!ControlledFeatures.USE_JS_BROADCAST_SETTINGS&&!ControlledFeatures.USE_WEBRTC_EXTERNAL_BROADCAST)&&"selfResolution"in data&&void 0!==data.flashId&&"Cam4VChat"===data.flashId){var aspectRatio=width/height,broadcasterResolution={width:JsReceiver.DEFAULT_CHATLESS_BROADCASTER_HEIGHT*aspectRatio,height:JsReceiver.DEFAULT_CHATLESS_BROADCASTER_HEIGHT};ChatlessPlayer.resolution.setResolutionFromDimensions(broadcasterResolution,!0),JsReceiver.resolution=broadcasterResolution,useBroadcasterFirebaseChat&&ChatlessPlayer.resize.updateChat(broadcasterResolution)}if(ControlledFeatures&&(ControlledFeatures.USE_JS_BROADCAST_SETTINGS||"undefined"!=typeof VideoCommunicator&&VideoCommunicator.isWebrtcSupported())&&void 0!==data.flashId&&"Cam4VChat"===data.flashId)try{Cam4Event.dispatch(Cam4Event.broadcastSettings.ADJUST_FOR_NEW_RESOLUTION,{key:data.selfResolution.width+"x"+data.selfResolution.height,auto:data.auto})}catch(ex){console.log(ex)}}}function streamIsPlayingLogic(changedWithSuccess){ChatUIController.streamIsPlaying(changedWithSuccess)}function onViewerLoadedStreamLogic(object){object=JSON.parse(object),Cam4Event.dispatch(Cam4Event.VIEWER_STREAM_LOADED,object),Cam4User.cameraData.viewerStreamLoaded=!0,object&&Cam4User.getIpSampler("ga_track_watch_broadcast")&&(JsReceiver.playerData.lastResolutionTimeUpdate=(new Date).getTime(),object.resolution&&(Cam4User.cameraData.resolutionStr=object.resolution,"HD"===object.resolution&&(Cam4User.cameraData.startedInHD=!0)),object.performerHDEnabled||Cam4User.cameraData.startedInHD?dataLayer.push({event:"View Broadcast",eventAction:"Watch "+object.resolution+" Broadcast",eventValue:Cam4User.performerName}):(Cam4User.cameraData.resolutionStr="Normal",dataLayer.push({event:"View Broadcast",eventAction:"Watch Normal Broadcast",eventValue:Cam4User.performerName}))),JsReceiver.trackCameraState()}function openRegModalLogic(url){if(-1===url.indexOf("contextual")&&(url+="&contextual=multicam-"+Cam4User.contextualGender+"&ct=fpmc&type=modal&showSignupForm=true"),url.indexOf("multicam")>-1)return Cam4Event.dispatch(Cam4Event.MULTICAM_DETECTED,{url:url}),void Registration.showGoldUpgradeOverlay("multicam");try{Registration.activateRegModal(url)}catch(ex){console.log(ex)}}function closeCamLogic(){Chat.closeCam()}function logEventLogic(json){var data=JSON.parse(json);ConnectionLogger.logEventFlash(data)}function logMetricLogic(json){var data=JSON.parse(json);ConnectionLogger.logMetricFlash(data)}function logSystemInfoLogic(json){var data=JSON.parse(json);ConnectionLogger.logSystemInfoFlash(data)}function onStreamDisconnectLogic(){"undefined"!=typeof StreamEmbed&&StreamEmbed.getLatestCams()}function getExternalEncoderStreamKeyLogic(){$.ajax({url:"/"+Cam4User.userName+"/streamKey",type:"GET",success:function(data){data.streamKey&&Chat.handleErrors(js_i18n.getStreamKeyResetAlert,null,"JsSender.setExternalEncoderStreamKey('"+data.streamKey+"')")}})}function resetExternalEncoderStreamKeyLogic(){$.ajax({url:"/"+Cam4User.userName+"/streamKey",type:"POST",success:function(data){Chat.handleErrors(js_i18n.streamKeyResetAlert,null,"JsSender.setExternalEncoderStreamKey('"+data.streamKey+"')")}})}function requestBackupRtmpLogic(flashId,params){Chat.requestBackupRtmp(flashId,params)}var edgeRequest={inProgress:!1,delayUntilNextRequest:3e3,requestTimeout:1e4};Cam4User.cameraData=Cam4User.cameraData?Cam4User.cameraData:{},_.extend(Cam4User.cameraData,{lastResolutionTimeUpdate:(new Date).getTime(),startedInHD:!1,startButtonClicked:!1,startBroadcastTime:null});var flashObj=!1,flashReady=!1;!function(){function getSwf(){Cam4User.cameraData.useFlashPlayer&&(tryouts++,void 0===(flashObj="Explorer"==BrowserDetect.browser?window.Cam4VChat:document.Cam4VChat)&&tryouts<100&&setTimeout(getSwf,500))}var tryouts=0;setTimeout(getSwf,0)}();var JsReceiver={playerData:{},onBroadcasterDisconnect:function(){},showLoginOverlay:function(){}};JsReceiver.trackBroadcastTime=function(){"undefined"!=typeof trackBroadcastTime&&trackBroadcastTime()},JsReceiver.onDragResize=function(swfHeight){document.getElementById("Cam4VChat").setAttribute("height",swfHeight+"px")},JsReceiver.getHeightLimit=function(){return $j(window).height()+($j("#newTippingViewer").height()+$j("#playerOptionsBar").height()+$j("#NewShowMainBar").height())},JsReceiver.setTranslationSettings=function(jsonStr){var receivedObject=JSON.parse(jsonStr);PlayerTranslate.showOriginalMessages=receivedObject.showOriginalMessage,receivedObject.enableTranslation&&(PlayerTranslate.enableTranslation=receivedObject.enableTranslation),receivedObject.showOriginalMessage?$j("#offerToTranslateShowOriginal").attr("checked","true"):$j("#offerToTranslateShowOriginal").removeAttr("checked"),PlayerTranslate.setState(receivedObject.ask,receivedObject.language,receivedObject.showBar,!1)},JsReceiver.cam4RoomReady=function(){JsSender.isReady=!0,Cam4Event.dispatch(Cam4Event.PLAYER_LOADED),useBroadcasterFirebaseChat&&Chat.init(Cam4User.performerName.toLowerCase(),Cam4User.userName.toLowerCase(),Cam4User.kN,!1,"")},JsReceiver.initializeRoom=function(initializeRoomInfo){setTimeout(initializeRoomLogic,0,initializeRoomInfo)},JsReceiver.getVerificationStatus=function(){return $.get("/verificationStatus?username="+Cam4User.userName)},JsReceiver.setAbrResolutions=function(jsonData){setTimeout(setAbrResolutionsLogic,0,jsonData)},JsReceiver.provideBroadcastResolutions=function(jsonData){setTimeout(provideBroadcastResolutionsLogic,0,jsonData)},JsReceiver.flashIsReady=function(id){return setTimeout(flashIsReadyLogic,0,id),!0},JsReceiver.isFlashReady=function(){return flashReady},JsReceiver.roomWentOffline=function(cb){setTimeout(roomWentOfflineLogic(cb),0)},JsReceiver.pushStreamTimeTracking=function(){(new Date).getTime(),Cam4User.cameraData.lastResolutionTimeUpdate;var mode="Normal";Cam4User.cameraData.canUseTranscoding&&(mode="SD"===Cam4User.cameraData.resolutionStr?"HD":"SD");Cam4User.isBroadcaster()&&"Broadcaster Time Tracking",Cam4User.cameraData.lastResolutionTimeUpdate=(new Date).getTime()},JsReceiver.onStartBroadcast=function(resolution){"undefined"!=typeof confirmWindowClose&&(confirmWindowClose=!0),Cam4User.cameraData.startButtonClicked=!0,Cam4User.cameraData.canUseTranscoding&&resolution?(Cam4User.cameraData.resolutionStr=resolution,dataLayer.push({event:"Broadcast",eventAction:resolution+" Broadcast",eventValue:Cam4User.userName}),"HD"===resolution&&(Cam4User.cameraData.startedInHD=!0)):dataLayer.push({event:"Broadcast",eventAction:"Normal Broadcast",eventValue:Cam4User.userName}),JsReceiver.trackCameraState(),Cam4User.cameraData.startBroadcastTime=new Date},JsReceiver.getStreamName=function(){return Chat.getStreamName()},JsReceiver.goFullScreen=function(){return JsReceiver.playerInFs?FullScreenApi.playerExitFullScreen():FullScreenApi.playerGoFullScreen(),JsReceiver.playerInFs},JsReceiver.setStealthModeValue=function(dataString){return"undefined"!=typeof Cam4User&&(Cam4User.stealthModeValue=dataString,!0)},JsReceiver.openWindowInNewTab=function(_string){window.open(_string,"_blank")},JsReceiver.isDocumentHidden=function(){return document.hidden||document.mozHidden||document.msHidden||document.webkitHidden},JsReceiver.getTippingLogs=function(start,end){JsReceiver.tipLogs=TipFactory.getTippingLogs(start,end);try{flashObj.sendTippingLogs(JsReceiver.tipLogs)}catch(ex){}return JsReceiver.tipLogs},JsReceiver.onTippingLogsReceived=function(string){if(console.log(string),"undefined"!=typeof AdminUtils)try{AdminUtils.parsePerformerTippingLogs(string)}catch(ex){}},JsReceiver.onResolutionChangedByBroadcaster=function(resolution){resolution&&(Cam4User.cameraData.resolutionStr=resolution,Cam4User.isBroadcaster()&&dataLayer.push({event:"Broadcast Resolution Change",eventAction:resolution+" Broadcast",eventValue:Cam4User.userName}),JsReceiver.pushStreamTimeTracking())},JsReceiver.onResolutionChangedByViewer=function(resolution){resolution&&(Cam4User.cameraData.resolutionStr=resolution,dataLayer.push({event:"Viewer Switches Resolution",eventAction:"Watch "+resolution+" Broadcast",eventValue:Cam4User.performerName}),JsReceiver.pushStreamTimeTracking())},JsReceiver.pressedStartBroadcast=function(){setTimeout(pressedStartBroadcastLogic,0)},JsReceiver.DEFAULT_CHATLESS_BROADCASTER_HEIGHT=360,JsReceiver.setResolution=function(data){setTimeout(setResolutionLogic,0,data)},JsReceiver.streamIsPlaying=function(changedWithSuccess){setTimeout(streamIsPlayingLogic,0,changedWithSuccess)},JsReceiver.onViewerLoadedStream=function(object){setTimeout(onViewerLoadedStreamLogic,0,object)},JsReceiver.trackCameraState=function(){Cam4User.cameraData.canUseTranscoding&&setTimeout(function(){var timeSpent=(new Date).getTime()-Cam4User.cameraData.lastResolutionTimeUpdate,category="Viewer Time Tracking",mode=Cam4User.cameraData.resolutionStr,analiticsValue="Watch "+mode+" Cams";Cam4User.isBroadcaster()&&(category="Broadcaster Time Tracking",analiticsValue="Broadcast in "+mode);var command=["_trackTiming",category,analiticsValue,timeSpent,Cam4User.userName];Cam4User.isOnDevMachine()&&command.push(100),Cam4User.cameraData.lastResolutionTimeUpdate=(new Date).getTime(),JsReceiver.trackCameraState()},6e4)},JsReceiver.openRegModal=function(url){setTimeout(openRegModalLogic,0,url)},JsReceiver.openGuestRegModal=function(){try{Registration.activateGuestRegisterModal()}catch(ex){console.log(ex)}},JsReceiver.decideOffer=function(featureCode,options){switch(featureCode){case"C4BND_FULL_SCREEN":Registration.showGoldUpgradeOverlay("theater-mode");break;case"multi_cam":Cam4Event.dispatch(Cam4Event.MULTICAM_DETECTED),Registration.showGoldUpgradeOverlay("multicam");break;case"picture_in_picture":Registration.showGoldUpgradeOverlay("picture-in-picture");break;case"C4BND_ENHANCED_CHAT":Registration.showGoldUpgradeOverlay("enhanced-chat");break;case"privateCam":Registration.showGoldUpgradeOverlay("private-cam");break;default:Utils.decideOffer(featureCode)}},JsReceiver.onCompleteProfileInfo=function(){Cam4Event.removeEventListener("viewerProfileCompleted"),Cam4Event.addEventListener("viewerProfileCompleted",function(data){Cam4User.needsMainProfileInfoCompletion=function(){return!1};try{flashObj.onNotifyProfileInfoCompleted()}catch(ex){console.log("flashObj does not support this method yet")}}),CompleteProfile.showOverlay()},JsReceiver.closeCam=function(){setTimeout(closeCamLogic,0)},JsReceiver.logEvent=function(json){setTimeout(logEventLogic,0,json)},JsReceiver.logMetric=function(json){setTimeout(logMetricLogic,0,json)},JsReceiver.logSystemInfo=function(json){setTimeout(logSystemInfoLogic,0,json)},JsReceiver.resumeBroadcastAfterNV=function(forceRefresh){idVerificationEnabled||(forceRefresh?window.location.reload():NetVerify.toggleAgeCheckNotification(!1))},JsReceiver.popTokens=function(){try{TipFactory.popTokens()}catch(ex){console.log(ex)}},JsReceiver.onStreamDisconnect=function(){setTimeout(onStreamDisconnectLogic,0)},JsReceiver.getExternalEncoderStreamKey=function(){setTimeout(getExternalEncoderStreamKeyLogic,0)},JsReceiver.resetExternalEncoderStreamKey=function(){setTimeout(resetExternalEncoderStreamKeyLogic,0)},JsReceiver.requestBackupRtmp=function(flashId,params){setTimeout(requestBackupRtmpLogic,0,flashId,params)},JsReceiver.bwCheckerResponder=function(data){console.log(data.state+" - "+data.value),VideoCommunicator.processBwChecker(data)},_.extend(JsReceiver,{showAlert:function(params){setTimeout(function(){switch(params){case"privateRoom":ChatSettings.showScreen(4);break;case"cameraBusy":Chat.handleErrors(js_i18n.cameraNotDetected,!1,!1,"Cam4 Error")}},0)}});
var IdVerificationTemplate='<div id="verification-overlay"><div class="main-message"></div><div class="second-message"></div><div class="button-container"></div></div>',verificationUI={notPublic:Cam4Chat.notPublic,goPublic:'<span class="glyphicon glyphicon-ok"></span>&nbsp;'+Cam4Chat.ageVerified,getStarted:Cam4Chat.startId.replace("{0}","<span>").replace("{1}","</span>")+"</br>"+Cam4Chat.submitPicture,capture1:Cam4Chat.holdId.replace("{0}","<span>").replace("{1}","</span>")+"</br>"+Cam4Chat.clickSubmit,capture2:Cam4Chat.otherside.replace("{0}","<span>").replace("{1}","</span>"),wait:Cam4Chat.almost+"<span>"+Cam4Chat.wait+"</span>",thanks:Cam4Chat.thanks,buttons:{getStarted:'<button id="startVerification" class="btn btn-default">'+Cam4Chat.getStarted+"</button>",goPublic:'<button id="goPublic" class="btn btn-default">'+Cam4Chat.goLive+"</button>"},overlay:{container:$("#id-verification"),capture:$("#capture"),retry:$("#retry"),submit:$("#submitImage")}},verification=function(){var states={unapproved:[verificationUI.notPublic,verificationUI.getStarted,verificationUI.buttons.getStarted],takeID:[verificationUI.notPublic,verificationUI.capture1],submitID:[verificationUI.notPublic,verificationUI.capture2],pendingApproval:[verificationUI.notPublic,verificationUI.wait],pendingUserAction:[verificationUI.goPublic,verificationUI.thanks,verificationUI.buttons.goPublic]};!function(){var container=$("#tab1C");container.on("click","#startVerification",function(e){e.stopPropagation(),verification.update("takeID"),IdVerificationStatus=new IdVerification(JsReceiver.roomInfo,flashObj),verificationUI.overlay.container.detach().appendTo(ChatUI.element.video).show()}),container.on("click","#goPublic",function(e){e.stopPropagation(),LogicObj.callWebchat("goPublic",{},function(){verification.update("goPublic")})})}();return{update:function(state){var container=$("#verification-overlay");if("goPublic"!=state){if(states[state]){var mainMessage=states[state][0],secondMessage=states[state][1],button=states[state][2];container.removeClass().addClass(state).show(),container.find(".main-message").html(mainMessage),container.find(".second-message").html(secondMessage),button?container.find(".button-container").html(button).show():container.find(".button-container").hide()}}else container.hide()}}}(),IdVerification=function(){function IdVerification(roomInformation,player){this.roomInformation=roomInformation,this.player=player,this.imagesArray=[],this.snapshot="",this.sendingImages=!1,this.unbindEvents(),this.bindEvents()}return Object.defineProperty(IdVerification,"WEB_URL",{get:function(){return"/idUpload"},enumerable:!0,configurable:!0}),IdVerification.prototype.clearInterface=function(){this.snapshot.length&&this.snapshot.remove(),verificationUI.overlay.container.hide()},IdVerification.prototype.unbindEvents=function(){verificationUI.overlay.capture.off("click"),verificationUI.overlay.submit.off("click"),verificationUI.overlay.retry.off("click")},IdVerification.prototype.bindEvents=function(){var _this=this;verificationUI.overlay.capture.on("click",function(event){_this.requestSnapshot(event)}),verificationUI.overlay.submit.on("click",function(){if(!_this.sendingImages)switch(_this.snapshot.length&&_this.snapshot.remove(),_this.imagesArray.length){case 1:verificationUI.overlay.retry.hide(),verificationUI.overlay.submit.hide(),verificationUI.overlay.capture.show(),verification.update("submitID");break;case 2:_this.forwardImages(_this.imagesArray)}}),verificationUI.overlay.retry.on("click",function(){_this.imagesArray.pop(),_this.snapshot.length&&_this.snapshot.remove(),verificationUI.overlay.retry.hide(),verificationUI.overlay.submit.hide(),verificationUI.overlay.capture.show()})},IdVerification.prototype.requestSnapshot=function(event){this.player.captureImage(),event.preventDefault()},IdVerification.prototype.onSendCapturedImage=function(success,image){this.snapshot=$('<img class="verificationPreview" />'),success?(this.imagesArray.push(image),this.snapshot.attr("src","data:image/png;base64,"+image),ChatUI.element.video.append(this.snapshot)):console.error("Image was not captured, please retry!"),verificationUI.overlay.capture.hide(),verificationUI.overlay.retry.show(),verificationUI.overlay.submit.show()},IdVerification.prototype.forwardImages=function(images){var _this=this;this.sendingImages=!0,$.post(IdVerification.WEB_URL,{username:Cam4User.userName,accessHash:Cam4User.kN,FileIDFRONT:images[0],FileIDBACK:images[1]}).then(function(response){try{_this.sendingImages=!1;var status=JSON.parse(response).status;void 0!==status&&"SUCCESS"==status?(verification.update("pendingApproval"),verificationUI.overlay.container.hide()):console.error("Failed to upload images with status : ",status)}catch(e){console.error("Failed to upload images with : ",e)}})},IdVerification}();JsReceiver.sendCapturedImage=function(status,image){IdVerificationStatus.onSendCapturedImage(status,image)};
var NewShowState={notAvailable:"viewer_notAvailable",guest:"viewer_guest",noPrivateShow:"viewer_noPrivateShow",notRequestingPrivateShow:"viewer_notRequestingPrivateShow",requestingPrivateShow:"viewer_requestingPrivateShow",inPrivateShow:"viewer_inPrivateShow",accesDenied:"viewer_accessDenied",requestingSpy:"viewer_requestingSpy",inSpy:"viewer_inSpy",requestExpired:"viewer_requestExpired",pendingPrivateShow:"pendingPrivateShow",requestGroupShow:"viewer_requestGroupShow",inGroupShow:"viewer_inGroupShow",goalReached:"viewer_goalReached",goalReachedTicketPurchased:"viewer_goalReachedTicketPurchased",sellingTicketsTicketPurchased:"viewer_sellingTicketsTicketPurchased",guestInGroupShow:"viewer_guestGS",accessDeniedGS:"viewer_accessDeniedGS",accessDeniedInBonusTime:"viewer_accessDeniedBT",inBonusTime:"viewer_inBonusTime",groupShowPaused:"viewer_groupShowPaused",inCam2Cam:"viewer_inPrivateShowCam2Cam",requestingCam2Cam:"viewer_requestingCam2Cam",mobileBroadcast:"viewer_mobileBroadcast",mobileBroadcastGuest:"viewer_mobileBroadcastGuest",cam2cam:{disabled:"noCam2Cam",requestEnabled:"enableRequest",requestSended:"requestSent",playerWindowClosed:"closeRequestAlert",inCam2Cam:"inCam2Cam"},currentCam2CamState:"undefined",AcceptingPrivateShow:"broadcaster_acceptingPrivateShow",InPrivateShow:"broadcaster_inPrivateShow",NotAvailable:"broadcaster_notAvailable",NotAcceptingPrivateShow:"broadcaster_notAcceptingPrivateShow",SellingTickets:"broadcaster_sellingTickets",InGroupShow:"broadcaster_inGroupShow",GoalReached:"broadcaster_goalReached",InBonusTime:"broadcaster_inBonusTime",InCam2Cam:"broadcaster_inPrivateShowCam2Cam"};
var NewShowSender={sendPrivateShowSettings:function(){var tmpObj=new Object;tmpObj.allowSpy=$j("#allowSpy")[0].checked,tmpObj.acceptPS=$j("#allowPrivate")[0].checked,tmpObj.allowCam2Cam=$j("#allowCam2Cam")[0].checked,tmpObj.viewerPPM=NewShow.getPSPrices().ps,tmpObj.spyPPM=NewShow.getPSPrices().ss,tmpObj.c2cPPM=NewShow.getPSPrices().c2c,tmpObj.blocksOfTimeActive=NewShow.getTBPrices().a,tmpObj.blocksOfTime=NewShow.getTBPrices().tb,console.log("sending to player JSON.stringify(",tmpObj,")");try{LogicObj.setPrivateShowSettings(JSON.stringify(tmpObj))}catch(ex){}}},NewShowReceiver={onPrivateShowPrice:function(viewerPricePerMinute,spyPricePerMinute,c2cPricePerMinute,blocksOfTimeActive,blocksOfTime){if($j("#selectPSPrice option").each(function(){if($j(this).val()==viewerPricePerMinute)return $j(this).prop("selected",!0),!1}),$j("#selectSSPrice option").each(function(){if($j(this).val()==spyPricePerMinute)return $j(this).prop("selected",!0),!1}),$j("#selectC2CPrice option").each(function(){if($j(this).val()==c2cPricePerMinute)return $j(this).prop("selected",!0),!1}),1==blocksOfTimeActive?$j('a[href="#time-blocks"]').click():$j('a[href="#fixed-rate"]').click(),void 0!==blocksOfTime){blocksOfTime=blocksOfTime.split("|");var blockOfTime,time,cost,description,c2cCost="";for(i=0;i<3;i++)$j("#box-option"+(i+1)).length>0&&($j("#box-option"+(i+1)).removeAttr("checked"),$j("#box-option"+(i+1)).closest(".box-option").find('input[type="text"]').prop("disabled",!0),$j("#box-option"+(i+1)).closest(".box-option").find("textarea").prop("disabled",!0)),$j("#timeBlocksDuration"+(i+1)).val(""),$j("#timeBlocksCost"+(i+1)).val(""),$j("#timeBlocksDescription"+(i+1)).val(""),$j("#timeBlockCam2CamCost"+(i+1)).val("");for(i=0;i<blocksOfTime.length;i++)time=(blockOfTime=blocksOfTime[i].split(":"))[0],cost=blockOfTime[1],blockOfTime.length>2&&(description=blockOfTime[2].replace(/`\^&/g,":").replace(/`#&/g,"|")),blockOfTime.length>3&&(c2cCost=blockOfTime[3]),$j("#box-option"+(i+1)).length>0&&($j("#box-option"+(i+1)).prop("checked",!0),$j("#box-option"+(i+1)).closest(".box-option").find('input[type="text"]').removeAttr("disabled"),$j("#box-option"+(i+1)).closest(".box-option").find("textarea").removeAttr("disabled")),$j("#timeBlocksDuration"+(i+1)).val(time),$j("#timeBlocksCost"+(i+1)).val(cost),$j("#timeBlocksDescription"+(i+1)).val(description),$j("#timeBlockCam2CamCost"+(i+1)).val(c2cCost),NewShowReceiver.displayPricePerMinuteForBlock(i+1,cost,time)}},displayPricePerMinuteForBlockFromElements:function(blockId){if(!ControlledFeatures.USE_C2C_PRICES){var duration=parseInt($("#timeBlocksDuration"+blockId).val()),cost=parseInt($("#timeBlocksCost"+blockId).val());NewShowReceiver.displayPricePerMinuteForBlock(blockId,cost,duration)}},displayPricePerMinuteForBlock:function(blockId,cost,duration){if(!ControlledFeatures.USE_C2C_PRICES){var pricePerMinute=cost/duration,priceLabel="";isNaN(pricePerMinute)||(priceLabel=pricePerMinute.toFixed(1)+" "+js_i18n.tokensPerMinute.toLowerCase()),$j("#pricePerMinuteBlock"+blockId).text(priceLabel)}},setMiddleButtonText:function(innerhtmltext){Cam4User.isBroadcaster()?$j("#mainButtonBroadcaster").html(innerhtmltext):Cam4User.isViewer()&&$j("#mainPSButton").html(innerhtmltext)},setBuyTicketButton:function(enabled){return enabled?(NewShowReceiver.setMiddleButtonText('<a onclick="NewShow.buyTicket();" class="joinGroupB" id="requestPrivateShow">'+BUY_TICKET_GS+"</a>"),ncTip.enableSendTipInput()):NewShowReceiver.setMiddleButtonText('<a class="joinGroupB NSMainButtonDisabled" id="requestPrivateShow">'+BUY_TICKET_GS+"</a>"),enabled}},NewShow={fixLang:function(){return setTimeout(function(){try{if(Cam4User.isBroadcaster()){for(var i=0;i<$j(".NSBoldedInfo").length;i++)$j(".NSBoldedInfo")[i].innerHTML.trim().length>19&&$j($j(".NSBoldedInfo")[i]).css("font-size","10px");"de"===Cam4User.lang&&TwitterOverlay.data.showTwitterOptions&&$j("#options .innerTube ul li").css("margin-left","0px")}if(Cam4User.isViewer()){switch(Cam4User.lang){case"nl":NewShowState.currentCam2CamState===NewShowState.cam2cam.requestSended?$j("#Cam2CamButton").css("font-size","10px"):$j("#Cam2CamButton").css("font-size","12px");break;case"pt":$j("#Cam2CamButton").css("font-size","11px")}$j("#introTxttest").textfill({maxFontPixels:12}),$j(".requestPsAutosize").textfill({maxFontPixels:12})}}catch(ex){}},0),Cam4User.lang},getPSPrices:function(){return{ps:parseInt($j("#selectPSPrice")[0].options[$j("#selectPSPrice")[0].options.selectedIndex].value),ss:parseInt($j("#selectSSPrice")[0].options[$j("#selectSSPrice")[0].options.selectedIndex].value),c2c:ControlledFeatures.USE_C2C_PRICES?parseInt($j("#selectC2CPrice")[0].options[$j("#selectC2CPrice")[0].options.selectedIndex].value):0}},getTBPrices:function(){return blocksOfTime=[],$j("#time-blocks .box-option").each(function(index){0==index?""!==$(".timeBlocksDuration").val()&&""!==$(".timeBlocksCost").val()&&blocksOfTime.push({duration:$j(this).find(".timeBlocksDuration").val(),price:$j(this).find(".timeBlocksCost").val(),c2cPrice:ControlledFeatures.USE_C2C_PRICES?""+Math.max($j(this).find(".timeBlockCam2CamCost").val(),0):0,description:$j(this).find(".timeBlocksDescription").val().replace(/\|/g,"`#&")}):$j(this).find(".addition-box-option").is(":checked")&&""!==$j(this).find(".timeBlocksDuration").val()&&""!==$j(this).find(".timeBlocksCost").val()&&blocksOfTime.push({duration:$j(this).find(".timeBlocksDuration").val(),price:$j(this).find(".timeBlocksCost").val(),c2cPrice:ControlledFeatures.USE_C2C_PRICES?""+Math.max($j(this).find(".timeBlockCam2CamCost").val(),0):0,description:$j(this).find(".timeBlocksDescription").val().replace(/\|/g,"`#&")})}),{a:$j("#time-blocks-tab").hasClass("active"),tb:blocksOfTime}},disablePSSelects:function(){$j("#selPrice").attr("disabled","disabled"),$j("#selectPSPrice").attr("disabled","disabled"),$j("#selectSSPrice").attr("disabled","disabled"),$j("#selectC2CPrice").attr("disabled","disabled")},enablePSSelects:function(){$j("#selPrice").removeAttr("disabled"),$j("#selectPSPrice").removeAttr("disabled"),$j("#selectSSPrice").removeAttr("disabled"),$j("#selectC2CPrice").removeAttr("disabled")},setPSPrice:function(event){var tokens_min=NewShow.getPSPrices().ps,tokens_spy=NewShow.getPSPrices().ss,tokens_c2c=NewShow.getPSPrices().c2c,use_timeblocks=NewShow.getTBPrices().a,tokens_timeblocks=NewShow.getTBPrices().tb;Cam4User.psPrice=tokens_min,NSPrices.privateShowPrice=tokens_min,NewShow.displayProperties.objList.length>0?($j("#RedNotificationNum").show(),$j("#RedNotificationNum").text(NewShow.displayProperties.objList.length+""),NewShow.setTableMessage("cam2camMulti")):($j("#RedNotificationNum").hide(),NewShow.setTableMessage(js_i18n.noPsRequest));try{LogicObj.setPrivateShowPrice(tokens_min,tokens_spy,tokens_c2c,use_timeblocks,tokens_timeblocks)}catch(ex){}}};
var NSReceipt={selectGift:function(item){$j("#NSReceiptGiftList a").removeClass("active");$j(item).hasClass("active")?$j(item).removeClass("active"):$j(item).addClass("active");var current_GiftId=parseInt(item.id.replace("GiftId_",""));$j("#SendGift_PSReceipt input[name=to]").val(Cam4User.performerName),$j("#SendGift_PSReceipt input[name=gift_id]").val(current_GiftId)},digestResponse:function(responseContent){var initText=$j("#NSReceiptStatusMessage").html();responseContent.indexOf("not-enough-tokens-error")>-1?(NSReceipt.initialText=$j("#NSReceiptStatusMessage").html(),$j("#NSReceiptStatusMessage").html(responseContent),setTimeout(function(){$j("#NSReceiptStatusMessage").html(NSReceipt.initialText),NSReceipt.enableInput(initText)},4e3)):($j("#NSReceiptStatusMessage").html(js_i18n.yourGiftSent+" "+Cam4User.performerName+".").addClass("alert alert-success"),setTimeout(function(){NSReceipt.enableInput(initText),$j("#NSReceiptStatusMessage").removeClass("alert alert-success")},5e3))},sendGift:function(){parseInt($j("#SendGift_PSReceipt input[name=gift_id]").val())>0&&(NSReceipt.disableInput(),$j("#SendGift_PSReceipt").ajaxSubmit({success:function(response){NSReceipt.digestResponse(response)},error:function(err){NSReceipt.digestResponse(err)}}))},disableInput:function(){$j("#NSReceiptSendGiftBtn, #NSReceiptGiftMessage").attr("disabled","true")},enableInput:function(message){$j("#NSReceiptSendGiftBtn, #NSReceiptGiftMessage").removeAttr("disabled"),message&&$j("#NSReceiptStatusMessage").html(message)},bindEvents:function(){$j(document).on("keyup keypress","#SendGift_PSReceipt",function(e){13==e.keyCode&&(NSReceipt.sendGift(),e.preventDefault())})}};$j(document).ready(function(){NSReceipt.bindEvents()});
if(void 0===processorPopUpPageWidth||!processorPopUpPageWidth)var processorPopUpPageWidth=650;if(void 0===processorPopUpPageHeight||!processorPopUpPageHeight)var processorPopUpPageHeight=880;var Utils={openedPopupWindows:{},closeOpenedPopupWindows:function(){for(var k in Utils.openedPopupWindows)try{Utils.openedPopupWindows[k].close()}catch(ex){console.log(ex)}},windowOpenCentered:function(url,width,height,name){width||(width=processorPopUpPageWidth),height||(height=processorPopUpPageHeight),name||(name="Cam4 window");var marginTop=0,marginLeft=0;try{marginTop=((screen.height||screen.availHeight)-height)/2,marginLeft=((screen.width||screen.availWidth)-width)/2}catch(ex){console.log(ex)}return window.open(url,name,"width="+width+", height="+height+",scrollbars=1,toolbars=0,status=0,left="+marginLeft+",top="+marginTop)},leadingZero:function(Time){return Time<10?"0"+Time:Time},milisecondsToTime:function(numberAsMiliSeconds){var seconds=parseInt(numberAsMiliSeconds/1e3),response=Utils.secondsToTime(seconds);return response.toSeconds=function(suffix){return suffix?Utils.leadingZero(seconds)+suffix:Utils.leadingZero(seconds)},response},secondsToTime:function(secs){var hours=Math.floor(secs/3600),divisorForMinutes=secs%3600,minutes=Math.floor(divisorForMinutes/60),divisorForSeconds=divisorForMinutes%60,seconds=Math.ceil(divisorForSeconds),obj={h:Utils.leadingZero(hours),m:Utils.leadingZero(minutes),s:Utils.leadingZero(seconds),inline:function(){return obj.h+":"+obj.m+":"+obj.s}};return obj},limitTextLength:function(item,max,output,outstr){if(max||(max=item.maxLength?item.maxLength:120),item){var text=item.value||"";if(function(left,total){output&&(document.getElementById(output)&&(output=document.getElementById(output)),outstr&&(outstr=outstr.replace(/%0/g,left),outstr=outstr.replace(/%1/g,total),output.innerHTML=outstr))}(max-text.length>-1?max-text.length:0,text.length),text.length>max)return item.value=text.substring(0,max),!1}},restrictInputToNumbers:function(object,event,type){var eventType=event.type||type,charCode=event.which?event.which:event.keyCode;return[8,13,99,118,46,37,39].indexOf(charCode)>-1||!(charCode>31&&(charCode<48||charCode>57)&&(charCode<96||charCode>105))&&("keyup"===eventType&&(object.value=object.value.replace(/\D/g,"")),!0)},isAlphanumericString:function(string){return/^[0-9a-zA-Z]+$/.test(string)},checkForDuplicateId:function(elementID){for(var elementCollection=[],allElements=document.getElementsByTagName("*"),i=0;i<allElements.length;i++)allElements[i].id===elementID&&elementCollection.push(allElements[i]);return console.log(elementID+" found "+elementCollection.length+" times"),elementCollection},getOffset:function(element){var top=0,left=0;do{top+=element.offsetTop||0,left+=element.offsetLeft||0,element=element.offsetParent}while(element);return{top:top,left:left}},lastToolTip:{},cancelEvent:function(event){return event.preventDefault?event.preventDefault():event.returnValue=!1,!1},uidDate:function(){var date=new Date;return date.getDate()+""+date.getDay()+date.getSeconds()+date.getMilliseconds()},getPageArgs:function(){var response={};response.window={width:window.innerWidth||document.documentElement.clientWidth||document.getElementsByTagName("body")[0].clientWidth,height:window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight||document.getElementsByTagName("body")[0].clientHeight},"undefined"!=typeof pageYOffset?response.window.scrollTop=pageYOffset:response.window.scrollTop=document.getElementsByTagName("html").item(0).scrollTop||document.body.scrollTop||document.documentElement.scrollTop||window.scrollY||window.scrollTop||0,response.body={height:Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)};var viewportwidth=0,viewportheight=0;return void 0!==window.innerWidth?(viewportwidth=window.innerWidth,viewportheight=window.innerHeight):void 0!==document.documentElement&&void 0!==document.documentElement.clientWidth&&0!==document.documentElement.clientWidth?(viewportwidth=document.documentElement.clientWidth,viewportheight=document.documentElement.clientHeight):(viewportwidth=document.getElementsByTagName("body")[0].clientWidth,viewportheight=document.getElementsByTagName("body")[0].clientHeight),response.viewport={width:viewportwidth,height:viewportheight},response},safePopUp:function(url,width,height){var blackOverlay=document.createElement("div");blackOverlay.setAttribute("class","blackOverlay");var windowWidth=Utils.getPageArgs().window.width,windowHeight=Utils.getPageArgs().window.height,scrollTop=Utils.getPageArgs().window.scrollTop,bodyHeight=Utils.getPageArgs().body.height;blackOverlay.style.height=bodyHeight+"px";var dialog=document.createElement("div");dialog.setAttribute("class","modal-content"),dialog.style.width=width+"px","rtl"===document.getElementsByTagName("html")[0].dir?dialog.style.right=(windowWidth-width)/2+"px":dialog.style.left=(windowWidth-width)/2+"px",dialog.style.top=(windowHeight-height)/2+scrollTop+"px",blackOverlay.appendChild(dialog),blackOverlay.style.display="block";var uidName="autogenFrame"+Utils.uidDate(),frameContent=document.createElement("iframe");frameContent.src=url,frameContent.style.width=width+"px",frameContent.style.height=height+"px",frameContent.id=uidName,frameContent.onload=function(e){frameContent.contentDocument.getElementsByTagName("body")[0].onkeydown=function(event){Cam4Event.dispatch(Cam4Event.DOCUMENT_KEY_DOWN,event)}},dialog.innerHTML="<a onclick=\"document.getElementById('Cam4DialogContainer').style.display='none';\" style=\"cursor:pointer; font-size:12px;\">Close</a>",dialog.insertBefore(frameContent,dialog.childNodes[0]);var name="Cam4DialogContainer";if(document.getElementById(name))document.getElementById(name).style.display="block",document.getElementById(name).innerHTML="",document.getElementById(name).appendChild(blackOverlay);else{var divContainer=document.body||document.documentElement||document.getElementsByTagName("head")[0],dialogContainer=document.createElement("div");dialogContainer.setAttribute("id",name),dialogContainer.style.display="block",dialogContainer.appendChild(blackOverlay),divContainer.appendChild(dialogContainer)}return{id:uidName}},openSupportMobileSearchModal:function(disableScroll){try{var modalLayout=$("#modalLayout");modalLayout.html($j("#support-mobile-search").html()),modalLayout.modal("show"),Cam4Event.dispatch(Cam4Event.MODAL_OPENED);var preventScroll=function(e){e.preventDefault(),e.stopPropagation()};return disableScroll&&($j("body").bind("touchmove",preventScroll),modalLayout.on("hide.bs.modal",function(){$j("body").unbind("touchmove",preventScroll)})),!0}catch(ex){return console.log(ex),!1}},codeForIE8and9:function(){8!=BrowserDetect.getIEVer()&&9!=BrowserDetect.getIEVer()||$j("input, textarea").placeholder()},mergeObjects:function(object1,object2){for(var item in object2)object2[item]&&(object1[item]=object2[item]);return object1},getObjectsDiff:function(firstObj,secondObj){var res={};for(var item in firstObj)secondObj.hasOwnProperty(item)?firstObj[item]!=secondObj[item]&&(res[item]=secondObj[item]):res[item]=firstObj[item];return res},getObjectAsCopy:function(srcObj){return"object"!=typeof srcObj?{}:JSON.parse(JSON.stringify(srcObj))},getCommonWords:function(str1,str2,separator){str1=str1.toLowerCase().replace(/\(/g,"").replace(/\)/g,""),str2=str2.toLowerCase().replace(/\(/g,"").replace(/\)/g,"");for(var arr1=str1.split(separator||" "),arr2=str2.split(separator||" "),commonWords=[],i=0;i<arr1.length;i++)-1!=arr2.indexOf(arr1[i])&&commonWords.push(arr1[i]);return commonWords},injectCss:function(cssPath,callback){var fileref=document.createElement("link");fileref.setAttribute("rel","stylesheet"),fileref.setAttribute("type","text/css"),fileref.setAttribute("href",cssPath);var thisIsReady=!1;fileref.onreadystatechange=function(){"complete"==this.readyState&&(thisIsReady||(thisIsReady=!0,callback&&callback("ok")))},fileref.onload=function(){thisIsReady||(thisIsReady=!0,callback&&callback("ok"))},fileref.onerror=function(err){thisIsReady||(thisIsReady=!0,callback&&callback("failed"))};var root=document.getElementsByTagName("head")[0]||document.body||document.documentElement;return root.appendChild(fileref),{script:fileref,root:root}},removeJavascriptNodes:function(array){for(var i=0;i<array.length;i++)array[i].root.removeChild(array[i].script),array.splice(i,1);return 0},injectJavascript:function(scriptSource,callback,toBottom){ServiceTipViewer.setSessionActiveRequest(scriptSource,!0);var thisIsReady=!1,script=document.createElement("script");script.async="async",script.type="text/javascript",script.onreadystatechange=function(){"complete"==this.readyState&&(thisIsReady||(thisIsReady=!0,callback&&callback("ok")))},script.onload=function(){thisIsReady||(thisIsReady=!0,callback&&callback("ok"),ServiceTipViewer.setSessionActiveRequest(scriptSource,!1))},script.onerror=function(err){thisIsReady||(thisIsReady=!0,callback&&callback("failed"),ServiceTipViewer.setSessionActiveRequest(scriptSource,!1))},script.src=scriptSource;var root=document.getElementsByTagName("head")[0]||document.body||document.documentElement;return toBottom&&(root=document.body||document.documentElement||document.getElementsByTagName("head")[0]),root.appendChild(script),{script:script,root:root}},convertNative:function(staticObj,dinamicObj,pmax){var a=0,max=10;pmax&&(max=pmax);for(var item in staticObj)item&&(a++,"object"==typeof dinamicObj[item]||dinamicObj[item]instanceof Object||"function"==typeof dinamicObj[item]?dinamicObj[item]="function":a<max&&(dinamicObj[item]=String(staticObj[item]),a++));return dinamicObj},jsonData:{encode:function(object){return JSON.stringify(object)}},getSupportedTransform:function(){for(var prefixes="transform WebkitTransform "+"MozTransform OTransform msTransform".split(" "),i=0;i<prefixes.length;i++)if(void 0!==document.createElement("div").style[prefixes[i]])return prefixes[i];return!1},isViewerInVR:function(){var iframe=document.getElementById("vr_player_iframe"),iframeWindow=iframe?iframe.contentWindow:iframe;return iframeWindow&&iframeWindow.vrrp?iframeWindow.vrrp.isPresenting():!!window.vrrp&&window.vrrp.isPresenting()},getCurrentPageNoArgs:function(urlData){String(urlData);var arr=urlData.split("?");return String(arr[0])},makeElementSticky:function(targetId,limiterId,stickyClass){var target=$j("#"+targetId),limit=$j("#"+limiterId).position().top+$j("#"+limiterId).height()-target.height();if(!target||!limit)return!1;var targetPos=target.position().top;return $j(window).scroll(function(){if(target.width()<=$j(window).width()/2){var windowPos=$j(window).scrollTop();windowPos>=targetPos&&windowPos<limit?(target.css("position",""),target.css("top",""),target.addClass(stickyClass)):windowPos>=limit?(target.removeClass(stickyClass),target.css({position:"absolute",top:limit+"px"})):target.removeClass(stickyClass)}}),$j(window).resize(function(){target.css("position",""),target.css("top",""),target.css("width",""),target.removeClass(stickyClass)}),!0},redirectOnSelect:function(selectElem){window.location.href=selectElem.value},isDescendant:function(parent,child){if(void 0!==parent.contains)return parent.contains(child);for(var node=child.parentNode;null!==node;){if(node==parent)return!0;node=node.parentNode}return!1},getCheckoutMembershipURL:function(fName){return void 0===fName&&(fName="default"),"/checkout/goldUpgrade?unlockFeature="+fName},openCheckoutMembership:function(unlockFeature,reportFeatureId){Utils.closeModalPops(),EpayPlugin.renderMemberships()},decideOffer:function(featureCode,options){Cam4User.useUnbundling&&Cam4User.isLoggedIn?function(){if((featureCode||void 0!==options&&"undefined"!==options.goldOnly)&&!Cam4User.isPayingMember())if(void 0===options||void 0===options.goldOnly||!0!==options.goldOnly){switch(featureCode){case"C4BND_UNLIMITED_SAVED_SEARCHES":if(null===document.getElementById("savedSearches"))return;if(document.getElementById("savedSearches").getElementsByTagName("li").length<Directory.loggedInUserSearchLimit)return}Modals.openSingleFeatureRequest(featureCode),void 0!==options&&void 0!==options.buyAttempt?FeatureReporting.sendUsageAttempt(featureCode,"BUY"):FeatureReporting.sendUsageAttempt(featureCode)}else Utils.openCheckoutMembership()}():function(){if(!Cam4User.isPayingMember())if(Cam4User.isLoggedIn)(featureCode&&"C4BND_UNLIMITED_SAVED_SEARCHES"!=featureCode||void 0!==options&&"gold"===options.pageType)&&Utils.openCheckoutMembership(void 0!==options&&options.contextClass?options.contextClass:"");else if(null===Utils.checkLoginLocalStorage()){var featureMap={C4BND_PRIVATE_MESSAGE:"private_message",C4BND_MULTI_CAM_PIP:"multicam",C4BND_NO_ADS:"no_ads",C4BND_FULL_SCREEN:"fullscreen",C4BND_MAIL_INBOX:"private_message",C4BND_ENHANCED_CHAT:"enhanced_chat",C4BND_SUPER_SHOW_CHAT:"",C4BND_UNLIMITED_SAVED_SEARCHES:""};if("string"==typeof options)try{options=JSON.parse(options)}catch(ex){console.log(ex)}featureCode||(featureCode="");var opts={unlockFeature:featureMap[featureCode]?featureMap[featureCode]:"",isModal:!1,pageVersion:null,pageType:featureCode?"gold":void 0!==options&&void 0!==options.pageType?options.pageType:"",contextClass:void 0!==options&&void 0!==options.contextClass?options.contextClass:"",ct:null,sendtipuser:""};if(void 0!==options&&(opts.unlockFeature=options.unlockFeature?options.unlockFeature:"",opts.isModal=!!options.isModal&&options.isModal,opts.ct=options.ct?options.ct:"",opts.sendtipuser=options.sendtipuser?options.sendtipuser:""),Cam4User.isLoggedInAsGuest){if(featureCode)switch(featureCode){case"C4BND_NO_ADS":case"C4BND_FULL_SCREEN":case"C4BND_MULTI_CAM_PIP":case"C4BND_PRIVATE_MESSAGE":case"C4BND_ENHANCED_CHAT":case"C4BND_SUPER_SHOW_CHAT":break;default:return void Registration.activateGuestRegisterModal()}if(opts.unlockFeature)switch(opts.unlockFeature){case"multicam":case"private_message":case"fullscreen":case"enhanced_chat":opts.pageType="gold";break;case"browse":return void Registration.activateGuestRegisterModal()}}else"C4BND_UNLIMITED_SAVED_SEARCHES"==featureCode&&(dataLayer.push({event:"saveSearchAsTab"}),featureCode="",opts.pageType="");var url="/gold?showSignupForm=true"+(opts.ct?"&ct="+opts.ct:"")+(opts.pageType?"&pageType="+opts.pageType:"")+(opts.pageVersion?"&pageVersion="+opts.pageVersion:"")+(opts.unlockFeature?"&contextual="+opts.unlockFeature+(Cam4User.contextualGender?"-"+Cam4User.contextualGender:""):"")+(opts.sendtipuser?"&sendtipuser="+opts.sendtipuser:"");dataLayer.push({event:"Open Guest Gold Upgrade Modal",eventCategory:"Gold Membership",eventAction:"Open Guest Gold Upgrade Modal",eventLabel:opts.contextClass}),Registration.activateRegModal(url+"&type=modal")}else window.location.reload()}()},removeClassNative:function(element,className){var attrValue=element.getAttribute("class");attrValue=attrValue.replace(className,""),element.setAttribute("class",attrValue)},addClassNative:function(element,className){var attrValue=element.getAttribute("class");attrValue=attrValue+" "+className,element.setAttribute("class",attrValue)},sizeOfObject:function(obj){if(void 0===obj)return 0;var size=0;for(var key in obj)obj.hasOwnProperty(key)&&size++;return size},storedDocumentHeight:0,initDocumentHeight:function(){var body=document.body,html=document.documentElement,fullHeight=Math.max(body.scrollHeight,body.offsetHeight,html.clientHeight,html.scrollHeight,html.offsetHeight);Utils.storedDocumentHeight=fullHeight},windowsPhoneIEFix:function(){try{$j("#Cam4DialogContainer").css({position:"absolute",height:Utils.storedDocumentHeight?Utils.storedDocumentHeight:document.body.offsetHeight+"px"}),$j("#Cam4DialogContainer .modal-dialog").css("top","20px"),$j("html, body").animate({scrollTop:$j("#Cam4DialogContainer").offset().top})}catch(ex){console.log(ex)}},throttle:function(fn,threshhold,scope){threshhold||(threshhold=250);var last,deferTimer;return function(){var context=scope||this,now=+new Date,args=arguments;last&&now<last+threshhold?(clearTimeout(deferTimer),deferTimer=setTimeout(function(){last=now,fn.apply(context,args)},threshhold)):(last=now,fn.apply(context,args))}},verticalAlign:function(parentElement,element){var new_margin=Math.ceil((parentElement.height()-element.height())/2);element.css("margin-top",new_margin+"px")},copyInputValueToClipboard:function(element){element.select(),document.execCommand("copy")},convertUriToJson:function(params){return params.split("&").map(function(item){return item.split("=")}).reduce(function(obj,pair){return obj[pair[0]]=decodeURIComponent(pair[1]),obj},{})},checkForOperaFullScreenIcon:function(){var obj=document.getElementById("Cam4HLSPlayer");null!=obj&&obj.addEventListener("loadeddata",function(){4==obj.readyState&&setTimeout(function(){$j('html > div[style*="top"]').hide()},0)})}};BrowserDetect.isOpera()&&Utils.checkForOperaFullScreenIcon();var AjaxSender={method:{post:"POST",get:"GET"},send:function(options){var xmlhttp,method="post";if(options.method&&(method=options.method),window.XMLHttpRequest)xmlhttp=new XMLHttpRequest;else if(window.ActiveXObject)try{xmlhttp=new ActiveXObject("Msxml2.XMLHTTP")}catch(err){try{xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){xmlhttp=!1,console.log("xmlhttp failed to init"),options.onexception&&options.onexception(ex)}}xmlhttp.onreadystatechange=function(){try{4==xmlhttp.readyState&&200==xmlhttp.status?options.success&&options.success(xmlhttp.responseText||xmlhttp.response,xmlhttp):options.onerror&&options.onerror(xmlhttp)}catch(ex){options.onexception&&options.onexception(ex)}},xmlhttp.onerror=function(err){options.onerror&&options.onerror(err)};try{xmlhttp.open(method,options.url,!0);try{method===AjaxSender.method.post&&xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded")}catch(ex){console.log(ex),options.onexception&&options.onexception(ex)}}catch(ex){console.log(ex),options.onexception&&options.onexception(ex)}try{options.data?xmlhttp.send(options.data):xmlhttp.send()}catch(ex){console.log(ex),options.onexception&&options.onexception(ex)}return 0}},SCEditorUtils={scEditorApply:function(elemId,toolbarVal,widthVal,heightVal,enableResize){if("undefined"==typeof ScEditorValues)return console.log("ScEditorValues is not defined!"),!1;void 0===enableResize&&(enableResize=!1),$j("#"+elemId).sceditor({plugins:"bbcode",toolbar:toolbarVal||"bold,italic,color,removeformat,size,image",width:widthVal||"100%",height:heightVal||"240",style:ScEditorValues.style,imageWidthTxt:ScEditorValues.imageWidthTxt,imageHeightTxt:ScEditorValues.imageHeightTxt,insertImageTxt:ScEditorValues.insertImageTxt,boldTxt:ScEditorValues.boldTxt,italicTxt:ScEditorValues.italicTxt,colorTxt:ScEditorValues.colorTxt,removeformatTxt:ScEditorValues.removeformatTxt,sizeTxt:ScEditorValues.sizeTxt,imageTxt:ScEditorValues.imageTxt,whiteListImageTLD:ScEditorValues.whiteListImageTLD,iGotIt:ScEditorValues.iGotIt,imageToolTip:ScEditorValues.imageToolTip,resizeEnabled:enableResize,autofocus:!1})}};$j(function(){var usernameFilterRegex=/[a-zA-Z0-9_]+/g;$j("#usernameFilter").keypress(function(e){var charCode=e.charCode?e.charCode:e.which;String.fromCharCode(charCode).match(usernameFilterRegex)||8==charCode||e.preventDefault()}).keyup(function(event){var matchedStrings=this.value.match(usernameFilterRegex);matchedStrings?matchedStrings[0]!==this.value&&(this.value=matchedStrings.join("")):this.value=""});try{Utils.initDocumentHeight()}catch(ex){console.log(ex)}}),function(){if(ControlledFeatures&&ControlledFeatures.USE_FLASH_RESTRICTION_FALLBACK){var hasFlash=!1;try{hasFlash=Boolean(new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))}catch(exception){hasFlash=void 0!==navigator.mimeTypes["application/x-shockwave-flash"]}hasFlash||!PageStatus.isProfile||!Cam4Performer.statusModel.isBroadcasting||"Desktop"!=cam4UserAgent||Cam4User.cameraData.useHlsVideoOnMobile||Cam4User.cameraData.useWebRTCPlayer||(window.location="/"+Cam4User.performerName+"/hls")}}();var tempInformativeMessages=function(){function createCookie(cookieName){var expireDate=new Date;expireDate.setFullYear(expireDate.getFullYear()+10),Cam4Cookies.setCookie(cookieName,"true",expireDate,"/","","")}function closeOption(cookieName,containerDiv,closeButton){$j(closeButton).on("click",function(){createCookie(cookieName),containerDiv.hide()})}return{init:function(cookieName,containerDiv,closeButton){return!Cam4Cookies.getCookie(cookieName)&&(closeOption(cookieName,containerDiv,closeButton),!0)}}}();
var Cam4Analytics=function(){function parseTags(s){if(!s||!s.split||s.length<5)return{};for(var result={},parts=s.split(";"),i=0;i<parts.length;i++){var crt=parts[i].split(":");"r"===crt[0]?result.recommended=crt[1]:"ra"===crt[0]?result.recEngOn=crt[1]:"p"===crt[0]?result.userAcceptedSexualProfiling=crt[1]:"c"===crt[0]?result.countryCode=crt[1]:"idx"===crt[0]&&(result.index=crt[1])}return result}var cntRetriesOnLoad=0,_currentTags="NA",getTags=function(room,doCleanup){function getVal(val){return val?"1":"0"}if("string"!=typeof room)return console.error("Cam4Analytics tags requested for no room"),"NA";if("undefined"==typeof localStorage)return console.error("Cam4Analytics tags noop - localStorage not available"),"NA";room=(room+"").toLowerCase();try{var isRecommended="-1",recEngOn="-1",item=localStorage.getItem("c4analyticsRecommendations");if(item){var rec=JSON.parse(item);(new Date).getTime()-rec.ts<12e4||doCleanup&&(localStorage.removeItem("c4analyticsRecommendations"),localStorage.removeItem("c4analyticsCams")),rec.recCams&&rec.recCams.indexOf&&(isRecommended=getVal(rec.recCams.indexOf(room)>=0)),recEngOn=getVal(rec.recEngOn)}var camIdx=-1,camsItem=localStorage.getItem("c4analyticsCams");if(camsItem){var cams=JSON.parse(camsItem);cams.cams&&cams.cams.indexOf&&(camIdx=cams.cams.indexOf(room))}var countryCode="00",userAcceptedSexualProfiling="-1";return"undefined"!=typeof Cam4User&&(countryCode=Cam4User.countryCode,userAcceptedSexualProfiling=getVal(Cam4User.userAcceptedSexualProfiling)),"r:"+isRecommended+";ra:"+recEngOn+";p:"+userAcceptedSexualProfiling+";c:"+countryCode+";idx:"+camIdx}catch(e){return console.error("Cam4Analytics failed to determine current tags",e),"NA"}};return{pageLoaded:function(){if(console.log("Cam4Analytics on page loaded"),"undefined"!=typeof localStorage)try{if("undefined"!=typeof Cam4Performer&&Cam4Performer.name)_currentTags=Cam4Performer&&getTags(Cam4Performer.name,!0);else{var crtTime=(new Date).getTime(),recs={recCams:$("#directoryHtml .profileDataBox.recEng").map(function(){return($("a",this).attr("href")+"").substring(1).toLowerCase()}).toArray(),recEngOn:!!ControlledFeatures.USE_RECOMMENDATION_ENGINE,ts:crtTime},dir={cams:$("#directoryHtml .profileDataBox").map(function(){return $("a",this).attr("href").substring(1).toLowerCase()}).toArray(),ts:crtTime};0===recs.recCams.length&&0===$("#directoryHtml .profileDataBox .profileBoxTitle").length?++cntRetriesOnLoad<10?(console.log("Cam4Analytics - delay onLoaded event as the page is not yet loaded"),setTimeout(Cam4Analytics.pageLoaded,2e3)):console.log("Cam4Analytics - onLoaded retries exhausted. Giving up"):(localStorage.setItem("c4analyticsRecommendations",JSON.stringify(recs)),localStorage.setItem("c4analyticsCams",JSON.stringify(dir)))}}catch(e){console.error("Cam4Analytics failed to track current directory content.",e)}else console.error&&console.error("Cam4Analytics tracking noop - localStorage not available")},getTags:getTags,getCurrentTags:function(){return _currentTags},getCurrentTagDetails:function(){try{return parseTags(_currentTags)}catch(e){return console.log("Unable to parse Cam4Analytic tags",e),{}}},getDeviceName:function(){return"undefined"==typeof UserAgent?"NA":["Desktop","Tablet","Mobile","Phone"].filter(function(device){return!0===UserAgent[device.toLowerCase()]})[0]}}}();$(document).ready(function(){Cam4Analytics.pageLoaded()});
var currentModal={};Utils.modalContainerID="Cam4DialogContainer",Utils.popWithAjaxContent=function(p_url,opts,useIframe,callback,preloadedContent,successCallback,closeCallback,additionClass){function closeModals(event){27!==(event.which?event.which:event.keyCode)||Disclaimer.disclaimerBeingShown||Utils.closeModalPops()}var name=Utils.modalContainerID;Disclaimer.disclaimerBeingShown="/disclaimer/ww.jsp"==p_url,Cam4Event.hasEventListener(Cam4Event.DOCUMENT_KEY_DOWN,closeModals)||Cam4Event.addEventListener(Cam4Event.DOCUMENT_KEY_DOWN,closeModals),function(){Utils.closeModalPops();var dialogContainer;if(document.getElementById(name))(dialogContainer=document.getElementById(name)).innerHTML="";else{var divContainer=document.body||document.documentElement||document.getElementsByTagName("head")[0];(dialogContainer=document.createElement("div")).setAttribute("id",name),dialogContainer.setAttribute("class","modal"),divContainer.insertBefore(dialogContainer,divContainer.childNodes[0]),$j(dialogContainer).fadeIn("fast")}var modalDialog=document.createElement("div");for(var i in opts)null!==modalDialog.style[i]&&(modalDialog.style[i]=opts[i]);dialogContainer.onclick||Disclaimer.disclaimerBeingShown||(dialogContainer.onclick=function(event){this.classList.contains("alwaysOpen")||void 0!==event&&event.target&&event.target.id===name&&Utils.closeModalPops()}),void 0!==additionClass?modalDialog.setAttribute("class","modal-dialog "+additionClass):modalDialog.setAttribute("class","modal-dialog"),dialogContainer.appendChild(modalDialog);var modalContent=document.createElement("div");if(modalContent.setAttribute("class","modal-content"),modalDialog.appendChild(modalContent),useIframe){var iframeElem=document.createElement("iframe");iframeElem.setAttribute("src",p_url);for(var i in opts)"name"==i?iframeElem.setAttribute("name",opts[i]):null!==iframeElem.style[i]&&(iframeElem.style[i]=opts[i]);return Cam4Event.dispatch(Cam4Event.MODAL_OPENED,iframeElem),modalContent.appendChild(iframeElem),"function"==typeof callback&&callback(),iframeElem}if(void 0!==preloadedContent&&""!==preloadedContent)modalContent.innerHTML=preloadedContent,Cam4Event.dispatch(Cam4Event.MODAL_OPENED,preloadedContent),"function"==typeof callback&&callback(preloadedContent);else{var ajaxParams={url:p_url,type:"GET"};/^\/checkout/.test(p_url)&&(ajaxParams.xhrFields={withCredentials:!0});var modalAjaxRequest=$.ajax(ajaxParams);modalAjaxRequest.success(function(response){modalContent.innerHTML=response,Cam4Event.dispatch(Cam4Event.MODAL_OPENED,response),callback&&callback(response),Utils.codeForIE8and9()}),modalAjaxRequest.error(function(response){callback&&callback(response)})}}(),currentModal.success=successCallback,currentModal.closed=closeCallback},Utils.popPreloadedContent=function(content,callback){Utils.popWithAjaxContent("",{},!1,callback,content)},Utils.displayModalLoadingLogo=function(){if(!$j("#"+Utils.modalContainerID).length){var elem=document.createElement("div"),domRoot=document.body||document.documentElement||document.getElementsByTagName("head")[0];elem.setAttribute("id",Utils.modalContainerID),elem.style.display="none",domRoot.appendChild(elem),$j("#"+Utils.modalContainerID).addClass("modal")}$j("#"+Utils.modalContainerID).css("opacity",1).addClass("loading-animation").show()},Utils.closeModalPops=function(success){if("undefined"!=typeof TokenExitOffer){if(TokenExitOffer.isExitOfferActive())return void TokenExitOffer.popExitOffer();if(TokenExitOffer.isExitOfferVisible())return}"undefined"!=typeof ChatSettings&&ChatSettings.hide(),"undefined"!=typeof PlayerTranslate&&PlayerTranslate.useModalLayout()&&PlayerTranslate.dismissTranslation();try{Cam4Event.dispatch(Cam4Event.MODAL_CLOSING)}catch(ex){console.log(ex)}$j("#"+Utils.modalContainerID).remove(),$j("#popup_submit").hide(),$j("#modalLayout .modal-dialog").removeClass("modal-lg");try{$j("#modalLayout").modal("hide")}catch(ex){console.log(ex)}$j("#modalLayout").removeData("bs.modal"),success&&currentModal.success?currentModal.success():currentModal.closed&&currentModal.closed(),currentModal={}},Utils.displayVidyoUnavailableModal=function($checkbox){ControlledFeatures.USE_NEW_CAM2CAM&&$checkbox.is(":checked")&&("undefined"==typeof VidyoConnector||!VidyoConnector.isAvailable()||VidyoConnector.isEdgeBrowser()||VidyoConnector.isSafariBrowser())&&($checkbox.prop("checked",!1),"1"===Chat.getBlocksOfTimeActive()&&$j("#sendRequest").attr("disabled",!0),$j("#genericAlertModalContent").html(js_i18n.vidyoSupportedBrowsers),$j("#genericAlertModal").show())};
var ToolTip=function(){var generatedTooltips=[];return{on:function(event,text,settings){var defaultSettings={offsetX:10,offsetY:0,backgroundColor:"#000",color:"#FFF",className:"tooltip",width:"auto",maxWidth:"150px",padding:"10px","font-size":"12px"};settings&&(defaultSettings=Utils.mergeObjects(defaultSettings,settings));var toolTip=document.createElement("div"),pagePoint={x:0,y:0};if("string"==typeof event){var item=document.getElementById(event);pagePoint.x=Utils.getOffset(item).left,pagePoint.y=Utils.getOffset(item).top}else if(event.domElement)pagePoint.x=Utils.getOffset(event.domElement).left,pagePoint.y=Utils.getOffset(event.domElement).top;else{if(!event)return!1;event.pageX?pagePoint.x=event.pageX:event.clientX&&(pagePoint.x=event.clientX+document.body.scrollLeft+document.documentElement.scrollLeft),event.pageY?pagePoint.y=event.pageY:event.clientY&&(pagePoint.y=event.clientY+document.body.scrollTop+document.documentElement.scrollTop)}$j(toolTip).css({position:"absolute","z-index":"99999",width:defaultSettings.width,height:"auto",padding:defaultSettings.padding,backgroundColor:defaultSettings.backgroundColor,left:defaultSettings.left||pagePoint.x+defaultSettings.offsetX+"px",top:defaultSettings.top||pagePoint.y+defaultSettings.offsetY+"px",color:defaultSettings.color,"border-radius":"2px","-moz-border-radius":"2px","-webkit-border-radius":"2px","font-size":defaultSettings["font-size"],maxWidth:defaultSettings.maxWidth,opacity:"1"}),text&&(toolTip.innerHTML=text),toolTip.setAttribute("id","autogenTooltip"+Math.round(100*Math.random())),toolTip.setAttribute("class",defaultSettings.className);var parent=document.body;parent.appendChild(toolTip);var tooltipObject={root:parent,child:toolTip};return Utils.lastTooltip=tooltipObject,generatedTooltips.push(tooltipObject),tooltipObject},removeAll:function(){for(var i=0;i<generatedTooltips.length;i++){var tooltipobject=generatedTooltips[i];try{tooltipobject.root.removeChild(tooltipobject.child)}catch(ex){}}},getAll:function(){return generatedTooltips}}}();Utils.toolTipOn=ToolTip.on,Utils.clearLastToolTip=ToolTip.removeAll;
!function($){var defaults={center:"screen",createNew:!0,height:500,left:0,location:!1,menubar:!1,name:null,onUnload:null,resizable:!1,scrollbars:!1,status:!1,toolbar:!1,top:0,width:500};$.popupWindow=function(url,opts){var options=$.extend({},defaults,opts);if("parent"===options.center)options.top=window.screenY+Math.round(($(window).height()-options.height)/2),options.left=window.screenX+Math.round(($(window).width()-options.width)/2);else if(!0===options.center||"screen"===options.center){var screenLeft=void 0!==window.screenLeft?window.screenLeft:screen.left;options.top=(screen.height-options.height)/2-50,options.left=screenLeft+(screen.width-options.width)/2}var params=[];params.push("location="+(options.location?"yes":"no")),params.push("menubar="+(options.menubar?"yes":"no")),params.push("toolbar="+(options.toolbar?"yes":"no")),params.push("scrollbars="+(options.scrollbars?"yes":"no")),params.push("status="+(options.status?"yes":"no")),params.push("resizable="+(options.resizable?"yes":"no")),params.push("height="+options.height),params.push("width="+options.width),params.push("left="+options.left),params.push("top="+options.top);var random=(new Date).getTime(),name=options.name||(options.createNew?"popup_window_"+random:"popup_window"),win=window.open(url,name,params.join(","));if(options.onUnload&&"function"==typeof options.onUnload)var unloadInterval=setInterval(function(){win&&!win.closed||(clearInterval(unloadInterval),options.onUnload())},50);return win&&win.focus&&win.focus(),win}}(jQuery);
var TokenExitOffer={offerTimeout:null,recacheTimer:0,exitOfferElemId:"buyTokensExitOffer",isExitOfferVisible:function(){return $j("#"+TokenExitOffer.exitOfferElemId).is(":visible")},closeExitOffer:function(){TokenExitOffer.isExitOfferVisible()&&$j("#"+TokenExitOffer.exitOfferElemId).hide()},popExitOffer:function(){TokenExitOffer.recacheTimer||(TokenExitOffer.recacheTimer=1e3*$j("#"+TokenExitOffer.exitOfferElemId).find("input[name=tokensExitOfferTimer]").val()),null!=TokenExitOffer.offerTimeout&&(clearTimeout(TokenExitOffer.offerTimeout),TokenExitOffer.offerTimeout=null),TokenExitOffer.isExitOfferActive()?($j("#buyTokensModalContainer .overlaySubmitBtn").hide(),$j("#"+TipFactory.checkoutPaymentFormId).append('<input type="hidden" name="withExitOffer" value="true" />'),$j("#"+TokenExitOffer.exitOfferElemId).show(),setTimeout(function(){$j("body").bind("click",TokenExitOffer.submitExitOffer)},0)):$j("body").unbind("click",TokenExitOffer.submitExitOffer)},offerWasUsed:!1,isExitOfferActive:function(){return!TokenExitOffer.offerWasUsed&&!TipFactory.purchaseDecisionMade&&$j("#"+TokenExitOffer.exitOfferElemId).length>0&&!TokenExitOffer.isExitOfferVisible()},submitExitOffer:function(event){if(!TokenExitOffer.offerWasUsed){$j("body").unbind("click",TokenExitOffer.submitExitOffer);var paymentForm=$j("#"+TipFactory.checkoutPaymentFormId);paymentForm.find("#tokenPackage_250_TOKENS").prop("checked","checked"),paymentForm.submit(),TokenExitOffer.offerWasUsed=!0}}};
var TipEvent={ON_BALANCE_GOT:"tipping_balance_got",ON_TIP_SENT:"on_tip_sent",ON_GET_SESSION:"viewer_session_got",PERFORMER_SESSION_GOT:"performer_session_got",PERFORMER_RECEIVED_TIPS:"performer_received_tips",DICE_ROLLED:"dice_rolled",DICE_GAME_ENABLED:"dice_game_enabled",DICE_GAME_UPDATED:"dice_game_updated",DICE_GAME_ENDED:"dice_game_ended",PERFORMER_GOAL_REACHED:"performer_goal_reached"},TipDeltas={sendTipSampling:4e3,performer:{GHS_delta:1e3,GHS_init:1e4,GLT_init:5e3,CS_tryAgain:2e3,failureSampling:5,incrementAfterFailure:1e3,watchDog:{restartAfter:2e4,waitBeforeRestart:200,killPendingAt:20},maxGHStryouts:5},viewer:{getViewS_delta:1e3,sessionGotFailureSampling:10,getViewS_init:1e3,getLastTS_init:8e3,getViewS_incrementOnFail:1e3,getViewS_restoreFromFail:8e3,getLastTS_incrementOnFail:1e3},allowWatchDogDebug:function(){return 50===Math.round(100*Math.random())}};Array.prototype.allValuesSame=function(){if(this.length>0)for(var i=1;i<this.length;i++)if(this[i]!==this[0])return!1;return!0};var TipSampler=function(){function flush(){listOfData=new Array,listOfDates=new Array;for(var i=0;i<unit+1;i++)listOfData.push(1);listOfData.push(new Date)}var listOfData=new Array,listOfDates=new Array,unit=TipDeltas.sendTipSampling;return flush(),{flush:flush,allow:function(){if(console.log(listOfDates),listOfDates.length<3)return!0;var lastIndex=listOfDates.length-1,last=listOfDates[lastIndex],previous=listOfDates[lastIndex-1],diff=Math.abs(last-previous);return console.log(">>>> "+diff),diff>=unit},push:function(dateTime){listOfDates.push(dateTime)}}}();Array.min=function(array){return Math.min.apply(Math,array)},Array.max=function(array){return Math.max.apply(Math,array)};
var TipCommunicator=new function(){var loggerInterval,URLApi=TIPPING_SERVER,URLUser=URLApi+"/tipper/tipping.user.php",URLClass=URLApi+"/tipper/tipping.class.php",logsArray=[],loggerIsRunning=!1,sendTraceId=!0;this.getDomain=function(){if(window.location&&window.location.host)return window.location.host;void 0===window.location&&(window.location={});try{window.location.host=document.URL.match(/:\/\/(.[^/]+)/)[1]}catch(ex){}return window.location.host},this.getURL=function(){return URLApi},this.breakURL=function(){URLUser="http://localhost/SheicProj/SheicPhp/tipping/tipper/tipping.user.php",URLClass="http://localhost/SheicProj/SheicPhp/tipping/tipper/tipping.user.php"},this.restoreURL=function(){URLApi=TIPPING_SERVER,URLUser=URLApi+"/tipper/tipping.user.php",URLClass=URLApi+"/tipper/tipping.class.php"};var self=this,data={performerName:"undefined",viewerName:"undefined",webCdn:WEB_CDN||"",lang:Cam4User.lang?Cam4User.lang:"en",kN:0,iB:0};data.performerName=Cam4User.performerName,data.viewerName=Cam4User.userName,data.kN=Cam4User.kN,data.iB=Cam4User.iB,data.lang=Cam4User.lang,this.status={callsToGetUserSession:{total:0,times:[]},callsToGetLastTips:{total:0,times:[]},callsToGetHostSession:{total:0,times:[]},callsToCreateSession:{total:0,times:[]},callsToGetBalance:{total:0,times:[]}},this.getStatus=function(){for(var i in this.status)this.status[i].rate=function(list){var response=new Object,arr=new Array;if(list.length>1){for(var i=1;i<list.length;i++)arr.push(list[i]-list[i-1]);response.maxDelay=Array.max(arr),response.minDelay=Array.min(arr),response.lastDelay=list[list.length-1].getTime()-list[list.length-2].getTime()}return response}(this.status[i].times);return this.status},this.destroy=function(){this.getUserSession=function(){},this.getLastTips=function(){},this.getHostSession=function(){}},this.setData=function(p_mN,p_uN,p_kN,p_iB,p_lang){data.performerName=p_mN,data.viewerName=p_uN,data.kN=p_kN,data.iB=p_iB,p_lang&&(data.lang=p_lang)},this.removeScript=function(object){setTimeout(function(){try{object.root.removeChild(object.script)}catch(ex){console.log("TC: unable to remove script because ",ex)}},200)},this.callAsyncWebTipping=function(url,callback){var request=$.ajax({url:url,type:"GET",dataType:"text",cache:!1});request.done(function(response){if(response){var obj=JSON.parse(response);callback(obj)}}),request.fail(function(jqXHR,status,errorThrown){self.log("error",{url:this.url,status:status,errorCode:jqXHR.status}),"function"==typeof callback&&callback()})},this.callAsyncTipping=function(scriptSource,callback,failCallback){function _getOperationFromUrl(url){for(var hash,op,vars=[],hashes=url.slice(url.indexOf("?")+1).split("&"),i=0;i<hashes.length;i++)hash=hashes[i].split("="),vars.push(hash[0]),vars[hash[0]]=hash[1];try{op=JSON.parse(decodeURIComponent(vars.params)).operation}catch(ex){console.log("could not parse URL params: "+ex)}return op}function _onRequestSuccess(request,response,requestUrl){-1!=requestUrl.indexOf("createSession")&&self.log("info",{operation:_getOperationFromUrl(requestUrl)+"_"+request.status,url:requestUrl,response:response});var obj,regExpMethod=/(^.*)\(/,regExpArg=/\((.*)\)/,arg=(response.match(regExpMethod),response.match(regExpArg));try{obj=JSON.parse(arg[1])}catch(ex){console.log(ex)}void 0!==obj&&(obj.hasOwnProperty("status")&&(obj.status=obj.status.toString()),callback(obj)),ServiceTipViewer.setSessionActiveRequest(requestUrl,!1)}function _onRequestError(requestUrl,errorArgs){self.log("error",{operation:_getOperationFromUrl(requestUrl)+"_"+errorArgs.jqXHR.status,url:requestUrl,status:errorArgs.status,errorCode:errorArgs.jqXHR.status});try{"function"==typeof failCallback?failCallback():callback()}catch(ex){console.log(ex)}ServiceTipViewer.setSessionActiveRequest(requestUrl,!1)}if(-1!=scriptSource.indexOf("createSession")&&self.log("info",{operation:_getOperationFromUrl(scriptSource)+"_send",url:scriptSource}),ControlledFeatures&&ControlledFeatures.USE_NONJQUERY_TIP_COMMUNICATOR)(request=new XMLHttpRequest).onload=function(){_onRequestSuccess(request,request.response,request.url)},request.onerror=function(jqXHR,status,errorThrown){_onRequestError(request.url,{jqXHR:{status:request.status},status:request.statusText,errorThrown:errorThrown})},request.url=scriptSource,request.open("GET",scriptSource,!0),request.send();else{var settings={url:scriptSource,type:"GET",dataType:"text"};sendTraceId&&ControlledFeatures.DISTRIBUTED_TRACING&&"undefined"!=typeof Chat&&(settings.headers={"X-B3-TraceId":Chat.generateTraceId(),"X-B3-SpanId":Chat.generateSpanId(),"X-B3-Sampled":1},sendTraceId=!1);var request=$.ajax(settings);request.done(function(response){_onRequestSuccess(request,response,this.url)}),request.fail(function(jqXHR,status,errorThrown){_onRequestError(this.url,{jqXHR:jqXHR,status:status,errorThrown:errorThrown})})}return!1},this.random=function(){return Math.random()},this.getAnalyticsTags=function(){return"undefined"!=typeof Cam4Analytics?Cam4Analytics.getCurrentTags():"NA"};var lastCallToGetUserSession=new Date("1985");this.getUserSession=function(session_id,callbackFunctionName,callBack){var jsonLine='{"operation":"getUserSession","session_id":"'+session_id+'","model_id":"'+data.performerName+'","user_id":"'+data.viewerName+'","key":"'+data.kN+'","lang":"'+data.lang+'", "domain": "'+this.getDomain()+'"}',url=URLUser+"?callback="+callbackFunctionName+"&params="+jsonLine+"&zzz="+this.random(),now=(ServiceTipViewer.getIntervals().getSessionIn,new Date);now.getTime(),lastCallToGetUserSession.getTime();return lastCallToGetUserSession=now,this.status.callsToGetUserSession.total++,this.status.callsToGetUserSession.times.push(new Date),this.callAsyncTipping(url,callBack),Cam4User.isLoggedIn},this.sendTipAmmount=function(session_id,p_amount,callbackFunctionName,callBack){var tags=this.getAnalyticsTags(),amount=p_amount;amount=parseInt(amount);var stealthMode="";void 0!==Cam4User.stealthModeValue&&""!=Cam4User.stealthModeValue&&(stealthMode=Cam4User.stealthModeValue);var analyticsEvent;ControlledFeatures.CAM4_ANALYTICS&&(analyticsEvent={event:"SendTip",eventCategory:"tipping",eventAction:"OnlineTip",eventLabel:tags,eventValue:amount});var objData={type:"SEND_TIP",sessionId:session_id,modelId:data.performerName,amount:amount,stealthMode:stealthMode,viewer:data.viewerName,accessHash:data.kN,tags:tags};Chat.hasOwnProperty("getKiiroo")&&(objData.kiirooRoom="true"==Chat.getKiiroo()),self.callWebTipping(objData,function(obj){Cam4User.isViewer()&&ServiceTipViewer.tipSent(obj)},analyticsEvent)};var oldDate=new Date("1985");this.getLastTips=function(session_id,last_session_id,callbackFunctionName,callBack){var isBroadcaster=Cam4User.userName.toLowerCase()==Cam4User.performerName.toLowerCase(),jsonLine='{"operation":"getLastTipsJ","session_id":"'+session_id+'","model_id":"'+data.performerName+'","last_id":"'+last_session_id+'","key":"'+data.kN+'","lang":"'+data.lang+'", "domain": "'+this.getDomain()+'"}',url="";url=isBroadcaster?URLClass+"?callback="+callbackFunctionName+"&params="+jsonLine+"&zzz="+this.random():URLUser+"?callback="+callbackFunctionName+"&params="+jsonLine+"&zzz="+this.random();ServiceTipViewer.getIntervals().getSessionIn;isBroadcaster&&ServiceTipPerformer.getIntervals().lastTipsIn;var now=new Date;oldDate=now,Cam4User.isLoggedIn&&(this.status.callsToGetLastTips.total++,this.status.callsToGetLastTips.times.push(new Date),this.callAsyncTipping(url,callBack))};var lastCallToGetHostSession=new Date("1985");this.getHostSession=function(session_id,callbackFunctionName,callBack){var jsonLine='{"operation":"getHostSession","session_id":"'+session_id+'","model_id":"'+data.performerName+'","key":"'+data.kN+'","lang":"'+data.lang+'", "domain": "'+this.getDomain()+'"}',url=URLClass+"?callback="+callbackFunctionName+"&params="+jsonLine+"&zzz="+this.random(),now=(ServiceTipPerformer.getIntervals().hostHessionIn,new Date);now.getTime(),lastCallToGetHostSession.getTime();lastCallToGetHostSession=now,(Cam4User.isLoggedIn||Cam4User.isLoggedInAsGuest)&&(this.status.callsToGetHostSession.total++,this.status.callsToGetHostSession.times.push(new Date),this.callAsyncTipping(url,callBack))},this.getWebHostSession=function(session_id,callback){var url="/tippingOperation?"+("type=GET_HOST_SESSION&sessionId="+(session_id||"")+"&modelId="+data.performerName+"&accessHash="+data.kN),now=new Date;now.getTime(),lastCallToGetHostSession.getTime();lastCallToGetHostSession=now,(Cam4User.isLoggedIn||Cam4User.isLoggedInAsGuest)&&(this.status.callsToGetHostSession.total++,this.status.callsToGetHostSession.times.push(new Date),this.callAsyncWebTipping(url,callback))},this.setGoal=function(session_id,amount,callbackFunctionName,callBack){var jsonLine='{"operation":"setGoal","session_id":"'+session_id+'","model_id":"'+data.performerName+'","amount":"'+amount+'","key":"'+data.kN+'","lang":"'+data.lang+'", "domain": "'+this.getDomain()+'"}',url=URLClass+"?callback="+callbackFunctionName+"&params="+jsonLine+"&zzz="+this.random();this.callAsyncTipping(url,callBack)},this.setMessage=function(session_id,message,callbackFunctionName,callBack){var jsonLine='{"operation":"setMessage","session_id":"'+session_id+'","model_id":"'+data.performerName+'","message":"'+message+'","key":"'+data.kN+'","lang":"'+data.lang+'", "domain":"'+this.getDomain()+'"}',url=URLClass+"?callback="+callbackFunctionName+"&params="+encodeURIComponent(jsonLine)+"&zzz="+this.random();this.callAsyncTipping(url,callBack)},this.setTimeLimit=function(session_id,value,callbackFunctionName,callBack){var jsonLine='{"operation":"setTimeLimit","session_id":"'+session_id+'","model_id":"'+data.performerName+'","deadline":"'+value+'","key":"'+data.kN+'","lang":"'+data.lang+'", "domain": "'+this.getDomain()+'"}',url=URLClass+"?callback="+callbackFunctionName+"&params="+jsonLine+"&zzz="+this.random();this.callAsyncTipping(url,callBack)},this.createSession=function(callbackFunctionName,callBack,failCallback){var jsonLine='{"operation":"createSession","model_id":"'+data.performerName+'","key":"'+data.kN+'","lang":"'+data.lang+'", "domain":"'+this.getDomain()+'"}',url=URLClass+"?callback="+callbackFunctionName+"&params="+jsonLine+"&zzz="+this.random();Cam4User.isLoggedIn&&(this.status.callsToCreateSession.total++,this.status.callsToCreateSession.times.push(new Date),this.callAsyncTipping(url,callBack,failCallback))},this.getBalance=function(callbackFunctionName,callBack){if(ControlledFeatures.USE_EWALLET)this.getBalanceFromCam4Api(callBack);else{var jsonLine='{"operation":"getBalance","user_id":"'+data.viewerName+'","key":"'+data.kN+'","lang":"'+data.lang+'", "domain": "'+this.getDomain()+'"}',url=URLUser+"?callback="+callbackFunctionName+"&params="+jsonLine+"&zzz="+this.random();this.status.callsToGetBalance.total++,this.status.callsToGetBalance.times.push(new Date),this.callAsyncTipping(url,callBack)}},this.getBalanceFromCam4Api=function(callBack){var urlCamr4ApiBalance="/rest/v1.0/ewallet/"+Cam4User.userName+"/accounts?accountType=WALLET";this.status.callsToGetBalance.total++,this.status.callsToGetBalance.times.push(new Date),$j.ajax({type:"GET",url:urlCamr4ApiBalance,success:function(result){if(result&&result.length>0){for(var i=0;i<result.length;i++)if("WALLET"==result[i].type){callBack({userbalance:result[i].balance});break}}else callBack()},error:function(err){callBack()}})},this.sendOfflineTip=function(amount,message,callbackFunctionName){ServiceTipViewer.checkDisabledRiskTokens()||$j.ajax({url:"/offlineTip",type:"POST",data:{receiver:data.performerName,tipAmount:amount,message:message},success:function(result){callbackFunctionName(result)},error:function(xhr,status,txt){console.log(txt)}})},this.callGameData=function(callParams,callback){var url=URLUser+"?params="+encodeURIComponent(JSON.stringify(callParams))+"&zzz="+TipCommunicator.random();$j.ajax({url:url,type:"GET",dataType:"json",success:function(res){"function"==typeof callback&&callback(res)},error:function(err){console.error(err)}})},this.callWebTipping=function(objData,callback,analyticsEvent){var settings={url:"/tippingOperation",type:"POST",data:objData,dataType:"json",success:function(res){var obj;if("string"==typeof res)try{obj=JSON.parse(res)}catch(ex){console.log(ex)}else obj=res;"function"==typeof callback&&callback(obj),"undefined"!=typeof dataLayer&&analyticsEvent&&(!analyticsEvent.amount&&obj.amount&&(analyticsEvent.amount=obj.amount),dataLayer.push(analyticsEvent))},error:function(err){console.error(err),callback({status:"-2"})}};ControlledFeatures.DISTRIBUTED_TRACING&&"undefined"!=typeof Chat&&(settings.headers={"X-B3-TraceId":Chat.generateTraceId(),"X-B3-SpanId":Chat.generateSpanId(),"X-B3-Sampled":1}),$j.ajax(settings)},this.sendGameAction=function(obj,callback){void 0!==Cam4User.stealthModeValue&&""!=Cam4User.stealthModeValue&&(obj.stealthMode=Cam4User.stealthModeValue),Chat.hasOwnProperty("getKiiroo")&&(obj.kiirooRoom="true"==Chat.getKiiroo());var analyticsEvent;ControlledFeatures.CAM4_ANALYTICS&&(analyticsEvent={event:"SendTip",eventCategory:"tipping",eventAction:"GameAction",eventLabel:this.getAnalyticsTags(),eventValue:0}),self.callWebTipping(obj,callback,analyticsEvent)},this.getData=function(){return data},this.tipToReachGoal=function(session_id,callback){var obj={type:"TIP_TO_REACH_GOAL",sessionId:session_id,modelId:data.performerName,viewer:data.viewerName,accessHash:data.kN};Chat.hasOwnProperty("getKiiroo")&&(obj.kiirooRoom="true"==Chat.getKiiroo()),void 0!==Cam4User.stealthModeValue&&""!=Cam4User.stealthModeValue&&(obj.stealthMode=Cam4User.stealthModeValue);var analyticsEvent;ControlledFeatures.CAM4_ANALYTICS&&(analyticsEvent={event:"SendTip",eventCategory:"tipping",eventAction:"TipToReachGoal",eventLabel:this.getAnalyticsTags(),eventValue:0}),self.callWebTipping(obj,callback,analyticsEvent)},this.killPending=function(){try{window.stop()}catch(e){console.log("window.stop failed with ",e);try{window.document.execCommand("Stop")}catch(ex){console.log("window.document.execCommand failed with ",ex);try{document.execCommand("Stop")}catch(ex){console.log("document.execCommand failed pendings are still alive ",ex)}}}},this.log=function(logType,logContent){logsArray.push({type:logType,content:logContent,timestamp:(new Date).toString()})},this.sendLogs=function(){if(function(){for(var i=0;i<logsArray.length;i++)if("error"==logsArray[i].type)return!0;return!1}()){var objData={loggerLevel:"ERROR",data:JSON.stringify(logsArray),username:Cam4User.userName};$j.ajax({url:"/log",type:"POST",dataType:"json",data:objData,error:function(jqXHR,status,err){console.error("ERROR on sending logs",arguments)}})}logsArray=[]},this.getLogs=function(){return logsArray},this.isLoggerRunning=function(){return loggerIsRunning},this.startLogging=function(){clearInterval(loggerInterval),loggerIsRunning=!0,loggerInterval=setInterval(function(){self.sendLogs()},3e4)},this.stopLogging=function(){loggerIsRunning=!1,clearInterval(loggerInterval)}};
var appsEngineTimeOffset=0,TipAppsEngineCommunicator=new function(){function doSimpleCall(callUrl,successCallBack,errorCallback){return Chat.jwt.then(function(token){doCall(callUrl,{token:token},successCallBack,errorCallback)})}function doCall(callUrl,parameters,successCallBack,errorCallback){jQuery.ajax({url:callUrl,data:JSON.stringify(parameters),type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",success:function(response){void 0!==successCallBack&&successCallBack(response)},error:function(e){void 0!==errorCallback?errorCallback(e):console.error("unable to make tipping bar action: ",e)}})}var BASE_URL=APPS_ENGINE_URL+"/"+Cam4User.performerName+"/TippingBar";return{updateTippingBarGoalDeadline:function(duration,successCallBack,errorCallback){return Chat.jwt.then(function(token){var parameters={d:parseInt(duration)||0,token:token};doCall(BASE_URL+"/update",parameters,successCallBack,errorCallback)})},updateTippingBarGoalMessage:function(message,successCallBack,errorCallback){return Chat.jwt.then(function(token){doCall(BASE_URL+"/update",{m:message,token:token},successCallBack,errorCallback)})},updateTippingBarGoal:function(goal,successCallBack,errorCallback){return Chat.jwt.then(function(token){var parameters={g:parseInt(goal)||0,token:token};doCall(BASE_URL+"/update",parameters,successCallBack,errorCallback)})},tipToReachGoal:function(successCallBack,errorCallback){return doSimpleCall(BASE_URL+"/tiptogoal",successCallBack,errorCallback)},crushTheLeader:function(successCallBack,errorCallback){return doSimpleCall(BASE_URL+"/crushtheleader",successCallBack,errorCallback)},beatTheLeader:function(successCallBack,errorCallback){return doSimpleCall(BASE_URL+"/beattheleader",successCallBack,errorCallback)},getTippingBar:function(successCallBack,errorCallback){return Chat.jwt.then(function(token){jQuery.ajax({url:APPS_ENGINE_URL+"/"+Cam4User.performerName+"/TippingBar",data:{token:token},contentType:"application/json; charset=utf-8",success:function(response){void 0!==successCallBack&&successCallBack(response),void 0!==response&&void 0!==response.st&&+response.st&&response.st>0&&(appsEngineTimeOffset=(new Date).getTime()-response.st)},error:function(e){console.log("error get goal bar:",e),void 0!==errorCallback&&errorCallback(e)}})})},sendTip:function(amount,successCallBack,errorCallback){return Chat.jwt.then(function(token){var parameters={a:parseInt(amount),token:token};doCall(BASE_URL+"/tip",parameters,successCallBack,errorCallback)})}}},TipBarAppsEngine=new function(){function checkGoalReached(oldGb){void 0!==tippingBarState.gb&&void 0!==oldGb&&void 0!==tippingBarState.g&&oldGb<tippingBarState.g&&tippingBarState.gb>=tippingBarState.g&&Cam4Event.dispatch(TipEvent.PERFORMER_GOAL_REACHED)}function playSound(response,updateType){switch(updateType){case"t":case"ttg":case"ctl":case"btl":SoundPlayer.playTippingSound(response.a)}}function startTimers(){void 0===timerIntervalID&&(timerIntervalID=setInterval(updateTimerValues,5e3)),updateTimerValues()}function updateTimerValues(){var now=(new Date).getTime()-appsEngineTimeOffset,messageLastUpdate=tippingBarState.sm;if(void 0!==messageLastUpdate&&messageLastUpdate>0){var lastUpdateTextMinutes,secondsSinceLastUpdate=(now-messageLastUpdate)/1e3,minutesSinceLastUpdate=Math.floor(secondsSinceLastUpdate/60);lastUpdateTextMinutes=minutesSinceLastUpdate<1?"< 1m":minutesSinceLastUpdate+"m";var lastUpdateText=nstiplang.lastUpdated.replace("%1",lastUpdateTextMinutes);$j("#lastUpdateVal").html(lastUpdateText).show()}else $j("#lastUpdateVal").hide();var goalEndTime=tippingBarState.eg;if(void 0!==goalEndTime&&goalEndTime>0&&goalEndTime>now){ncTip.toogleBlackBar(!0);var timeLimitInMinutes=Math.floor((goalEndTime-now)/6e4),timeLimitInMinutesText=timeLimitInMinutes;timeLimitInMinutes<1&&(timeLimitInMinutesText="< 1"),ncTip.setBlackBarMessage(nstiplang.timeLeft+timeLimitInMinutesText+"m")}else ncTip.toogleBlackBar(!1)}function copyFields(dest,source){for(var field in source)source.hasOwnProperty(field)&&(dest[field]=source[field])}var timerIntervalID,tippingBarState={};return{updateTipLeader:function(){if(tippingBarState.tl){var tlName=tippingBarState.tl.u,tlAmount=tippingBarState.tl.a;$j("#infoNum1").html(tlName),tlAmount?$j("#infoSu1").html(" ("+tlAmount+nstiplang.tokens+")"):$j("#infoSu1").html(" (0"+nstiplang.tokens+")"),Cam4User.tipLeader!=tlName&&(ChatUIController.updateTipLeaderIcon(tlName),Cam4User.tipLeader=tlName)}else $j("#infoNum1").html(" (0 "+nstiplang.tokens+")")},getTippingBarState:function(){return tippingBarState},updateTippingBarState:function(response,updateType){switch(updateType){case"u":void 0===response.g&&(response.g=0,response.gb=0)}var oldGb=tippingBarState.gb;copyFields(tippingBarState,response),checkGoalReached(oldGb),startTimers(),playSound(response,updateType)}}};
var TippingDevices=new function(){this.deviceTipNotifier=null,this.addDeviceNotification=function(obj){obj.user&&obj.amount?(TippingDevices.deviceTipNotifier||TippingDevices.appendDeviceNotifierDiv(),TippingDevices.deviceTipNotifier.append('<div class="tip_item">'+obj.user+" "+obj.amount+"</div>")):console.error("Could not add device notification for tip: ",obj)},this.appendDeviceNotifierDiv=function(){null==TippingDevices.deviceTipNotifier&&($j("body").append('<div id="tip_content" class="device-notifier"></div>'),TippingDevices.deviceTipNotifier=$j("#tip_content"))}};$j(document).ready(function(){TippingDevices.appendDeviceNotifierDiv()});
var ServiceTipPerformer=new function(){function dispatch(array,arguments){for(var i=0;i<array.length;i++)try{array[i](arguments)}catch(ex){console.log("CALLBACK ERROR: ",ex)}}function tryAgainCreateSession(){failures++,clearTimeout(tryAgain_tid),clearTimeout(GHS_tid),clearTimeout(GLT_tid),failures>TipDeltas.performer.failureSampling&&(tryAgainIn+=TipDeltas.performer.incrementAfterFailure),communicator.log("error","tryAgainCreateSession called at retry number "+failures),tryAgain_tid=setTimeout(function(){createSession()},tryAgainIn)}function tryAgainGetHostSession(){1==++tryouts&&(tryAgainIn=TipDeltas.performer.CS_tryAgain),communicator.log("error","tryAgainGetHostSession was called at tryout = "+tryouts),tryouts<TipDeltas.performer.maxGHStryouts?started&&(GHS_tid=setTimeout(getHostSession,GHS_tui)):tryAgainCreateSession()}function createSession(){clearTimeout(tryAgain_tid),clearTimeout(GHS_tid),clearTimeout(GLT_tid),communicator.createSession(self.getMethod("sessionCreated"),ServiceTipPerformer.sessionCreated,tryAgainCreateSession)}function getWebHostSession(){clearTimeout(GHS_tid),started&&communicator.getWebHostSession(session_id,ServiceTipPerformer.webHostSessionGot)}function getHostSession(){clearTimeout(GHS_tid),started&&communicator.getHostSession(session_id,self.getMethod("hostSessionGot"),ServiceTipPerformer.hostSessionGot)}function getLastTips(){clearTimeout(GLT_tid),self.hasSession()&&started?communicator.getLastTips(session_id,last_session_id,self.getMethod("lastTipsGot"),ServiceTipPerformer.lastTipsGot):started?autoCheckId=setTimeout(getLastTips,1e3):clearTimeout(autoCheckId)}var communicator=TipCommunicator,useTippingBarAppsEngine=ControlledFeatures&&ControlledFeatures.TIPPING_BAR_APPS_ENGINE_BROADCASTER,communicatorAppsEngine=TipAppsEngineCommunicator,session_id="",last_session_id="",self=this;this.getMethod=function(suffix){return"ServiceTipPerformer."+suffix};var hostSessionCallbacks=[],lastTipsCallbacks=[],sessionCreatedCallbacks=[],errorCallbacks=[],goalSettedCallbacks=[],timeLimitCallbacks=[],messageSetCallbacks=[],started=!1,sessionDone=!1,GHS_tid="",GLT_tid="",GHS_tui=TipDeltas.performer.GHS_init,GLT_tui=TipDeltas.performer.GLT_init;TIPPING_SERVER;this.getIntervals=function(){return{hostHessionIn:GHS_tui,lastTipsIn:GLT_tui}};var failures=0,tryAgainIn=TipDeltas.performer.CS_tryAgain,tryAgain_tid="";this.sessionCreated=function(args){args&&args.session_id&&args.status?args.status>=0?(session_id=args.session_id,dispatch(sessionCreatedCallbacks,args),getHostSession(),getLastTips(),sessionDone=!0,tryAgainIn=TipDeltas.performer.CS_tryAgain):-2==args.status?tryAgainCreateSession():-1==args.status&&(tryAgainIn=TipDeltas.performer.CS_tryAgain,tryAgainCreateSession()):tryAgainCreateSession()},this.webHostSessionGot=function(object){if(object){if(object.session_id&&(session_id=object.session_id),object.status){tryouts=0,object.f&&(GHS_tui=parseInt(object.f)*TipDeltas.performer.GHS_delta);var resForPerf={};for(var i in object)"f"!==i&&"session_id"!==i&&(resForPerf[i]=object[i]);object.goal&&(dataForSocket.goal=object.goal),object.goalbalance&&(dataForSocket.total=object.goalbalance),object.toptipper&&(dataForSocket.topTipper=object.toptipper),object.tlamount&&(dataForSocket.topTipperAmount=object.tlamount),object.last_id&&(clearTimeout(GLT_tid),allowCallAgainGetLastTips=!1,object.last_id>lastRemoteId&&(getLastTips(),lastRemoteId=object.last_id)),dispatch(hostSessionCallbacks,resForPerf);try{Cam4Event.dispatch(TipEvent.PERFORMER_SESSION_GOT,resForPerf)}catch(ex){console.log(ex)}started&&(!1===Cam4User.useFirebase()||usePollingTipping)&&(GHS_tid=setTimeout(getWebHostSession,GHS_tui)),started&&!0===Cam4User.useFirebase()&&!usePollingTipping&&(GHS_tid=setTimeout(getWebHostSession,49e3))}}else GHS_tid=setTimeout(getWebHostSession,GHS_tui)},this.getSessionOnce=function(){return communicator.getHostSession(session_id,self.getMethod("sessionOnceGot"),ServiceTipPerformer.sessionOnceGot),communicator.getLastTips(session_id,last_session_id,self.getMethod("lastTipsOnceGot"),ServiceTipPerformer.lastTipsOnceGot),!0},this.getSessionOnDemand=function(){communicator.getHostSession(session_id,self.getMethod("sessionOnceGot"),ServiceTipPerformer.sessionOnceGot),communicator.getLastTips(session_id,last_session_id,self.getMethod("lastTipsOnceGot"),ServiceTipPerformer.lastTipsOnceGot)},this.sessionOnceGot=function(object){var resForPerf={};for(var i in object)"f"!==i&&"session_id"!==i&&(resForPerf[i]=object[i]);dispatch(hostSessionCallbacks,resForPerf);try{Cam4Event.dispatch(TipEvent.PERFORMER_SESSION_GOT,resForPerf)}catch(ex){console.log(ex)}},this.getTipsOnce=function(){communicator.getLastTips(session_id,last_session_id,self.getMethod("lastTipsOnceGot"),ServiceTipPerformer.lastTipsOnceGot)},this.lastTipsOnceGot=function(object){var resForPerf={};for(var i in object)resForPerf[i]=object[i];if(object.last_id&&(last_session_id=object.last_id),object.tips)try{Cam4Event.dispatch(TipEvent.PERFORMER_RECEIVED_TIPS,object.tips)}catch(ex){console.log(ex)}dispatch(lastTipsCallbacks,resForPerf)};var tryouts=0,dataForSocket={total:0,goal:0,topTipper:"undefined",topTipperAmount:"undefined",lastTipper:"undefined",lastTipperAmount:"undefined"},lastRemoteId=-999;this.hostSessionGot=function(object){if(clearTimeout(GHS_tid),object)if(object.session_id)if(session_id=object.session_id,object.status)if(tryouts=0,object.f&&(GHS_tui=parseInt(object.f)*TipDeltas.performer.GHS_delta),-1==object.status)tryAgainCreateSession();else if(-2==object.status)tryAgainCreateSession();else if(object.status>=0){tryAgainIn=3e4;var resForPerf={};for(var i in object)"f"!==i&&"session_id"!==i&&(resForPerf[i]=object[i]);object.goal&&(dataForSocket.goal=object.goal),object.goalbalance&&(dataForSocket.total=object.goalbalance),object.toptipper&&(dataForSocket.topTipper=object.toptipper),object.tlamount&&(dataForSocket.topTipperAmount=object.tlamount),object.last_id&&(clearTimeout(GLT_tid),allowCallAgainGetLastTips=!1,object.last_id>lastRemoteId&&(getLastTips(),lastRemoteId=object.last_id)),dispatch(hostSessionCallbacks,resForPerf);try{Cam4Event.dispatch(TipEvent.PERFORMER_SESSION_GOT,resForPerf)}catch(ex){console.log(ex)}started&&(!1===Cam4User.useFirebase()||usePollingTipping)&&(GHS_tid=setTimeout(getHostSession,GHS_tui)),started&&!0===Cam4User.useFirebase()&&!usePollingTipping&&(GHS_tid=setTimeout(getHostSession,49e3))}else communicator.log("error","object.status has innappropriate value: "+object.status),tryAgainGetHostSession();else communicator.log("error","object.status has innappropriate value: "+object.status),tryAgainGetHostSession();else communicator.log("error","no session_id given, tryAgainGetHostSession"),tryAgainGetHostSession();else communicator.log("error","no session_id given, hostSessionGot NO RESPONSE OBJECT!"),tryAgainGetHostSession()};var autoCheckId="",allowCallAgainGetLastTips=!0;this.lastTipsGot=function(object){if(clearTimeout(GLT_tid),object){object.last_id&&(last_session_id=object.last_id);var resForPerf={};for(var i in object)resForPerf[i]=object[i];if(object.tips&&object.tips.length>0){try{Cam4Event.dispatch(TipEvent.PERFORMER_RECEIVED_TIPS,object.tips)}catch(ex){console.log(ex)}try{dataForSocket.lastTipper=object.tips[0].user,dataForSocket.lastTipperAmount=object.tips[0].amount}catch(ex){console.log(ex)}try{TippingDevices.addDeviceNotification(object.tips[0])}catch(ex){console.log(ex)}}dispatch(lastTipsCallbacks,resForPerf),dataForSocket.lastTipper="undefined",dataForSocket.lastTipperAmount="undefined",dataForSocket.topTipper="undefined",dataForSocket.topTipperAmount="undefined"}else clearTimeout(GLT_tid)},this.lastTimeLimit="",this.setTimeLimit=function(value){this.lastTimeLimit=value,useTippingBarAppsEngine?communicatorAppsEngine.updateTippingBarGoalDeadline(this.lastTimeLimit):communicator.setTimeLimit(session_id,value,this.getMethod("timeLimitSet"),ServiceTipPerformer.timeLimitSet)},this.lastMessageSet="",this.setMessage=function(value){try{value=value.replace(/(\r\n|\n|\r)/gm," ")}catch(ex){console.log(ex)}this.lastMessageSet=value,useTippingBarAppsEngine?communicatorAppsEngine.updateTippingBarGoalMessage(this.lastMessageSet):communicator.setMessage(session_id,value,this.getMethod("messageSet"),ServiceTipPerformer.messageSet)},this.lastGoal="",this.setGoal=function(amount){this.lastGoal=amount,useTippingBarAppsEngine?communicatorAppsEngine.updateTippingBarGoal(this.lastGoal):communicator.setGoal(session_id,amount,this.getMethod("goalSetted"),ServiceTipPerformer.goalSetted)},this.messageSet=function(args){args&&(args.badword&&Cam4User.userId&&JsReceiver.statusMessageCensoredWord(Cam4User.userId,args.badword),args.status&&args.status>=0&&dispatch(messageSetCallbacks,args))},this.timeLimitSet=function(args){args&&args.status&&args.status>=0&&dispatch(timeLimitCallbacks,args)},this.goalSetted=function(args){args&&args.status&&args.status>=0&&dispatch(goalSettedCallbacks,args)},this.tippingBarUpdate=function(response,updateType){TipBarAppsEngine.updateTippingBarState(response,updateType),dispatch(hostSessionCallbacks,TipBarAppsEngine.getTippingBarState())},this.getTippingBar=function(){useTippingBarAppsEngine&&communicatorAppsEngine.getTippingBar(this.tippingBarUpdate)},this.start=function(){if(!useTippingBarAppsEngine){if(!started&&Cam4User.isLoggedIn){started=!0;try{communicator.isLoggerRunning()||communicator.startLogging()}catch(ex){console.log("Error, tipping logger could not be initialized",ex)}clearTimeout(GHS_tid),clearTimeout(GLT_tid),clearInterval(""),clearTimeout(autoCheckId),tryAgainIn=TipDeltas.performer.CS_tryAgain,ControlledFeatures&&ControlledFeatures.USE_WEB_TIPPING_SESSION?getWebHostSession():this.hasSession()?(getHostSession(),getLastTips()):createSession(),wait=0}return started}this.getTippingBar()},this.stop=function(){started=!1,clearTimeout(GHS_tid),clearTimeout(GLT_tid),clearInterval(""),clearTimeout(autoCheckId),wait=0};var wait=0;this.onTimeLimitSet=function(listener){timeLimitCallbacks.push(listener)},this.onMessageSet=function(listener){messageSetCallbacks.push(listener)},this.onGoalSetted=function(listener){goalSettedCallbacks.push(listener)},this.onSessionCreated=function(listener){sessionCreatedCallbacks.push(listener)},this.onHostSessionGot=function(listener){hostSessionCallbacks.push(listener)},this.onLastTipsGot=function(listener){lastTipsCallbacks.push(listener)},this.onError=function(listener){errorCallbacks.push(listener)},this.hasSession=function(){return void 0!==session_id&&""!==session_id},this.getSessionId=function(){return session_id},this.isRunning=function(){return started},this.removeEventListeners=function(){return hostSessionCallbacks=[],lastTipsCallbacks=[],sessionCreatedCallbacks=[],errorCallbacks=[],goalSettedCallbacks=[],timeLimitCallbacks=[],messageSetCallbacks=[],!0}};
var ServiceTipViewer=new function(){function dispatch(array,arguments){for(var i=0;i<array.length;i++)array[i](arguments)}function checkStatus(num){num>=0?fatalErrors=0:-1==num?dispatch(errorCallbacks,{message:"no tokens in balance",description:"no_more_tokens"}):-2==num&&(fatalErrors++,getViewS+=TipDeltas.viewer.getViewS_incrementOnFail,getLastTS+=TipDeltas.viewer.getLastTS_incrementOnFail,console.log(getViewS+" downing to..."+getLastTS),dispatch(errorCallbacks,{message:nstiplang.errors.serverConnectionError,description:"err_auth_failed"}),fatalErrors>10&&(communicator.destroy(),self.stop()))}function getLastTips(){if(""!==session_id){totalCallsToLastTips++;var allow=Cam4User.useFirebase();return allow||(allow=started),allow?communicator.getLastTips(session_id,last_session_id,self.getMethod("lastTipsGot"),ServiceTipViewer.lastTipsGot):totalCallsToLastTips--,!0}return started&&allowLastTipsUpdate&&!1===Cam4User.useFirebase()&&(getLastTT=setTimeout(getLastTips,getLastTS)),!1}function getViewerSession(){started&&(totalCallsToSession++,communicator.getUserSession(session_id,self.getMethod("sessionGot"),ServiceTipViewer.sessionGot))}var communicator=TipCommunicator,useAppsEngineGoalBar=ControlledFeatures&&ControlledFeatures.TIPPING_BAR_APPS_ENGINE_VIEWER,communicatorAppsEngine=TipAppsEngineCommunicator,session_id="",last_session_id="",self=this,pendingRequest=!1,sessionGotCallbacks=new Array,lastTipGotCallbacks=new Array,sendedTipsCallbacks=new Array,errorCallbacks=new Array,balanceValue="",totalCallsToSession=0,totalCallsToLastTips=0,getViewT="",getViewS=TipDeltas.viewer.getViewS_init,getLastTT="",getLastTS=TipDeltas.viewer.getLastTS_init;this.setSessionActiveRequest=function(script,value){pendingRequest=-1!==script.indexOf("sessionGot")&&value},this.isSessionRequestActive=function(){return pendingRequest},this.getIntervals=function(){return{getUserSession:getViewS,getLastTips:getLastTS}},this.getIntervals=function(){return{getSessionIn:getViewS,lastTipsIn:getLastTS}};var started=!1,allowSessionUpdate=!0,allowLastTipsUpdate=!0,fatalErrors=0,sessionResponseForViewer={userbalance:"",message:"",goal:"0",goalbalance:"0",deadline:"",crtbalance:0,tlamount:0,toptipper:"",status:""},lastTipsReponseForViewer={response:"",tippers:[],status:""};this.tippingBarUpdate=function(response,updateType){TipBarAppsEngine.updateTippingBarState(response,updateType),dispatch(sessionGotCallbacks,TipBarAppsEngine.getTippingBarState())},this.getTippingBar=function(){useAppsEngineGoalBar&&communicatorAppsEngine.getTippingBar(this.tippingBarUpdate)},this.start=function(){useAppsEngineGoalBar?this.getTippingBar():(!1===Cam4User.useFirebase()||usePollingTipping)&&(started||!Cam4User.isLoggedIn&&!Cam4User.isLoggedInAsGuest?started||Cam4User.isLoggedIn||Cam4User.isLoggedInAsGuest||(this.getSessionOnce(),started=!0):(this.stop(),started=!0,allowLastTipsUpdate=!0,allowSessionUpdate=!0,getViewerSession(),getLastTips()))},this.getMethod=function(suffix){return"ServiceTipViewer."+suffix},this.lastTipValue="undefined",this.checkDisabledRiskTokens=function(){return!(!Cam4User.isLoggedInAsGuest||Cam4User.performerAcceptRiskTokens)&&(Registration.activateGuestRegisterModal({isDisabledTips:!0}),!0)},this.sendTip=function(amount){ServiceTipViewer.checkDisabledRiskTokens()||(Cam4User.isLoggedInAsGuest&&NewShow.tipInputToGuestUpsell?Registration.activateGuestRegisterModal({isDisabledTips:!0}):(this.lastTipValue=amount,useAppsEngineGoalBar?communicatorAppsEngine.sendTip(amount,this.tipSentNewApps):communicator.sendTipAmmount(session_id,amount,this.getMethod("tipSent"),ServiceTipViewer.tipSent)))},this.beatTheLeader=function(){communicatorAppsEngine.beatTheLeader(this.tipSentNewApps)},this.crushTheLeader=function(){communicatorAppsEngine.crushTheLeader(this.tipSentNewApps)},this.tipSent=function(args){console.log("viewer tip sent ",args),args?args.status?(checkStatus(args.status),args.response==nstiplang.serverMessages.InsufficientFunds&&TipFactory.popTokens()):dispatch(errorCallbacks,{message:nstiplang.errors.serverConnectionError,description:"err_no_status_tipSent"}):dispatch(errorCallbacks,{message:nstiplang.errors.serverConnectionError,description:"err_no_response_tipSent"}),"undefined".tipSentArgs=args,dispatch(sendedTipsCallbacks,args);try{Cam4Event.dispatch(TipEvent.ON_TIP_SENT,args)}catch(ex){console.log(ex)}},this.tipSentNewApps=function(response){if(void 0!==response){if(void 0!==response.errorCode)switch(response.errorCode){case"INS_FUNDS":TipFactory.popTokens();break;default:this.getTippingBar()}else ServiceTipViewer.tippingBarUpdate(response);dispatch(sendedTipsCallbacks,response);try{Cam4Event.dispatch(TipEvent.ON_TIP_SENT,response)}catch(ex){console.log(ex)}}else console.error("empty response while trying to make tipping operation")},this.lastTipsGot=function(response){lastTipsReponseForViewer.tippers=new Array,response?(response.status?checkStatus(response.status):dispatch(errorCallbacks,{message:nstiplang.errors.serverConnectionError,description:"err_no_status_lastTipGot"}),response.last_id&&""!==response.last_id&&(last_session_id=response.last_id),response.response&&(lastTipsReponseForViewer.response=response.response),response.tips&&(lastTipsReponseForViewer.tippers=response.tips),response.status&&(lastTipsReponseForViewer.status=response.status)):dispatch(errorCallbacks,{message:nstiplang.errors.serverConnectionError,description:"err_no_response_lastTipsGot"}),started&&allowLastTipsUpdate&&Cam4User.isLoggedIn&&!1===Cam4User.useFirebase()&&(getLastTT=setTimeout(getLastTips,getLastTS)),"undefined".lastTipsReponseForViewer=lastTipsReponseForViewer,dispatch(lastTipGotCallbacks,lastTipsReponseForViewer)},this.FireBaseUpdated=function(){!1===Cam4User.useFirebase()&&getViewerSession()},this.getSessionOnce=function(){return totalCallsToSession++,console.log("session: "+session_id),communicator.getUserSession(session_id,self.getMethod("sessionGotOnce"),ServiceTipViewer.sessionGotOnce),!0},this.sessionGotOnce=function(response){console.log("session got once",response);var previousTipAmount=localStorage.getItem("previousTipAmount"),tipAmountBox=navigator.userAgent.match(/iPhone|iPad|android/i)?$j("#i_MobileAmmo"):$j("#i_tipAmmo");try{Cam4Event.dispatch(TipEvent.ON_GET_SESSION,response)}catch(ex){console.log(ex)}if(response){response.session_id&&(session_id=response.session_id),response.last_id&&response.last_id>lastRemoteId&&(lastRemoteId=response.last_id,getLastTips());for(var i in response)"session_id"!==i&&"f"!==i&&null!==response[i]&&(sessionResponseForViewer[i]=response[i]);dispatch(sessionGotCallbacks,sessionResponseForViewer),"undefined".sessionResponseForViewer=sessionResponseForViewer,null!==previousTipAmount&&setTimeout(function(){tipAmountBox.val(previousTipAmount)},1e3)}};var sessionGotFailures=0,lastRemoteId=-999;this.sessionGot=function(response){if(response){if(response.session_id?session_id=response.session_id:(++sessionGotFailures>TipDeltas.viewer.sessionGotFailureSampling&&(getViewS+=TipDeltas.viewer.getViewS_incrementOnFail),dispatch(errorCallbacks,{message:nstiplang.errors.serverConnectionError,description:"err_no_id_sessionGot"}),session_id>0&&this.clearSession()),response.status&&-2==response.status)return console.log("Viewer DIE, REFRESH BROWSER"),void dispatch(errorCallbacks,{message:nstiplang.errors.serverConnectionError,description:"err_auth_failed_sessionGot"});response.last_id&&(clearTimeout(getLastTT),allowLastTipsUpdate=!1,response.last_id>lastRemoteId&&(lastRemoteId=response.last_id,getLastTips())),response.f&&parseFloat(response.f)!==parseFloat(getViewS)&&(getViewS=parseFloat(response.f)*TipDeltas.viewer.getViewS_delta),response.userbalance&&parseInt(response.userbalance)>=0&&(balanceValue=response.userbalance);for(var i in response)"session_id"!==i&&"f"!==i&&null!==response[i]&&(sessionResponseForViewer[i]=response[i])}else getViewS=TipDeltas.viewer.getViewS_restoreFromFail,dispatch(errorCallbacks,{message:nstiplang.errors.serverConnectionError,description:"err_no_response_sessionGot"});dispatch(sessionGotCallbacks,sessionResponseForViewer),"undefined".sessionResponseForViewer=sessionResponseForViewer,started&&allowSessionUpdate&&(Cam4User.isLoggedIn||Cam4User.isLoggedInAsGuest)&&(!1===Cam4User.useFirebase()||usePollingTipping)?getViewT=setTimeout(getViewerSession,getViewS):this.stop();try{Cam4Event.dispatch(TipEvent.ON_GET_SESSION,response)}catch(ex){}},this.stop=function(what){if(started?console.log("stopping service viewer"):console.log("service viewer already stopped"),what)switch(what){case"getSession":return clearTimeout(getViewT),void(allowSessionUpdate=!1);case"getLastTips":clearTimeout(getLastTT),allowLastTipsUpdate=!1}else clearTimeout(getViewT),clearTimeout(getLastTT),allowSessionUpdate=!1,allowLastTipsUpdate=!1;started=!1},this.removeEvent=function(strEvent,index){switch(strEvent){case"onSessionGot":index?sessionGotCallbacks.slice(index,1):sessionGotCallbacks=new Array;break;case"onLastTipsGot":lastTipGotCallbacks.slice(index,1);break;case"onTipSent":sendedTipsCallbacks.slice(index,1);break;case"onError":errorCallbacks.slice(index,1)}},this.removeEventListeners=function(){return sessionGotCallbacks=new Array,lastTipGotCallbacks=new Array,sendedTipsCallbacks=new Array,errorCallbacks=new Array,!0},this.onSessionGot=function(func){return func?(sessionGotCallbacks.push(func),sessionGotCallbacks.length):{remove:function(index){sessionGotCallbacks.slice(index,1)}}},this.onTipToReachGoal=function(response){switch(response.status){case"-2":ncTip.setCompleteGoalBtn("inactive");break;case"-1":response.response==nstiplang.serverMessages.InsufficientFunds&&TipFactory.popTokens();break;default:ncTip.setCompleteGoalBtn("inactive"),dispatch(sendedTipsCallbacks,response)}},this.tipToReachGoal=function(){Cam4User.isLoggedIn||Cam4User.isLoggedInAsGuest?useAppsEngineGoalBar?communicatorAppsEngine.tipToReachGoal(ServiceTipViewer.tipSentNewApps):communicator.tipToReachGoal(session_id,ServiceTipViewer.onTipToReachGoal):TipFactory.popTokens()},this.clearSession=function(){session_id=""},this.onLastTipsGot=function(func){lastTipGotCallbacks.push(func)},this.onTipSent=function(func){sendedTipsCallbacks.push(func)},this.onError=function(func){errorCallbacks.push(func)},this.getCommunicator=function(){return communicator},this.hasSession=function(){return void 0!==session_id&&""!==session_id&&"null"!=session_id&&"undefined"!=session_id},this.hasBalance=function(){return""!==balanceValue},this.getSomeRespone=function(){return"undefined"},this.getSessionId=function(){return session_id},this.isRunning=function(){return started}};
var TipFactory={toggleMobileMenu:function(){$("#mobileTipMenu").slideToggle()},tokensWindow:null,balanceCookieName:"cam4-tipGetBalanceAction",popHelp:function(){Cam4User.isBroadcaster()?window.open("/help/tipping/what","","width=700,height=600,scrollbars=1,toolbars=0,status=0"):(Utils.closeModalPops(),$(".modal-content").empty(),$("#modalLayout").modal({remote:"/help/tipping/what?type=modal"}))},getTippingLogs:function(start,end){var balanceCookieVal=unescape(Cam4Cookies.getCookie(TipFactory.balanceCookieName)),response=Cam4User.userName+"|";response+=Cam4User.lang+"|";try{response+=document.URL.replace("http://","").split("/")[0]+"|"}catch(ex){}return response+=BrowserDetect.browser+"|",response+=BrowserDetect.version+"|",response+=BrowserDetect.OS+"| \n",response+="GET BALANCE ACTION: "+balanceCookieVal+"\n",response+="CAM4 DEBUGS: \n",response+="TIP COMMUNICATOR STATUS: "+JSON.stringify(TipCommunicator.getStatus())+"\n","all"===start?response:end>0?response.substr(start,end):response.length>25e3?response.substr(0,25e3)+" <...>":response},getSessionId:function(){return Cam4User.isBroadcaster()?ServiceTipPerformer.getSessionId():ServiceTipViewer.getSessionId()},checkoutPaymentFormId:"checkoutPaymentForm",purchaseDecisionMade:!1,popTokens:function(){if(!Cam4User.isBroadcaster())try{EpayPlugin.renderTokenPackages()}catch(ex){console.log(ex)}},showBonusTokensOffer:function(){this.bonusTokensTimeout&&clearTimeout(this.bonusTokensTimeout);var popover=$(".buyTokensPopover");!sessionStorage.getItem("popperDismissed")&&popover.length&&popover.removeClass("hidden")},getBalance:function(){return $("#miniBalance").length?Number($("#miniBalance").text()):0},checkIfOpen:function(){return $("#Cam4DialogContainer #epayInnerContainer").length>0},purchasedTokens:function(){return this.initialBalance<this.getBalance()},initialBalance:0,initialPromoModalDelay:12e4,dismissedForLater:!1,checkModal:function(timeout){var self=this;return setTimeout(function(){self.checkIfOpen()?self.modalCheckTimeout=self.checkModal(timeout):(clearTimeout(self.modalCheckTimeout),self.purchasedTokens()?sessionStorage.setItem("popperDismissed","dismissed"):setTimeout(function(){self.showBonusTokensOffer()},self.repeatPromoModalTimeout))},timeout)},waitForPurchase:function(){$(".buyTokensPopover").addClass("hidden"),this.initialBalance=this.getBalance(),this.modalCheckTimeout=this.checkModal(6e4)},hideBonusTokensOffer:function(){$(".buyTokensPopover")&&!$(".buyTokensPopover").hasClass("hidden")&&($(".buyTokensPopover").addClass("hidden"),sessionStorage.setItem("popperDismissed","dismissed"))},setBonusTokensOffer:function(){if(this.bonusTokensTimeout&&clearTimeout(this.bonusTokensTimeout),!sessionStorage.getItem("popperDismissed")){var delay=this.initialPromoModalDelay;if(sessionStorage.getItem("popperTimeoutStarted")){var diff=Date.now()-new Date(sessionStorage.getItem("popperTimeoutStarted")).getTime();delay=diff<this.initialPromoModalDelay?this.initialPromoModalDelay-diff:0}else sessionStorage.setItem("popperTimeoutStarted",new Date);this.bonusTokensTimeout=setTimeout(this.showBonusTokensOffer,delay)}},camelize:function(str){return str.replace(/(?:^\w|[A-Z]|\b\w)/g,function(letter,index){return letter.toUpperCase()}).replace(/\s+/g,"")},parseKey:function(str){if(str.indexOf(" ")>-1){var key=TipFactory.camelize(str);return nstiplang.serverMessages[key]?nstiplang.serverMessages[key]:str}return nstiplang.serverMessages[str]?nstiplang.serverMessages[str]:str},redirectGuest:function(){Cam4User.isLoggedInAsGuest?Registration.activateGuestRegisterModal():Cam4User.useGuestBilling?TipFactory.popTokens():Utils.decideOffer("",{unlockFeature:"tokens",ct:"wost",sendtipuser:Cam4User.performerName})}};TipFactory.quickTipValues=[5,10,25,50],TipFactory.viewerTokensMode=function(hasTokens){function setAttr(id,actionString){document.getElementById(id)&&document.getElementById(id).setAttribute("onclick",actionString)}function setValue(id,value){document.getElementById(id)&&(document.getElementById(id).innerHTML=value+"")}for(var quickTipValues=TipFactory.quickTipValues,i=0;i<quickTipValues.length;i++)setValue("atipBox"+(i+1),quickTipValues[i]+""),setValue("btipBox"+(i+1),quickTipValues[i]+"");if(Cam4User.isLoggedIn||Cam4User.isLoggedInAsGuest)if(hasTokens){for(i=0;i<quickTipValues.length;i++)setAttr("atipBox"+(i+1),"TipExt.sendTip("+quickTipValues[i]+")"),setAttr("btipBox"+(i+1),"TipExt.sendTip("+quickTipValues[i]+")");setAttr("sendTipButtonViewer","ncTip.buttonClicked(this, event)"),setAttr("tipjarHref","tipjar.sendTip()");try{setAttr("mobileSendTipBtn","ncTip.buttonClicked(this, event)")}catch(ex){}}else{var fnCall="TipFactory.popTokens();";setAttr("widgetLoggedin",fnCall),setAttr("sendTipButtonViewer",fnCall);try{setAttr("mobileSendTipBtn",fnCall)}catch(ex){}for(i=0;i<quickTipValues.length;i++)setAttr("atipBox"+(i+1),fnCall),setAttr("btipBox"+(i+1),fnCall);setAttr("tipjarHref",fnCall)}else{for(i=0;i<quickTipValues.length;i++)setAttr("atipBox"+(i+1),"TipFactory.redirectGuest()"),setAttr("btipBox"+(i+1),"TipFactory.redirectGuest()");setAttr("sendTipButtonViewer","TipFactory.redirectGuest()"),setAttr("tipjarHref","TipFactory.redirectGuest()");try{setAttr("mobileSendTipBtn","TipFactory.redirectGuest()")}catch(ex){}}},TipFactory.decrementDeadlineForGuest=function(){if(TipViewerSessionAnswer&&TipViewerSessionAnswer.deadline&&TipViewerSessionAnswer.deadline>0&&ncTip instanceof TipWatcher){var mins=Math.round(TipViewerSessionAnswer.deadline/60);ncTip.toogleBlackBar(!0),ncTip.setBlackBarMessage(nstiplang.timeLeft+mins+"m"),TipViewerSessionAnswer.deadline--}else ncTip.toogleBlackBar(!1);!1===Cam4User.isLoggedIn&&setTimeout(TipFactory.decrementDeadlineForGuest,1e3)};
TipExt={sendTipFromReceipt:function(){var value=$j("#tipAmmoRec").val();value=parseInt(value),ServiceTipViewer.sendTip(value)},sendTip:function(tipValue){ServiceTipViewer.sendTip(tipValue)}};
function TipRoot(){function fixValueToInt(value){return!+value||isNaN(value)||null===value?0:(value=parseInt(value))<0?0:value}function debug(args){}function strOK(value){var dup=value;return""!==(dup=dup.replace(/\s/g,""))}function numOK(value){return!!(strOK(value)&&!1===isNaN(value)&&parseInt(value)>0)}function atLeastOne(number){return number<=0?.1:number}this.lang={setTimeLimit:"Set Time Limit:",enterGoal:"Enter Goal:",enterTipAmmount:"Enter tip amount: ",sendTip:"Send tip",balance:"Balance: ",buyTokens:"Buy tokens",total:"Total: ",goal:"Goal: ",tickets:"Tickets: ",tipLeader:"Tip leader: ",yourTips:"Your tips: ",tokens:" Tokens",timeLeft:"Time left: ",costPerTicket:"Cost of Ticket ",showLength:"Show Length ",minutes:"Minutes",ticketGoal:"Ticket Goal: ",tokenGoal:"Token Goal: ",timeLimit:"Time Limit: ",broadcasterInGroupShow:'<p id="LoginMessage">The current performer is in a group show. You must <a href="/login" class="login nopop">Login</a> or <a href="/gold?showSignupForm=true" class="registerModal nopop">Register</a> to start using this feature.</p>',broadcasterInPrivateShow:'<p id="LoginMessage">The current performer is in a private show. You must <a href="/login" class="login nopop">Login</a> or <a href="/gold?showSignupForm=true" class="registerModal nopop">Register</a> to start using this feature.</p>',broadcasterBasic:'<p id="LoginMessage">You must <a href="/login" class="login nopop">Login</a> or <a href= "/gold?showSignupForm=true" class="registerModal nopop">Register</a> to start using this feature.</p>'},this.settings={maxGoalBarWidth:246,offlineRedirectUrl:"/gold?showSignupForm=true"},this.get=function(name){return document.getElementById(name)},this.merge=function(incompleteObject,completeObject){for(var i in incompleteObject)completeObject[i]=incompleteObject[i];return completeObject},this.setViewerStatusMessage=function(message){return $j("#viewerScreenTxt").text(message),this.arrangeStatusMessage(),message},this.responsiveFix=function(user){if("viewer"===user&&Cam4User.isBroadcaster()){var percent=100-100/($j("#newTipAreaMain").width()/($j("#leftContentViewer").width()+$j("#rightContent").width()))-2;$j("#middleScreen").css("width",percent+"%")}},this.arrangeStatusMessage=function(){var textItem=$j("#viewerScreenTxt"),screenItem=$j("#viewerScreen"),perfFontSize=textItem.css("font-size")||"";perfFontSize=parseFloat(perfFontSize.replace("px",""));var textItemHeight=textItem.height(),screenItemHeight=screenItem.height();if($j("#lastUpdateVal").is(":visible")&&(screenItemHeight-=16),Cam4User.isBroadcaster()?textItem.width("335px"):textItem.width("100%"),textItem.css("word-break","break-all"),textItemHeight>screenItemHeight){var unit=perfFontSize-1;textItem.css("font-size",unit+"px"),this.arrangeStatusMessage()}else textItem.css("top",(screenItemHeight-textItemHeight)/2+"px")},this.setViewerOnline=function(){return $j("#viewerOffline, #broadcasterScreen, #leftContentBroadcast").hide(),$j("#leftContentViewer, #viewerScreen, #goalMeterBox, #viewerOnline, #info1, #info2").show(),!0},this.confirmViewerStatusMessage=function(message){this.setViewerStatusMessage(message),this.colorTransitionEffect({r:156,g:156,b:156},{r:255,g:255,b:255},this.get("viewerScreen"))},this.confirmUpRedLabel=function(value){this.get("i_tipGoal").value=value+"",this.colorTransitionEffect({r:114,g:86,b:86},{r:251,g:228,b:216},this.get("i_tipGoal"))},this.confirmDownRedLabel=function(value){this.get("i_timeLimit").value=value+"",this.colorTransitionEffect({r:114,g:86,b:86},{r:251,g:228,b:216},this.get("i_timeLimit"))},this.confirmFirstInfo=function(value){$j("#infoNum1").text(""+value),this.textColorEffect({r:238,g:238,b:238},{r:56,g:56,b:56},this.get("info1"))},this.confirmSecondInfo=function(value){$j("#infoNum2").text(""+value),this.textColorEffect({r:238,g:238,b:238},{r:56,g:56,b:56},this.get("info2"))},this.colorTransitionEffect=function(fColor,sColor,item){var tn=new TweenMulti(fColor,sColor,60);tn.onUpdate=function(c){item.style.backgroundColor=ColorUtils.rgbToHex(c.r,c.g,c.b)},item&&tn.start()},this.textColorEffect=function(fColor,sColor,item){var tn=new TweenMulti(fColor,sColor,60);tn.onUpdate=function(c){item.style.color=ColorUtils.rgbToHex(c.r,c.g,c.b)},item&&tn.start()},this.setBroadcasterOnline=function(){return $j("#leftContentViewer, #viewerScreen, #viewerOffline, #viewerOnline").hide(),$j("#leftContentBroadcast, #broadcasterScreen, #goalMeterBox, #leftContentBroadcast, #broadcasterScreen").show(),$j("#lastUpdateVal").css("bottom","4px"),this.toogleGoalBar(!1),$j("#infoPre2").html(nstiplang.yourEarnings+":"),$j("#infoNum2").html("0"),$j("#infoSu2").html(nstiplang.tokens),$j("#infoPre1").html(nstiplang.tipLeader),$j("#infoNum1").html(" (0"+nstiplang.tokens+")"),$j("#infoSu1").html(""),this.setInputIndexes(),!0},this.setInputIndexes=function(){return $j("#i_tipGoal").attr("tabindex","1"),$j("#i_timeLimit").attr("tabindex","2"),$j("#i_screen").attr("tabindex","3"),!0},this.fitOfflineText=function(num){if($j("#viewerOffline").is(":visible")){var one=$j("#viewerOffline").height(),self=this;$j("#viewerOffline").css({"font-size":num+"px","line-height":num+"px"}),one<74&&setTimeout(function(){self.fitOfflineText(num+.1)},10)}},this.setViewerOffline=function(broadcasterState){this.loadLang();var currentText=this.lang.broadcasterBasic;if(broadcasterState)switch(broadcasterState){case"inGS":currentText=this.lang.broadcasterInGroupShow;break;case"inPS":currentText=this.lang.broadcasterInPrivateShow;break;default:currentText=this.lang.broadcasterBasic}Cam4User.isBroadcaster()&&$j("#viewerOffline").css({"font-size":"15px","padding-top":"4px"}),$j("#viewerOnline, #leftContentBroadcast, #broadcasterScreen").hide(),$j("#viewerOffline").html(currentText).show();var self=this;return this.buttonClicked=function(item){Cam4User.isBroadcaster()?window.location.href=self.settings.offlineRedirectUrl:Utils.decideOffer()},this.toogleBlackBar(!1),$j("#viewerOffline").html()&&Cam4User.isBroadcaster()&&($j("#viewerOffline").html().length>160?$j("#viewerOffline").css({"font-size":"11px","padding-top":"0"}):$j("#viewerOffline").html().length>82&&broadcasterState?$j("#viewerOffline").css({"font-size":"13px","padding-top":"0"}):$j("#viewerOffline").css({"font-size":"15px","padding-top":"4px"})),"Explorer"===BrowserDetect.browser&&BrowserDetect.version<10&&$j("#sendTipButtonViewer").css({filter:"none",color:"black"}),!0},this.setRightContentData=function(prefix1,prefix2,prefix3,num1,num2,num3,suffix1,suffix2,suffix3){return $j("#infoPre1").html(prefix1),$j("#infoPre2").html(prefix2),$j("#infoPre3").html(prefix3),$j("#infoNum1").html(num1),$j("#infoNum2").html(num2),$j("#infoNum3").html(num3),$j("#infoSu1").html(suffix1),$j("#infoSu2").html(" "+suffix2),$j("#infoSu3").html(suffix3),!0},this.updateRightContentData=function(num1,num2,num3){$j("#infoNum1").text(num1),$j("#infoNum2").text(num2),$j("#infoNum3").text(num3)};var _goalBarPre1="",_goalBarPre2="";this.setGoalBarData=function(pre1,pre2,num1,num2){num1=fixValueToInt(num1)+"",num2=fixValueToInt(num2)+"",_goalBarPre1=pre1,_goalBarPre2=pre2,$j("#gPre1, #gPre1White").text(pre1),$j("#gPre2, #gPre2White").text(pre2),$j("#gNum1, #gNum1White").text(num1),$j("#gNum2, #gNum2White").text(num2)},this.setCompleteGoalBtn=function(state){if(!Cam4User.isBroadcaster()){var btn=$j("#completeGoalBtn");if(0!=btn.length&&!btn.hasClass("always-hidden"))switch(state){case"active":btn.removeAttr("disabled"),btn.show();break;case"inactive":btn.attr("disabled","disabled"),btn.show();break;case"hidden":default:btn.hide()}}},this.updateGoalBarData=function(total,goal){var nu=fixValueToInt(total),cu=fixValueToInt(goal);if(!Cam4User.isBroadcaster()){var maxWidth=$j("#goalMeterBox").width();return percent=cu>0?100-100*nu/cu:0,$j("#goalFront").html(_goalBarPre1+": "+fixValueToInt(total)+" / "+_goalBarPre2+fixValueToInt(goal)),0===nu?($j("#goalBack").width(percent+"%").removeClass("blink"),this.setCompleteGoalBtn("active"),percent=0):total===goal?($j("#goalBack").width("0"),percent=fixValueToInt(maxWidth),this.setCompleteGoalBtn("inactive")):nu>cu?($j("#goalBack").width(maxWidth+"px").addClass("blink"),this.setCompleteGoalBtn("inactive"),percent=0):(nu<cu?($j("#goalBack").width(percent+"%"),fixValueToInt(nu/cu*100)>=90?$j("#goalBack").addClass("blink"):$j("#goalBack").removeClass("blink")):$j("#goalBack").width(percent+"%"),this.setCompleteGoalBtn("active")),percent}if($j("#gNum1, #gNum1White").html(""+fixValueToInt(nu)),$j("#gNum2, #gNum2White").html(""+fixValueToInt(cu)),total===goal)return $j("#goalBack, #whiteBoxWrapper").width(this.settings.maxGoalBarWidth+"px"),void $j("#gPre1, #gNum1, #gPre2, #gNum2").css("color","white");if(0===nu)return $j("#goalBack, #whiteBoxWrapper").width("0"),void $j("#gPre1, #gNum1, #gPre2, #gNum2").css("color","black");$j("#gPre1, #gNum1, #gPre2, #gNum2").css("color","black");var percent;return nu<cu?(percent=this.settings.maxGoalBarWidth*atLeastOne(nu)/atLeastOne(cu),$j("#goalBack, #whiteBoxWrapper").width(percent+"px"),$j("#gNum2").css("color","black")):(percent=this.settings.maxGoalBarWidth,$j("#goalBack, #whiteBoxWrapper").width(this.settings.maxGoalBarWidth+"px"),$j("#gNum2").css("color","white")),percent},this.toogleGoalBar=function(visible){visible?($j("#goalMeterBox").show(),this.setCompleteGoalBtn("active")):($j("#goalMeterBox").hide(),this.setCompleteGoalBtn("hidden"))},this.setBlackBarMessage=function(message){$j("#info3").html(message)},this.toogleBlackBar=function(visible){visible?($j("#info1").css("margin-top","0"),$j("#info3").show()):($j("#info1").css("margin-top","10px"),$j("#info3").hide())},this.addStickyMessage=function(message,callback){var item=document.createElement("div");item.setAttribute("class","dmsg"),item.innerHTML=message+"",!0===Cam4User.isBroadcaster()&&(UserAgent.phone?document.getElementById("newShowNotificationsWrapper")&&this.get("newShowNotificationsWrapper").insertBefore(item,this.get("newShowNotificationsWrapper").firstChild):this.get("bottomStatusBar").appendChild(item),$j(item).fadeOut(6e3,function(){if(document.contains&&document.contains(item)&&document.getElementById("bottomStatusBar"))try{document.getElementById("bottomStatusBar").removeChild(item)}catch(ex){console.log(ex)}callback&&callback()}))},this.inputsData={tipGoal:-1,timeLimit:-1,statusMessage:"",tipAmmount:-1};this.alignInputScreen=function(element,event){var inputScreen=$j(element),inputScreenText=inputScreen.val(),inputScreenTextLength=inputScreenText.length,fontDeltas={min:27,med:52,max:64};inputScreenText===inputScreenText.toLowerCase()&&(fontDeltas.min=33,fontDeltas.med=81,fontDeltas.max=90),inputScreenTextLength<fontDeltas.min&&inputScreen.css({"font-size":"20px","line-height":"50px"}),inputScreenTextLength>=fontDeltas.min&&inputScreenTextLength<=fontDeltas.med&&inputScreen.css({"font-size":"20px","line-height":"normal"}),inputScreenTextLength>fontDeltas.med&&inputScreenTextLength<=fontDeltas.max&&inputScreen.css({"font-size":"16px","line-height":"25px"}),inputScreenTextLength>fontDeltas.max&&inputScreen.css({"font-size":"16px","line-height":"normal"})},this.inputRestrictToNumbers=function(element,event){var charCode=event.which?event.which:event.keyCode;return 13===charCode?(Cam4User.isBroadcaster()||Cam4User.isLoggedIn||Cam4User.isLoggedInAsGuest?(this.buttonClicked({id:"sendTipButtonViewer"}),this.inputFocusedIn(element,event)):TipFactory.redirectGuest(),!1):!(46!==charCode&&charCode>31&&(charCode<48||charCode>57)&&(charCode<96||charCode>105))&&!(0===$.trim(event.target.value).length&&48===charCode)},this.inputFocusedIn=function(item){"i_screen"!=item.id&&(item.value="")},this.inputFocusedOut=function(item){var selectedValue=item.value;switch(item.id){case"i_tipGoal":numOK(selectedValue)&&(this.inputsData.tipGoal=parseInt(selectedValue),this.onGoalUpdate(this.inputsData));break;case"i_MobileAmmo":case"i_tipAmmo":+selectedValue&&(this.inputsData.tipAmmount=parseInt(selectedValue),this.onAmmoUpdate(this.inputsData));break;case"i_timeLimit":numOK(selectedValue)&&(this.inputsData.timeLimit=parseInt(selectedValue),this.onTimeLimitUpdate(this.inputsData));break;case"i_screen":strOK(selectedValue)&&(this.inputsData.statusMessage=selectedValue,this.onBroadcasterStatusUpdate(this.inputsData))}this.refreshInputs()},this.refreshInputs=function(){this.get("i_tipGoal").value=this.inputsData.tipGoal>0?this.inputsData.tipGoal:0,this.get("i_tipAmmo").value=this.inputsData.tipAmmount>0?this.inputsData.tipAmmount:0,this.get("i_timeLimit").value=this.inputsData.timeLimit>0?this.inputsData.timeLimit:0,this.get("i_screen").value=this.inputsData.statusMessage,this.inputDataChanged(this.inputsData)},this.buttonClicked=function(item){var ammoInputVal="",tipAmountBox=navigator.userAgent.match(/iPhone|iPad|android/i)?$j("#i_MobileAmmo"):$j("#i_tipAmmo"),newValue=Number(tipAmountBox.val());return this.storeNewTipValue(newValue),"mobileSendTipBtn"===item.id&&numOK(this.get("i_MobileAmmo").value)&&(ammoInputVal=this.get("i_MobileAmmo").value,this.onSendTipClicked(parseInt(this.get("i_MobileAmmo").value))),"sendTipButtonViewer"===item.id&&numOK(this.get("i_tipAmmo").value)&&(ammoInputVal=this.get("i_tipAmmo").value,this.onSendTipClicked(parseInt(this.get("i_tipAmmo").value))),0==TipBalance.updateBalanceFields()&&""===ammoInputVal&&TipFactory.popTokens(),"buyTokensButtonViewer"===item.id&&window.open("/checkout/tokens","","width=700,height=700,scrollbars=1,toolbars=0,status=0,resizable=1,left="+(screen.width/2-350)),!1},this.storeNewTipValue=function(newValue){var tipAmountBox=navigator.userAgent.match(/iPhone|iPad|android/i)?$j("#i_MobileAmmo"):$j("#i_tipAmmo");"string"==typeof newValue||isNaN(newValue)||(Cam4Storage.set("previousTipAmount",newValue),setTimeout(function(){tipAmountBox.val(newValue)},1500))},$(document).ready(function(){var previousTipAmount=localStorage.getItem("previousTipAmount"),tipAmountBox=navigator.userAgent.match(/iPhone|iPad|android/i)?$j("#i_MobileAmmo"):$j("#i_tipAmmo");null!==previousTipAmount&&setTimeout(function(){tipAmountBox.val(previousTipAmount)},1500)}),this.onGoalUpdate=function(obj){debug(),debug()},this.onAmmoUpdate=function(obj){debug(),debug()},this.onTimeLimitUpdate=function(obj){debug(),debug()},this.onBroadcasterStatusUpdate=function(obj){debug(),debug()},this.onSendTipClicked=function(obj){debug(),debug()},this.updateData=function(args){this.outPutsData=this.merge(args,this.outPutsData),$j("#balanceVal").text(this.outPutsData.tokenBalance),this.updateGoalBarData(this.outPutsData.viewerTotal,this.outPutsData.viewerGoal),this.updateRightContentData(this.outPutsData.riA,this.outPutsData.riB,this.outPutsData.riC),this.setViewerStatusMessage(this.outPutsData.viewerStatus)},this.outPutsData={tokenBalance:0,viewerStatus:" ",viewerGoal:0,viewerTotal:0,lastUpdated:20,riA:0,riB:0,riC:0},this.inputDataChanged=function(object){debug(),debug()},this.loadLang=function(){try{this.lang=nstiplang}catch(ex){console.log(ex)}return $j("#infoPre1").text(this.lang.tipLeader),$j("#infoPre2").text(this.lang.yourTips),$j("#gPre1, #gPre1White, #gwPre1").text(this.lang.total),$j("#gPre2, #gPre2White, #gwPre2").text(this.lang.goal),$j("#i_tipAmmo").val(this.lang.enterTipAmmount),$j("#sendTipButtonViewer").text(this.lang.sendTip),$j("#balanceTxt").text(this.lang.balance),"BLACK_FRIDAY"==Campaigns.activeCampaignName?Cam4User.accessLevel<AccessLevel.GOLD?$j("#buyTokensButtonViewer, #buyTokensLinkMobile").text(this.lang.buyTokensBlackFridayNonGold):$j("#buyTokensButtonViewer, #buyTokensLinkMobile").text(this.lang.buyTokensBlackFridayGold):"GOLD_VALENTINES_DAY"==Campaigns.activeCampaignName?$j("#buyTokensButtonViewer, #buyTokensLinkMobile").text(this.lang.buyTokensValentinesDay):$j("#buyTokensButtonViewer, #buyTokensLinkMobile").text(this.lang.buyTokens),$j("#lastUpdateVal").text(" "),$j("#brUpInputDesc").text(this.lang.tokens),$j("#brDownInputDesc").text(this.lang.minutes),$j("#brUpRedLabel").text(this.lang.enterGoal),$j("#brDownRedLabel").text(this.lang.setTimeLimit),this.fixLang(),!0},this.disableSendTipInput=function(){$j("#i_tipAmmo, #i_MobileAmmo, #mobileSendTipBtn").css("opacity","0.5"),$j("#i_tipAmmo, #i_MobileAmmo, #mobileSendTipBtn, #sendTipButtonViewer").attr("disabled","true"),$j("#sendTipButtonViewer").addClass("sendTipButtonBlocked"),$j("#NSBar .sendatip").attr("disabled","disabled")},this.enableSendTipInput=function(){$j("#i_tipAmmo, #sendTipButtonViewer, #mobileSendTipBtn, #i_MobileAmmo, #NSBar .sendatip").removeAttr("disabled"),$j("#mobileSendTipBtn, #i_MobileAmmo, #i_tipAmmo").css("opacity","1"),$j("#sendTipButtonViewer").removeClass("sendTipButtonBlocked"),$j("#i_tipAmmo").blur().val(this.lang.enterTipAmmount),$j("#i_MobileAmmo").val("")},this.freeze=function(message){return Cam4User.isLoggedIn||Cam4User.isLoggedInAsGuest||Cam4User.useGuestBilling?($j("#tipErrorMessage").remove(),$j("#leftContentBroadcast, #sendTipBox, #middleScreen, #rightContent").hide(),$j("#newTipAreaBox").append('<div id="tipErrorMessage">'+message+"</div>")):$j("#newTipAreaMain #rightContent").hide(),!0},this.unFreeze=function(){return $j("#tipErrorMessage").remove(),$j("#sendTipBox, #middleScreen, #rightContent").show(),Cam4User.isBroadcaster()&&$j("#leftContentBroadcast").show(),!1},this.fixLang=function(){ncTip.lang=nstiplang;var label=$j("#brUpRedLabel"),downLabel=$j("#brDownRedLabel");if(label.length){var labelLength=label.html().length;labelLength>12&&label.css("font-size","8px"),labelLength>13&&label.css("font-size","9px"),labelLength>23&&"ro"===Cam4User.lang&&label.css({"font-size":"9px","word-break":"break-all","white-space":"normal"})}var button=$j("#sendTipButtonViewer");button.length&&button.html().length>11&&button.css("font-size","9px");var labelStyles={tr:{"font-size":"8px","white-space":"normal",width:"90px",left:"0"},sv:{"font-size":"8px","white-space":"normal"},es:{"font-size":"9px","white-space":"normal"},ru:{"font-size":"7px","white-space":"normal"},da:{"font-size":"8px","white-space":"normal"},fr:{"font-size":"9px","white-space":"normal"},ro:{"font-size":"8px","white-space":"normal"}},selectedLang=Cam4User.lang;switch(selectedLang){case"tr":case"es":case"fr":case"ro":case"ru":Cam4User.isBroadcaster()&&(label.css(labelStyles[selectedLang]),downLabel.css(labelStyles[selectedLang]));break;case"sv":case"da":Cam4User.isBroadcaster()&&downLabel.css(labelStyles[selectedLang]);break;case"it":$j("#i_tipAmmo").css("font-size","11px");break;case"pt":Cam4User.isBroadcaster()?(downLabel.css({"font-size":"7px","white-space":"normal"}),label.css("white-space","normal")):label.css("font-size","7px");break;case"de":Cam4User.isViewer()&&($j("#info1").css("line-height","9px"),$j("#rightContent").css("margin-top","2px"));break;default:label.css("font-size","9px"),downLabel.css("font-size","9px")}},this.init=function(){try{this.loadLang(),Cam4User.isBroadcaster()?this.setBroadcasterOnline():Cam4User.isLoggedIn||Cam4User.isLoggedInAsGuest||Cam4User.useGuestBilling||this.setViewerOffline(),debug()}catch(ex){debug(),debug()}},this.close=function(){},this.getStatus=function(){};try{Cam4Event.hasEventListener(TipEvent.PERFORMER_GOAL_REACHED,"performerGoalReachedListener")||Cam4Event.addEventListener(TipEvent.PERFORMER_GOAL_REACHED,function(){"MBA"==Cam4User.broadcastSource&&window.JsHandler?window.JsHandler.jsFnCallAudio("complete_goal.mp3"):SoundPlayer.playTippingSound("","completeGoal")},"performerGoalReachedListener")}catch(ex){console.log(ex)}}var ncTip=new TipRoot;ncTip.init();
if(Cam4User.isLoggedIn||Cam4User.isLoggedInAsGuest){var TipBalance=new function(){var self=this;try{Cam4Cookies.setCookie(TipFactory.balanceCookieName,"unsetByServer")}catch(ex){}var communicator=TipCommunicator;communicator.setData(Cam4User.performerName,Cam4User.userName,Cam4User.kN,Cam4User.iB,Cam4User.lang||lang);var allow=!0;try{flashObj&&ServiceTipViewer.hasBalance()&&(allow=!1)}catch(ex){ServiceTipViewer.hasBalance()&&(allow=!1)}allow&&!ControlledFeatures.USE_EWALLET&&$j(document).ready(function(){communicator.getBalance("TipBalance.balanceGot",TipBalance.balanceGot)}),this.getBalance=function(){communicator.getBalance("TipBalance.balanceGot",TipBalance.balanceGot)},this.balanceOnPageLoad=null;var balanceVal=0;this.balanceGot=function(response){try{Cam4Cookies.setCookie(TipFactory.balanceCookieName,escape(JSON.stringify(response))),Cam4Event.dispatch(TipEvent.ON_BALANCE_GOT,response)}catch(ex){}if(response&&response.userbalance){if(balanceVal=response.userbalance,null===self.balanceOnPageLoad||parseInt(response.userbalance)>parseInt(self.balanceOnPageLoad)){try{null!==self.balanceOnPageLoad&&Campaigns&&"BONUS_TOKENS"==Campaigns.activeCampaignName&&Campaigns.details&&"true"==Campaigns.details.firstPurchaseOnly&&EpayPlugin.disableActiveCampaign()}catch(ex){console.log(ex)}self.balanceOnPageLoad=parseInt(response.userbalance)}if(response.userbalance>0)try{TipFactory.viewerTokensMode(!0)}catch(ex){console.log(ex)}self.updateBalanceFields(response.userbalance)}},this.setValue=function(num){balanceVal=num};this.updateBalanceFields=function(balanceAmount){if(!balanceAmount)return balanceVal;if(balanceAmount<this.balanceOnPageLoad)try{AutoReload.evaluateBalance(balanceAmount)}catch(ex){console.log(ex)}document.getElementById("miniInbox")&&""===Cam4User.userFirebaseShard&&$j("#miniInbox").text(Cam4User.iB).parent("span").addClass("inboxCount"+Cam4User.iB),document.getElementById("miniBalance")&&(document.getElementById("miniBalance").innerHTML=balanceAmount+""),document.getElementById("tokenBalanceValue")&&(document.getElementById("tokenBalanceValue").innerHTML=balanceAmount+""),document.getElementById("tipBalanceModal")&&(document.getElementById("tipBalanceModal").innerHTML=balanceAmount+""),document.getElementById("numTokens")&&(document.getElementById("numTokens").innerHTML=balanceAmount+""),document.getElementById("tj1")&&(document.getElementById("tj1").innerHTML=balanceAmount+""),document.getElementById("tipJarBalance")&&(document.getElementById("tipJarBalance").innerHTML=balanceAmount+""),document.getElementById("balanceVal")&&(document.getElementById("balanceVal").innerHTML=balanceAmount+""),document.getElementById("v1")&&(document.getElementById("v1").innerHTML=balanceAmount+""),document.getElementById("tipBalanceGifting")&&(document.getElementById("tipBalanceGifting").innerHTML=balanceAmount+""),document.getElementById("mobileBalanceView")&&(document.getElementById("mobileBalanceView").innerHTML=balanceAmount+""),!Cam4User.isBroadcaster()&&document.querySelector("#tippingButtonsMd span")&&WaitFor.dependencies(["nstiplang"],function(){document.querySelector("#tippingButtonsMd span").innerHTML=nstiplang.balance+balanceAmount});try{tipjar.update(balanceAmount)}catch(ex){}return this.setValue(balanceAmount),balanceAmount},this.refresh=function(){return this.updateBalanceFields(balanceVal)}};$j(document).ready(function(){TipBalance.refresh()})}
if("true"==Cam4User.showTipping)var TipJar=function(){var communicator=TipCommunicator;communicator.setData(Cam4User.performerName,Cam4User.userName,Cam4User.kN,Cam4User.iB,Cam4User.lang||lang);var currentBalance=0;this.sendTip=function(){if((Cam4User.isLoggedIn||Cam4User.isLoggedInAsGuest)&&currentBalance>0){if(+document.getElementById("tipJarInput").value)if(+document.getElementById("tipJarInput").value<=currentBalance){var message="";document.getElementById("tipJarTextarea")&&(message=document.getElementById("tipJarTextarea").value).trim()===js_i18n.defaultTipJarText.trim()&&(message=""),communicator.sendOfflineTip(parseInt(document.getElementById("tipJarInput").value),message,tipjar.tipSent)}else TipFactory.popTokens()}else(Cam4User.isLoggedIn||Cam4User.isLoggedInAsGuest)&&currentBalance<=0||Cam4User.useGuestBilling?TipFactory.popTokens():""!=Cam4User.contextualGender?Utils.decideOffer("",{unlockFeature:"tokens",ct:"ppt"}):TipFactory.popTokens()},this.freeze=function(message){document.getElementById("tipjarError").style.display="block",document.getElementById("tipjarAction").style.display="none",message&&(document.getElementById("tipJarMessage").innerHTML=message);var textareaMsg="";Cam4User.isBroadcaster()?(textareaMsg=nstiplang.includeMessage,document.getElementById("tipJarInput").value=nstiplang.enterTipAmount):document.getElementById("tipJarInput").value="",document.getElementById("tipJarTextarea")&&(document.getElementById("tipJarTextarea").value=textareaMsg)},this.revert=function(){document.getElementById("tipjarError").style.display="none",document.getElementById("tipjarAction").style.display="block"},this.update=function(balanceValue){balanceValue&&(currentBalance=balanceValue,0==balanceValue&&(Cam4User.isLoggedIn||Cam4User.isLoggedInAsGuest)?(document.getElementById("tipJarInput").style.display="none",document.getElementById("tipJarInputContainer").style.display="none",document.getElementById("tipjarHref").innerHTML=nstiplang.buyTokens):(document.getElementById("tipJarInput").style.display="block",document.getElementById("tipJarInputContainer").style.display="block",document.getElementById("tipjarHref").innerHTML=nstiplang.sendTip))};var _self=this;this.tipSent=function(response){console.log(response),"INSUFFICIENT_FUNDS"===response.errorCode||-2==response.status?(TipFactory.popTokens(),_self.freeze(nstiplang.errors.tokensNeeded)):"SOURCE_ACCOUNT_UNAVAILABLE"===response.errorCode?_self.freeze(nstiplang.errors.tokensNeeded):response.transactionId&&(Cam4User.isBroadcaster()||(document.getElementById("tippingSuccessDiv").className="alert alert-success"),_self.freeze(nstiplang.thanksForTip));try{TipBalance&&response.balance&&(response.userbalance=response.balance),TipBalance&&response.userbalance&&TipBalance.balanceGot(response)}catch(ex){}_self.update(response.userbalance)},this.inputFocused=function(object,event){switch(object.id||event.target.id){case"tipJarTextarea":(str=document.getElementById("tipJarTextarea").value).trim()===nstiplang.includeMessage.trim()&&(document.getElementById("tipJarTextarea").value="");break;case"tipJarInput":var str=document.getElementById("tipJarInput").value;str.trim()===nstiplang.enterTipAmount.trim()&&(document.getElementById("tipJarInput").value="")}},this.inputRestrictToNumbers=function(object,event,type){var eventType=event.type||type,charCode=event.which?event.which:event.keyCode;return 8===charCode||13===charCode||99===charCode||118===charCode||46===charCode||37===charCode||39===charCode||!(charCode>31&&(charCode<48||charCode>57))&&("keyup"===eventType&&(object.value=object.value.replace(/\D/g,"")),!0)},this.inputBlured=function(object,event){switch(object.id||event.target.id){case"tipJarTextarea":""===document.getElementById("tipJarTextarea").value&&(document.getElementById("tipJarTextarea").value=nstiplang.includeMessage);break;case"tipJarInput":""===document.getElementById("tipJarInput").value&&(document.getElementById("tipJarInput").value=nstiplang.enterTipAmount)}}},tipjar=new TipJar;
var JsSender=JsSender||{};JsSender.isReady=!!JsSender.isReady&&JsSender.isReady,JsSender.setExternalEncoderStreamKey=function(streamKey){try{flashObj.setExternalEncoderStreamKey(streamKey)}catch(ex){console.log(ex)}},JsSender.tabFocus=function(){JsSender.isReady&&flashObj.tabFocus&&flashObj.tabFocus()},JsSender.setBroadcastId=function(broadcastId){try{flashObj.setBroadcastId(broadcastId)}catch(ex){console.log("Exception on setBroadcastId: ",ex),ConnectionLogger.logEvent("CAUGHT_ERROR","setBroadcastId error call: "+ex)}},JsSender.closeNc=function(){if(JsSender.isReady)try{flashObj.closenc(),JsReceiver.pushStreamTimeTracking()}catch(ex){console.log("Exception on closing stream : ",ex)}},JsSender.setAbrResolution=function(resolution){if(JsSender.isReady)try{flashObj.setAbrResolution(resolution)}catch(ex){console.log(ex)}},JsSender.setBroadcastResolution=function(resolution){if(JsSender.isReady)try{flashObj.setBroadcastResolution(resolution)}catch(ex){console.log(ex)}},JsSender.setTranslationSettings=function(jsonString){try{console.log("JSSender.setTranslationSettings (",jsonString,")"),flashObj.setTranslationSettings(jsonString+"")}catch(ex){console.log(ex)}},JsSender.jsIsReady=function(sessionUuid){try{flashObj.jsIsReady(sessionUuid)}catch(ex){console.log(ex)}},JsSender.reconnectStream=function(token){if(JsSender.isReady)try{flashObj.reconnectStream&&flashObj.reconnectStream(token)}catch(ex){console.log(ex)}},JsSender.disconnectStream=function(){if(JsSender.isReady)try{flashObj.disconnectStream()}catch(ex){console.log(ex)}},JsSender.setPlayToken=function(token){if(JsSender.isReady)try{flashObj.setPlayToken(token)}catch(ex){console.log(ex)}},JsSender.publishStream=function(data){try{flashObj.publishedExternalEncoderStream(JSON.stringify(data))}catch(ex){console.log(ex)}},JsSender.playStream=function(videoPlayUrl){try{flashObj.playStream&&flashObj.playStream('{"videoAppUrl": "", "videoPlayUrl": "'+videoPlayUrl+'"}')}catch(ex){console.log(ex)}},JsSender.unPublishStream=function(data){try{flashObj.unPublishedExternalEncoderStream(JSON.stringify(data))}catch(ex){console.log(ex)}},JsSender.successNetVerify=function(elem){try{elem&&elem.setAttribute("disabled","disabled"),flashObj?flashObj.successNetVerify():window.location.reload()}catch(ex){console.log(ex)}},JsSender.setNewRtmp=function(flashId,data){var flashObj;if(flashObj="Explorer"==BrowserDetect.browser?window[flashId]:document[flashId])try{flashObj.setNewRtmp(data)}catch(ex){console.log(ex)}},JsSender.getDebugFps=function(seconds){try{return flashObj.getDebugFps({seconds:seconds})}catch(ex){return console.log(ex),{error:"unable to call method"}}},JsSender.getDebugDroppedFrames=function(seconds){try{return flashObj.getDebugDroppedFrames({seconds:seconds})}catch(ex){return console.log(ex),{error:"unable to call method"}}},JsSender.getDebugBitrate=function(seconds){try{return flashObj.getDebugBitrate({seconds:seconds})}catch(ex){return console.log(ex),{error:"unable to call method"}}},JsSender.getDebugVideoBitrate=function(){try{return flashObj.getDebugVideoBitrate()}catch(ex){return console.log(ex),{error:"unable to call method"}}},JsSender.getDebugAudioBitrate=function(){try{return flashObj.getDebugAudioBitrate()}catch(ex){return console.log(ex),{error:"unable to call method"}}},JsSender.getDebugResolution=function(){try{return flashObj.getDebugResolution()}catch(ex){return console.log(ex),{error:"unable to call method"}}},JsSender.getDebugStreamState=function(){try{return flashObj.getDebugStreamState()}catch(ex){return console.log(ex),{error:"unable to call method"}}},JsSender.pressStartBroadcast=function(){try{return flashObj.pressStartBroadcast()}catch(ex){return console.log(ex),{error:"unable to call method"}}},JsSender.canReconnect=function(){return flashObj&&void 0!=flashObj.reconnectStream},JsSender.startBWChecker=function(originUrl){try{var bwCheker=document.getElementById("idBWChecker");return bwCheker.start?originUrl?(bwCheker.start(originUrl),!0):(console.log("No origin for bandwidth check"),!1):(console.log("Flash is not enabled. Bandwidth checker is not available."),!1)}catch(ex){return console.log(ex),!1}},JsSender.sendBroadcastFeedback=function(broadcastId,feedback){var params={broadcastId:broadcastId,userId:Cam4User.userId,username:Cam4User.userName,feedback:feedback};$j.ajax({contentType:"application/json",type:"POST",cache:!1,url:feedbackUrl,data:JSON.stringify(params),headers:{accessHash:Cam4User.kN,username:Cam4User.userName,"X-Requested-With":"XMLHttpRequest"},success:function(result){console.log(result)},error:function(cause){console.log("Could not send feedback: ",cause)}})},Cam4Event.addEventListener(Cam4Event.WINDOW_ON_BEFORE_UNLOAD,function(){JsSender.closeNc()});
function showInitSignupOverlay(rightWidth,zoneName,adUserName,listingType,isDirectory,loggedIn,adsKey,showBroadcast,isProfilePage){var pageCount=amt(),cookieLoggedIn=Cam4Cookies.getCookie("userWasLoggedIn");pageCount>=5&&pageCount<7?(""===adUserName&&(adUserName=null),null===cookieLoggedIn?$j(document).ready(displayAds(rightWidth,zoneName,adUserName,listingType,isDirectory,loggedIn,adsKey,showBroadcast,isProfilePage)):(setTimeout(reloadIframes,refreshTimeout),$j(document).ready(displayAds(rightWidth,zoneName,adUserName,listingType,isDirectory,loggedIn,adsKey,showBroadcast,isProfilePage)))):(setTimeout(reloadIframes,refreshTimeout),$j(document).ready(displayAds(rightWidth,zoneName,adUserName,listingType,isDirectory,loggedIn,adsKey,showBroadcast,isProfilePage)))}function loadVideoBannerAds(){if(!ControlledFeatures.LOAD_SHAFT_VIDEO_ADS)return!1;if(Cam4User.useVrPlayer&&Utils.isViewerInVR())return!1;var videoBannerMidrollAdWrapper=jQuery("#videoBannerMidrollAdWrapper");$(videoBannerMidrollAdWrapper).on("click touchend",function(){videoBannerMidrollAdWrapper.remove()});var addMutationListenerForHls=function(){var element=jQuery("#Cam4HLSPlayer")[0],observer=new MutationObserver(function(e){e[0]&&e[0].target&&"none"===e[0].target.style.display&&(videoBannerMidrollAdWrapper.remove(),observer.disconnect())});observer.observe(element,{attributes:!0,attributeFilter:["style"]})},startVideoBannerTimeout=function(){setTimeout(function(){jQuery("#firebasePrivateShow").is(":visible")||jQuery("#firebaseReturningIn").is(":visible")||jQuery("#firebaseGroupShow").is(":visible")?startVideoBannerTimeout():(videoBannerMidrollAdWrapper.appendTo(".chatlessPlayer"),videoBannerMidrollAdWrapper.show(),Cam4User.cameraData.useHlsVideoOnMobile&&addMutationListenerForHls())},21e4)};startVideoBannerTimeout()}function displayAds(rightWidth,zoneName,adUserName,listingType,isDirectory,loggedIn,adsKey,showBroadcast,isProfilePage){var listType=listingType,localKey=window.adsKey;~window.location.pathname.indexOf("/male")?~window.location.pathname.indexOf("straight")?(listType="female",window.adsKey="straight"):(listType="male",window.adsKey="gay"):(listType="female",window.adsKey="straight"),~window.location.pathname.indexOf("transgender")&&(listType="shemale",window.adsKey="shemale");var url="/ads/directory/display.jsp?zoneName="+zoneName+"&adUserName="+(adUserName||"")+"&listingType="+listType+"&showBroadcast="+showBroadcast+"&isDirectory="+isDirectory+"&loggedIn="+loggedIn+"&isProfilePage="+isProfilePage;if(!Cam4User.isPayingMember()){var adsLoadedInContainer=document.getElementById("loading_ads")&&document.getElementById("loading_ads").childElementCount;localKey===window.adsKey&&adsLoadedInContainer||$j.get(url,null,function(data){updateAds(data,rightWidth,adsKey),isProfilePage&&ControlledFeatures.LOAD_SHAFT_VIDEO_ADS&&"true"===showBroadcast&&loadVideoBannerAds()},"html")}}function callCamRedAd(){if(ControlledFeatures.USE_CAM4RED){var cam4RedDomElement=document.querySelector("#homeRandomAd-1");"shemale"!==window.adsKey?(randomHomepageAds.getCam4RedAd("#homeRandomAd-1"),showCam4RedContainer(cam4RedDomElement)):$j("#homeRandomAd-1").hide()}}function isElementInViewport(coords){return coords.bottom>0&&coords.right>0&&coords.left<(window.innerWidth||document.documentElement.clientWidth)&&coords.top<(window.innerHeight||document.documentElement.clientHeight)}function showCam4RedContainer(element){element.style.visibility="visible",element.style.height="initial"}function getCam4RedContainerClientRect(){return document.getElementById("homeRandomAd-1").getBoundingClientRect()}function setCam4RedAdsLoaded(){IS_CAM4_RED_ADS_LOADED=!0,callCamRedAd()}function checkIfRed(){isElementInViewport(getCam4RedContainerClientRect())&&(IS_CAM4_RED_ADS_LOADED=!0,callCamRedAd(),window.removeEventListener("scroll",checkIfRed))}var Cam4Xtra={loadRemoveButton:function(text){var action='style="cursor: pointer" onclick="Registration.showGoldUpgradeOverlay(\'remove-ads\');" class="removeAds nopop"';if(Cam4User.isLoggedIn&&(action='style="cursor: pointer" onclick="Registration.showGoldUpgradeOverlay(\'remove-ads\');" class="removeAds nopop"'),document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Shape","1.1")){var svgText='<a class="nopop"'+action+'> <svg xmlns="http://www.w3.org/2000/svg" class="nopop" version="1.1" width="20" height="'+8.5*text.length+'"> <rect width="20" height="200" rx="2" ry="2" style="fill:rgb(252, 83, 29);"/><text id="removeSvgStruct" x="12" y="-6" style="font-size:12px" fill="white" transform="rotate(90)">'+text+"</text> </svg></a>";document.getElementById("removeAdWrapper").innerHTML=svgText}else!1!==Utils.getSupportedTransform()?document.getElementById("removeAdWrapper").innerHTML='<a class="removeAdButton" '+action+">"+text+"</a>":document.getElementById("removeAdWrapper").innerHTML='<a class="removeAdImg" '+action+'><img src="'+WEB_CDN+'/images/tab2.png"></a>'},referralAdPrompt:function(){if(!isRefreshing){if(-1!=window.location.toString().indexOf("act=")&&-1!=window.location.toString().indexOf("displayConfirm=true")&&null===Cam4Cookies.getCookie("referralPrompted")){var returnValue;return clickedLink||(Cam4Cookies.setCookie("referralPrompted","true"),setTimeout(function(){var sourceScript="http://one.cam4ads.com/www/delivery/apu.php?n=&zoneid=56&popunder=1";if(void 0!==Utils.injectJavascript)Utils.injectJavascript(sourceScript);else{var NewScript=document.createElement("script");NewScript.src=sourceScript,NewScript.async=!0,document.body.appendChild(NewScript)}},100),returnValue="",clickedLink=!0),returnValue}}},goBackToUserMarketPlace:function(){var viewedUser=window.location.href.split("/")[3];window.location.href="/"+viewedUser+"/marketplace"},exit:function(){BrowserDetect.isMSIE()?(window.event.screenX-window.screenLeft>document.documentElement.scrollWidth-20&&window.event.clientY<0||window.event.altKey)&&(isExit=!0,doPopExit()):isExit&&doPopExit()},checkTaboocamsAdsStatusCode:function(element){var iframeURL=element.getElementsByTagName("iframe")[0].src,parentId=element.parentNode.getAttribute("id");$j.ajax({url:iframeURL,error:function(){var elementID=element.getAttribute("id");"footerFirst"==elementID||"footerSecond"==elementID||"footerThird"==elementID?(element.setAttribute("style","display:none !important"),"none"==document.getElementById("footerFirst").style.display&&"none"==document.getElementById("footerSecond").style.display&&"none"==document.getElementById("footerThird").style.display&&document.getElementById("subfoot").setAttribute("style","display:none !important")):"headerBanner"==elementID?element.style.display="none":"camPaneBig"!=parentId&&"profileCamWrap"!=parentId&&(element.parentNode.style.display="none")}})}},IS_CAM4_RED_ADS_LOADED=!1;$(document).ready(function(){document.getElementById("homeRandomAd-1")&&(!IS_CAM4_RED_ADS_LOADED&&isElementInViewport(getCam4RedContainerClientRect())?setCam4RedAdsLoaded():window.addEventListener("scroll",checkIfRed,!1))});
var Overlays={opened:[],reloadAvatar:function(){if(document.getElementById("avatarFrame")){var f=document.getElementById("avatarFrame");return f.src=f.src,!0}return!1},addMessageOption:function(selectbox,text,value,selected){var optn=document.createElement("OPTION");optn.text=text,optn.value=value,selected&&(optn.selected=!0),selectbox.options.add(optn)},openRegisterModal:function(index,elementId){switch(index){case 1:Utils.decideOffer("",{pageType:"gold",unlockFeature:"multicam",ct:"womc"});break;case 2:Utils.decideOffer("",{pageType:"gold",unlockFeature:"private_message",bypassToSignup:!0});break;case 3:Utils.decideOffer("",{pageType:"gold",unlockFeature:"fullscreen",bypassToSignup:!0});break;case 4:Utils.decideOffer("",{pageType:"gold",unlockFeature:"enhanced_chat",ct:"woec"});break;default:Utils.decideOffer()}},open:function(index,elementId){if(Cam4User.isBroadcaster()||$j(".overlayWrap ").css("top","180px"),Cam4User.isLoggedIn||Cam4User.isLoggedInAsGuest){if(PlayerTranslate.barIsVisible?$j(".overlayWrap").css("top","277px"):$j(".overlayWrap").css("top","220px"),useBroadcasterFirebaseChat){var newPosition=parseInt($j("#broadcastingApp").outerHeight(),10)-parseInt($j(".overlayWrap").innerHeight(),10);$j(".overlayWrap").css("top",newPosition+"px")}}else if(!Cam4User.useGuestBilling&&5==index)return this.openRegisterModal(index,elementId),!1;if(!0===Overlays.opened[index])return Overlays.opened[index]=!1,void Overlays.closeAll();Overlays.closeAll(),document.getElementById("overlayWrap"+index)&&0!==index&&(document.getElementById("overlayWrap"+index).style.display="block"),elementId?document.getElementById(elementId)&&($j("#"+elementId).hasClass("ovIcon")?($j("#"+elementId).removeClass("ovIcon"),$j("#"+elementId).addClass("ovIconHover")):($j("#"+elementId).removeClass("ovIconHover"),$j("#"+elementId).addClass("ovIcon"))):document.getElementById("li"+index)&&($j("#li"+index).hasClass("ovIcon")?($j("#li"+index).removeClass("ovIcon"),$j("#li"+index).addClass("ovIconHover")):($j("#li"+index).removeClass("ovIconHover"),$j("#li"+index).addClass("ovIcon"))),Overlays.opened[index]=!0},closeAll:function(index){for(var a=1;document.getElementById("overlayWrap"+a);)document.getElementById("overlayWrap"+a).style.display="none",document.getElementById("li"+a)&&($j("#li"+a).removeClass("ovIconHover"),$j("#li"+a).addClass("ovIcon")),a++;for(var i in Overlays.opened)Overlays.opened[i]=!1},openPrivateMessage:function(index,elementName){if(idVerificationEnabled||!Cam4User.isViewer()||"pending"!==Cam4User.broadcasterStatusCached){if(Cam4User.isViewer()&&Cam4User.isLoggedIn&&!Cam4User.isPayingMember()&&!Cam4User.isSubscribedToFanClub()){if(2==index)return void Registration.showGoldUpgradeOverlay("private-message");if(4==index)return void Registration.showGoldUpgradeOverlay("enhanced-chat")}else Overlays.reloadAvatar(),Overlays.open(index);if(Cam4User.isPayingMember()||2==index&&Cam4User.userFeatures.C4BND_PRIVATE_MESSAGE||4==index&&Cam4User.userFeatures.C4BND_ENHANCED_CHAT||Cam4User.isSubscribedToFanClub()&&Cam4User.performerHasFanclub()||1==Cam4User.isBroadcastingWindow){document.getElementById(elementName).innerHTML="";var roomUsers=ChatUIController.getOnlineUsers(),selBox=document.getElementById(elementName);if(null==roomUsers||0==roomUsers.length)Overlays.addMessageOption(selBox,"loading","loading",!0);else for(var i=0;i<roomUsers.length;i++)if(!("mobile"===Cam4Performer.statusModel.source&&Chat.getMbaVersion()<100&&roomUsers[i]==room)){var selected=!1;roomUsers[i]==room&&(selected=!0),Overlays.addMessageOption(selBox,roomUsers[i],roomUsers[i],selected)}Cam4User.isViewer()&&!Cam4User.isBroadcastingWindow&&$("#userBlist, #roomList").selectpicker("refresh")}else console.log("user not gold")}else Modals.openUnderAgeModal()},goFullScreen:function(){Cam4User.isPayingMember()||Cam4User.userFeatures.C4BND_FULL_SCREEN||1==Cam4User.isBroadcastingWindow?(Overlays.closeAll(),JsReceiver.goFullScreen()):Cam4User.isLoggedIn?Registration.showGoldUpgradeOverlay("theater-mode"):Overlays.open(3)},viewMultiCam:function(){Cam4User.isViewer()&&Cam4User.isLoggedIn&&!Cam4User.isPayingMember()?Registration.showGoldUpgradeOverlay("multicam"):Overlays.open(1)},ignoreUser:function(){if(Cam4User.isPayingMember()||Cam4User.userFeatures.C4BND_ENHANCED_CHAT){var username=document.getElementById("userBlist").options[document.getElementById("userBlist").selectedIndex].text;Chat.ignoreUser(username),Overlays.open(4)}}};Cam4Event.addEventListener(Cam4Event.MODAL_OPENED,function(){Overlays.closeAll()});
/**
 * HTML4 based notifications
 * @module HTML4Notification.js
 */

var HTML4Notification = (function() {
    /**
     * @property {Object} defaultDesktopNotification
     * @type Object
     */
    var defaultDesktopNotification = {
        lifeTime: 5000,
        title: 'Cam4 Chrome notification!',
        text: 'Here is the notification text',
        picture: WEB_CDN + '/images/logo.png',
        onclick: function() {
        },
        onclose: function() {
        }
    };

    var currentNotifications = {};



    var notifySettings = {
        updateId: '',
        parent: {},
        rules: {
            'newshow': {
                target: 'camPaneBig',
                lifeTime: 50000,
                onInit: function(item, list, callback) {
                    item.style.position = 'absolute';
                    item.style.right = '4px';
                    item.style.top = '1400px';
                    item.style.opacity = '0';
                    //http://stackoverflow.com/questions/18578244/displaying-elements-other-than-fullscreen-element-html5-fullscreen-api
                    item.style['z-index'] = 2147483648; // not working anymore, notification needs to be under the fullscreen element, hence adding "target" property
                    callback();
                },
                onUpdate: function(item, index, list, callback) {
                    console.log('on update ' + index);
                    var itemHeight = (item.offsetHeight + 10 || item.clientHeight + 10 || 100);
                    var tween;
                    var bottomTo = Utils.getPageArgs().window.height - (itemHeight * (index + 1.5) + 10);

                    if (item.style.opacity < .5) {
                        tween = new TweenMulti({opacity: 0, top: 0}, {opacity: 1, top: bottomTo}, 20, item);
                        tween.onUpdate = function(object) {
                            item.style.opacity = object.opacity;
                            item.style.top = object.top + 'px';
                        };
                    }
                    else {
                        var topFrom = Math.floor((item.style.top).replace('px', ''));
                        tween = new TweenMulti({top: topFrom}, {top: bottomTo}, 24, item);
                        tween.onUpdate = function(object) {
                            item.style.top = object.top + 'px';
                        };
                    }

                    tween.onComplete = function() {
                        callback();
                    };
                    tween.start();
                },
                onRemove: function(div, callback) {
                    var tween = new TweenMulti({opacity: 1}, {opacity: 0}, 20, div);
                    tween.onUpdate = function(object) {
                        if (div) {
                            div.style.opacity = object.opacity;
                        }
                    }


                    tween.onComplete = function() {
                        try {
                            div && div.parentElement && div.parentElement.removeChild(div);
                        } catch (ex) {

                        }
                        callback();
                    };

                    tween.start();
                }
            },
            'notification': {
                lifeTime: 5000,
                onInit: function(item, list, callback) {
                    var index = list.length - 1;
                    var lastItem = false;
                    if (list[list.length - 2]) {
                        lastItem = list[list.length - 2];
                    }

                    item.style.position = 'fixed';
                    item.style.opacity = '0';
                    item.style['z-index'] = '999999';


                    document.body.appendChild(item);
                    var itemHeight = $j(item).height() + 10;

                    if (!this._lastRight) {
                        this._lastRight = 1;
                    }
                    if (lastItem) {

                        var lastBottom = parseInt($j('#' + lastItem)[0].style.bottom);
                        item.style.bottom = lastBottom + itemHeight + 'px';
                        item.style.right = this._lastRight + 'px';
                    } else {
                        item.style.bottom = '0px';
                        item.style.right = '0px';
                    }



                    function updateNotifications() {
                        var windowHeight = $j(window).height();
                        var mainList = HTML4Notification.getNotificationList();
                        var thisList = mainList['notification'];
                        var occupiedHeight = 0;
                        var offsetY = 0;
                        var offsetX = 0;


                        function animateFix(i) {
                            if (document.getElementById(thisList[i])) {
                                var citem = document.getElementById(thisList[i]);
                                var itemHeight = $j(citem).height() + 10;
                                var itemWidth = $j(citem).width() + 10;
                                var marginBottom = (offsetX * itemHeight);
                                occupiedHeight += itemHeight;

                                var fromX = parseInt(citem.style.bottom) || 0;
                                var fromY = parseInt(citem.style.right) || 0;

                                var tween = new TweenMulti({x: fromX, y: fromY}, {x: marginBottom, y: offsetY}, 20, {});
                                tween.onUpdate = function(props) {
                                    citem.style.bottom = props.x + 'px';
                                    citem.style.right = props.y + 'px';
//                                    console.log(props);
                                };
                                tween.onComplete = function() {
                                    if (occupiedHeight > (windowHeight - itemHeight)) {

                                        occupiedHeight = 0;
                                        offsetY += itemWidth;
                                        HTML4Notification.rules.notification._lastRight = offsetY;
                                        offsetX = 0;
                                    }
                                    else {
                                        offsetX++;
                                    }

                                    animateFix(i + 1);
                                };
                                tween.start();

                            }
                        }

                        animateFix(0);





                    }

                    if (!Cam4Event.hasEventListener(Cam4Event.WINDOW_RESIZED, 'notificationUpdate')) {
                        Cam4Event.addEventListener(Cam4Event.WINDOW_RESIZED, updateNotifications, 'notificationUpdate');
                    }
                    updateNotifications();



                    this.updateNotifications = updateNotifications;
                    var tween = new TweenMulti({opacity: 0}, {opacity: 1}, 20, item);
                    tween.onUpdate = function(object) {
                        if (item) {
                            item.style.opacity = object.opacity;
                        }
                    };
                    tween.onComplete = function() {
                        callback();
                    };

                    tween.start();

                },
                onUpdate: function(item, index, list, callback) {
                },
                onRemove: function(div, callback) {
                    var tween = new TweenMulti({opacity: 1}, {opacity: 0}, 20, div);
                    var self = this;
                    tween.onUpdate = function(object) {
                        if (div) {
                            div.style.opacity = object.opacity;
                        }
                    };
                    tween.onComplete = function() {
                        callback();
                        try {
                            self.updateNotifications();
                        } catch (ex) {

                        }
                    };

                    tween.start();
                }
            }
        }
    };



    function makeId(uid, styleName) {
        return 'autoNotice' + uid + '_' + styleName;
    }


    function getStyleName(itemName) {
        if (typeof itemName === 'undefined') {
            return '';
        }
        var styleName;
        var itemTemp = itemName.split('_');
        styleName = itemTemp[itemTemp.length - 1];
        return styleName;
    }


    function checkNotification(index, list) {

        if (index < list.length) {
            var itemName = list[index];
            var styleName = getStyleName(itemName);
//            console.log('check notification ' + itemName)
            var settings;
            if (HTML4Notification.rules[styleName]) {
                settings = HTML4Notification.rules[styleName];
            } else {
                checkNotification(index + 1, list);
                return;
            }

            if (document.getElementById(itemName)) {
                settings.onUpdate(document.getElementById(itemName), index, list, function() {
                    HTML4Notification.checkNotification(index + 1, list);
                });
            }

            else {
                HTML4Notification.checkNotification(index + 1, list);
            }

        }

    }

    function addNotification(text, uid, styleName) {

        if (!HTML4Notification.rules[styleName]) {
            styleName = 'newshow';
        }


        if (!currentNotifications[styleName]) {
            currentNotifications[styleName] = [];
        }

        var settings = HTML4Notification.rules[styleName];

        var itemIdName = makeId(uid, styleName);
        var targetElement = document.body;
        if (settings['target']) {
            targetElement = document.getElementById(settings['target']) || targetElement;
        }
        let oldElement = document.getElementById(itemIdName);
        if (oldElement && oldElement.parentNode && oldElement.parentNode.removeChild) {
            oldElement.parentNode.removeChild(oldElement);
        } else {
            console.warn('unable to remove old notification', oldElement)
        }

        var currentList = currentNotifications[styleName];
        var indx = currentList.indexOf(uid);

        if (indx > -1) {
            currentList.splice(indx, 1);
        }

        if (notifySettings['tid' + uid]) {
            clearTimeout(notifySettings['tid' + uid]);
        }



        notifySettings['tid' + uid] = setTimeout(function() {
            removeNotification(itemIdName, false);
        }, settings.lifeTime);


        var div = document.createElement('div');
        div.innerHTML = text;
        div.id = itemIdName;
        currentList.push(itemIdName);

        settings.onInit(div, currentList, function() {
            if (!document.getElementById(itemIdName)) {
                targetElement.appendChild(div);
            }
            checkNotification(0, currentList);
        });

        return div;

    }

    function removeNotification(uid, event) {
        console.log('remove ' + uid);
        if (event) {
            try {
                event.preventDefault();
                event.stopPropagation();
            } catch (ex) {

            }
        }


        var styleName = getStyleName(uid);

        if (!HTML4Notification.rules[styleName] || !currentNotifications[styleName]) {
            return;
        }

        var settings = HTML4Notification.rules[styleName];
        var currentList = currentNotifications[styleName];

        if (currentList.indexOf(uid) > -1) {
            currentList.splice(currentList.indexOf(uid), 1);
        }

        if (document.getElementById(uid)) {
            console.log('removing ' + uid);
            settings.onRemove(document.getElementById(uid), function() {
                let elementById = document.getElementById(uid);
                if (elementById && elementById.parentElement && elementById.parentElement.removeChild) {
                    elementById.parentElement.removeChild(elementById);
                }
                checkNotification(0, currentList);
            });


        }
    }

    function removeAll(){
        for(var i in currentNotifications){
            for(var j = 0; j < currentNotifications[i].length; j++) {
                var uid = currentNotifications[i][j];
                let elementById = document.getElementById(uid);
                if (elementById && elementById.parentElement && elementById.parentElement.removeChild) {
                    elementById.parentElement.removeChild(elementById);
                }
            }
        }
        currentNotifications = [];
    }


    return {
        removeNotification: removeNotification,
        addNotification: addNotification,
        checkNotification: checkNotification,
        removeAll: removeAll,
        getSettings: function() {
            return notifySettings;
        },
        getNotificationList: function() {
            return currentNotifications;
        },
        makeId: makeId,
        rules: notifySettings.rules
    };

})();


Utils.addNotification = HTML4Notification.addNotification;
Utils.removeNotification = HTML4Notification.removeNotification;


var _num = 0;
function test_HTML4Notifications() {
    _num++;
    var data = {
        username: 'test' + '-testUser' + 'C$UID',
        time: 20000,
        imageLink: 'http://alex.cam4.com/images/logo.png',
        title: '' + _num
    };
    Cam4Notifications.uid++;
    data.lifeTime = Cam4Notifications.deltas.notificationLifetime;
    var html = '<div class="browser-notification ' + Cam4Notifications.getStyle() + '" onclick="window.open(\'/' + data.title + '\',\'_blank\'); Utils.removeNotification(' + Cam4Notifications.uid + ')">';
    html += '<div class="br-right">';
    html += '<span class="br-title">';
    html += '<span class="br-name">CAM4 - ' + data.title + '</span><span class="br-dismiss" onclick="Utils.removeNotification(' + Cam4Notifications.uid + ', event);" >X</span>';
    html += '</span>';
    html += '<span class="br-text">';
    html += data.text;
    html += '</span>';
    html += '</div>';
    html += '<div class="br-left">';
    html += '<img src="' + data.picture + '"/>';
    html += '</div>';
    html += '</div>';
    return HTML4Notification.addNotification(html, Cam4Notifications.uid, 'notification');
}
var HTML5Notification=function(){var defaultDesktopNotification={lifeTime:5e3,title:"Cam4 Chrome notification!",text:"Here is the notification text",picture:WEB_CDN+"/images/logo.png",onclick:function(){},onclose:function(){}},_currentNotification={},_timeoutId=!1;return{setDesktopNotification:function(unique,settings){function closeNotification(){if(currentNotification){try{currentNotification.cancel()}catch(ex){}try{currentNotification.close()}catch(ex){}}}function makeFirefoxNotification(){(currentNotification=new Notification(settings.title,{body:settings.text,icon:settings.picture})).onclick=settings.onclick,currentNotification.onclose=settings.onclose,unique&&(_currentNotification=currentNotification)}if(settings)for(var i in defaultDesktopNotification)settings[i]||(settings[i]=defaultDesktopNotification[i]);else settings=defaultDesktopNotification;var currentNotification;if(_timeoutId&&clearTimeout(_timeoutId),unique?_timeoutId=setTimeout(closeNotification,settings.lifeTime):setTimeout(closeNotification,settings.lifeTime),window.webkitNotifications&&"Safari"!=BrowserDetect.browser){unique&&closeNotification();var havePermission=window.webkitNotifications.checkPermission();return 0==havePermission?((currentNotification=window.webkitNotifications.createNotification(settings.picture,settings.title,settings.text)).onclick=settings.onclick,currentNotification.onclose=settings.onclose,currentNotification.show(),unique&&(_currentNotification=currentNotification),"success"):1==havePermission?(window.webkitNotifications.requestPermission(),"pending-approval"):(window.webkitNotifications.requestPermission(),"failed")}return"Notification"in window?(unique&&closeNotification(),"granted"===Notification.permission?(makeFirefoxNotification(),"success"):"denied"!==Notification.permission?(Notification.requestPermission(function(permission){"permission"in Notification||(Notification.permission=permission),"granted"===permission&&makeFirefoxNotification()}),"pending-approval"):"failed"):"failed"}}}();Utils.defaultDesktopNotification=HTML5Notification.defaultDesktopNotification,Utils.setDesktopNotification=HTML5Notification.setDesktopNotification;
var Tween=function(start,end,steps,object){function doAnimate(){values[count]?(count++,self.onUpdate&&self.onUpdate(values[count],object),updateEvent.start(doAnimate)):self.onComplete&&(self.onComplete(object),updateEvent.stop())}var self=this,values=Easing(start,end,steps),count=0;this.onUpdate=function(value,object){},this.onComplete=function(object){},this.start=function(){doAnimate()};var updateEvent=new UpdateEvent(100)},TweenMulti=function(startObjectProps,endObjectProps,steps,object){function doAnimate(){var num=-1;count++;for(var i in result)valuesContainer[++num][count]?(result[i]=valuesContainer[num][count],allowUpdate=!0):allowUpdate=!1;allowUpdate?(self.onUpdate&&self.onUpdate(result),updateEvent.start(doAnimate)):self.onComplete&&self.onComplete(result)}var self=this;"Explorer"===BrowserDetect.browser&&(steps=Math.round(steps/2));var valuesContainer=[],result={};for(var i in startObjectProps){var value=Easing(startObjectProps[i],endObjectProps[i],steps);result[i]=startObjectProps[i],valuesContainer.push(value)}var count=0;this.onUpdate=function(object){},this.onComplete=function(object){},this.start=function(){doAnimate()};var updateEvent=new UpdateEvent(100),allowUpdate=!1},ColorUtils={stringToHex:function(integer){var str=parseInt(integer).toString(16);return 1===str.length?"0"+str:str},rgbToHex:function(r,g,b){return"#"+ColorUtils.stringToHex(r)+ColorUtils.stringToHex(g)+ColorUtils.stringToHex(b)},rgbToHexShift:function(r,g,b){return"#"+((1<<24)+(r<<16)+(g<<8)+b).toString(16).slice(1)}},Easing=function(firstNumber,secondNumber,steps){0===firstNumber&&(firstNumber=.001);for(var arai=new Array,unit=(secondNumber-firstNumber)/steps,i=0;i<steps+1;i++)arai.push(firstNumber.toFixed(4)),firstNumber+=unit;return arai},UpdateEvent=function(frameRate){var timeoutId,fps,lastLoop=(new Date).getTime(),type="unknown";this.start=function(callback){if(window.requestAnimationFrame)return timeoutId=window.requestAnimationFrame(callback),thisLoop=(new Date).getTime(),fps=thisLoop-lastLoop,lastLoop=thisLoop,void(type="requestAnimationFrame");if(window.mozRequestAnimationFrame)return timeoutId=window.mozRequestAnimationFrame(callback),thisLoop=(new Date).getTime(),fps=thisLoop-lastLoop,lastLoop=thisLoop,void(type="mozRequestAnimationFrame");if(window.msRequestAnimationFrame){timeoutId=window.msRequestAnimationFrame(callback);var thisLoop=(new Date).getTime();return fps=thisLoop-lastLoop,lastLoop=thisLoop,void(type="msRequestAnimationFrame")}return window.webkitRequestAnimationFrame?(timeoutId=window.webkitRequestAnimationFrame(callback),thisLoop=(new Date).getTime(),fps=thisLoop-lastLoop,lastLoop=thisLoop,void(type="webkitRequestAnimationFrame")):window.oRequestAnimationFrame?(timeoutId=window.oRequestAnimationFrame(callback),thisLoop=(new Date).getTime(),fps=thisLoop-lastLoop,lastLoop=thisLoop,void(type="oRequestAnimationFrame")):(timeoutId=setTimeout(callback,frameRate),thisLoop=(new Date).getTime(),fps=thisLoop-lastLoop,lastLoop=thisLoop,void(type="setTimeout("+frameRate+");"))},this.stop=function(){if(!window.cancelAnimationFrame)return clearTimeout(timeoutId),timeoutId;window.cancelAnimationFrame(timeoutId)},this.getType=function(){return type},this.getFPS=function(){return fps}};
var SafeClick=new function(){var mobilePayIframeAdded=!1;this.changeSFCiframeSize=function(){var iframe=document.getElementById("SFCiframe"),innerDoc=iframe.contentDocument||iframe.contentWindow.document,mobileSendTipContainer=document.getElementById("mobileSendTipContainer");innerDoc.getElementById("containerPackages").style.visibility="hidden",innerDoc.getElementById("chooseAmountSFC").style.visibility="hidden",mobileSendTipContainer.className="mobileSendTipContainerSafeClick",iframe.width=315,iframe.height=400},this.togglePFIiframeSize=function(isOpen){isOpen?$j("#mobileSendTipContainer").addClass("pfiOpened"):$j("#mobileSendTipContainer").removeClass("pfiOpened")},this.changeSFCiframeSizeBack=function(){var iframe=document.getElementById("SFCiframe"),mobileSentTipContainer=document.getElementById("mobileSendTipContainer");iframe.width=280,iframe.height=150,mobileSentTipContainer.className="mobileSendTipSmallBoxContainer"},this.show=function(){if(Cam4User.isLoggedIn||Cam4User.isLoggedInAsGuest){var what="",wurl="",logo="safeklickLogo";Cam4User.showPFI?(what="PFIiframe",wurl="/payment/payforit?showProducts=true&broadcaster=",logo="paiforitLogo"):(Cam4User.showSafeClick,what="SFCiframe",wurl="/payment/safeclick?showProducts=true&broadcaster=",logo="safeklickLogo");var htmlContent='<div  id="mobileSendTip" class="mobile_opt bg_icon" \n                        onmouseout="SafeClick.mouseOut()" onmouseover="SafeClick.mouseOver()" \n                        onclick="SafeClick.click(\''+what+"');\"></div>";htmlContent+='<div id="mobileSendTipHelp" style="display:none" >',htmlContent+=nstiplang.mobileCaption,htmlContent+="</div>",htmlContent+='<div id="mobileSendTipContainer" class="mobileSendTipSmallBoxContainer">',htmlContent+='<div id="iframeContainer">',htmlContent+='<div id="headerPFI">',htmlContent+='<div class="'+logo+'"></div>',htmlContent+='<div class="safeClickTitle">'+nstiplang.mobileTitle+"</div>",htmlContent+="</div>",htmlContent+='<iframe id="'+what+'" src="'+wurl+Cam4User.performerName+'" width="292" height="150" scrolling="no" frameborder="0"></iframe>',htmlContent+="</div>",htmlContent+="</div>",document.getElementById("sendTipButtonContainer")&&!mobilePayIframeAdded&&($j("#mobileSendTip").remove(),document.getElementById("sendTipButtonContainer").innerHTML+=htmlContent,mobilePayIframeAdded=!0),$j("#mobileSendTipHelp").hide()}};var opened=!1;this.click=function(iframeType){try{if(document.getElementById(iframeType)){console.log("sfclick "+iframeType+opened);var iframeURL=document.getElementById(iframeType);"PFIiframe"==iframeType?(this.togglePFIiframeSize(!1),iframeURL.src="/payment/payforit?showProducts=true&broadcaster="+Cam4User.performerName):"SFCiframe"==iframeType&&(this.changeSFCiframeSizeBack(),iframeURL.src="/payment/safeclick?showProducts=true&broadcaster="+Cam4User.performerName),opened?($j("#mobileSendTipContainer").hide(),opened=!1):($j("#mobileSendTipHelp").hide(),$j("#mobileSendTipContainer").show(),opened=!0)}}catch(ex){console.warn("Error on this.click : ",ex)}},this.mouseOut=function(){$j("#mobileSendTipHelp").hide()},this.mouseOver=function(){$j("#mobileSendTipHelp").show()}};
var CheckoutTokens=CheckoutTokens||{productLabels:[],submitInNewWindow:function(form,wWidth,wHeight){function openAndWriteToWindow(){(win=window.open(args.url,args.name,args.specs)).document.write('<div style="visibility:hidden">'+htmlContent+"</div>")}wWidth||(wWidth=650),wHeight||(wHeight=880);var htmlContent=form.outerHTML,args={url:"",name:"formSubmission",specs:"width="+wWidth+",height="+wHeight+",scrollbars=1,toolbars=0,status=0,resizable=1,left="+window.outerWidth/2},win=null;try{openAndWriteToWindow()}catch(ex){console.log("Exception encoutered - ",ex),window.open(args.url,args.name).close(),openAndWriteToWindow()}return win.focus(),win.document.getElementsByTagName("form")?(win.document.getElementsByTagName("form")[0].removeAttribute("onsubmit"),win.document.getElementsByTagName("form")[0].submit()):(console.log("form not found"),setTimeout(submitForm,1e3)),win},submitInIframe:function(form,iName,callback){Utils.closeModalPops();var iframeElem=document.createElement("iframe");iName&&iframeElem.setAttribute("name",iName),iframeElem.setAttribute("class","over-screen"),iframeElem.setAttribute("width","100%"),iframeElem.setAttribute("height","100%"),modalHTML='<div><span class="close floating" onclick="Utils.closeModalPops();" ontap="Utils.closeModalPops();">&times;</span></div>'+iframeElem.outerHTML,Utils.popPreloadedContent(modalHTML,function(){$j("#Cam4DialogContainer .modal-dialog").css("position","relative").css("top","0px").css("left","0px").css("width","100%").css("height","100%"),$j("#Cam4DialogContainer .modal-content").css("height","100%").css("width","inherit").css("overflow-x","hidden");var insertedIframe=$j("iframe[name="+iName+"]");insertedIframe.addClass("loading"),insertedIframe.load(function(){insertedIframe.removeClass("loading")}),insertedIframe.unload(function(){insertedIframe.addClass("loading")}),insertedIframe.contents().find("body").html('<div style="visibility:hidden">'+form.outerHTML+"</div>"),insertedIframe.contents().find("form")[0]?(insertedIframe.contents().find("form")[0].removeAttribute("onsubmit"),insertedIframe.contents().find("form")[0].submit()):(console.log("Form not found in iFrame. Submitting form..."),setTimeout(function(){form.submit()},1e3))})},submitDirect:function(item,equalBilling){this.setFormActionAndSubmitEB(),Utils.closeModalPops()},setFormActionAndSubmitEB:function(){isMedhatUser&&window.resizeTo(popUpCheckoutWidth,880);try{if("tokens"==document.getElementById("productType").innerHTML){for(var s="/checkout/tokens/product",radios=document.getElementsByName("priceId"),tokenAmount="",membershipPurchase=!1,i=0;i<radios.length;i++)if(radios[i].checked){tokenAmount=document.getElementById("productQuantity"+radios[i].value).innerHTML,"MEMBERSHIP"==document.getElementById("productType"+radios[i].value).innerHTML&&(membershipPurchase=!0);break}s=s+"/"+tokenAmount,membershipPurchase&&(document.checkoutPaymentForm.action="/checkout/membership",document.getElementById("freeTokensMembership").value="true")}}catch(e){console.log(e)}document.checkoutPaymentForm.submit()}};CheckoutTokens.productLabels[5]="1000",CheckoutTokens.productLabels[6]="500",CheckoutTokens.productLabels[7]="250",CheckoutTokens.productLabels[4]="100",CheckoutTokens.productLabels[3]="50",CheckoutTokens.productLabels[1]="25";
var AutoReload={allPurposeUrl:"/autoReload",optInYes:"YES",optInNo:"NO",isPopOpen:!1,isOverlayDisplayed:!1,lastCallWaitTime:3e4,lastCallTS:0,popData:null,closePopTip:function(){$j(".popover").remove(),AutoReload.isPopOpen=!1},closeOverlay:function(optInFlag,clickedEl){AutoReload.isOverlayDisplayed&&(AutoReload.isOverlayDisplayed=!1,!0!==optInFlag?AutoReload.optIn(!1):AutoReload.optIn(!0),clickedEl&&(Cam4Event.removeEventListener(Cam4Event.MODAL_CLOSING,"detectLastClosedModal"),Utils.closeModalPops()))},handleResponseData:function(data){if(-1!=data.indexOf("autoReloadOptinBalloon")){if(AutoReload.closePopTip(),$j(data).find("input[name=isAutoReloadBonus]").length>0&&"true"==$j(data).find("input[name=isAutoReloadBonus]").val()){try{TipBalance.getBalance()}catch(ex){console.log(ex)}if(BrowserDetect.isPhoneDevice())return}AutoReload.popData={html:!0,placement:"top",trigger:"manual",title:function(){return $j(data).find("#autoReloadPopTitle").html()},content:function(){return $j(data).find("#autoReloadPopContent").html()}},$j("#balanceTextViewer").is(":visible")?($j("#balanceTextViewer").popover("destroy"),$j("#balanceTextViewer").popover(AutoReload.popData),$j("#balanceTextViewer").popover("show")):$j("#tippingButtonsMd").is(":visible")?($j("#tippingButtonsMd").popover("destroy"),$j("#tippingButtonsMd").popover(AutoReload.popData),$j("#tippingButtonsMd").popover("show")):($j("#NSBar .xs-balance").popover("destroy"),$j("#NSBar .xs-balance").popover(AutoReload.popData),$j("#NSBar .xs-balance").popover("show"))}else if(-1!=data.indexOf("autoReloadFirstTimeOverlay")){if(AutoReload.isOverlayDisplayed)return;AutoReload.closePopTip(),Utils.popPreloadedContent(data),AutoReload.isOverlayDisplayed=!0}else if(-1!=data.indexOf("DONE"))try{TipBalance.getBalance()}catch(ex){console.log(ex)}else-1!=data.indexOf("FAILED")&&(Cam4User.autoReloadData.threshold=-1)},callAutoReload:function(callPop,isShowMore){!isShowMore&&""!==AutoReload.lastCallTS&&new Date-AutoReload.lastCallTS<AutoReload.lastCallWaitTime||(isShowMore||!AutoReload.isOverlayDisplayed&&!AutoReload.isPopOpen)&&(AutoReload.lastCallTS=new Date,$j.ajax({url:AutoReload.allPurposeUrl+(callPop?"?balloonTooltip=true":""),type:"GET",success:function(res){AutoReload.handleResponseData(res)},error:function(err){console.error(err)}}))},evaluateBalance:function(userBalance){void 0!==Cam4User.autoReloadData&&Cam4User.autoReloadData.threshold>-1&&parseInt(userBalance)<=parseInt(Cam4User.autoReloadData.threshold)&&(Cam4User.isViewer()?AutoReload.callAutoReload(!0):AutoReload.callAutoReload())},optIn:function(flag,fromToolTip){void 0!==flag?($j.ajax({url:AutoReload.allPurposeUrl,type:"POST",data:"optInResponse="+(flag?AutoReload.optInYes:AutoReload.optInNo)+(fromToolTip?"&balloonTooltip=true":""),success:function(response){void 0===Cam4User.autoReloadData||flag?flag&&AutoReload.handleResponseData(response):Cam4User.autoReloadData.threshold=-1},error:function(err){console.log(err)}}),AutoReload.isPopOpen&&AutoReload.closePopTip()):console.error("Paramter true / false required!")},toggleSettings:function(toggle){toggle?($j("#autoReloadOptns").children().attr("disabled",!1),$j(".btn-group.sel-input *").removeClass("disabled"),$j("#autoReloadOptns").fadeTo("fast",1)):($j("#autoReloadOptns").children().attr("disabled",!0),$j(".btn-group.sel-input *").addClass("disabled"),$j("#autoReloadOptns").css("opacity",.6))}};$j(document).on("shown.bs.popover",function(){AutoReload.isPopOpen=!0,$j(".popover .close").click(function(){AutoReload.closePopTip()})}),$j(document).ready(function(){-1!=Cam4User.htmlStates.indexOf("payment_options_ftl")&&$j("#autoReloadEnable").length>0&&($j("#autoReloadEnable").change(function(){this.checked?(AutoReload.toggleSettings(!0),!1===$j("input[name=enableOneClick]").is(":checked")&&$j("input[name=enableOneClick]").prop("checked",!0)):AutoReload.toggleSettings(!1)}),$j("#enableOneClick").change(function(){this.checked||$j("#autoReloadEnable").is(":checked")&&($j("#autoReloadEnable").prop("checked",!1),AutoReload.toggleSettings(!1))})),Cam4Event.hasEventListener(Cam4Event.MODAL_CLOSING,"detectLastClosedModal")||Cam4Event.addEventListener(Cam4Event.MODAL_CLOSING,function(event){AutoReload.closeOverlay(!1)},"detectLastClosedModal")});
var Cam4Notifications={uid:0,timeoutId:"",putTimeoutId:"",history:[],receivedList:[],showedList:[],cookieLife:3,maxBroadcastTime:15,HISTORY_CHANGED:"Cam4NotificationsHistoryChanged",deltas:{notificationLifetime:5e3,notificationDelay:5e3,ajaxTimeout:24e4},inIframe:function(){try{return window.self!==window.top}catch(e){return!0}},requestPermission:function(callback){try{window.webkitNotifications.requestPermission(function(permission){0===window.webkitNotifications.checkPermission()&&($j("#RP-notif-area").hide(),Cam4Cookies.setCookie("Cam4BrowserNotificationsEnabled","true"))})}catch(ex){console.log("window.webkitNotifications.requestPermission() FAILED",ex);try{Notification.requestPermission(function(permission){console.log(permission),$j("#RP-notif-area").hide(),Cam4Cookies.setCookie("Cam4BrowserNotificationsEnabled","true")})}catch(e){console.log("Notification.requestPermission() FAILED",e)}}},generate:function(data){Cam4Notifications.uid++;var idName=HTML4Notification.makeId(Cam4Notifications.uid,"notification");data.username||(data.username=data.title);var html='<div class="browser-notification '+Cam4Notifications.getStyle()+'" onclick="window.open(\'/'+data.username+"','_blank'); Utils.removeNotification('"+idName+"', {}, true)\">";html+='<div class="br-right">',html+='<span class="br-title">',html+='<span class="br-name">'+data.title+'</span><span class="br-dismiss" onclick="Utils.removeNotification(\''+idName+"', event, true);\" >&times;</span>",html+="</span>",html+='<span class="br-text">',html+=data.text,html+="</span>",html+="</div>",html+='<div class="br-left">',html+='<img src="'+data.picture+'"/>',html+="</div>",html+="</div>",data.onclick=function(){window.open("/"+data.username,"_blank")},data.lifeTime=Cam4Notifications.deltas.notificationLifetime;var stat;try{stat=Utils.setDesktopNotification(!1,data)}catch(ex){stat="failed"}return"success"!==stat&&Utils.addNotification(html,this.uid,"notification"),stat},getStyle:function(){switch(BrowserDetect.browser){case"Firefox":case"Safari":return"br-Firefox"}return""},fetchURL:function(callback){$j.ajax({url:"/profile/html5Notifications",type:"get",error:function(err,status,errThrown){callback({})},success:function(result){callback(result)}})},getData:function(){function iterateList(list,type){for(var i=0;i<list.length;i++)list[i].error?Cam4Notifications.history.push({time:new Date,action:" error occured "}):(list[i].type=type,Cam4Notifications.receivedList.push(list[i]))}Cam4Notifications.fetchURL(function(result){for(var i=0;i<result.length;i++){var currentObj=result[i];currentObj.FAVORITE_BROADCASTS&&iterateList(currentObj.FAVORITE_BROADCASTS,"favOnline-"),currentObj.SCHEDULED_SHOWS&&iterateList(currentObj.SCHEDULED_SHOWS,"scheduledOnline-"),currentObj.FANCLUB_PRIVATE_SHOWS&&iterateList(currentObj.FANCLUB_PRIVATE_SHOWS,"fanclub-"),currentObj.FRIEND_ACCEPTED&&iterateList(currentObj.FRIEND_ACCEPTED,"friendAccepted-")}})},detectDisplayText:function(object){var displayTxt="";return"fanclub-"===object.type?(displayTxt=js_i18n.userStartedPrivateShow,displayTxt+=js_i18n.youCanSpyForFree,displayTxt=displayTxt.replace("%0",object.username),object.displayTxt=displayTxt):"friendAccepted-"===object.type?(displayTxt=Cam4NotificationsBundles.friendAccepted,displayTxt=displayTxt.replace("%0",object.username),object.displayTxt=displayTxt):(void 0!==typeof object.time&&object.type&&object.username&&(displayTxt=object.type,"favOnline-"===object.type?displayTxt=parseInt(object.time)>Cam4Notifications.maxBroadcastTime?Cam4NotificationsBundles.performerBroadcasting:Cam4NotificationsBundles.showStarted:"scheduledOnline-"===object.type&&(displayTxt=Cam4NotificationsBundles.userAboutToBegin),displayTxt=(displayTxt=displayTxt.replace("%0",object.username)).replace("%1",object.time)),object.displayTxt=displayTxt)},detectTitle:function(object){return"fanclub-"===object.type?js_i18n.userFanClubNotification.replace("%0",object.username):"CAM4 - "+object.username},putItem:function(index,list){if(clearTimeout(this.putTimeoutId),!list||!list[index]){var stat=list?"no index":"no list";return Cam4Notifications.history.push({time:new Date,action:" listStatus "+stat}),this.putTimeoutId=setTimeout(function(){Cam4Notifications.putItem(0,list)},Cam4Notifications.deltas.notificationDelay),void Cam4Event.dispatch(Cam4Notifications.HISTORY_CHANGED,!1)}var currentObj=list[index],type=currentObj.type,displayTxt=Cam4Notifications.detectDisplayText(currentObj),currentBuffer=Cam4Notifications.showedList,currentName=Cam4Cookies.getCookie(type+currentObj.username),nextTick=Cam4Notifications.deltas.notificationDelay;if(Cam4User.performerName!==currentObj.username&&null===currentName&&currentBuffer.indexOf(currentObj.username)<0&&currentObj.username){Cam4Notifications.generate({title:Cam4Notifications.detectTitle(currentObj),text:displayTxt,picture:currentObj.imageLink,username:currentObj.username}),Cam4Notifications.showedList.push(type+currentObj.username);var now=new Date,over=new Date(now.getFullYear(),now.getMonth(),now.getDate(),now.getHours()+Cam4Notifications.cookieLife);Cam4Cookies.setCookie(type+currentObj.username,currentObj.username,over),currentObj.localStatus="added",Cam4Notifications.history.push({time:now,action:" added "+type+" "+currentObj.username})}else currentObj.localStatus="skipped",Cam4Notifications.history.push({time:new Date,action:" skipped "+type+" "+currentObj.username}),nextTick=100;Cam4Event.dispatch(Cam4Notifications.HISTORY_CHANGED,currentObj),Cam4Notifications.putTimeoutId=setTimeout(function(){Cam4Notifications.putItem(index+1,list)},nextTick)}},CompleteProfile={showOverlay:function(){Utils.popWithAjaxContent("/completeProfileInfo",{roundedCorners:!1},!1,function(){$j(".complete-profile-modal select").selectpicker(),$j("#Cam4DialogContainer").find(".close").on("click",function(event){Utils.closeModalPops(),event.preventDefault()})},void 0,void 0,void 0,"complete-profile-modal-dialog")},isChecked:!1,checkBoxChanged:function(event){CompleteProfile.isChecked=event.currentTarget.checked},submitWithAjax:function(){if(CompleteProfile.isChecked){var allFieldsFilled=!0;if($j(".field-wrap:not(.optional) select").each(function(){"0"==$j(this).val().toString()||""===$j(this).val().toString()?(allFieldsFilled=!1,$j(this).parent().addClass("notFilled")):$j(this).parent().removeClass("notFilled")}),!1!==allFieldsFilled){if(ControlledFeatures.GDPR_NEW_DESIGN){var userConsentStatus="DENIED";$j("#accept-broadcast-consent").is(":checked")&&(userConsentStatus="APPROVED"),$j.ajax({type:"POST",url:"/rest/v1.0/user/"+Cam4User.userName+"/consent?login_user_name="+Cam4User.userName+"&accessHash="+Cam4User.kN,data:JSON.stringify([{consentType:"PERFORMER",userConsentStatus:userConsentStatus}]),dataType:"json",contentType:"application/json; charset=utf-8",success:function(){allowBroadcast=!0},error:function(err){console.warn("AJAX error in request: "+JSON.stringify(err,null,2))}})}else allowBroadcast=!0;var profileData={monthBorn:$j("#monthBorn").val(),dayBorn:$j("#dayBorn").val(),yearBorn:$j("#yearBorn").val(),gender:$j(".field-wrap select[name=gender]").val(),sexPreference:$j(".field-wrap select[name=sexPreference]").val(),ethnicity:$j(".field-wrap select[name=ethnicity]").val(),isAjaxCall:"true",partial:Math.random()};$j.ajax({url:"/forms/save_profile.jsp",type:"get",data:profileData,error:function(err,status,errThrown){},success:function(result){"done"===result.trim()&&(Utils.closeModalPops(),Cam4User.needsMainProfileInfoCompletion=function(){return!1})}})}else alert(Cam4Bundles.completeProfile)}else alert(Cam4Bundles.termsOfUseAgree)},ToggleFields:function(currentCheckbox){"accept-broadcast-consent"===currentCheckbox.getAttribute("id")?$j(".broadcast-fields-row").removeClass("disabled"):$j(".broadcast-fields-row").addClass("disabled")}};$j(document).ready(function(){"true"===Cam4Cookies.getCookie("Cam4BrowserNotificationsEnabled")&&$j("#RP-notif-area").hide();var notificationOsAllowed="iPad"!==BrowserDetect.OS&&"iPhone"!==BrowserDetect.OS&&"Android"!==BrowserDetect.OS&&!Cam4User.isBroadcastingWindow;Cam4User.isLoggedIn&&Cam4User.notificationSettings.canReceive()&&notificationOsAllowed&&!Cam4Notifications.inIframe()&&(Cam4Notifications.getData(),Cam4Notifications.putItem(0,Cam4Notifications.receivedList))});
var FanClub={genderCriteria:"all",amount:"",performer:"",response:{},selectGenderCriteria:function(item){$("#fanclubFilterBtn_all, #fanclubFilterBtn_online, #fanclubFilterBtn_offline").removeClass("active"),item&&item.id&&(FanClub.genderCriteria=item.id.split("_")[1],$j(item).addClass("active")),FanClub.sortFanClubList()},getFanClubReport:function(){var year=$j("#FanclubYearSelect").val();window.location="/"+Cam4User.userName+"/edit/editMyFanClub?yearReport="+year},init:function(){if(Cam4User.htmlStates.indexOf("profile_editFanClub_ftl")>-1){$("#FanclubYearSelect").selectpicker().on("change",function(){var year=$("#FanclubYearSelect option:selected").val();window.location="/"+Cam4User.userName+"/edit/editMyFanClub?yearReport="+year}),$("#subscribersReportList").selectpicker();var tokenWarning=$(".token-warning");$(".price-change #amount").on("change",function(){var priceInputValue=$(this).val();priceInputValue<1||priceInputValue>250?(tokenWarning.show(),$(this).css("border-color","red")):(tokenWarning.hide(),$(this).css("border-color","#ccc"))})}Cam4User.htmlStates.indexOf("fanclubs_ftl")>-1&&$("#sortFanClubList").selectpicker()},sortSubscribers:function(){var list=$j("#subscribersList li");list=list.sort(function(a,b){return a.innerHTML<b.innerHTML?-1:a.innerHTML>b.innerHTML?1:0}),$j("#subscribersList").append(list)},parseEpayErrorCode:function(code){var errors={INVALID_PERFORMER_NAME:js_i18n.epayMessages.invalidPerformerName,INVALID_FANCLUB_AMOUNT:js_i18n.epayMessages.invalidFanclubAmount,FANCLUB_NOT_ACTIVATED:js_i18n.epayMessages.notActivated,ALREADY_HAS_FANCLUB_SUBSCRIPTION:js_i18n.epayMessages.alreadyHasSubscription,DEFAULT:marketLocales.tryAgain};return errors.hasOwnProperty(code)?errors[code]:errors.DEFAULT},joinFanClub:function(){var amount=FanClub.amount,performer=FanClub.performer,fanclubModal=$("#Cam4DialogContainer .modal-content"),content=fanclubModal.find(".fanclub-overlay");fanclubModal.prepend('<div class="modal-loading"></div>'),content.find(".alert").remove(),TipBalance.refresh()<amount?TipFactory.popTokens():"SUCCESS"===FanClub.response.status?EpayPlugin.buyFanclubSubscription(FanClub.response,performer,amount,Cam4User.kN,Cam4User.userName,function(response){if(response.hasOwnProperty("status"))if("SUCCESS"!==response.status)content.prepend($("<div></div>",{class:"alert alert-danger",text:FanClub.parseEpayErrorCode(response.reason||response.status)}));else{var tags;if(tags="undefined"!=typeof Cam4Analytics?Cam4Analytics.getCurrentTags():"NA",dataLayer.push({event:"socialEvents",eventCategory:"fanClub",eventAction:"joinFanClub",eventLabel:tags}),PageStatus.isProfile)var subCheck=setInterval(function(){$j.ajax({url:"/rest/v1.0/profile/"+FanClub.performer+"/fanclub/authorization",type:"GET",complete:function(response){204===response.status&&location.reload(),404===response.status&&clearInterval(subCheck)}})},666)}fanclubModal.find(".modal-loading").remove()}):(content.prepend($("<div></div>",{class:"alert alert-danger",text:FanClub.parseEpayErrorCode(FanClub.response.status)})),fanclubModal.find(".modal-loading").remove())},subscribeWithTokens:function(user){$("#subs2FanClubTokens").addClass("disabled"),FanClub.subscriptionStarted||(FanClub.subscriptionStarted=!0,FanClub.subscribeToFanClub(user,function(status){Utils.closeModalPops(),204===status&&(FanClub.popModal("/"+user+"/fanclub/subscribeSuccess"),Cam4User.isSubscribedToFanClub=function(){return!0},$j("#btnJoin-"+user).html(js_i18n.youAreAFan).attr("disabled","disabled").removeAttr("onclick"),$j("#fanZoneBtn").removeAttr("onclick").attr("disabled","disabled").addClass("disabled").text(js_i18n.youAreAFan)),FanClub.subscriptionStarted=!1,$("#subs2FanClubTokens").removeClass("disabled")}))},subscribeToFanClub:function(user,onComplete){var _url="/"+user+"/fanclub/subscribe";$j.ajax({url:_url,type:"PUT",complete:function(jqxhr,txt_status){204===jqxhr.status&&(onComplete?onComplete(jqxhr.status):window.location=document.URL)}})},unsubscribeFromFanClub:function(user){var _modalUrl="/"+user+"/fanclub/unsubscribeConfirmation?subscriber="+Cam4User.profileName;FanClub.popModal(_modalUrl)},requestFanClubApproval:function(){var _url="/"+Cam4User.userName+"/edit/requestFanClubApproval";Cam4User.userName;$j.ajax({url:_url,type:"POST",complete:function(jqxhr,txt_status){204===jqxhr.status&&(FanClub.popReminder(),FanClub.requestFanClubApproval=function(){window.location="/"+Cam4User.userName+"/edit/editMyFanClub"})},error:function(jqXHR,textStatus,errorThrown){$j("#joinFanClubMainContent").html(jqXHR.responseText)}})},sortFanClubList:function(pageIndex){var selectedGender=$j("#sortFanClubList option:selected").val(),onlineMode="all";"offline"===FanClub.genderCriteria&&(onlineMode="false"),"online"===FanClub.genderCriteria&&(onlineMode="true");var _url="/fan-club?ajax=true&online="+onlineMode;return"all"!==selectedGender&&(_url+="&gender="+selectedGender),pageIndex&&(_url+="&page="+pageIndex),$j("#fanclubDynamicContent .navigator li").addClass("disabled"),$j("#fanclubDynamicContent .navigator li a").removeAttr("onclick"),$("#sortFanClubList").attr("disabled","true").selectpicker("refresh"),$(".btn-group button").addClass("disabled"),$j.ajax({url:_url,type:"GET",complete:function(response){$j("#fanclubDynamicContent").html(response.responseText),FanClub.init()}}),!1},popModal:function(url){$(".modal-backdrop").length>1&&$(".modal-backdrop").not(":last-child").remove(),Utils.popWithAjaxContent(url,{},!1,function(){FanClub.amount=parseInt($("#fanclubTokenPrice").val()),FanClub.performer=$("#fanclubPerformerName").val(),$("#subs2FanClubTokens").attr("disabled",!0),EpayPlugin.getFanclubProduct(FanClub.performer,FanClub.amount).success(function(response){FanClub.response=response,$("#subs2FanClubTokens").attr("disabled",!1)})})},goToFanZone:function(price){if(!Cam4User.isLoggedIn||!Cam4User.performerName)return TipFactory.redirectGuest(),0;FanClub.joinClub(Cam4User.performerName,price)},joinClub:function(userName,price,alreadyRegistered){Cam4User.isLoggedIn?alreadyRegistered?window.location="/"+userName+"/fanclub/fanZoneLanding":(Utils.closeModalPops(),TipBalance.getBalance(),Cam4Event.addEventListener(TipEvent.ON_BALANCE_GOT,function(response){Cam4Event.removeEventListener(TipEvent.ON_BALANCE_GOT,"join_club_check");var url="/"+userName+"/fanclub/";+response.userbalance&&parseInt(response.userbalance)>=price?url+="subscribeWithTokens":url+="subscribeWithBuy?balance="+response.userbalance,$("#modalLayout").modal("hide"),FanClub.popModal(url)},"join_club_check")):TipFactory.redirectGuest()},popReminder:function(){Utils.closeModalPops(),$(".modal-content").empty(),$("#modalLayout").modal({remote:"/fanclub/approvedSuccess"}),$("#modalLayout").modal()},fileInputChanged:function(element){!function(input){if(input.files&&input.files[0]){var reader=new FileReader;reader.onload=function(e){$("#blah").attr("src",e.target.result),badgePreview.innerHTML='<img src = "'+e.target.result+'"/>',$j("#badgePreviewVisible").attr("src",e.target.result),FanClub.checkSaveChanges()},reader.readAsDataURL(input.files[0])}}(element),setTimeout(function(){FanClub.checkSaveChanges()},1e3)},openMembershipExpiration:function(){var url="/"+Cam4User.userName+"/fanclub/subscriptionsToExpire";FanClub.popModal(url)},checkSaveChanges:function(){function enableBtn(){return $j("#submitSaveFanclubChanges").removeClass("disabled").removeAttr("disabled","disabled"),!0}function disableBtn(){return $j("#submitSaveFanclubChanges").addClass("disabled").attr("disabled","disabled"),!1}var hasText=""!=($j("#fanClubDescription").val()+"").trim(),isFirstSave=Cam4User.hasFanClubEditingRequired,hasImage=!!$j("#badgePreview img").attr("src");return isFirstSave?hasText&&hasImage?enableBtn():disableBtn():hasText||hasImage?enableBtn():disableBtn()},lastExpiredDeactivatedFCModalIndex:0,showExpiredSubscriptionsAndDeactivatedFanClubs:function(index){var notifications=JSON.parse(Cam4User.expiredDeactivatedFanClubs);if(null!=notifications){FanClub.lastExpiredDeactivatedFCModalIndex=index;var currentNotification=notifications[index];if(null!=currentNotification){var url="/"+currentNotification.performerName+"/fanclub/expiredOrDeactivated?type="+currentNotification.notificationType+"&id="+currentNotification.notificationId;FanClub.popModal(url)}}},closeExpiredDeactivatedFCModal:function(){Utils.closeModalPops(),FanClub.showExpiredSubscriptionsAndDeactivatedFanClubs(FanClub.lastExpiredDeactivatedFCModalIndex+1)},exportTable:function(){if(document.getElementById("FanclubReportTbl")){var convertor=new Table2CSV,fname=Cam4User.userName+"_"+new Date+".csv",text=convertor.parseTable(document.getElementById("FanclubReportTbl"));convertor.downloadParsed(text,!1,fname)}},putMainBadge:function(badgeUrl){Cam4User.htmlStates.indexOf("profilePageHeaderInfo_jsp")>-1&&badgeUrl&&$j("#profileHeaderTop").css({background:"url("+badgeUrl+")","padding-top":"30px","padding-bottom":"30px"})},lockGallery:function(price){$(".fanLockIcon").css("cursor","pointer").click(function(){FanClub.joinClub(Cam4User.performerName,price)})},gotoSubscribersPage:function(pageIndex){$j.ajax({url:"/"+Cam4User.profileName+"/fanclub/listOfSubscribers?subscribersPageNo="+pageIndex,type:"GET",complete:function(response){$j("#fanclubListingContent").html(response.responseText)}})}};$j(document).ready(function(){function characterCounter(event){Utils.limitTextLength(event.currentTarget,120,"fanClub_charsLeft",js_i18n.charactersLeft+" %0")}FanClub.init(),Cam4User.htmlStates.indexOf("profile_editFanClub_ftl")>-1&&(FanClub.sortSubscribers(),FanClub.checkSaveChanges(),$j("#fanClubDescription").keyup(function(){FanClub.checkSaveChanges()})),Cam4User.isSubscribedToFanClub()||Cam4User.performerName==Cam4User.userName||FanClub.lockGallery(Cam4Performer.fanclubPrice),Cam4User.fanClubRequiredNotification&&FanClub.popReminder(),$j("#fanClubDescription")[0]&&($j("#fanClubDescription").keyup(characterCounter).keydown(characterCounter).focusout(characterCounter).focus(characterCounter),$j("#fileInputBadge").mouseover(function(){$j("#fakeFileBtn").addClass("hover-btn")}).mouseout(function(){$j("#fakeFileBtn").removeClass("hover-btn")}));var isDirectory="undefined"!=typeof PageStatus&&void 0!==PageStatus.isDirectory&&PageStatus.isDirectory;Cam4User.fanclubSubscriptionsAboutToExpire.length>0&&isDirectory&&(FanClub.openMembershipExpiration(),Cam4User.fanclubSubscriptionsAboutToExpire=[]),null!=Cam4User.expiredDeactivatedFanClubs&&Cam4User.expiredDeactivatedFanClubs.length>0&&isDirectory&&FanClub.showExpiredSubscriptionsAndDeactivatedFanClubs(0)});
function setSelected(value){var name;"number"!=typeof value&&(name=value[value.selectedIndex].text,value=value[value.selectedIndex].value),document.getElementById("btnWrap").style.display="none",document.getElementById("id").value=value,document.getElementById("to").value=name,null!=value&&value.length>0&&(document.getElementById("btnWrap").style.display="block")}function submit(to,gift){var string="/"+to+"/give/"+gift;$j.get(string,function(data){$j("#select_container").html(data)})}function limitText(limitField,limitCount,limitNum){limitField.value.length>limitNum?limitField.value=limitField.value.substring(0,limitNum):limitCount.value=limitNum-limitField.value.length}if(void 0===GiftList)var GiftList=[];var Gifting={MAX_MESSAGE_CHARS:12,textAreaFocused:function(){console.log("textarea focused"),$j(".gift-message-textarea").val().fulltrim()===Cam4Bundles.giftingOptionalMessage.fulltrim()&&$j(".gift-message-textarea").val("")},textAreaBlurred:function(){console.log("textarea blurred");var text=$j(".gift-message-textarea").val();(text=text.fulltrim())||$j(".gift-message-textarea").val(Cam4Bundles.giftingOptionalMessage)},maps:{},last_selection:GiftList||[],last_sorted:GiftList||[],popGiftsModal:function(){Utils.popResponsiveModal("/"+Cam4User.performerName+"/modal/gifts?type=modal")},getAllGifts:function(fromObj,id){if(fromObj&&0!=id){if(void 0!==this["all_gifts_from_cat_"+id])return this["all_gifts_from_cat_"+id];a=_.map(fromObj,function(element){return element.gifts});return this["all_gifts_from_cat_"+id]=[].concat.apply([],a),this["all_gifts_from_cat_"+id]}if(void 0!==this.all_gifts)return this.all_gifts;var a=_.map(GiftList,function(element){return element.gifts});return this.all_gifts=[].concat.apply([],a),this.all_gifts},duplicate:function(obj){return JSON.parse(JSON.stringify(obj))},getSelection:function(){this.last_categoryId=parseInt($j("#giftChooseCategory").val()),this.last_sortedBy=$j("#giftSortCategory").val(),this.last_mapName="cat_"+this.last_categoryId+"_sb_"+this.last_sortedBy;var giftSortCategory=$("#giftSortCategory");0!==this.last_categoryId?(giftSortCategory.find("option[value=category]").attr("disabled","disabled"),giftSortCategory.selectpicker("refresh")):(giftSortCategory.find("option[value=category]").removeAttr("disabled"),giftSortCategory.selectpicker("refresh"));var sortKey="";switch(this.last_sortedBy){case"recent":sortKey="release";break;case"popular":sortKey="sentCount";break;case"price":sortKey="price";break;default:sortKey=this.last_sortedBy}return{categoryId:this.last_categoryId,sortedBy:this.last_sortedBy,mapName:this.last_mapName,sortKey:sortKey}},makeGiftDomPattern:function(giftObject){var nameKey=giftObject.nameKey,imageSrc=giftObject.imageSrc,giftName=giftObject.giftName,price=giftObject.price,giftId=giftObject.giftId,htmlText='<div id="'+nameKey+'" class="giftItem">';return htmlText+='<div class="gift-pod"><img class="lazy" data-src="'+imageSrc+'" alt="gift_image">',htmlText+='<ul class="giftInfo">',htmlText+="<li> "+giftName+" </li>",htmlText+="<li>"+price+nstiplang.tokens.toLowerCase()+"</li>",Cam4User.userName!==Cam4User.performerName&&(htmlText+="<li>",htmlText+='<a class="btn btn-xs btn-green" onclick="Gifting.openSendGiftModal(\''+giftId+"');\">",htmlText+='<span class="cam4icon icon-gift">&nbsp;</span>',htmlText+=Cam4Bundles.sendGift+" </a>",htmlText+="</li>"),!0===Cam4User.isModerator&&(htmlText+="<li>",htmlText+="<span>",htmlText+="<a onclick=\"Gifting.openEditGiftForm('"+Cam4User.performerName+"', "+giftId+')" class="adminMod"> Edit Gift </a>',htmlText+="</span>",htmlText+="</li>"),htmlText+="</ul>",htmlText+="</div></div>"},makeGiftWrapper:function(categoryTitle,categoryPriority,innerContent){var htmlText='<div class="giftCategoryWrap">',priorityNumber="";return!0===Cam4User.isModerator&&null!==categoryPriority&&(priorityNumber=" - Priority: "+categoryPriority),null!==categoryTitle&&(htmlText+="<h2> "+categoryTitle+priorityNumber+" </h2>"),htmlText+=innerContent,htmlText+="</div>"},displayCategory:function(object){for(var giftsHtml="",i=0;i<object.gifts.length;i++)giftsHtml+=this.makeGiftDomPattern(object.gifts[i]);return this.makeGiftWrapper(object.categoryName,object.priority,giftsHtml)},initStyle:function(){$("#giftSortCategory").selectpicker(),$("#giftChooseCategory").selectpicker({"margin-left":"140px"}),this.filter()},filter:function(){var mapName=this.getSelection().mapName;if(0==this.last_categoryId&&!0===Cam4User.isModerator&&$j(".openEditGiftsCategory a").hide(),void 0!==this.maps[mapName])return $j("#whiteShelfBg").html(this.maps[mapName]),$j("img.lazy").Lazy(),console.log("loaded from map: ",mapName),this.maps[mapName];this.chooseCategory();var ret=this.sortCategory();return $j("img.lazy").Lazy(),ret},chooseCategory:function(){var categoryId=this.getSelection().categoryId;return this.last_selection=0!==categoryId?_.filter(GiftList,function(element){return element.categoryId===categoryId}):GiftList,this.last_selection},sortCategory:function(){var mapName=this.getSelection().mapName,categoryId=this.getSelection().categoryId,sortKey=this.getSelection().sortedBy,sortName=this.getSelection().sortKey,categoryPriority=this.getCategoryPriority();if(0===categoryId&&"category"===sortKey){this.last_sorted=_.sortBy(GiftList,function(element){return!element.priority});for(var txt="",i=0;i<this.last_sorted.length;i++)txt+=this.displayCategory(this.last_sorted[i]);$j("#whiteShelfBg").html(txt),this.maps[mapName]=txt}else{this.last_sorted=_.sortBy(this.getAllGifts(this.last_selection,categoryId),function(element){return element[sortName]}),"recent"!==sortKey&&"popular"!==sortKey||(this.last_sorted=this.last_sorted.reverse());for(var txt="",i=0;i<this.last_sorted.length;i++)txt+=this.makeGiftDomPattern(this.last_sorted[i]);var selectedCategoryTitle=$j("#giftChooseCategory option:selected").text().trim(),htmlTxt=this.makeGiftWrapper(selectedCategoryTitle,categoryPriority,txt);$j("#whiteShelfBg").html(htmlTxt),this.maps[mapName]=htmlTxt,0!=categoryId&&!0===Cam4User.isModerator&&$j(".openEditGiftsCategory a").show()}return $j("#whiteShelfBg")},getCategoryPriority:function(){for(var i=0;i<GiftList.length;i++)if(this.getSelection().categoryId==GiftList[i].categoryId)return GiftList[i].priority;return null},openSendGiftModal:function(giftid){giftid=parseInt(giftid),this.lastModalUrl="/"+Cam4User.performerName+"/give/"+giftid,Utils.popWithAjaxContent(this.lastModalUrl),console.log("open modal url",this.lastModalUrl)},sendGift:function(destination,giftid){if(Cam4User.isLoggedIn||Cam4User.isLoggedInAsGuest){if(!ServiceTipViewer.checkDisabledRiskTokens()){$j("#Cam4DialogContainer .giftName").html();var adminPriceEl=$j(".buyGiftModalContent .admin-only");if(Cam4User.isModerator&&adminPriceEl.length>0){if(adminPriceEl.removeClass("alert-danger"),!(adminPriceEl.val()>=0))return void adminPriceEl.addClass("alert-danger");$j("#buyGift_Form input[name=admin_price]").val(adminPriceEl.val())}$j("#sendGiftBtn").addClass("disabled"),$j("#sendGiftBtn").removeAttr("onclick"),$j("#buyGift_Form").ajaxSubmit({success:function(response){var responseContent=$j(response);if(0!=responseContent.find("#not-enough-tokens-error").length)$j(".giftDescription").prepend(responseContent);else{Utils.closeModalPops();try{TipBalance.getBalance()}catch(ex){console.log(ex)}}}})}}else TipFactory.popTokens()},validateAndSubmitNewGift:function(giftId){var error="",form=document.getElementById("gift_form_"+giftId);null==form.giftImage.value||""==form.giftImage.value?(form.giftImage.className+=" invalid",error+="<li>image name can`t be empty</li>"):form.giftImage.className="textBox",null==form.folderName.value||""==form.folderName.value?(form.folderName.className+=" invalid",error+="<li>folder name can`t be empty</li>"):form.folderName.className="textBox",null==form.name.value||""==form.name.value?(form.name.className+=" invalid",error+="<li>name can`t be empty</li>"):form.name.className="textBox","Invalid Date"==new Date(form.release.value)?(form.release.className+=" invalid",error+="<li>release date can`t be empty</li>"):form.release.className="textBox","Invalid Date"==new Date(form.retire.value)?(form.retire.className+=" invalid",error+="<li>retire date can`t be empty</li>"):form.retire.className="textBox",isNaN(form.lifespan.value)||Number(form.lifespan.value)<1?(form.lifespan.className+=" invalid",error+="<li>lifespan must be a positive integer</li>"):form.lifespan.className="textBox",!(isNaN(form.price.value)||Number(form.price.value)<1)||$j("#gift_form_"+giftId).find("select[name=category] option:selected").hasClass("gold-exclusive")||$j("#gift_form_"+giftId).find("select[name=category] option:selected").hasClass("admin-only")?form.price.className="textBox":(form.price.className+=" invalid",error+="<li>price must be a positive integer</li>"),error.length>0?document.getElementById("error_box_"+giftId).innerHTML=error:($j(form).find("input, select").each(function(){$j(this).removeAttr("disabled")}),form.submit())},openAddGiftForm:function(){Utils.popWithAjaxContent("/gift/admin?path=add_gift&username="+Cam4User.performerName,{},!1,function(){$("#Cam4DialogContainer").find(".modal-dialog").addClass("modal-lg"),checkIfPriceMustBeEnabled()})},openAddGiftCategory:function(){Utils.popWithAjaxContent("/gift/admin?path=add_category&username="+Cam4User.performerName,{},!1,function(){$("#Cam4DialogContainer").find(".modal-dialog").addClass("modal-lg")})},openEditCategory:function(){var categoryId=this.getSelection().categoryId;Utils.popWithAjaxContent("/gift/admin?path=edit_category&selected_category_id="+categoryId,{},!1,function(){$("#Cam4DialogContainer").find(".modal-dialog").addClass("modal-lg")})},openEditGiftForm:function(userName,giftId){var url="/gift/admin?path=add_gift&gift_id="+giftId+"&username="+userName;Utils.popWithAjaxContent(url,{},!1,function(){$("#Cam4DialogContainer").find(".modal-dialog").addClass("modal-lg"),checkIfPriceMustBeEnabled(giftId)}),console.log(url)},activateGiftDate:function(for_logic){$j("#"+for_logic).datepicker(),$j("#"+for_logic).datepicker("show")},categoryInputPressed:function(){var rest=51-$j('input[name="cat_name"]').val().length;$j($j(".smTxt")[0]).text(rest+" characters remaining")},doSubmit:function(sourceLink){var container=$j(sourceLink).closest("#select_container").parent().parent();$j(sourceLink).hide(),$j(".closeOverlayJquery a").hide(),$j(sourceLink).closest("#purchase_form").ajaxSubmit({target:container})},scrollToStore:function(){Overlays.closeAll(),$j("#profileTabMenu a[data-content=gifts]").click(),$j("html, body").animate({scrollTop:$j("#profileTabMenu").offset().top},500)}};$j(document).ready(function(){Cam4User.htmlStates.indexOf("marketplaceContent_ftl")>-1&&Gifting.initStyle()}),"undefined"!=typeof ProfileManager&&ProfileManager.onTabChangeAfter(function(partName){"giftsContent"==partName&&(Gifting.initStyle(),"undefined"!=typeof TipBalance&&TipBalance.refresh())});
var UsersOnline={widgetDivId:"friendsAndFavoritesOnline",widgetButtonId:"toggleFriendsFavs",activeTab:"",setClickOutside:!1,reloadRate:6e4,attachImage:function(uName,imageSrc,flag){document.getElementById("user-"+uName).querySelectorAll(".user-img")[0].setAttribute("src",imageSrc)},toggleFriendsFavsOnline:function(btnElem,tab){switch(tab){case"friends":$j(this).hasClass("active")||($j("."+UsersOnline.widgetDivId+" .option-tabs .btn").removeClass("active"),$j(btnElem).addClass("active"),$j(".favoritesOnlineList").hide(),$j(".friendsOnlineList").fadeIn(400));break;case"favorites":$j(this).hasClass("active")||($j("."+UsersOnline.widgetDivId+" .option-tabs .btn").removeClass("active"),$j(btnElem).addClass("active"),$j(".friendsOnlineList").hide(),$j(".favoritesOnlineList").fadeIn(400))}UsersOnline.initOnlineFriendsAndFavorites(tab)},getOnlineFriendsAndFavorites:function(tab){tab==UsersOnline.activeTab&&$j.ajax({url:"/broadcastingUsers?FriendFavoriteTab="+tab,type:"GET",success:function(data){try{UsersOnline.populateOnlineFriendsAndFavorites(tab,data)}catch(e){console.log(e)}},error:function(err){console.log(err);try{UsersOnline.populateOnlineFriendsAndFavorites(tab,!1)}catch(e){console.log(e)}}})},populateOnlineFriendsAndFavorites:function(tab,data){var sectionId="";switch(tab){case"friends":sectionId="friendsOnlineList";break;case"favorites":sectionId="favoritesOnlineList"}if("false"==data)$j("."+sectionId+" .no-items-msg:first-child").show();else{var dataObj={};switch(typeof data){case"object":dataObj=data;break;case"string":break;default:try{dataObj=JSON.parse(data)}catch(ex){return void console.log(ex)}}var oldList=$j("."+sectionId+" .online-user");if(oldList.length>0&&oldList.remove(),dataObj&&dataObj.length>0){var tpl="";$j("."+sectionId+" .no-online-msg:first-child").hide(),$j("."+sectionId+" .no-items-msg:first-child").hide();for(var i=0;i<dataObj.length;i++)(tpl=$j("."+sectionId+" .user-item:nth-child(3)").first().clone(!0)).addClass("online-user"),tpl.attr("id","user-"+dataObj[i].username),tpl.attr("href","/"+dataObj[i].username),tpl.find(".user-img").attr("src",dataObj[i].defaultImageLink),tpl.find(".user-name").html(dataObj[i].username),!0===dataObj[i].HD?tpl.find(".hd-flag").show():tpl.find(".hd-flag").hide(),tpl.show(),$j("."+sectionId).append(tpl),dataObj[i].imgHandler=new Image,dataObj[i].imgHandler.uName=dataObj[i].username,dataObj[i].imgHandler.src=dataObj[i].imageLink,dataObj[i].imgHandler.onload=function(){UsersOnline.attachImage(this.uName,this.src)}}else $j("."+sectionId+" .no-online-msg:first-child").show();setTimeout(function(){UsersOnline.getOnlineFriendsAndFavorites(tab)},UsersOnline.reloadRate)}},classSplitOut:function(element,actionStyle){for(var i=0;i<element.length;i++)switch(actionStyle){case"displayBlock":element[i].style.display="block";break;case"displayNone":element[i].style.display="none"}},resetWidget:function(){UsersOnline.classSplitOut(document.querySelectorAll("."+UsersOnline.widgetDivId),"displayBlock"),document.getElementById(UsersOnline.widgetButtonId).removeAttribute("class"),document.getElementById(UsersOnline.widgetButtonId).setAttribute("class","active");for(var tabs=document.querySelectorAll(".widget-tab"),tabLists=document.querySelectorAll(".users-list"),i=0;i<tabs.length;i++)tabs[i].setAttribute("class",tabs[i].getAttribute("class").replace("active","")),tabLists[i].style.display="none";$j(".friendsTab").addClass("active"),UsersOnline.activeTab="friends",UsersOnline.initOnlineFriendsAndFavorites("friends")},closeWidget:function(){UsersOnline.classSplitOut(document.querySelectorAll("."+UsersOnline.widgetDivId),"displayNone"),document.getElementById(UsersOnline.widgetButtonId).removeAttribute("class"),UsersOnline.activeTab=""},initOnlineFriendsAndFavorites:function(tab){Cam4User.isLoggedIn&&!Cam4User.isLoggedInAsGuest&&(UsersOnline.classSplitOut(document.querySelectorAll("."+tab+"OnlineList"),"displayBlock"),UsersOnline.activeTab=tab,UsersOnline.getOnlineFriendsAndFavorites(tab))},toggleWidget:function(){if(Cam4User.isLoggedInAsGuest)Registration.activateGuestRegisterModal();else{var widgetElem="";widgetElem=document.querySelectorAll("."+UsersOnline.widgetDivId)[1];var widgetButton=document.getElementById(UsersOnline.widgetButtonId);""!==widgetElem?(UsersOnline.setClickOutside||(UsersOnline.setClickOutside=!0,document.getElementsByTagName("html")[0].onclick=function(event){var eventTarget=(event=event||window.event).target||event.srcElement;eventTarget===widgetElem||Utils.isDescendant(widgetButton,eventTarget)||Utils.isDescendant(widgetElem,eventTarget)||UsersOnline.closeWidget()}),"none"==$j(widgetElem).css("display")?(document.querySelectorAll("#admin-dark .account")[0].style.display="none",UsersOnline.resetWidget()):UsersOnline.closeWidget()):console.log("Could not find element ."+UsersOnline.widgetDivId)}},mobileTabs:function(){$j("#toggleMainMenu").on("click",function(){$j("#main").hasClass("mm-opened")&&($j(".friendsOnlineList").hide(),$j(".favoritesTab").removeClass("active"),$j(".friendsTab").addClass("active")),UsersOnline.initOnlineFriendsAndFavorites("friends")})},simpleToggle:function(){$("."+this.widgetDivId).is(":visible")?this.closeWidget():this.resetWidget()}};$j(function(){UsersOnline.mobileTabs()});
var Complaints={init:function(){Cam4User.htmlStates.indexOf("abuseForm_ftl")>-1?($j("#abuse-form input:radio[value^='chatter']").click(function(){$j("#chatter, #chatter label, #chatter input").show()}),$j("#abuse-form input:radio:not([value^='chatter'])").click(function(){$j("#chatter, #chatter label, #chatter input").hide()}),$j(".abuse-popup.ui-dialog").css({position:"fixed"})):($j("#openAbuseBtn").hide(),$j("#MobileMenuNavigator option[value=open_abuse_form]").remove())},submitData:function(event){if(void 0===$j('input[name="abuseType"]:checked').val())return!1;var postData=$j("#abuse-form form").serializeArray(),formURL=$j("#abuse-form form").attr("action");$j.ajax({url:formURL,type:"POST",data:postData,dataType:"html",success:function(data,textStatus,jqXHR){console.log("Abuse-Form: data sent successfully"),$j("#output1").html(data),setTimeout(function(){Complaints.closeAbuseForm()},3e3)},error:function(jqXHR,textStatus,errorThrown){console.log("Abuse-Form: data submit FAILED - "+textStatus+" "+errorThrown)}});var evt=event||window.event;evt.preventDefault&&evt.preventDefault(),evt.returnValue=!1},closeAbuseForm:function(){Utils.closeModalPops();try{$j("#abuse-form").dialog("close")}catch(ex){}return!1},responsive_openAbuseForm:function(reportedUserId,status,extraData){try{JsReceiver.playerInFs&&(FullScreenApi.exitFullScreen(),FullScreenApi.playerStyleReset(),$j("#abuse-form .modal-header").css("padding","0px"))}catch(ex){console.log(ex)}if(this.modalHtml||document.getElementById("abuse-form")&&(this.modalHtml=document.getElementById("abuse-form").outerHTML,$("#abuse-form").remove()),document.getElementById("abuse-form")||Complaints.modalHtml){var modalLayout=$("#modalLayout");modalLayout.find(".modal-content").empty().append(Complaints.modalHtml);var reportedUsername=$j("#headerUsername").text();$j("#abuse-form").find('input[name="reportedUsername"]').val(reportedUsername),$("#abuse-form").show(),modalLayout.modal()}},openAbuseForm:function(reportedUserId,status,extraData){Utils.closeModalPops(),Complaints.responsive_openAbuseForm(reportedUserId,status,extraData)},makeChoiceAbuse:function(){for(var val=0,nrItems=document.reporAbuse.abuseType.length,i=0;i<nrItems;i++)!0===document.reporAbuse.abuseType[i].checked&&(val=document.reporAbuse.abuseType[i].value,document.getElementById("BroadcasterAmount").style.display="none",document.getElementById("inappropriateContentSubtypes").style.display="none",document.getElementById("commentBoxTitle").style.display="block","broadcasterTippingFraud"==val&&(document.getElementById("BroadcasterAmount").style.display="block",document.getElementById("commentBoxTitle").style.display="none"),"inappropriateContent"==val&&(document.getElementById("inappropriateContentSubtypes").style.display="block",$("#abuseSubtypes").selectpicker()))},statusMessageCensoredWord:function(id,string){$j.ajax({url:"/profiles/reportAbuse",data:{abuseType:"inappropriateContent",abuseSubtype:"other",abuseComment:"status "+string,broadcasterId:id,reportedUserId:id},type:"post",success:function(result){console.log(result)}})}};"undefined"!=typeof JsReceiver&&(JsReceiver.statusMessageCensoredWord=Complaints.statusMessageCensoredWord,JsReceiver.openAbuseForm=Complaints.openAbuseForm),$j(function(){Complaints.init()}),$j("#report-abuse").click(function(event){Complaints.openAbuseForm("","broadcaster")}),$j(function(){$j(".restoreButton").click(function(){$j(".checkChoice input").attr("checked","checked"),$j(".tabsDisplayButtons .saveButton").trigger("click")})});
var EpayPlugin={};EpayPlugin.dom={targetDivID:"epayTool",preContainer:"#epayContainer",containerDivID:"#epayInnerContainer",productsViewSelector:".in-products-view",methodsViewSelector:".in-methods-view",membershipsViewSelector:".in-memberships-view",epayExtraSelector:".epay-extra-content",modalDialogContainer:"#Cam4DialogContainer .modal-dialog",buyTokensButton:"#buyTokensButton",newOverlayClass:"new-overlay",guestTitleGoldPrice:"#guestTitleGoldPrice",guestTitleBonusPromo:"#guestTitleBonusPromo",disclaimerGold:"#disclaimer-gold",paymentForm:"#paymentForm",submitWindow:null,goldOverlayClass:"gold-overlay-no-conflict"},EpayPlugin.getDeviceName=function(){return["Desktop","Tablet","Mobile"].filter(function(device){return!0===UserAgent[device.toLowerCase()]})[0]},EpayPlugin.guestGoldMembership=null,EpayPlugin.useNewTokensOverlay=ControlledFeatures&&ControlledFeatures.USE_NEW_TOKENS_OVERLAY,EpayPlugin.newGoldOverlay=ControlledFeatures&&ControlledFeatures.NEW_GOLD_OVERLAY,EpayPlugin.toggleNewOverlayClass=function(flag){flag?$j(EpayPlugin.dom.modalDialogContainer).find(EpayPlugin.dom.containerDivID).addClass(EpayPlugin.dom.newOverlayClass).end().addClass("modal-new"):$j(EpayPlugin.dom.modalDialogContainer).find(EpayPlugin.dom.containerDivID).removeClass(EpayPlugin.dom.newOverlayClass).end().removeClass("modal-new")},EpayPlugin.toggleGoldOverlayClass=function(flag){flag?$j(EpayPlugin.dom.modalDialogContainer).find(EpayPlugin.dom.containerDivID).addClass(EpayPlugin.dom.goldOverlayClass).end().addClass("modal-gold"):$j(EpayPlugin.dom.modalDialogContainer).find(EpayPlugin.dom.containerDivID).removeClass(EpayPlugin.dom.goldOverlayClass).end().removeClass("modal-gold")},EpayPlugin.ui={displayProductsViewContent:function(){$j(EpayPlugin.dom.containerDivID+" "+EpayPlugin.dom.epayExtraSelector).hide(),$j(EpayPlugin.dom.containerDivID+" "+EpayPlugin.dom.productsViewSelector).show()},displayMethodsViewContent:function(){$j(EpayPlugin.dom.containerDivID+" "+EpayPlugin.dom.epayExtraSelector).show(),$j(EpayPlugin.dom.containerDivID+" "+EpayPlugin.dom.productsViewSelector).hide()},displayMembershipsViewContent:function(){$j(EpayPlugin.dom.containerDivID+" "+EpayPlugin.dom.membershipsViewSelector).show(),$j(EpayPlugin.dom.containerDivID+" "+EpayPlugin.dom.epayExtraSelector).hide()},close:function(){Utils.closeModalPops()},isVisible:function(){return $j(EpayPlugin.dom.containerDivID).is(":visible")}},EpayPlugin.settings={id:EpayPlugin.dom.targetDivID,lang:Cam4User.lang,country:Cam4User.countryCode,domainPrefix:DOMAIN_PREFIX,apiBaseUrl:EPAY_SERVER+"/rest/v1",cdnBaseUrl:WEB_CDN,args:{userName:Cam4User.userName,requestBodyData:{accessHash:Cam4User.kN,email:Cam4User.isLoggedIn||Cam4User.isLoggedInAsGuest?Cam4User.email:"",country:Cam4User.profileCountry,city:Cam4User.profileCity,siteSubcat:DOMAIN_NAME,originalDomain:window.location.origin,userAgent:UserAgent.phone?"mobile":"",returnPath:"/checkout",device:EpayPlugin.getDeviceName()},passThrough:{membershipOperation:PASS_THROUGH_PARAMS.membershipOperation,linkCode:PASS_THROUGH_PARAMS.linkCode,pageVersion:PASS_THROUGH_PARAMS.pageVersion,packageName:PASS_THROUGH_PARAMS.packageName}},hasMembershipBonus:Cam4User.hasMembershipBonus>0},Cam4User.couponCodeForTokenBonus&&(EpayPlugin.settings.args.passThrough.additional={bonusId:Cam4User.couponCodeForTokenBonus}),EpayPlugin.createSubmissionForm=function(data){"CC"==data.paymentType&&(data.paymentType=""),data.pagef="details",data.clearCheckout="true",data.resetTrackingId="true",data.return_path="/checkout";var form=document.createElement("form");form.setAttribute("id","epaySubmitForm"),form.setAttribute("name","epaySubmitForm"),form.setAttribute("method","POST"),form.setAttribute("action","/checkout/"+data.productType.toLowerCase()+"/method"),form.setAttribute("style","display: none");for(var k in data){var field=document.createElement("input");field.setAttribute("name",k),field.setAttribute("value",data[k]),form.appendChild(field)}var submitBtn=document.createElement("button");return submitBtn.setAttribute("id","epaySubmitBtn"),submitBtn.setAttribute("type","submit"),submitBtn.setAttribute("value","send"),submitBtn.innerHTML="TEST",form.appendChild(submitBtn),form},EpayPlugin.onSubmit=function(obj){if(dataLayer.push({event:"epayTransactionSubmit"}),EpayPlugin.ui.close(),"function"!=typeof epay.tool.handleTransactionSubmission){var data={paymentType:obj.method.type,processorId:obj.method.processorId,priceId:obj.product.id,productType:obj.product.type},formElem=EpayPlugin.createSubmissionForm(data);document.body.appendChild(formElem),EpayPlugin.dom.submitWindow&&!EpayPlugin.dom.submitWindow.closed&&(EpayPlugin.dom.submitWindow.close(),EpayPlugin.dom.submitWindow=null),EpayPlugin.dom.submitWindow=CheckoutTokens.submitInNewWindow(formElem),EpayPlugin.dom.submitWindow.focus()}},EpayPlugin.createGuestAccount=function(callback){var request=new XMLHttpRequest;request.open("POST","/checkout",!1),request.onreadystatechange=function(){if(4==request.readyState){var res=JSON.parse(request.response);Cam4User.userName=res.userName,Cam4User.guestUserName=res.userName,Cam4User.kN=res.token,EpayPlugin.settings.args.userName=res.userName,EpayPlugin.settings.args.requestBodyData.accessHash=res.token,Cam4User.userFirebaseShard=res.firebaseShard,Cam4User.userFirebaseToken=res.webFirebaseToken;try{Cam4UserNotifications.init()}catch(ex){console.error(ex)}"function"==typeof callback&&callback({userName:res.userName,accessHash:res.token})}},request.setRequestHeader("Content-type","application/x-www-form-urlencoded"),request.send("isGuestRegister=true")},EpayPlugin.handleSingleMethod=function(){if(epay.globals.selectedProductObj){var obj={method:{type:"",processorId:epay.globals.selectedProductObj.categories[0].methods[0].processorId},product:{id:epay.globals.selectedProductObj.id,type:epay.globals.selectedProductObj.type}};EpayPlugin.onSubmit(obj)}else console.error("No product selected..")},EpayPlugin.checkIfSingleMethod=function(){return epay.globals.selectedProductObj&&1==epay.globals.selectedProductObj.categories.length&&1==epay.globals.selectedProductObj.categories[0].methods.length},EpayPlugin.handleErrorReasons=function(){switch($j("#"+EpayPlugin.dom.targetDivID).html()){case"UPSELL_REQUIRED":return Registration.activateGuestRegisterModal(),!1;case"LOGIN_REQUIRED":return Utils.closeModalPops(),setTimeout(function(){LoginModals.activateLoginModal()},1e3),!1;case"ALREADY_HAS_MEMBERSHIP":return $j("#"+EpayPlugin.dom.targetDivID).html(js_i18n.epayMessages.alreadyGold),$j("#"+EpayPlugin.dom.targetDivID).addClass("alert-msg"),!1;default:return!0}},EpayPlugin.renderTokenPackages=function(callback){if(epay)if(0!=$j("#"+EpayPlugin.dom.targetDivID).length){if("undefined"!=typeof dataLayer){var tags;tags="undefined"!=typeof Cam4Analytics?Cam4Analytics.getCurrentTags():"NA",dataLayer.push({event:"BuyTokensOverlay",eventCategory:"tipping",eventLabel:tags})}Utils.displayModalLoadingLogo();var options=Utils.getObjectAsCopy(EpayPlugin.settings);ControlledFeatures.PAY_PAL_OPTIMIZATION?(options.customTemplate={products:EpayPlugin.newGoldOverlay?epay.templates.ProductsTemplateV4:epay.templates.ProductsTemplateV3},~[AccessLevel.UNVERIFIED,AccessLevel.GUEST,AccessLevel.GENERAL].indexOf(Cam4User.accessLevel)&&(options.customTemplate.showUpgradeToGoldOffer=!0,"BLACK_FRIDAY_2019"===Campaigns.activeCampaignName&&(options.customTemplate.upgradeToGoldPercentage=15))):options.customTemplate={products:epay.templates.ProductsTemplateV2},Cam4User.isPayingMember()||!Cam4User.isLoggedIn||EpayPlugin.newGoldOverlay?options.view="TOKENS":options.view="TOKENS-MEMBERSHIP",options.isGoldUser=EpayPlugin.newGoldOverlay&&Cam4User.accessLevel>=30,options.onContentReady=function(){EpayPlugin.ui.displayProductsViewContent(),Utils.popPreloadedContent($j(EpayPlugin.dom.preContainer).html(),function(){if(EpayPlugin.handleErrorReasons()){try{EpayPlugin.loadCampaignContent()}catch(ex){console.log(ex)}EpayPlugin.useNewTokensOverlay?EpayPlugin.toggleNewOverlayClass(!0):EpayPlugin.toggleNewOverlayClass(!1),EpayPlugin.newGoldOverlay?EpayPlugin.toggleGoldOverlayClass(!0):EpayPlugin.toggleGoldOverlayClass(!1)}}),"undefined"!=typeof $j&&$j.fn.selectpicker&&EpayPlugin.newGoldOverlay&&($j("#method_dropdown").selectpicker(),$j("button.selectpicker").removeAttr("title"))},options.onSubmitProduct=function(){EpayPlugin.useNewTokensOverlay&&EpayPlugin.toggleNewOverlayClass(!1),EpayPlugin.newGoldOverlay&&EpayPlugin.toggleGoldOverlayClass(!1),EpayPlugin.checkIfSingleMethod()?EpayPlugin.handleSingleMethod():(EpayPlugin.ui.displayMethodsViewContent(),epay.tool.renderPaymentMethods())},options.onBeforeSubmit=""!=Cam4User.userName&&""!=Cam4User.kN?null:EpayPlugin.createGuestAccount,options.onSubmit=EpayPlugin.onSubmit,Campaigns&&Campaigns.details&&(options.campaignDetails=Campaigns.details),"undefined"!=typeof optionalParametersForTokens&&(options.args.optionalParametersForTokens=optionalParametersForTokens),EpayPlugin.newGoldOverlay&&(options.newGold=!0),~[AccessLevel.UNVERIFIED,AccessLevel.GUEST,AccessLevel.GENERAL].indexOf(Cam4User.accessLevel)&&"BLACK_FRIDAY_2019"===Campaigns.activeCampaignName&&(options.customTemplate.showUpgradeToGoldOffer=!0,options.customTemplate.upgradeToGoldPercentage=15),epay.tool.render(options)}else console.error("Element with ID "+EpayPlugin.dom.targetDivID+" was not found.");else console.error("epay plugin is not available!")},EpayPlugin.renderMemberships=function(){if(EpayPlugin.ui.close(),~[AccessLevel.UNVERIFIED,AccessLevel.GUEST].indexOf(Cam4User.accessLevel))Utils.decideOffer("",{pageType:"gold",contextClass:"remove-ads"});else{Utils.displayModalLoadingLogo();var options=Utils.getObjectAsCopy(EpayPlugin.settings);options.view="MEMBERSHIP",options.onContentReady=function(){EpayPlugin.ui.displayMembershipsViewContent();var content=$j(EpayPlugin.dom.preContainer);"undefined"!=typeof optionalParametersForTokens&&optionalParametersForTokens.campaign&&(content=content.find(".epay-memberships > .msg:eq(1)").hide().end()),Utils.popPreloadedContent(content.html(),function(){if(EpayPlugin.handleErrorReasons()){var productElements=$j(EpayPlugin.dom.modalDialogContainer).find(".price-tier");$j(EpayPlugin.dom.modalDialogContainer).addClass("modal-md"),productElements.click(function(){$(this).find("input[name=priceId]").removeAttr("checked").prop("checked",!0),$(this).addClass("active"),$(this).siblings().removeClass("active")}),1==productElements.length&&productElements[0].click();try{EpayPlugin.loadCampaignContent()}catch(ex){console.log(ex)}}})},options.onSubmitProduct=function(data){$j(EpayPlugin.dom.modalDialogContainer).removeClass("modal-md"),EpayPlugin.checkIfSingleMethod()?EpayPlugin.handleSingleMethod():(EpayPlugin.ui.displayMethodsViewContent(),epay.tool.renderPaymentMethods())},options.onSubmit=EpayPlugin.onSubmit,epay.tool.render(options)}},EpayPlugin.attachGuestToGoldFunnel=function(){if(!Cam4User.isLoggedIn){var queryArgs={siteSubcat:EpayPlugin.settings.args.requestBodyData.siteSubcat},membershipType="TOKENS-MEMBERSHIP";"object"==typeof optionalParametersForTokens&&optionalParametersForTokens.campaign&&(queryArgs.campaign=!0,membershipType="MEMBERSHIP"),epay.ApiService.getEpayData(Cam4User.lang,membershipType,EpayPlugin.settings.apiBaseUrl,queryArgs,function(obj){if(queryArgs.campaign&&$("#formTitlePromo").hide(),obj.status&&"ERROR"==obj.status)Cam4User.isLoggedInAsGuest?Registration.activateGuestRegisterModal():Registration.activateRegModal("/gold?showSignupForm=true&type=modal");else{for(var goldBonusAmount,tknPackages=[],i=0;i<obj.products.length;i++)"MEMBERSHIP"==obj.products[i].type?EpayPlugin.guestGoldMembership=obj.products[i]:tknPackages.push(obj.products[i]);for(i=0;i<tknPackages.length;i++)tknPackages[i].quantity==EpayPlugin.guestGoldMembership.details.bonus&&(goldBonusAmount=Math.ceil(tknPackages[i].amount));var titlePrice=$j(EpayPlugin.dom.guestTitleGoldPrice);titlePrice.find(".gold-currency").html(EpayPlugin.guestGoldMembership.currency.symbol),titlePrice.find(".gold-full-price").html(EpayPlugin.guestGoldMembership.amount);var titlePromo=$j(EpayPlugin.dom.guestTitleBonusPromo);titlePromo.find(".gold-bonus-tokens").html(EpayPlugin.guestGoldMembership.details.bonus),titlePromo.find(".gold-bonus-currency").html(EpayPlugin.guestGoldMembership.currency.symbol),titlePromo.find(".gold-bonus-amount").html(goldBonusAmount),$j(EpayPlugin.dom.disclaimerGold).find(".gold-bonus-tokens").html(EpayPlugin.guestGoldMembership.details.bonus);var paymentForm=$j(EpayPlugin.dom.paymentForm);paymentForm.find("input[name=processorId]").val(EpayPlugin.guestGoldMembership.categories[0].methods[0].processorId),paymentForm.find("input[name=priceId]").val(EpayPlugin.guestGoldMembership.id)}})}},EpayPlugin.createUserBeforeGold=function(postData,callback){epay.DomMan.submissionWindow&&epay.DomMan.submissionWindow.close();var winSpecs=epay.tool.determineCheckoutWindowSpecs(postData.processorId,"CC");epay.DomMan.submissionWindow=epay.DomMan.preOpenCheckoutWindow(winSpecs);var queryData=[];for(var k in postData)queryData.push(encodeURIComponent(k)+"="+encodeURIComponent(postData[k]));var request=new XMLHttpRequest;request.open("POST","/goldProcessorRedirect",!1),request.onreadystatechange=function(){4==request.readyState&&"function"==typeof callback&&callback(JSON.parse(request.response))},request.setRequestHeader("Content-type","application/x-www-form-urlencoded"),request.send(queryData.join("&"))},EpayPlugin.submitGuestToGold=function(data,callback){var opts=Utils.getObjectAsCopy(EpayPlugin.settings);opts.args.userName=data.userName,opts.args.requestBodyData.email=data.email,opts.args.requestBodyData.accessHash=data.accessHash?data.accessHash:Cam4User.kN,opts.args.requestBodyData.country=Cam4User.countryCode.toUpperCase(),opts.args.requestBodyData.city="";var submitObj={method:{type:"CC",processorId:data.processorId},product:EpayPlugin.guestGoldMembership};epay.tool.handleTransactionSubmission(submitObj,opts,callback)},EpayPlugin.loadCampaignContent=function(){if(!Campaigns||Campaigns.activeCampaignName)switch(Campaigns.activeCampaignName){case"SUMMER_TOKENS":Campaigns.promoText&&Campaigns.promoText.bonusTokens&&$j(EpayPlugin.dom.containerDivID).find(".header-msg").after('<span class="promo-msg">'+Campaigns.promoText.bonusTokens+"</span>");break;case"BONUS_TOKENS":case"BONUS_TOKENS_GOLD":case"HALLOWEEN_TOKENS_GOLD":EpayPlugin.useNewTokensOverlay||(Campaigns&&Campaigns.details?($j(EpayPlugin.dom.containerDivID).find(".header-wrap.in-products-view").addClass("campaign-header-wrap"),$j(EpayPlugin.dom.containerDivID).find(".standard-header").hide(),$j(EpayPlugin.dom.containerDivID).find(".promo-header").show()):($j(EpayPlugin.dom.containerDivID).find(".header-wrap.in-products-view").removeClass("campaign-header-wrap"),$j(EpayPlugin.dom.containerDivID).find(".promo-header").hide(),$j(EpayPlugin.dom.containerDivID).find(".standard-header").show()));break;case"GOLD_HOLIDAY":var modalEpayContent=$j(EpayPlugin.dom.modalDialogContainer).find(".epay-content");if(!modalEpayContent.hasClass("epay-memberships"))return;modalEpayContent.find(".price-tier:first").addClass("holiday-promo"),modalEpayContent.find(".price-tier:first").find(".savings").html(js_i18n.epayMessages.savePercentage.replace("{0}",Campaigns.details.discountPercent))}},EpayPlugin.disableActiveCampaign=function(){if(!Campaigns||Campaigns.activeCampaignName)switch(Campaigns.activeCampaignName){case"BONUS_TOKENS":var buyBtn=$j(EpayPlugin.dom.buyTokensButton);buyBtn.removeClass("blink"),buyBtn.find(".standard-button").show(),buyBtn.find(".campaign-badge").hide(),Campaigns&&Campaigns.details&&delete Campaigns.details}},EpayPlugin.getFanclubProduct=function(performer,amount){return epay.ApiService.getFanclubProduct({apiBaseUrl:EpayPlugin.settings.apiBaseUrl,lang:EpayPlugin.settings.lang,args:{userName:Cam4User.userName,accessHash:Cam4User.kN,target:performer,amount:amount}})},EpayPlugin.buyFanclubSubscription=function(response,performer,amount,accessHash,userName,callback){var product=response.products,processorId=product[0].categories[0].methods[0].processorId,postData={product:product[0],processorId:processorId,method:{processorId:processorId}},opts={apiBaseUrl:EpayPlugin.settings.apiBaseUrl,lang:EpayPlugin.settings.lang,args:{userName:userName,requestBodyData:{userName:userName,accessHash:accessHash,target:performer,amount:amount,siteSubcat:DOMAIN_NAME,originalDomain:window.location.origin,returnPath:"/checkout",device:EpayPlugin.getDeviceName()}}},receiptWindow=epay.DomMan.preOpenCheckoutWindow(epay.tool.determineCheckoutWindowSpecs(processorId,"FANCLUB"));epay.tool.handleTransactionSubmission(postData,opts,callback,function(response){receiptWindow.close(),callback(response)})},$j(document).ready(function(){WaitFor.dependencies(["jQuery","epay"],function(){if(epay.tool.setConfig({pluginCDN:EPAY_PLUGIN_LOCATION}),epay.EpayLang.load(Cam4User.lang,Cam4User.countryCode,EpayPlugin.settings.domainPrefix),"goldUpgrade"==PageStatus.sourcePage){var queryArgs={siteSubcat:EpayPlugin.settings.args.requestBodyData.siteSubcat};epay.ApiService.getEpayData(Cam4User.lang,"TOKENS-MEMBERSHIP",EpayPlugin.settings.apiBaseUrl,queryArgs,function(obj){for(var i=0;i<obj.products.length;i++)if("MEMBERSHIP"==obj.products[i].type){var symbol=obj.products[i].currency.symbol;$j("#fullGoldAmount").text(symbol+obj.products[i].amount),$j("#fullGoldSymbol").text(symbol);break}})}epay.EpayEvent.addEventListener(epay.EpayEvent.CHANGE_METHOD,function(){$j.fn.selectpicker&&EpayPlugin.newGoldOverlay&&window.setTimeout(function(){$j("#method_dropdown").selectpicker(),$j("button.selectpicker").removeAttr("title")},0)})})});
var Modals={featureReminderExpireTime:6048e5,openAllUnbundledFeaturesModal:function(){try{var modalLayout=$("#modalLayout");return modalLayout.html($j("#goldfeats").html()),modalLayout.modal("show"),Cam4Event.dispatch(Cam4Event.MODAL_OPENED),!0}catch(ex){return!1}},openTabooCamsPromo:function(){try{var modalHtml='<div class="modal-dialog modal-md" id="tabooCamsPromo"><div class="modal-content"><div class="modal-body"><p id="congratulations-header">'+TabooCamsStrings.promoHeader+"</p><p>"+TabooCamsStrings.paragraph1+"</p><p>"+TabooCamsStrings.paragraph2+"</p></div></div></div>";$("#modalLayout").html(modalHtml).modal("show"),Cam4Event.dispatch(Cam4Event.MODAL_OPENED)}catch(ex){console.log(ex)}},sendViewedNewGoldOverlay:function(){AjaxSender.send({method:"POST",url:"/goldIntroductionOverlay",data:"",success:function(){console.log("newGoldOverlay has been viewed!")},onerror:function(err){console.log(err)},onexception:function(ex){console.log(ex)}})},openSingleFeatureRequest:function(featureCode){var options={top:"20px"};Utils.popWithAjaxContent("/features?overlay="+featureCode,options,!1,function(){$j("#featureOrderDashboard").parents(".modal-dialog").addClass("feature-single"),FeatureOrder.initDashboard()}),Cam4Cookies.setCookie("mostRecentlyAttemptedFeature",featureCode,Modals.featureReminderExpireTime)},openFeatureSwapOffer:function(featureCode,clbk){var options={top:"20px"};Utils.popWithAjaxContent("/features?overlay=SWAP&featureToSwap="+featureCode,options,!1,function(response){$j("#featureSwapDashboard").parents(".modal-dialog").addClass("feature-single"),clbk&&clbk(response)})},openAllFeaturesDashboard:function(){function _overlayCallback(){FeatureOrder.initDashboard(),FeatureOrder.markBestPaired();var mostRecentFeature=Cam4Cookies.getCookie("mostRecentlyAttemptedFeature");mostRecentFeature&&FeatureOrder.addItemToCart(mostRecentFeature,"purchase")}var options={top:"20px"};Utils.popWithAjaxContent("/features?overlay=ALL",options,!1,function(){$j("#featureOrderDashboard").parents(".modal-dialog").addClass("feature-order"),_overlayCallback()})},openMostRecentLockedFeature:function(){var mostRecentFeature=Cam4Cookies.getCookie("mostRecentlyAttemptedFeature");mostRecentFeature&&Modals.openSingleFeatureRequest(mostRecentFeature)},underAgeModalContent:$j(".error-modal-content").detach(),openUnderAgeModal:function(){var errorModal=this.underAgeModalContent,modalLayout=$j("#modalLayout");errorModal.removeClass("hidden"),modalLayout.find(".modal-content").empty().append(errorModal.html()),modalLayout.modal(),Cam4Event.dispatch(Cam4Event.MODAL_OPENED)}};$j(document).ready(function(){try{var mostRecentFeature=Cam4Cookies.getCookie("mostRecentlyAttemptedFeature");mostRecentFeature&&!Cam4User.userFeatures.hasOwnProperty(mostRecentFeature)?$j("#admin-dark .upgrade-btn .reminder").show():$j("#admin-dark .upgrade-btn .reminder").hide()}catch(ex){console.log(ex)}});
var ProfileModalMessage=function(){function isBlank(str){return!str||/^\s*$/.test(str)}function showItem(num){$j("#openMailBoxButton").hide(),$j("#messageStatus").show(),$j("#messageStatus .mailStatus").hide(),$j($j("#messageStatus .mailStatus")[num]).show()}function hideItems(){$j("#openMailBoxButton").show(),$j("#messageStatus").hide(),$j("#send_message").hide(),Utils.closeModalPops()}var allowSendMail=!0;this.responsiveHTML=!1;var self=this;return{send:function(){if(idVerificationEnabled||"pending"!==Cam4User.broadcasterStatusCached){allowSendMail=!1;var data=new Object,idSelector="sendPrivateMsgForm";data.username=$j("#"+idSelector+" input[name=username]").val(),data.subject=$j("#"+idSelector+" input[name=subject]").val(),data.redirect=$j("#"+idSelector+" input[name=redirect]").val(),data.message=$j("#"+idSelector+" textarea").val(),isBlank(data.message)||allowSendMail?($j("#sendPrivateMsgForm textarea").val(""),allowSendMail=!0):(showItem(1),$j("#"+idSelector+" button").attr("disabled"),$j("#"+idSelector+" button").addClass("disabled"),$j.ajax({type:"POST",url:"/mail",data:data,error:function(err,status,errThrown){showItem(2),allowSendMail=!0,console.log("ajax err ",err),$j("#"+idSelector+" button").removeAttr("disabled"),$j("#"+idSelector+" button").removeClass("disabled")},success:function(result){if(allowSendMail=!0,"code"in result)switch(result.code){case"ERROR_PENDING_BROADCASTER":$j("#openMailBoxButton").show(),$j("#messageStatus").hide(),$j("#send_message").hide(),Modals.openUnderAgeModal();break;case"ERROR_MESSAGE_LIMIT":allowSendMail=!1,Registration.showGoldUpgradeOverlay("newinbox-throttle");break;default:showItem(0),hideItems()}else showItem(0),hideItems();$j("#"+idSelector+" button").removeAttr("disabled"),$j("#"+idSelector+" button").removeClass("disabled")}}))}else Modals.openUnderAgeModal()},open:function(username){if(Cam4User.isLoggedInAsGuest)Registration.activateGuestRegisterModal();else if(idVerificationEnabled||"pending"!==Cam4User.broadcasterStatusCached){self.responsiveHTML||(self.responsiveHTML=$("#send_message").html(),$("#send_message").remove());var innerText=JsVar.map(self.responsiveHTML,{username:username,title:js_i18n.sendingMessageTo});$("#modalLayout").find(".modal-content").empty().append(innerText).end().modal(),Cam4Event.dispatch(Cam4Event.MODAL_OPENED)}else Modals.openUnderAgeModal()}}}();"undefined"!=typeof JsReceiver&&(JsReceiver.openSendInboxMessagePopup=ProfileModalMessage.open),Utils.openSendInboxMessagePopup=ProfileModalMessage.open;
$j(document).ready(function(){-1!=Cam4User.htmlStates.indexOf("payment_options_ftl")&&($j("#autoReloadEnable").length>0&&($j("#autoReloadEnable").change(function(){this.checked?(AutoReload.toggleSettings(!0),0==$j("input[name=enableOneClick]").is(":checked")&&$j("input[name=enableOneClick]").prop("checked",!0)):AutoReload.toggleSettings(!1)}),$j("#enableOneClick").change(function(){this.checked||$j("#autoReloadEnable").is(":checked")&&($j("#autoReloadEnable").prop("checked",!1),AutoReload.toggleSettings(!1))})),$j("#acceptRiskTokens").length>0&&($j("#acceptRiskTokens").change(function(){this.checked&&0==$j("#receiveTips").is(":checked")&&$j("#receiveTips").prop("checked",!0)}),$j("#receiveTips").change(function(){this.checked||1==$j("#acceptRiskTokens").is(":checked")&&$j("#acceptRiskTokens").prop("checked",!1)})))});
var FeatureReporting={sendUsageAttempt:function(featureId,attemptType){if(void 0===attemptType&&(attemptType="USE"),Cam4User.useUnbundling){switch(featureId){case"C4BND_UNLIMITED_SAVED_SEARCHES":if(null==document.getElementById("savedSearches"))return;if(document.getElementById("savedSearches").getElementsByTagName("li").length<Directory.loggedInUserSearchLimit)return}try{var smsUrl=SMS_SERVER+"/sms/webcontent/index/FeatureTrackingAPI.php",data="feature_id="+featureId+"&locked=1&event="+attemptType+"&user_name="+Cam4User.userName;AjaxSender.send({method:"POST",url:smsUrl,data:data,onerror:function(err){console.log(err)},onexception:function(ex){console.log(ex)}})}catch(ex){console.log(ex)}}else"C4BND_UNLIMITED_SAVED_SEARCHES"!==featureId||Cam4User.isLoggedIn||activateOverlayItself("/gold?overlay=1&pageVersion=initSignup")}};
var FeatureOrder={userTierType:"",cartList:{},bestPairedFeatures:{},getBestPairedFeatures:function(callback){for(var obj=document.getElementsByClassName("bestPaired-instance"),k=0;k<obj.length;k++)FeatureOrder.bestPairedFeatures[obj[k].getAttribute("name")]=obj[k].getAttribute("value");callback&&callback()},resetFirstOfTier:function(){for(var items=document.querySelectorAll(".feat-item"),k=0;k<items.length;k++)Utils.removeClassNative(items[k],"first-of-tier")},markItemAsAdded:function(featureCode,addType){FeatureOrder.resetFirstOfTier();var itemElementId="featureItem-"+featureCode;switch(addType){case"purchase":default:document.querySelectorAll("#"+itemElementId+" .feat-actions .btn-green")[0].style.display="none",document.querySelectorAll("#"+itemElementId+" .feat-actions .active")[0].style.display="inline-block",document.querySelectorAll("#"+itemElementId+" .feat-actions .delete")[0].style.display="inline-block";var itemElem=document.getElementById(itemElementId);if(!itemElem)return;-1!=itemElem.getAttribute("class").indexOf("buy")&&Utils.removeClassNative(itemElem,"buy"),-1==itemElem.getAttribute("class").indexOf("in-cart")&&Utils.addClassNative(itemElem,"in-cart")}},resetFeatureItem:function(featureCode,addType){FeatureOrder.resetFirstOfTier();var itemElementId="featureItem-"+featureCode,itemElem=document.getElementById(itemElementId);if(itemElem)switch(addType){case"purchase":default:document.querySelectorAll("#"+itemElementId+" .feat-actions .btn-green")[0].style.display="inline-block",document.querySelectorAll("#"+itemElementId+" .feat-actions .active")[0].style.display="none",document.querySelectorAll("#"+itemElementId+" .feat-actions .delete")[0].style.display="none",-1!=document.getElementById(itemElementId).getAttribute("class").indexOf("in-cart")&&Utils.removeClassNative(itemElem,"in-cart"),-1==document.getElementById(itemElementId).getAttribute("class").indexOf("buy")&&Utils.addClassNative(itemElem,"buy")}},getTierTypeOfList:function(listObj){var tier="";if(Utils.sizeOfObject(listObj)>0)for(var k in listObj)if("BOTTOM"===listObj[k].tierType&&(tier="BOTTOM"),"TOP"===listObj[k].tierType){tier="TOP";break}return tier},getOwnedTierType:function(){return FeatureOrder.getTierTypeOfList(FeatureOrder.getOwnedFeatures(!0))},getCartTierType:function(){return FeatureOrder.getTierTypeOfList(FeatureOrder.cartList)},updateCurrentTierType:function(){var cartTier=FeatureOrder.getCartTierType(),ownedTier=FeatureOrder.getOwnedTierType();switch(cartTier){case"TOP":FeatureOrder.userTierType=cartTier;break;case"BOTTOM":FeatureOrder.userTierType="TOP"==ownedTier?ownedTier:cartTier;break;case"":default:FeatureOrder.userTierType=ownedTier}},getCurrentTierType:function(){if(""!=FeatureOrder.userTierType)return FeatureOrder.userTierType;var cartTier=FeatureOrder.getCartTierType(),ownedTier=FeatureOrder.getOwnedTierType();switch(cartTier){case"TOP":return cartTier;case"BOTTOM":return"TOP"==ownedTier?ownedTier:cartTier;case"":default:return ownedTier}},updateFeaturesDiscount:function(){for(var currentTier=FeatureOrder.getCurrentTierType(),ownedTier=FeatureOrder.getOwnedTierType(),featureItems=document.querySelectorAll("#buyFeaturesContent .feat-item"),i=0;i<featureItems.length;i++)if(-1==featureItems[i].getAttribute("class").indexOf("first-of-tier"))switch(currentTier){case"":featureItems[i].getElementsByClassName("price-display")[0].innerHTML=featureItems[i].getElementsByClassName("price_default")[0].value;break;case"BOTTOM":featureItems[i].getElementsByClassName("price-display")[0].innerHTML=featureItems[i].getElementsByClassName("price_bottom")[0].value;break;case"TOP":featureItems[i].getElementsByClassName("price-display")[0].innerHTML=featureItems[i].getElementsByClassName("price_top")[0].value}else featureItems[i].getElementsByClassName("price-display")[0].innerHTML="BOTTOM"==ownedTier?featureItems[i].getElementsByClassName("price_bottom")[0].value:featureItems[i].getElementsByClassName("price_default")[0].value;FeatureOrder.adjustPricesOverMaxDifference()},getMaxPrice:function(){return 1*(1*document.getElementsByName("maxAllowedBundlePrice")[0].value).toFixed(2)},toggleDeactivateDialog:function(){var dialog=document.getElementById("confirmDialog");"none"==dialog.style.display?dialog.style.display="block":dialog.style.display="none"},toggleErrorDialog:function(){var dialog=document.getElementById("errorDialog");"none"==dialog.style.display?dialog.style.display="block":dialog.style.display="none"},toggleGoldOption:function(ownedTotal){if(document.getElementById("getGoldBox")){var priceStepLow=FeatureOrder.getMaxPrice()-document.getElementsByName("preMaxDiff_2")[0].value;document.getElementById("getGoldBox").style.display=ownedTotal>=priceStepLow?"block":"none"}},adjustPromotionMessage:function(currentTotal){function _toggleMsg(msgKey){if("HIDE_ALL"!=msgKey){promoMessages[msgKey].style.display="block";for(var k in promoMessages)k!=msgKey&&(promoMessages[k].style.display="none")}else for(var k in promoMessages)promoMessages[k].style.display="none"}if(!document.getElementById("featureOrderDashboard").getAttribute("class")||-1==document.getElementById("featureOrderDashboard").getAttribute("class").indexOf("single")){var promoMessages={standard:document.querySelector("#blueInfoBox .default"),getItAll_1:document.querySelector("#blueInfoBox .get-it-all-1"),getItAll_2:document.querySelector("#blueInfoBox .get-it-all-2"),getItAll_3:document.querySelector("#blueInfoBox .get-it-all-3")};switch(FeatureOrder.getCurrentTierType()){case"TOP":document.getElementById("savingsPercentage").innerHTML="70%";break;case"BOTTOM":default:document.getElementById("savingsPercentage").innerHTML="30%"}var maxPrice=FeatureOrder.getMaxPrice();document.getElementsByName("preMaxDiff_1")[0].value;_toggleMsg(currentTotal<maxPrice-document.getElementsByName("preMaxDiff_2")[0].value?"standard":"HIDE_ALL")}},getOwnedFeatures:function(onlyPaid){if(void 0===onlyPaid&&(onlyPaid=!1),!document.getElementById("ownedFeaturesContent"))return{};for(var ownedFeats=document.querySelectorAll("#ownedFeaturesContent .feat-item.owned"),obj={},i=0;i<ownedFeats.length;i++){var featureCode=ownedFeats[i].getAttribute("id").split("-")[1];onlyPaid&&"LIFETIME"==document.querySelector("#featureItem-"+featureCode+" input[name=ownedType]").value||(obj[featureCode]={tierType:document.querySelector("#featureItem-"+featureCode+" input[name=tierType]").value,currency:document.querySelector("#featureItem-"+featureCode+" input[name=currency]").value,priceObj:{default:document.querySelector("#featureItem-"+featureCode+" input[name=price_default]").value,top:document.querySelector("#featureItem-"+featureCode+" input[name=price_top]").value,bottom:document.querySelector("#featureItem-"+featureCode+" input[name=price_bottom]").value}})}return obj},calculateTotalOfCart:function(){var purchasePrice=0,purchaseDiscount=0,skippedFirstPurchaseItem=!1,currency="",currTier=FeatureOrder.getCurrentTierType(),ownedTier=FeatureOrder.getOwnedTierType();FeatureOrder.getTierTypeOfList(FeatureOrder.getOwnedFeatures());if(Utils.sizeOfObject(FeatureOrder.cartList)>0)for(var k in FeatureOrder.cartList)if(""==currency&&(currency=FeatureOrder.cartList[k].currency),purchasePrice+=1*FeatureOrder.cartList[k].priceObj.default,""!=currTier)if(!skippedFirstPurchaseItem&&FeatureOrder.cartList[k].tierType==currTier&&(""==ownedTier&&"BOTTOM"==currTier||""==ownedTier&&"TOP"==currTier||"BOTTOM"==ownedTier&&"TOP"==currTier)){"BOTTOM"==ownedTier&&"TOP"==currTier&&(purchaseDiscount+=1*FeatureOrder.cartList[k].priceObj.default-1*FeatureOrder.cartList[k].priceObj[ownedTier.toLowerCase()]),skippedFirstPurchaseItem=!0;var firstPurchaseItem=document.getElementById("featureItem-"+k);firstPurchaseItem&&-1==firstPurchaseItem.getAttribute("class").indexOf("first-of-tier")&&Utils.addClassNative(firstPurchaseItem,"first-of-tier")}else purchaseDiscount+=1*FeatureOrder.cartList[k].priceObj.default-1*FeatureOrder.cartList[k].priceObj[currTier.toLowerCase()];var total_price=0,total_discount=0;return{price:total_price=purchasePrice.toFixed(2),discount:total_discount=purchaseDiscount.toFixed(2),currency:currency,sum:(1*total_price-1*total_discount).toFixed(2)}},calculateTotalOfOwned:function(){var totalPrice=0,totalDiscount=0,ownedList=FeatureOrder.getOwnedFeatures(!0);if(Utils.sizeOfObject(ownedList)>0){var tier="";for(var k in ownedList)switch(totalPrice+=1*ownedList[k].priceObj.default,""!=tier&&(totalDiscount+=1*ownedList[k].priceObj.default-1*ownedList[k].priceObj[tier.toLowerCase()]),tier){case"":""!=ownedList[k].tierType&&(tier=ownedList[k].tierType);break;case"BOTTOM":"TOP"==ownedList[k].tierType&&(tier=ownedList[k].tierType);break;case"TOP":continue}}return{price:totalPrice.toFixed(2),discount:totalDiscount.toFixed(2),currency:"",sum:(1*totalPrice.toFixed(2)-1*totalDiscount.toFixed(2)).toFixed(2)}},updateTotalOrder:function(){FeatureOrder.updateCurrentTierType();var cartTotalObj=FeatureOrder.calculateTotalOfCart(),ownedTotalObj=FeatureOrder.calculateTotalOfOwned();FeatureOrder.updateFeaturesDiscount();var maxPrice=FeatureOrder.getMaxPrice(),displayedDiscount=1*cartTotalObj.discount>0?cartTotalObj.discount:"0.00",displayedTotal=1*cartTotalObj.sum>0?cartTotalObj.sum:"0.00",evaluatedTotal=1*(1*displayedTotal+1*ownedTotalObj.sum).toFixed(2);evaluatedTotal>maxPrice&&(displayedDiscount=(1*cartTotalObj.discount+1*(evaluatedTotal-maxPrice)).toFixed(2),displayedTotal=(maxPrice-ownedTotalObj.sum).toFixed(2)),document.getElementById("totalCost")&&(document.querySelectorAll("#totalCost .cart-item-price")[0].innerHTML=1*cartTotalObj.price>0?cartTotalObj.price:"0.00",document.querySelectorAll("#totalCost .cart-item-currency")[0].innerHTML=cartTotalObj.currency),document.getElementById("totalDiscount")&&(document.querySelectorAll("#totalDiscount .cart-item-price")[0].innerHTML=displayedDiscount,document.querySelectorAll("#totalDiscount .cart-item-currency")[0].innerHTML=cartTotalObj.currency),document.getElementById("orderSavingsBottom")&&(document.querySelectorAll("#orderSavingsBottom .total-price")[0].innerHTML=displayedDiscount,document.querySelectorAll("#orderSavingsBottom .total-currency")[0].innerHTML=cartTotalObj.currency),document.getElementById("orderTotalBottom")&&(document.querySelectorAll("#orderTotalBottom .total-price")[0].innerHTML=displayedTotal,document.querySelectorAll("#orderTotalBottom .total-currency")[0].innerHTML=cartTotalObj.currency),evaluatedTotal>=maxPrice?FeatureOrder.addRemainingItemsAsPromotion():FeatureOrder.removeFreeItems(),FeatureOrder.adjustPromotionMessage(evaluatedTotal)},addItemToCart:function(featureCode,addType){if(void 0===addType&&(addType="purchase"),!0===FeatureOrder.cartList.hasOwnProperty(featureCode))return console.log("item "+featureCode+" already added to shopping cart!"),!1;var itemElementId="featureItem-"+featureCode,itemDisplayName=document.querySelectorAll("#"+itemElementId+" .title")[0].innerHTML,itemCurrency=document.querySelectorAll("#"+itemElementId+" input[name=currency]")[0].value,itemPrice={};switch(addType){case"free":itemPrice={default:"0.00",top:"0.00",bottom:"0.00"};break;case"purchase":default:itemPrice={default:document.querySelectorAll("#"+itemElementId+" input[name=price_default]")[0].value,top:document.querySelectorAll("#"+itemElementId+" input[name=price_top]")[0].value,bottom:document.querySelectorAll("#"+itemElementId+" input[name=price_bottom]")[0].value}}var itemTierType=document.querySelectorAll("#"+itemElementId+" input[name=tierType]")[0].value;if(FeatureOrder.cartList[featureCode]={domElementId:itemElementId,displayName:itemDisplayName,currency:itemCurrency,priceObj:itemPrice,tierType:itemTierType,addType:addType},document.getElementById("cartList")){var tpl=document.getElementById("tpl_cartItem").cloneNode(!0);tpl.setAttribute("id","cartItem-"+featureCode),tpl.getElementsByClassName("cart-item-name")[0].innerHTML=itemDisplayName,tpl.getElementsByClassName("cart-item-currency")[0].innerHTML=itemCurrency,tpl.getElementsByClassName("cart-item-sign")[0].innerHTML="",tpl.getElementsByClassName("cart-item-price")[0].innerHTML=itemPrice.default,tpl.style.display="block",document.getElementById("cartList").appendChild(tpl)}FeatureOrder.markItemAsAdded(featureCode,addType),"free"!==addType&&FeatureOrder.updateTotalOrder()},removeItemFromCart:function(featureCode){if(!1===FeatureOrder.cartList.hasOwnProperty(featureCode))return console.log("item "+featureCode+" not in cart list.."),!1;if(!document.getElementById("featureOrderDashboard").getAttribute("class")||-1==document.getElementById("featureOrderDashboard").getAttribute("class").indexOf("overlayed")){var itemElem=document.getElementById("cartItem-"+featureCode);itemElem.parentNode.removeChild(itemElem)}document.getElementById("featureOrderDashboard").getAttribute("class")&&-1!=document.getElementById("featureOrderDashboard").getAttribute("class").indexOf("single")||FeatureOrder.resetFeatureItem(featureCode,FeatureOrder.cartList[featureCode].addType),delete FeatureOrder.cartList[featureCode],FeatureOrder.updateTotalOrder()},addRemainingItemsAsPromotion:function(){for(var remainingItems=document.querySelectorAll(".feat-item.buy"),i=0;i<remainingItems.length;i++)FeatureOrder.addItemToCart(remainingItems[i].getAttribute("id").split("-")[1],"free"),-1==remainingItems[i].getAttribute("class").indexOf("free")&&Utils.addClassNative(remainingItems[i],"free")},removeFreeItems:function(){for(var k in FeatureOrder.cartList)if("free"===FeatureOrder.cartList[k].addType){FeatureOrder.removeItemFromCart(k);var item=document.getElementById("featureItem-"+k);if(!item)return;Utils.removeClassNative(item,"free")}},getMostRecentPurchased:function(){for(var k in Cam4User.userFeatures)if(Cam4User.userFeatures[k]&&"PAID"===Cam4User.userFeatures[k])return k;return!1},unmarkBestPairedItem:function(key){Utils.sizeOfObject(FeatureOrder.bestPairedFeatures)<=0&&FeatureOrder.getBestPairedFeatures();try{var featItemElem=document.getElementById("featureItem-"+FeatureOrder.bestPairedFeatures[key]);featItemElem&&-1!=featItemElem.getAttribute("class").indexOf("best-paired")&&FeatureOrder.bestPairedFeatures[key]!=FeatureOrder.bestPairedFeatures.TOP_FEATURE&&(Utils.removeClassNative(featItemElem,"best-paired"),featItemElem.getElementsByClassName("popular-tag")[0].style.display="none")}catch(ex){console.log(ex)}},markBestPaired:function(){document.getElementById("featureOrderDashboard").getAttribute("class")&&-1!=document.getElementById("featureOrderDashboard").getAttribute("class").indexOf("single")||document.getElementById("featureOrderDashboard")&&FeatureOrder.getBestPairedFeatures(function(){if(0!=Utils.sizeOfObject(FeatureOrder.bestPairedFeatures)){var toMark,mostRecentFeature=FeatureOrder.getMostRecentPurchased();toMark=mostRecentFeature&&FeatureOrder.bestPairedFeatures[mostRecentFeature]?FeatureOrder.bestPairedFeatures[mostRecentFeature]:FeatureOrder.bestPairedFeatures.TOP_FEATURE;var initialBest=document.getElementById("featureItem-"+toMark);if(-1==initialBest.getAttribute("class").indexOf("owned")){initialBest.getElementsByClassName("popular-tag")[0].style.display="inline",Utils.addClassNative(initialBest,"best-paired");var cloneBest=initialBest.cloneNode(!0);initialBest.parentNode.removeChild(initialBest);for(var restOfElems=document.getElementById("buyFeaturesContent").getElementsByClassName("feat-item"),arr=[],i=0;i<restOfElems.length;i++)arr.push(restOfElems[i].cloneNode(!0));for(document.getElementById("buyFeaturesContent").innerHTML="",document.getElementById("buyFeaturesContent").appendChild(cloneBest),i=0;i<arr.length;i++)document.getElementById("buyFeaturesContent").appendChild(arr[i])}}})},offerSwap:function(featureCode,callback){Modals.openFeatureSwapOffer(featureCode,callback)},swapFeatures:function(featureToRemove,featureToAdd){AjaxSender.send({method:"post",url:"/features?featureToRemove="+featureToRemove+"&featureToAdd="+featureToAdd,success:function(response){window.location.reload()},onerror:function(res){-1!=document.getElementById("errorDialog").getAttribute("style").indexOf("none")&&FeatureOrder.toggleErrorDialog()}})},deactivateFeature:function(featureCode,processorId){FeatureOrder.offerSwap(featureCode,function(res){"BOTTOM"==$j("#featureItem-"+featureCode).find("input[name=tierType]").val()&&FeatureOrder.checkIfRemoveBasicDeactivate(),200!=res.status&&0!=res.status&&void 0!==res.status&&(Utils.closeModalPops(),-1!=document.getElementById("confirmDialog").getAttribute("style").indexOf("none")&&(FeatureOrder.toggleDeactivateDialog(),document.querySelector("#confirmDialog .yes-btn").setAttribute("onclick",'FeatureOrder.deactivateFeatureConfirm("'+featureCode+'", "'+processorId+'");')))})},deactivateFeatureConfirm:function(featureCode,processorId){if(1!=document.querySelectorAll("#ownedFeaturesContent .feat-item").length)-1==document.getElementById("confirmDialog").getAttribute("style").indexOf("none")&&FeatureOrder.toggleDeactivateDialog(),Utils.closeModalPops(),FeatureOrder.submitCheckout([featureCode+"-REMOVED"]);else try{window.location.href=Cam4Processors.links[processorId].url}catch(ex){console.log(ex)}},submitCheckout:function(featuresArr,isSwap){var data=[];if(featuresArr&&void 0!==featuresArr.length&&featuresArr.length>0)data=featuresArr;else if(Utils.sizeOfObject(FeatureOrder.cartList)>0)for(var key in FeatureOrder.cartList)"free"!==FeatureOrder.cartList[key].addType&&data.push(key);if(data.length>0){var win=window.open("/checkout/bundle?addFeature="+data.join(","),"featureCheckout","width=650,height=880,scrollbars=1,toolbars=0,status=0,resizable=1");win.focus();try{1==data.length&&-1!=data[0].indexOf("REMOVED")||FeatureReporting.sendUsageAttempt(data.join("|"),"BUY")}catch(ex){console.log(ex)}if(void 0!==isSwap&&isSwap)window.location.reload();else var checkIfWindowClosed=setInterval(function(){win.closed&&(Utils.closeModalPops(),clearInterval(checkIfWindowClosed))},500)}},getMaxPriceDiff:function(){return FeatureOrder.getMaxPrice()-1*FeatureOrder.calculateTotalOfOwned().sum},adjustPricesOverMaxDifference:function(){var diffToMaxPrice=FeatureOrder.getMaxPriceDiff(),unpurchasedItems=$j(".feat-item.buy, .feat-item.in-cart");if(document.getElementById("featureOrderDashboard").getAttribute("class")&&-1!=document.getElementById("featureOrderDashboard").getAttribute("class").indexOf("single"))1*$j(unpurchasedItems[0]).find(".you-pay-less-display").html()>diffToMaxPrice&&$j(unpurchasedItems[0]).find(".you-pay-less-display").html(diffToMaxPrice.toFixed(2));else for(var i=0;i<unpurchasedItems.length;i++)1*$j(unpurchasedItems[i]).find(".price-display").html()>diffToMaxPrice&&$j(unpurchasedItems[i]).find(".price-display").html(diffToMaxPrice.toFixed(2))},checkIfRemoveBasicDeactivate:function(){var bottomCount=0,itemType="",initialTier=FeatureOrder.getTierTypeOfList(FeatureOrder.getOwnedFeatures());$j(".feat-item.owned").each(function(){switch(itemType=$j(this).find("input[name=tierType]").val()){case"BOTTOM":bottomCount++}}),$j(".feat-item.owned").each(function(){$j(this).find(".deactivate-btn").show()}),4==bottomCount&&"TOP"==initialTier?$j(".feat-item.owned").each(function(){"BOTTOM"==$j(this).find("input[name=tierType]").val()&&$j(this).find(".deactivate-btn").hide()}):bottomCount<=3&&"TOP"==initialTier&&$j("#featureSwapDashboard .bottom-cta").hide()},initDashboard:function(){if(Utils.sizeOfObject(FeatureOrder.cartList)>0)for(k in FeatureOrder.cartList)FeatureOrder.removeItemFromCart(k);FeatureOrder.markBestPaired(),FeatureOrder.adjustPricesOverMaxDifference(),FeatureOrder.adjustPromotionMessage(1*FeatureOrder.calculateTotalOfOwned().sum),FeatureOrder.toggleGoldOption(1*FeatureOrder.calculateTotalOfOwned().sum),FeatureOrder.checkIfRemoveBasicDeactivate()}};$j(document).ready(function(){-1!=Cam4User.htmlStates.indexOf("feature_dashboard_fullpage")&&(FeatureOrder.initDashboard(),document.getElementById("featurePurchaseReminder").style.display="none")});
var Registration=function(){function submitValidForm(){initSignup_container.username&&initSignup_container.password&&initSignup_container.email&&document.paymentFormInit.submit()}function initSignup_enableBtn(mode){var submitButton=$j("#initSignupSubmitBtn");mode?submitButton.removeClass("disabled").removeAttr("disabled"):submitButton.addClass("disabled").attr("disabled","disabled")}function initSignup_validate(text,span,property){usrparams=defineParameters(text,property),$j.ajax({url:"/signup/"+property,data:usrparams,dataType:"json",type:"post",success:function(json){if(json.success){switch(initSignup_container[property]=!0,property){case"username":""===usernameCheck&&(usernameCheck=!0);break;case"email":""===emailCheck&&(emailCheck=!0)}!0===usernameCheck&&!0===emailCheck&&submitValidForm()}else initSignup_container[property]=!1,usernameCheck=!1,emailCheck=!1;updateMessage(span,json.success,json.message),checkForUsernameSuggestions(json,span,property)},error:function(err){initSignup_container[property]=!1,ajFailureInitSignup(span)}})}function defineParameters(username,property){return usrparams={},usrparams[property]=username,username.length>=4&&"username"==property&&(usrparams.suggestions="true",usrparams.numberOfSuggestions=3),usrparams}function removeToolTip(userNameField){userNameField.popover("destroy")}function checkForUsernameSuggestions(json,span,property){var userNameField=$(".modal input[name=userName]"),popoverBox=$(".popover");void 0!==json.suggestions?json.suggestions.length>0?setupUsernameSuggestion(json.suggestions,span,userNameField):removeToolTip(userNameField):popoverBox.length&&"username"==property&&removeToolTip(userNameField)}function removeMultiplePopups(){var popupParent=$("#newJoin2013"),popupChildren=popupParent.find(".popover.fade.bottom.in");popupParent.has(".userNameSuggestionList")&&popupChildren.length>0&&popupChildren.each(function(index){index>0&&$(this).remove()})}function firePopupSuggestion(userNameField,span){userNameField.popover({html:!0,trigger:"manual",placement:"bottom",container:"#newJoin2013 > li:first-child, #initSignupModal #paymentFormInit > p:first-child",content:function(){return $("#userNameSuggestionContainer").html()}}),userNameField.popover("show"),useSuggestedUsername(userNameField,span),removeMultiplePopups()}function setupUsernameSuggestion(suggestedUsernames,span,userNameField){var suggestionList=$(".userNameSuggestionList");suggestionList.empty(),$.each(suggestedUsernames,function(i,val){suggestionList.append('<li class="suggestedUsername">'+val+"</li>")}),firePopupSuggestion(userNameField,span)}function useSuggestedUsername(userNameField,span){$(".suggestedUsername").on("click",function(){userNameField.val($(this).html()),updateMessage(span,!0,loginMessages.successUsernameMsg),removeToolTip(userNameField),$("#initSignupModal").length&&Registration.initSignupCheck("username")})}function initSignup_finalCheck(){initSignup_container.username&&initSignup_container.password&&initSignup_container.email?($j("#buttonLink").removeAttr("onclick"),initSignup_enableBtn(!0)):initSignup_enableBtn(!1)}function updateMessage(div,success,message){div.html(message),success?div.removeClass("error"):div.addClass("error")}function ajFailureInitSignup(div){updateMessage(div,!0,"")}function incrementCounter(field){"email"==field?emailValidationCount++:usernameValidationCount++}function getCounter(field){return"email"==field?emailValidationCount:usernameValidationCount}function validationRegModal(){function getCallbackSuccess(json,span,property,valid){switch(json=JSON.parse(json.responseText),checkForUsernameSuggestions(json,span,property),updateMessage(span,json.success,json.message),json.status){case"GOOD_EMAIL":case"OK":valid[property]=!0,span==validateUserNameSpan&&$(".username-icon-info").addClass("hide");break;case"INVALID":case"USERNAME_EXISTS":case"USERNAME_CENSORED":valid[property]=!1,span==validateUserNameSpan&&$(".username-icon-info").removeClass("hide")}}function getCallbackError(json,span,property,valid){valid[property]=!1,ajFailure(span)}function getCallback(count,span,property,valid,field){return function(json,status){count==getCounter(property)&&(void 0===field.checkedValues&&(field.checkedValues={}),field.checkedValues[field.value]={json:json,status:status},"success"==status?getCallbackSuccess(json,span,property,valid):getCallbackError(json,span,property,valid))}}function validate(field,span,property){if(usrparams[property]=field.value,field.value!=field.lastValue){if(incrementCounter(property),void 0!==field.checkedValues&&void 0!==field.checkedValues[field.value]){var memodata=field.checkedValues[field.value];return void("success"==memodata.status?getCallbackSuccess(memodata.json,span,property,valid):getCallbackError(memodata.json,span,property,valid))}field.timer&&clearTimeout(field.timer),field.timer=setTimeout(function(){span.removeClass("error").html('<img src="'+WEB_CDN+'/images/ajax-loader.gif" height="16" width="16" /> '+js_i18n.checking),usrparams=defineParameters(field.value,property),$.ajax({url:"/signup/"+property,data:usrparams,dataType:"json",type:"POST",complete:getCallback(getCounter(property),span,property,valid,field)})},100),field.lastValue=field.value}}function updateMessage(div,success,message){div.html(message),success?(div.removeClass("error"),suggestionEmailDomain()):div.addClass("error")}function ajFailure(div){updateMessage(div,!0,"")}function suggestionEmailDomain(){($("paymentForm").length||$("changeEmail").length)&&$("#email").length&&$("#email").mailcheck({suggested:function(element,suggestion){$("#email_suggestion").find("a").removeAttr("onclick").end().css({display:"block"}),$("#emailSuggested").text(suggestion.full).on("click",function(){suggestionEmailDomainClicked()})}})}function suggestionEmailDomainClicked(){$("#email").val($("#emailSuggested").text()).each(function(){validate(this,$("#emailSpan"),"email")}),$("#emailSpan").css({display:"block"}),$("#email_suggestion").css({display:"none"})}var validateUserNameSpan=$("#userNameSpan");$("#userName").bind("keyup blur change input",function(){validate(this,validateUserNameSpan,"username"),""==this.value&&$(".username-icon-info").removeClass("hide")});var validateEmailSpan=$("#emailSpan");$("#email").bind("keyup blur change input",function(){validate(this,validateEmailSpan,"email")}),$("#emailGuest").bind("keyup blur change input",function(){validate(this,validateEmailSpan,"email")})}function unbindRegModalOnClose(){var _closeModal=Utils.closeModalPops;Utils.closeModalPops=function(){$("#Cam4DialogContainer .modal-dialog").removeClass("registration-modal"),_closeModal(),Utils.closeModalPops=_closeModal}}function setRegistrationTimeout(){Cam4User.useVrPlayer&&Utils.isViewerInVR()||($(".modal").is(":visible")?setTimeout(setRegistrationTimeout,AUTOMATIC_REGISTRATION_MODAL_TIMEOUT):(Utils.decideOffer(),$("#Cam4DialogContainer").on("remove",function(){setTimeout(setRegistrationTimeout,AUTOMATIC_REGISTRATION_MODAL_TIMEOUT)})))}var usernameCheck,emailCheck,AUTOMATIC_REGISTRATION_MODAL_TIMEOUT=18e4,initSignup_container={},usrparams={},valid={},usernameValidationCount=0,emailValidationCount=0;return{guestModal:function(){PageStatus.isCheckoutTokensModalActive||PageStatus.showLoginModal||Utils.popWithAjaxContent("/gold?overlay=1&pageVersion=initSignup",{},!1,function(){$("#Cam4DialogContainer .modal-dialog").addClass("modal-lg")}),dataLayer.push({event:"directoryAutoModalRegister"}),Cam4Cookies.setCookie("dirPageCount","101",864e5)},submitCreateMyAccount:function(){dataLayer.push({event:"CreateMyAccountOverlay",login:document.getElementById("userName").value,email:document.getElementById("email").value}),document.paymentFormInit.submit()},initSignupCheck:function(action){if("username"!==action)if("email"!==action){if("password"===action){var textPassword=$j("#paymentFormInit input[name=newPassword]").val(),textUserName=$j("#paymentFormInit input[name=userName]").val(),spanPassword=$j("#passwordSpan"),json=Registration.checkPassword(textUserName,textPassword);return json.success?initSignup_container.password=!0:initSignup_container.password=!1,updateMessage(spanPassword,json.success,json.message),void initSignup_finalCheck()}}else initSignup_validate($j("#paymentFormInit input[name=email]").val(),$j("#emailSpan"),"email");else initSignup_validate($j("#paymentFormInit input[name=userName]").val(),$j("#userNameSpan"),"username")},openRegModal:function(url){var originalUrl=url;switch(url+="&type=modal&showSignupForm=true",Registration.activateRegModal(url),originalUrl){case"gold?pageType=gold&contextual=fullscreen-"+Cam4User.gender+"&ct=fpfs":dataLayer.push({event:"fullScreenChat"});break;case"gold?pageType=gold&contextual=enhanced_chat-"+Cam4User.gender+"&ct=fpec":dataLayer.push({event:"emoticonChat"});break;case"gold?pageType=basic&contextual=enhanced_chat-"+Cam4User.gender+"&ct=fpec":dataLayer.push({event:"typingChatArea"})}},activateRegModal:function(hrefComplete,extraPadding){Utils.popWithAjaxContent(hrefComplete,{},!1,function(){var cam4dialogContainer=$("#Cam4DialogContainer .modal-dialog");"undefined"!=typeof detachRightSignupForm&&detachRightSignupForm(),ControlledFeatures.NEW_ACCOUNT_CREATION?-1!=hrefComplete.indexOf("pageType=gold")?cam4dialogContainer.addClass("modal-lg registration-modal"):cam4dialogContainer.addClass("modal-md registration-modal"):cam4dialogContainer.addClass("modal-lg registration-modal"),extraPadding&&cam4dialogContainer.addClass("extra-padding"),validationRegModal(),unbindRegModalOnClose(),-1!=hrefComplete.indexOf("pageType=gold")&&EpayPlugin.attachGuestToGoldFunnel()})},checkForm:function(ev){ev.preventDefault(),usernameCheck="",emailCheck="",Registration.initSignupCheck("username"),Registration.initSignupCheck("password"),Registration.initSignupCheck("email")},activateGuestRegisterModal:function(opts){Cam4User.isLoggedInAsGuest&&Utils.popPreloadedContent($j("#guestRegisterForm").html(),function(){$j("#Cam4DialogContainer .modal-dialog").addClass("modal-sm registration-modal guest-modal"),"object"==typeof opts&&opts.isDisabledTips&&($j("#Cam4DialogContainer .msg").hide(),$j("#Cam4DialogContainer .msg.no-guest-tips").show()),validationRegModal(),unbindRegModalOnClose(),$j(window).keydown(function(e){13==e.which&&$j(".modal-dialog.registration-modal").is(":visible")&&$j(".modal-dialog.registration-modal input").is(":focus")&&(e.preventDefault(),$j(".modal-dialog.registration-modal form[name=paymentFormGuest] button").trigger("click"))})})},activateEmailConflictModal:function(){Cam4User.isLoggedInAsGuest||Cam4User.isLoggedIn||!Cam4User.useGuestBilling||Utils.popPreloadedContent($j("#provideAnotherEmailForm").html(),function(){$j("#Cam4DialogContainer .modal-dialog").addClass("modal-sm headless"),validationRegModal(),unbindRegModalOnClose(),document.getElementById("Cam4DialogContainer").onclick=function(event){void 0!==event&&event.target&&event.target.id===name&&event.preventDefault()},$j(window).keydown(function(e){13==e.which&&$j(".modal-dialog #emailExistsPrompt").is(":visible")&&($j(".modal-dialog #provideNewEmailForm input").is(":focus")&&(e.preventDefault(),$j(".modal-dialog #provideNewEmailForm button").trigger("click")),$j(".modal-dialog #alternativeLogin input").is(":focus")&&(e.preventDefault(),$j(".modal-dialog #alternativeLogin button").trigger("click")))})})},showCampaignRegModal:function(sourceElem){var modal=$j(".promo-reg-overlay");if(0!=modal.length){switch(modal.attr("id")){case"goldHolidaySale":case"goldValentinesDaySale":if(Cam4User.isPayingMember())return}Utils.popPreloadedContent(modal.html(),function(){$j("#Cam4DialogContainer .modal-dialog").addClass("modal-md")});var sourceID;sourceElem&&sourceElem.id&&(sourceID=sourceElem.id),dataLayer.push({event:"Enter Gold Funnel",eventCategory:"Gold Membership",eventAction:"Enter Gold Funnel",eventLabel:"camapaign - "+Campaigns.activeCampaignName+(sourceID?" | triggered from - "+sourceID:"")})}},showGoldUpgradeOverlay:function(contextClass,embeddedAd){if(Cam4Performer.statusModel.isGoldPartyWinner)Utils.decideOffer("",{pageType:"gold",contextClass:"gold-shows"});else if(contextClass||(contextClass="default"),ControlledFeatures.GOLD_CONTEXTUAL_OVERLAYS||embeddedAd){var modal=$j(".gold-reg-overlay");if(0==modal.length||Cam4User.isPayingMember())return;modal.find(".msg").hide(),modal.find(".msg."+contextClass).length>0?modal.find(".msg."+contextClass).show():modal.find(".msg.default").show(),Utils.popPreloadedContent(modal.html(),function(){$j("#Cam4DialogContainer .modal-dialog").addClass("modal-md modal-gold-overlay"),$j("#Cam4DialogContainer .modal-dialog #goldUpgradeSubmitBtn").attr("onclick","Utils.decideOffer('', {'pageType': 'gold','contextClass': '"+contextClass+"'});")}),dataLayer.push({event:"Enter Gold Funnel",eventCategory:"Gold Membership",eventAction:"Enter Gold Funnel",eventLabel:contextClass})}else switch(contextClass){case"theater-mode":Utils.decideOffer("C4BND_FULL_SCREEN");break;case"multicam":case"picture-in-picture":Utils.decideOffer("C4BND_MULTI_CAM_PIP");break;case"private-message":Utils.decideOffer("C4BND_PRIVATE_MESSAGE");break;case"enhanced-chat":Utils.decideOffer("C4BND_ENHANCED_CHAT");break;case"remove-ads":Utils.decideOffer("C4BND_NO_ADS",{ct:"ad",pageType:"gold",unlockFeature:"no_ads"});break;case"save-searches":DirectoryEvents.showTooManySearchesModal();break;case"super-show-chat":Utils.decideOffer("C4BND_SUPER_SHOW_CHAT");break;case"chat-filters":case"unlimited-chat":case"stealth-mode":Utils.decideOffer("",{pageType:"gold"});break;case"private-cam":case"gold-shows":case"default":Utils.decideOffer({pageType:"gold",contextClass:"default"})}},openCheckoutMembership:function(){Utils.decideOffer("",{pageType:"gold"})},checkPassword:function(userName,pwTxt){if(""==pwTxt)return{message:js_i18n.passCantBeBlank,success:!1};if(userName==pwTxt)return{message:js_i18n.passAndUsrIdSame,success:!1};if(/[^0-9a-z]/i.test(pwTxt))return{message:js_i18n.passCantBeAlpha,success:!1};if(pwTxt.length<passwordMinLength||pwTxt.length>passwordMaxLength)return{message:js_i18n.place(js_i18n.passBetween,passwordMinLength,passwordMaxLength),success:!1};var upperCase=new RegExp("[A-Z]"),lowerCase=new RegExp("[a-z]");return null==pwTxt.match(upperCase)||null==pwTxt.match(lowerCase)?{message:js_i18n.mustContainLowercaseUppercase,success:!1}:(score=0,toadd={letters:1,digits:1,specials:1},pwTxt.match(/[a-zA-Z]/)&&(score+=1,toadd.letters=0),pwTxt.match(/\d+/)&&(score+=1,toadd.digits=0),pwTxt.match(/[!,@#$%^&*?_~]/)&&(score+=1,toadd.specials=0),{message:js_i18n.passErrorOk,success:!0})},clearUsername:function(){var userNameField=$("#userName");userNameField.val(""),userNameField.focus(),removeToolTip(userNameField)},setRegistrationTimeout:setRegistrationTimeout,AUTOMATIC_REGISTRATION_MODAL_TIMEOUT:AUTOMATIC_REGISTRATION_MODAL_TIMEOUT}}();$(document).ready(function(){if(!StreamEmbedApi.enabled&&(!Cam4User.isLoggedIn&&!Cam4User.isLoggedInAsGuest&&Cam4User.useGuestBilling&&""!=Cam4User.guestUserName&&Cam4User.guestPromptEmailExists&&Registration.activateEmailConflictModal(),Cam4User.isViewer()&&!Cam4User.isLoggedIn&&!Cam4User.isLoggedInAsGuest&&Cam4Performer.statusModel&&Cam4Performer.statusModel.isBroadcasting&&setTimeout(Registration.setRegistrationTimeout,Registration.AUTOMATIC_REGISTRATION_MODAL_TIMEOUT),Cam4Cookies.getCookie("cam4-GUEST"))){var guestCookieVal=Cam4Cookies.getCookie("cam4-GUEST").split("|")[0],guestCookieDomainName=Cam4Cookies.getCookie("cam4-GUEST").split("|")[1];switch(guestCookieVal){case"expiredRejoinLink":LoginModals.activateForgotPasswordModal();break;case"showGuestUpsellForm":Registration.activateGuestRegisterModal()}Cam4Cookies.deleteCookie("cam4-GUEST","/",guestCookieDomainName)}});
var GoldPartySidebar={switchTab:function(tabName){$j("#goldPartyChallengers .contestants-group").hide(),$j("#group_"+tabName).show(),$j("#goldPartyChallengers .option-tabs .option").removeClass("active"),$j("#option_"+tabName).addClass("active")},showTipBox:function(){$j(".btn.side-help").popover({html:!0,content:function(){return $("#goldPartyTip").html()},title:function(){return $("#goldPartyTipTitle").html()}})},decideInitialTab:function(){var useCase="";Cam4User.isLoggedIn&&(useCase=Cam4User.userSexPref+"_"+Cam4User.userGender);var firstTab="";switch(useCase){case"straight_male":case"bicurious_female":case"gay_female":firstTab="FEMALE";break;case"gay_male":case"bicurious_male":case"straight_female":firstTab="MALE";break;default:firstTab=$j(".contestants-group:first").attr("id").split("_")[1]}GoldPartySidebar.switchTab(firstTab)},refreshCycle:null,initRefreshCycle:function(){null!==GoldPartySidebar.refreshCycle&&delete GoldPartySidebar.refreshCycle,GoldPartySidebar.refreshCycle=setInterval(function(){GoldPartySidebar.init()},3e5)},init:function(){$j.ajax({type:"GET",url:"/goldSidebar",success:function(data){data&&data.length>0?($j("#goldPartySidebar").show(),$j("#goldPartySidebar").html(data),$j("#goldPartyChallengers").length>0&&(GoldPartySidebar.decideInitialTab(),null===GoldPartySidebar.refreshCycle&&GoldPartySidebar.initRefreshCycle())):($j("#goldPartySidebar").hide(),console.log("No GoldParty challengers available.."))}})}};$j(document).ready(function(){$j("#goldPartySidebar").length>0&&GoldPartySidebar.init()});
var BrowserDetect=BrowserDetect||{},EverCookie=function(){function getData(){var text=get("C4OBJ"),obj={};if(text)try{obj=JSON.parse(text)}catch(ex){obj={}}return obj}function set(keyName,value){if(Cam4Storage.isEnabled())Cam4Storage.set(keyName,value);else if("undefined"!=typeof Cam4Cookies){var expireDate=new Date;expireDate.setMonth(expireDate.getMonth()+6),Cam4Cookies.setCookie(key,value,expireDate,"/")}sessionSetted[keyName]=value}function get(key){var keyName=key+"",value=Cam4Storage.get(keyName);return value||"undefined"==typeof Cam4Cookies?value:Cam4Cookies.getCookie(key)}function setDataAgain(){window._EverCoookieData=sessionSetted,clearTimeout(tid);for(var i in sessionSetted)sessionSetted[i].key&&sessionSetted[i].value&&set(sessionSetted[i].key,sessionSetted[i].value);tid=setTimeout(function(){EverCookie.setDataAgain()},6e4)}var sessionSetted={},tid="";return setDataAgain(),{set:set,get:get,setData:function(object){try{"undefined"!=typeof Cam4User&&(object.username=Cam4User.userName);var oldData=getData();return _.extend(oldData,object),set("C4OBJ",JSON.stringify(oldData)),object}catch(ex){return!1}},getData:getData,getInt:function(filedname){var obj=getData(),value=0;return obj[filedname]&&(value=parseInt(obj[filedname]),!isNaN(value))?value:0},setDataAgain:setDataAgain,pushData:function(){var obj=getData();if(arguments.length>1){var arrayname=arguments[0];void 0===obj[arrayname]&&(obj[arrayname]=[]);for(var i=1;i<arguments.length;i++)obj[arrayname].push(arguments[i]);set("C4OBJ",JSON.stringify(obj))}return obj},increment:function(fieldname,value){var obj=getData();return obj[fieldname]?value?obj[fieldname]+=value:obj[fieldname]++:obj[fieldname]=1,set("C4OBJ",JSON.stringify(obj)),obj},getSessionData:function(){return sessionSetted}}}();$j(window).load(function(){BrowserDetect.getBrowserUID&&EverCookie.set("C4EC",BrowserDetect.getBrowserUID())});
!function(){Utils.setLoginLocalStorage=function(){Cam4Storage.setLocal("isLoggedIn","true")},Utils.removeLoginLocalStorage=function(){"undefined"!=typeof localStorage&&null!=localStorage&&localStorage.removeItem("isLoggedIn")},Utils.checkLoginLocalStorage=function(){return"undefined"!=typeof localStorage&&null!=localStorage?localStorage.getItem("isLoggedIn"):null}}(),$j(document).ready(function(){Cam4User.isLoggedIn?Utils.setLoginLocalStorage():Utils.removeLoginLocalStorage()});
var Cam4UserNotifications={isConnected:!1,init:function(){function connectToFirebase(userName){Cam4UserNotifications.isConnected=!0;var firebaseAuth=new Firebase(Cam4User.userFirebaseShard,"Notifications");firebaseAuth.authWithCustomToken(Cam4User.userFirebaseToken,function(error){error?console.log("Error reading node from Firebase... ",error):(firebaseAuth.child("userNotification").child(userName.toLowerCase()).on("value",function(snap){updateUI(snap),onDomLoad=!1}),Cam4User.isBroadcaster()&&ExternalEncoderHandler.init(firebaseAuth))})}function updateUnreadMessages(threadData){var threadId=threadData.threadId;void 0!==Conversations.threads[threadId]?Conversations.threads[threadId].unreadCount++:Conversations.threads[threadId]={unreadCount:1},$("#thread"+threadId).find(".ur-count").text(Conversations.threads[threadId].unreadCount).show(),$("#thread"+threadId).addClass("unread")}function updateInboxNotificationIcon(data,cached){var unreadCount;unreadCount=cached?Conversations.unreadThreadsIds.length:data.length,inboxIcon.text(unreadCount).parent().removeClass(function(index,css){return(css.match(/(^|\s)inboxCount\S+/g)||[]).join(" ")}).addClass("inboxCount"+unreadCount)}function updatePreview(threadData){if(void 0===Conversations.threads[threadData.threadId]||void 0===Conversations.threads[threadData.threadId].preview||Conversations.threads[threadData.threadId].preview.msgId!=threadData.msgId){var thread=$("#thread"+threadData.threadId),sender=thread.find(".sender"),excerpt=Conversations.excerpt(threadData.message);"marketplace"==threadData.mType&&(excerpt=JSON.parse(threadData.message).title),"gift"==threadData.mType?thread.find(".excerpt").html(Conversations.giftPreview(threadData.giftUrl,excerpt)):thread.find(".excerpt").text(excerpt),Cam4User.id==threadData.senderId?sender.css("display","inline"):sender.hide(),thread.find(".date").text(threadData.sendDate),Cam4User.id==threadData.senderId||onDomLoad||updateUnreadMessages(threadData)}}function setTopThread(threadId){$("#thread"+threadId).prependTo(".thread-previews")}function formatMessageDate(timestamp){var msgTime=new Date(timestamp),hours=msgTime.getHours(),minutes=msgTime.getMinutes();return(0==hours||12==hours?12:hours%12)+":"+minutes+(hours<12?" AM":" PM")}function resolveUnconfirmedMessages(threadData){var id=threadData.id;void 0!==Conversations.unconfirmedMessages[id]&&(delete Conversations.unconfirmedMessages[id],$("#"+id).find(".msgDate").text(threadData.sendDate).find(".full-msg").text(threadData.message).find(".id").text(threadData.msgId)),Conversations.scrollToBottom("msg-body-wrap")}function findMessageById(messageId,id){return null!==document.getElementById(messageId)||null!==document.getElementById(id)}function updateBalance(balance){if(Cam4User.isLoggedIn||Cam4User.isLoggedInAsGuest){if(void 0!==balance)return void(ControlledFeatures&&ControlledFeatures.USE_EWALLET?TipBalance.updateBalanceFields(balance):TipBalance.getBalance());TipBalance.getBalance()}}function reloadUI(){var checkGuestStatus=$.ajax({type:"GET",url:"/guestInfo?_="+(new Date).getTime(),dataType:"text"});checkGuestStatus.done(function(data){switch(data=data.trim()){case"SUCCESS":window.location.reload();break;case"EMAIL_EXISTS":Registration.activateEmailConflictModal();break;case"PENDING":setTimeout(function(){reloadUI()},1e3)}}),checkGuestStatus.fail(function(){console.log("checkGuestStatus failed!")})}function updateUI(snap){var nodeData=snap.val();if(null!=nodeData)switch(nodeData.t){case"g":if(onDomLoad)return;switch(UserNotificationsType.fromShortName(nodeData.a)){case"TRANSACTION_COMPLETED":break;case"JOIN_INVITE":ChatUIController.showInvitationBubble(nodeData.i);break;case"VIDEO_CHANGE":"undefined"!=typeof RequestParameters&&void 0!==RequestParameters.sourcePage&&"videos"==RequestParameters.sourcePage&&fileUpload.updatePreviewStatus(nodeData);break;case"UPDATE_BALANCE":if(Cam4User.isLoggedIn||Cam4User.isLoggedInAsGuest){updateBalance(nodeData.bl);break}reloadUI();break;case"FRIEND_REQUEST":notificationContainer.length&&NotificationContainer.newFriendRequest(nodeData.i);break;case"FRIEND_ACCEPT":notificationContainer.length&&NotificationContainer.acceptRequest(nodeData.p);case"FRIEND_CANCEL":case"FRIEND_DELETE":notificationContainer.length&&NotificationContainer.removeFriendRequest(nodeData.p,nodeData.i);break;case"LOGOUT_USER":MobileMenusManager.triggerLogout()}break;case"i":if(isInboxPage){if(nodeData.sendDate=formatMessageDate(nodeData.sendDate),updateThreads(nodeData),void 0!==Conversations.unreadThreadsIds&&Conversations.unreadThreadsIds.indexOf(nodeData.threadId)<0){if(onDomLoad)return;nodeData.senderId!=Cam4User.id&&(Conversations.unreadThreadsIds.push(nodeData.threadId),updateInboxNotificationIcon("",!0))}}else updateUnreadCounters()}}function isMessageInCache(threadId,messageId){if(void 0!==Conversations.threads[threadId]&&void 0!==Conversations.threads[threadId].messages)for(var i=0;i<Conversations.threads[threadId].messages.length;i++)if(Conversations.threads[threadId].messages[i].msgId==messageId)return!0;return!1}function updateThreads(threadData){isMessageInCache(threadData.threadId,threadData.msgId)||(Conversations.activeTab!=threadData.threadId||findMessageById(threadData.msgId,threadData.id)?void 0!==Conversations.unconfirmedMessages&&resolveUnconfirmedMessages(threadData):Conversations.addMessage(threadData,!0,!0),void 0!==Conversations.threads[threadData.threadId]&&(void 0!==Conversations.threads[threadData.threadId].messages?Conversations.threads[threadData.threadId].messages.unshift(threadData):Conversations.threads[threadData.threadId].messages=[threadData]),void 0===Conversations.threads[threadData.threadId]?onDomLoad||(Conversations.getThreadMessagesAjax(threadData.threadId,!0,threadData),updateInboxNotificationIcon("",!0)):updatePreview(threadData),setTopThread(threadData.threadId))}var isInboxPage=!1,inboxIcon=$("#miniInbox, .inbox-icon .counter"),onDomLoad=!0;void 0!==Cam4User.htmlStates&&(isInboxPage=1==Cam4User.htmlStates.indexOf("threaded_conversations"));var notificationContainer=$("#notificationContainer"),UserNotificationsType=function(){return{fromShortName:function(shortName){switch(shortName){case"frR":return"FRIEND_REQUEST";case"frD":return"FRIEND_DELETE";case"frA":return"FRIEND_ACCEPT";case"frC":return"FRIEND_CANCEL";case"tC":return"TRANSACTION_COMPLETED";case"b":return"UPDATE_BALANCE";case"vc":return"VIDEO_CHANGE";case"ji":return"JOIN_INVITE";case"lo":return"LOGOUT_USER";default:return"unknown"}}}}();if(""!=Cam4User.userFirebaseShard&&(!Cam4User.isBroadcaster()||useBroadcasterFirebaseChat)){if(Cam4UserNotifications.isConnected)return;if(Cam4User.isLoggedIn||Cam4User.isLoggedInAsGuest)return void connectToFirebase(Cam4User.userName);if("true"!=Cam4Cookies.getCookie("cam4-PAY"))return;if(""!=Cam4User.guestUserName)return void connectToFirebase(Cam4User.guestUserName)}}};
var ChatUI=function(){var elements={firebaseContainer:$j("#containerFirebase"),video:Cam4User.cameraData.useHlsVideoOnMobile?$j("#video"):UserAgent.desktop?$j(".chatlessPlayer"):$j("#video"),privateShowContainer:$j("#privateShowContainer"),tippingDiv:$j("#tDiv"),tippingViewer:$j("#newTippingViewer"),iframePlayer:$j("#iframeVideoPlayer"),imagePush:$j("#imagePush"),tsToggleButton:$j("#ts-toggle, #ts-toggle-new"),translatorButton:$j(".translator"),playerChatContainer:$j("#broadcastingApp"),sellingTicketsBar:$j("#NSTimeLeftVr"),userBar:$j(".userBar"),chatInput:$j(".fakechatbutton"),fakeChatDiv:$j("#fakechatDiv"),containerHeader:$j(".containerHeader")},overlays={groupShow:$j("#firebaseGroupShow"),privateShow:$j("#firebasePrivateShow"),pausedShow:$j("#firebasePausedShow"),returnCountdown:$j("#firebaseReturningIn"),privateRoom:$j("#privateRoomOverlay"),pausedGS:$j("#firebasePausedGS"),reconnect:$j("#firebaseReconnect .vertical-center"),goldShow:$j("#firebaseGoldShow"),broadcasterPauseOverlay:$j("#pauseOverlay"),broadcasterSpeedTestOverlay:$j("#speedTestOverlay")},headers={superShow:$j("#goldNavbarSpecialEvent")},volume={element:$j(".volume"),slider:$j("#slider")};return{element:elements,addTooltips:function(){if(UserAgent.desktop){var chatTooltipMap=[{selector:"#showChatSettings",info:js_i18n.showChatSettings},{selector:".nopop.player-btn.translator",info:js_i18n.showTranslation},{selector:"#slider",info:js_i18n.soundVolume},{selector:"#chat_main .fullscreen",info:js_i18n.fullscreen},{selector:".newStreamControls .fullscreen",info:js_i18n.fullscreen},{selector:"#emoticonPicker",info:js_i18n.emoticons},{selector:"#chat_main #ts-toggle",info:js_i18n.tippingSoundButton},{selector:".newStreamControls #ts-toggle-new, .broadcast-control-bar .ts-toggle",info:js_i18n.newTippingMuteUnmute},{selector:".newStreamControls .volume",info:js_i18n.newMuteUnmute},{selector:".newStreamControls .resolution",info:js_i18n.newQuality},{selector:".newStreamControls .theatre",info:js_i18n.newTheaterMode},{selector:".newStreamControls .completeFullscreen",info:js_i18n.newFullscreenMode},{selector:"#chatConnectionStatus",info:js_i18n.chatConnectionStatus},{selector:"#msgChatBtn",info:js_i18n.send},{selector:"#toggleOBS",info:js_i18n.obsVideoPreview},{selector:"#contextualNotes",info:js_i18n.editNoteTooltip},{selector:"#cameraButton",info:js_i18n.vidyoControlsToggleCamera},{selector:"#microphoneButton",info:js_i18n.vidyoControlsToggleMic},{selector:"#settingsButton",info:js_i18n.vidyoControlsSettings}];$("#lists").tooltip({selector:".editNote",placement:"bottom",title:js_i18n.editNoteTooltip}),$("#tab1C").tooltip({selector:".editNote",placement:"bottom",title:js_i18n.editNoteTooltip}),$("#tab2C").tooltip({selector:".peek",placement:"bottom",title:Cam4Chat.preview});for(var i=0;i<chatTooltipMap.length;i++){var info=chatTooltipMap[i].info,selector=chatTooltipMap[i].selector;$(selector).tooltip({container:"body",placement:"bottom",title:info})}}},overlay:overlays,header:headers,error:{kicked:$j("#errorKicked"),banned:$j("#errorBanned")},volume:volume,playerHeader:{element:$j(".player-header"),performer:{header:$j(".player-header header"),footer:$j(".player-header footer")}},showVideoContainer:function(){return Cam4User.cameraData.useHlsVideoOnMobile&&$j("#Cam4HLSPlayer").show(),ChatUI},hideVideoContainer:function(){return Cam4User.cameraData.useHlsVideoOnMobile&&$j("#Cam4HLSPlayer").hide(),ChatUI},muteAudio:function(streamSource){if(streamSource&&streamSource.mute&&(streamSource.mute(),ChatUI.volume.slider.slider("disable"),ChatUI.volume.element.off("click"),Cam4User.cameraData.useHlsVideoOnMobile)){var player=$j("#Cam4HLSPlayer");player.length>0&&(player.prop("muted",!0),player.on("volumechange",function(e){player.prop("muted",!0)}))}},unmuteAudio:function(streamSource){if(streamSource&&streamSource.volume&&streamSource.volume.init&&streamSource.volume.init(),streamSource&&streamSource.unmute&&streamSource.unmute(),ChatUI.volume.slider.slider("enable"),Cam4User.cameraData.useHlsVideoOnMobile){var player=$j("#Cam4HLSPlayer");player.length>0&&(player.prop("muted",!1),player.off("volumechange"))}}}}();$(document).ready(function(){WaitFor.lang(function(){ChatUI.addTooltips()})});var BroadcastStatus=function(){function setStatusUI(newStatus){""===newStatus?newStatus=js_i18n.setStatus:dataLayer.push({event:"BroadcastStatusMessage",eventCategory:"Broadcast Settings",eventAction:"Set Status",eventLabel:newStatus.toLowerCase()}),whosBro.find(".bottom").text(newStatus),statusInput.val(newStatus)}var status=Cam4User.streamingData.broadcastSettings.statusMessage||"",whosBro=$("#whosBro"),updateStatus=$("#updateStat"),statusInput=$("#brStatIn");return{setStatus:function(customStatus,keepCurrentStatus){updateStatus.hide();var newValue=statusInput.val();void 0===customStatus?newValue=newValue.trim().substring(0,90):(statusInput.val(customStatus),newValue=customStatus),newValue!=status&&(keepCurrentStatus||(newValue=GameCenter.filterOutGamesFromStatus(newValue,"room")),status=newValue,LogicObj.updateBroadcastStatus(newValue),setStatusUI(newValue)),whosBro.show()},init:function(pStatus){pStatus&&(status=pStatus),whosBro.on("click",function(){updateStatus.show(),$("#brStatIn").focus(),whosBro.hide()}),$("#brStatBar").fadeIn("slow"),whosBro.find(".top").text(Cam4User.userName+" - "+js_i18n.broadcastingLive),setStatusUI(status)},setPrivateRoom:function(status){status?whosBro.find(".top").text(Cam4User.userName+" - "+js_i18n.broadcastingLive+" ["+js_i18n.privateRoom+"]"):whosBro.find(".top").text(Cam4User.userName+" - "+js_i18n.broadcastingLive)},getStatus:function(){return status}}}(),blocksOfTimeTooltip=function(){function createCookie(){var expireDate=new Date;expireDate.setFullYear(expireDate.getFullYear()+1),Cam4Cookies.setCookie("broadcast-control-bar-tooltip","true",expireDate,"/","","")}function showToolTipMessage(){$(".newStreamControls").hasClass("controlBarShowFirstTime")||$(".newStreamControls").addClass("controlBarShowFirstTime"),containerElem.popover({html:!0,trigger:"manual",placement:"top",container:".blocksOfTimeTooltip",content:function(){return createCookie(),$("#blocksOfTimeUpdateContainer").html()}}),containerElem.popover("show"),$(".blocksOfTimeTooltip .popover").css("margin-left","-30px"),$(".blocksOfTimeTooltip .arrow").css("margin-left","94px"),closeOption()}function closeOption(){containerElem.on("click",".closeToolTip",function(){containerElem.popover("hide"),$(".newStreamControls").removeClass("controlBarShowFirstTime")})}var containerElem=$(".blocksOfTimeTooltip");return{init:function(){!Cam4Cookies.getCookie("broadcast-control-bar-tooltip")&&containerElem.length&&showToolTipMessage()}}}(),gameCenterTooltip=function(){function createCookie(){var expireDate=new Date;expireDate.setFullYear(expireDate.getFullYear()+1),Cam4Cookies.setCookie("broadcast-control-bar-tooltip2","true",expireDate,"/","","")}function showToolTipMessage(){$(".newStreamControls").hasClass("controlBarShowFirstTime")||$(".newStreamControls").addClass("controlBarShowFirstTime"),containerElem.popover({html:!0,trigger:"manual",placement:"top",container:".gameCenterTooltip",content:function(){return createCookie(),$("#gameCenterUpdateContainer").html()}}),containerElem.popover("show"),$(".gameCenterTooltip .popover").css("margin-left","204px"),$(".gameCenterTooltip .arrow").css("margin-left","15px"),closeOption()}function closeOption(){containerElem.on("click",".closeToolTip",function(){containerElem.popover("hide"),$(".newStreamControls").removeClass("controlBarShowFirstTime")})}var containerElem=$(".gameCenterTooltip");return{init:function(){!Cam4Cookies.getCookie("broadcast-control-bar-tooltip2")&&containerElem.length&&showToolTipMessage()}}}();
Cam4User.langIsRTL=function(){return["ar","iw"].indexOf(Cam4User.lang)>-1};var ChatlessPlayer=function(){function calculateChatWidth(){chatWidth=500,$(window).width()>1600&&(chatWidth=540),$(window).width()<1140&&(chatWidth=300)}function calculateDimensions(){var width=$("#broadcastingApp").width()-chatWidth,height=width/ChatlessPlayer.resolution.getAspectRatio(),maxHeight=.59*screen.height;return height>maxHeight&&(width=(height=maxHeight)*ChatlessPlayer.resolution.getAspectRatio()),{width:width,height:height}}function isChatlessPlayer(){return("undefined"!=typeof flashObj&&0!==$j("#Cam4VChat").length||Cam4User.cameraData.useHlsVideoOnMobile)&&!useBroadcasterFirebaseChat}function setState(value){state=value}function reconnectPlayer(){isChatlessPlayer()&&JsSender.isReady&&(JsSender.canReconnect()?(reconnectRetries=0,console.log("playToken: ",playToken),JsSender.reconnectStream(playToken),setState("connected")):reconnectRetries<5&&(reconnectRetries++,setTimeout(reconnectPlayer,500)))}function reconnect(){reconnectPlayer()}var iosBroadcasterReconnectForRotation,chatWidth,reconnectRetries=0,broadcastResolutionsLandscape=["1920:1440","1920:1080","1280:960","1280:768","1280:720","1056:704","960:720","880:720","800:600","800:480","720:720","720:480","640:480","512:288","352:288","320:240","176:144"],state="disconnected",playToken="",type="flash",controlledFeatureFixedChatAndViewerView=ControlledFeatures&&ControlledFeatures.FIXED_WIDTH_CHAT&&!Cam4User.isBroadcastingWindow;controlledFeatureFixedChatAndViewerView&&calculateChatWidth();var volume=function(){function setVolumeImage(value){var states=["muted","state-1","state-2","state-3","state-4"].join(" ");ChatUI.volume.element.removeClass(states),0==value?ChatUI.volume.element.addClass("muted"):value<=9?ChatUI.volume.element.addClass("state-1"):value<=25?ChatUI.volume.element.addClass("state-2"):value<=75?ChatUI.volume.element.addClass("state-3"):ChatUI.volume.element.addClass("state-4")}function setLastVolumeValue(value){null==value||_.isNaN(value)||(Cam4Storage.set(lastVolumeKey,value),0==value&&Cam4Storage.set(muteVolumeKey,!0))}function getLastVolumeValue(){var value=Cam4Storage.get(lastVolumeKey);return null===value||_.isNaN(Number(value))?DEFAULT_VOLUME_VALUE:parseInt(value)}function isMuted(){var value=Cam4Storage.get(muteVolumeKey);return null!==value?"true"==value:DEFAULT_MUTED_VALUE}function setMicrophoneImage(value){var states=["muted","state-4"].join(" ");ChatUI.volume.element.removeClass(states),value?ChatUI.volume.element.addClass("state-4"):ChatUI.volume.element.addClass("muted")}function setMicrophoneState(value){Cam4Storage.set(microphoneOn,value)}function getMicrophoneState(){var value=Cam4Storage.get(microphoneOn);return null===value||"true"==value}function setSliderValue(value){null===value||_.isNaN(value)||ChatUI.volume.slider.slider("option","value",parseInt(value))}function setVolume(value){var status=!1;try{Cam4User.cameraData.useHlsVideoOnMobile?HLS.setVolume(value):"undefined"!=typeof WebRTCPlayer?WebRTCPlayer.setVolume(value):flashObj?flashObj.setSoundVolume(parseFloat(value)):console.error("Unable to set sound volume"),status=!0}catch(ex){status=!1}return status}function mute(){Cam4Storage.set(muteVolumeKey,!0),refreshValues()}function unMute(){Cam4Storage.set(muteVolumeKey,!1);var volume=getLastVolumeValue();0==volume&&setLastVolumeValue(volume=50),refreshValues()}function changeVolume(volume){Cam4Storage.set(muteVolumeKey,!1),setLastVolumeValue(volume),refreshValues()}function refreshValues(){var volume=getLastVolumeValue();isMuted()?(setVolumeImage(0),setVolume(0)):(setVolumeImage(volume),setVolume(volume/100)),setSliderValue(volume)}var DEFAULT_VOLUME_VALUE=50,DEFAULT_MUTED_VALUE=!1,lastVolumeKey="lastVolumeValue",muteVolumeKey="muteVolume",lastValue=getLastVolumeValue(),microphoneOn="microponeState"+Cam4User.userName,externalClickHandler=void 0;return{init:function(){if(Cam4User.isBroadcaster()){if($("#slider").hide(),"external_encoder"==Chat.getBroadcastSettings().streamSource)return void $(".volume-wrapper").css({display:"none"});var performerSoundEnabled=getMicrophoneState();setMicrophoneImage(performerSoundEnabled);try{VideoCommunicator.client.enableSound(performerSoundEnabled)}catch(ex){console.log("FlashIbj.enableSound error",ex)}$(".volume-wrapper .volume").click(function(){setMicrophoneImage(performerSoundEnabled=!performerSoundEnabled);try{VideoCommunicator.client.enableSound(performerSoundEnabled)}catch(ex){console.log("FlashIbj.enableSound error",ex)}setMicrophoneState(performerSoundEnabled),void 0!==externalClickHandler&&externalClickHandler()})}else lastValue=getLastVolumeValue(),ChatUI.volume.slider.slider({range:!1,min:0,max:100,value:lastValue,step:2,slide:function(event,ui){changeVolume(ui.value)},stop:function(event,ui){changeVolume(ui.value)}}),ChatUI.volume.slider.find(".ui-slider-handle").addClass("nopop"),refreshValues(),ChatUI.volume.element.off("click"),ChatUI.volume.element.click(function(event){if(isMuted())unMute(),"undefined"!=typeof Cam4VideoAds&&Cam4VideoAds.getStreamType&&"isHls"===Cam4VideoAds.getStreamType()&&"undefined"!=typeof StreamSource&&(streamSource=StreamSource.getInstance()).unmute();else if(mute(),"undefined"!=typeof Cam4VideoAds&&Cam4VideoAds.getStreamType&&"isHls"===Cam4VideoAds.getStreamType()&&"undefined"!=typeof StreamSource){var streamSource=StreamSource.getInstance();streamSource.mute()}event.preventDefault(),void 0!==externalClickHandler&&externalClickHandler()})},mute:mute,unmute:unMute,set:setSliderValue,setPlayerVolume:setVolume,setVolumeImage:setVolumeImage,refreshValues:refreshValues,get:getLastVolumeValue,isMuted:isMuted,setExternalClickHandler:function(handler){externalClickHandler=handler}}}(),isMobileBroadcast="undefined"!=typeof mbaVersion&&mbaVersion>=100,checkIsVr2DStream=function(){return"undefined"!=typeof BROADCAST_RESOLUTION&&["720:2560","1440:1280","1200:800"].indexOf(BROADCAST_RESOLUTION)>-1},resolution=function(){function getPlayerWidth(_resolution){return Math.round(_resolution.width/_resolution.height*containerHeight)}function getResolutionName(dimensions){if(typeof dimensions==typeof{}&&"width"in dimensions&&"height"in dimensions)for(var i=0;i<resolutions.length;i++){var _resolution=resolutions[i];if(_resolution.width===dimensions.width&&_resolution.height===dimensions.height)return _resolution.name}return"sd_mac"}function getResolutionDimensions(name){for(var i=0;i<resolutions.length;i++){var _resolution=resolutions[i];if(_resolution.name===name)return _resolution}return null}function setActive(_state){resolution.state=_state}function getActive(){return resolution.state}function updateUI(_class){ChatUI.element.playerChatContainer.removeClass(resolutionsClasses.join(" ")).addClass(_class+"_stream");var newWidth=getPlayerWidth(getResolutionDimensions(getActive())),flashPlayer=document.getElementById("Cam4VChat");ChatUI.element.video.add(ChatUI.element.video.find("object")),"ar"!=Cam4User.lang&&(ChatUI.element.video.width(newWidth),ChatUI.element.firebaseContainer.css("padding-left",newWidth-paddingOffset)),flashPlayer&&(flashPlayer.width=newWidth),"resize"in ChatlessPlayer&&ChatlessPlayer.resize.updateAspectRatio()}function switchResolutionInFullScreen(resolution,resolutionName){setActive(resolutionName);var resolutionWhenExitFullScreenWidth=getPlayerWidth(resolution),aspectRatio=resolution.width/resolution.height;FullScreenApi.updateUIinFullScreen(aspectRatio,resolutionWhenExitFullScreenWidth)}function switchResolution(resolutionName){setActive(resolutionName),updateUI(getActive())}function setAspectRatio(_aspectRatio){aspectRatio=_aspectRatio}var aspectRatio,containerHeight=440,paddingOffset=0,isVr2DStream=checkIsVr2DStream(),resolutions=[{name:"hd",width:1280,height:720},{name:"sd_mac",width:480,height:360},{name:"hd_to_sd",width:640,height:360},{name:"sd",width:640,height:480},{name:"svga",width:800,height:600}],resolutionsClasses=resolutions.map(function(resolution){return resolution.name+"_stream"}),currentResolution="";return{state:"sd_mac",getActive:getActive,setActive:setActive,setResolutionFromDimensions:function(_resolution){if(!Cam4User.langIsRTL()){var resolutionName=getResolutionName(_resolution);JsReceiver.playerInFs?switchResolutionInFullScreen(_resolution,resolutionName):switchResolution(resolutionName)}},getCurrentResolution:function(){return currentResolution},setResolution:function(_resolution){var separator=_resolution.lastIndexOf(":"),_width=_resolution.substring(0,separator),_height=_resolution.substring(separator+1,_resolution.length);isVr2DStream&&("1200:800"==BROADCAST_RESOLUTION?(_width=600,_height=800):"720:2560"==BROADCAST_RESOLUTION?(_width=720,_height=1280):"2560:960"==BROADCAST_RESOLUTION&&(_width=1280,_height=960)),"1600:600"==_resolution&&(_width=800,_height=600),mbaVersion>4024&&mbaVersion<4027&&(Cam4User.cameraData.useHlsVideoOnMobile||Cam4User.cameraData.useFlashPlayer)?(setAspectRatio((_height/_width).toFixed(4)),currentResolution=_resolution,_resolution=_height+":"+_width,BROADCAST_RESOLUTION=_resolution):(setAspectRatio((_width/_height).toFixed(4)),currentResolution=_resolution,mbaVersion>4026&&(Cam4User.cameraData.useHlsVideoOnMobile||Cam4User.cameraData.useFlashPlayer)&&(BROADCAST_RESOLUTION=_resolution))},getAspectRatio:function(){return aspectRatio},setAspectRatio:setAspectRatio}}(),resize=function(){function setConstraints(){Cam4User.isBroadcaster()&&(isVr2DStream=checkIsVr2DStream());var mbaMinWidth=320+mbaOffset,mbaMaxWidth=400+mbaOffset;isMobileBroadcast?(constraints.minWidth=mbaMinWidth,constraints.maxWidth=mbaMaxWidth):(constraints.minWidth=Math.round(30*ChatUI.element.playerChatContainer.width()/100),constraints.maxWidth=Math.round(70*ChatUI.element.playerChatContainer.width()/100)),isVr2DStream&&("1200:800"==BROADCAST_RESOLUTION?constraints.minWidth=820:~["720:2560","1440:1280"].indexOf(BROADCAST_RESOLUTION)&&(constraints.minWidth=720)),player.resizable("option","minWidth",constraints.minWidth),player.resizable("option","maxWidth",constraints.maxWidth),isVr2DStream&&(Cam4User.isBroadcaster()&&(Cam4Event.addEventListener(Cam4Event.FULLSCREEN_STATE_CHANGED,updateVr2dStream),Cam4Event.addEventListener(Cam4Event.FULL_SCREEN_CHANGED,updateVr2dStream)),updateVr2dStream())}function showChat(){Cam4User.langIsRTL()&&$j(".chatlessPlayer").css("width","530px"),ChatUI.element.containerHeader.show(),ChatUI.element.fakeChatDiv.show()}function updatePlayer(videoContainerWidth,videoContainerHeight){var aspectRatio=ChatlessPlayer.resolution.getAspectRatio(),width=videoContainerWidth,height=width/aspectRatio;height>videoContainerHeight&&(width=(height=videoContainerHeight)*aspectRatio),player.css({width:videoContainerWidth,height:videoContainerHeight}).find("object").css({width:width,height:height})}function updateChat(width,height){mbaOffset=300;width="object"!=typeof width&&void 0!==width?width:player.outerWidth(),height="object"!=typeof height&&void 0!==height?height:player.height();var playerContainerWidth=width;if(controlledFeatureFixedChatAndViewerView){playerContainerWidth=$("#broadcastingApp").width()-chatWidth;var dimensions=calculateDimensions();width=dimensions.width,height=dimensions.height}11==BrowserDetect.isMSIE()&&(height+=29),updatePlayer(playerContainerWidth,height),isMobileBroadcast&&100==mbaVersion&&Cam4User.cameraData.useHlsVideoOnMobile&&(broadcastResolutionsLandscape.indexOf(BROADCAST_RESOLUTION)>-1?player.find("video").addClass("ios-broadcast"):(player.find("video").removeClass("ios-broadcast"),void 0!==iosBroadcasterReconnectForRotation&&clearTimeout(iosBroadcasterReconnectForRotation),iosBroadcasterReconnectForRotation=setTimeout(function(){StreamSource.getInstance().reconnect()},15e3))),window.matchMedia("(min-width: 729px)").matches&&(controlledFeatureFixedChatAndViewerView?chat.css({"padding-left":$("#broadcastingApp").width()-chatWidth}):chat.css({"padding-left":width}));var newChatHeight=getNewChatHeight();Cam4User.isLoggedIn||"Phone"===cam4UserAgent||(newChatHeight+=29);var fakechatDiv=$("#fakechatDiv");newChatHeight-=parseInt(fakechatDiv.css("border-top-width"),10)+parseInt(fakechatDiv.css("border-bottom-width"),10),$("#tab1C").height(newChatHeight),$("#tab2C").height(newChatHeight+ChatUI.element.chatInput.outerHeight()),$("#lists").height(newChatHeight+ChatUI.element.chatInput.outerHeight()-ChatUI.element.userBar.outerHeight()),$(".infoUsersBar").height("100%"),isVrStream&&$("#vr-wrapper").css({width:width,height:height}),isVr2DStream&&updateVr2dStream()}function getNewChatHeight(){return"Phone"===cam4UserAgent?Math.round(ChatUI.element.playerChatContainer.height()-player.height()-ChatUI.element.chatInput.outerHeight()):Math.round(player.height()-ChatUI.element.containerHeader.outerHeight()-ChatUI.element.chatInput.outerHeight())}function initResize(){loadSavedDimensions()}function updateVr2dStream(){function calculateAspectRatioFit(srcWidth,srcHeight,maxWidth,maxHeight){var ratio=Math.min(maxWidth/srcWidth,maxHeight/srcHeight);return{width:srcWidth*ratio,height:srcHeight*ratio}}var VR_2D_STREAM_WIDTH,VR_2D_STREAM_HEIGHT,vr=$("#vr-wrapper"),resizeObject=$(".chatlessPlayer");"1200:800"==BROADCAST_RESOLUTION?(VR_2D_STREAM_WIDTH=600,VR_2D_STREAM_HEIGHT=800):~["720:2560","1440:1280"].indexOf(BROADCAST_RESOLUTION)&&(VR_2D_STREAM_WIDTH=720,VR_2D_STREAM_HEIGHT=1280),function(){var _sizes=calculateAspectRatioFit(VR_2D_STREAM_WIDTH,VR_2D_STREAM_HEIGHT,resizeObject.width(),resizeObject.height());vr.css({width:_sizes.width,height:_sizes.height})}()}function loadSavedDimensions(){var width=getLastDimensions();if((ControlledFeatures&&!ControlledFeatures.FIXED_WIDTH_CHAT||Cam4User.isBroadcastingWindow)&&setAndUpdateResize(),settings.saveState&&width!==JSON.stringify({})){isMobileBroadcast&&width>constraints.maxWidth-mbaOffset&&(width=constraints.maxWidth-mbaOffset);var height=parseInt(width/getAspectRatio());if((mbaVersion>4026||100===mbaVersion)&&broadcastResolutionsLandscape.indexOf(BROADCAST_RESOLUTION)>-1&&(width=700,height=Cam4User.cameraData.useFlashPlayer?400:394),mbaVersion>4024&&mbaVersion<4027&&(Cam4User.cameraData.useFlashPlayer&&"512:288"===BROADCAST_RESOLUTION&&(width=700,height=400),Cam4User.cameraData.useHlsVideoOnMobile&&"512:288"===BROADCAST_RESOLUTION&&(height=394)),controlledFeatureFixedChatAndViewerView){var dimensions=calculateDimensions();width=dimensions.width,height=dimensions.height}updateChat(width,height)}}function getAspectRatio(){var fallback=(4/3).toFixed(4);return resolution.getAspectRatio()||fallback}function setAndUpdateResize(){if(!BrowserDetect.isIOS()){var options={aspectRatio:getAspectRatio(),resize:updateChat,stop:function(ui,event){updateChat(ui,event),BrowserDetect.isMSIE()>=12&&saveCurrentDimensions()}};BrowserDetect.isMSIE()>=12&&(options.helper="ui-resizable-helper"),player.resizable(options).on("resize",function(event){event.stopPropagation()}),setConstraints()}}function saveDimensions(_width){Cam4Storage.set("resizeWidth",JSON.stringify(_width))}function saveCurrentDimensions(){settings.saveState&&saveDimensions(player.width())}function getLastDimensions(){var value=Cam4Storage.get("resizeWidth")||constraints.defaultWidth;return value?JSON.parse(value):{}}var isVr2DStream=checkIsVr2DStream(),defaultWidth=640,mbaOffset=300,settings={saveState:Cam4User.userName!=Cam4User.performerName};if(Cam4User.langIsRTL())return{init:function(){},settings:settings,updateAspectRatio:function(){},showChat:showChat,updateChat:function(){}};Cam4User.cameraData.useHlsVideoOnMobile&&(defaultWidth=Math.round(50*ChatUI.element.playerChatContainer.width()/100)),isVr2DStream&&("1200:800"==BROADCAST_RESOLUTION?defaultWidth=820:~["720:2560","1440:1280"].indexOf(BROADCAST_RESOLUTION)&&(defaultWidth=720),Cam4Event.addEventListener(Cam4Event.FULLSCREEN_STATE_CHANGED,updateVr2dStream),Cam4Event.addEventListener(Cam4Event.FULL_SCREEN_CHANGED,updateVr2dStream));var player=ChatUI.element.video,chat=ChatUI.element.firebaseContainer,constraints={minWidth:0,maxWidth:0,maxHeight:0,defaultWidth:defaultWidth};return{init:function(){Cam4User.langIsRTL()||(isMobileBroadcast="undefined"!=typeof Chat&&Chat.getMbaVersion()>=100,initResize())},settings:settings,updateAspectRatio:function(){setConstraints(),player.resizable("option","aspectRatio",player.width()/player.height())},showChat:showChat,updateChat:updateChat,updatePlayer:updatePlayer,saveDimensions:saveDimensions,loadSavedDimensions:loadSavedDimensions}}(),lazyLayout=_.debounce(function(){if(controlledFeatureFixedChatAndViewerView&&calculateChatWidth(),window.matchMedia("(min-width: 729px)").matches&&"regular"===FullScreenApi.getState()&&!Cam4User.isBroadcastingWindow)if(controlledFeatureFixedChatAndViewerView){var dimensions=calculateDimensions();ChatlessPlayer.resize.updateChat(dimensions.width,dimensions.height)}else ChatlessPlayer.resize.updateChat()},10);$(window).on("resize",lazyLayout);var tippingSound=function(){function setMuted(_state){tippingSound.state=_state}function isMuted(){return tippingSound.state}function setTippingSoundValue(value){Cam4Storage.set("tippingSoundValue",value)}function getTippingSoundValue(){return"true"==Cam4Storage.get("tippingSoundValue")}var toggleButtonClasses=["active"],toggleButton={};return toggleButton.clear=function(){ChatUI.element.tsToggleButton.removeClass(toggleButtonClasses.join(" "))},toggleButton.mute=function(){toggleButton.clear(),ChatUI.element.tsToggleButton.addClass("active")},toggleButton.unmute=function(){toggleButton.clear()},{init:function(){setMuted(getTippingSoundValue()),isMuted()?toggleButton.mute():toggleButton.unmute(),ChatUI.element.tsToggleButton.on("click",function(event){tippingSound.toggleSpButton(),setTippingSoundValue(isMuted()),event.preventDefault()})},isMuted:isMuted,setMuted:setMuted,toggleSpButton:function(){tippingSound.isMuted()?(tippingSound.setMuted(!1),toggleButton.unmute()):(tippingSound.setMuted(!0),toggleButton.mute())},state:!1}}(),ignore=function(){return{init:function(){$("#containerFirebase").on("click",".ignore",function(){Cam4User.isLoggedIn||Cam4User.isLoggedInAsGuest?Cam4User.isLoggedInAsGuest&&Registration.activateGuestRegisterModal():Utils.decideOffer()})}}}(),roomMessage=function(){var lastMessage="";return{update:function(message){lastMessage!=message&&(notification.add(chatlessPlayerI18n.room_updated),ChatUI.playerHeader.performer.footer.text(message)),lastMessage=message}}}(),notification=function(){function remove(notification){notification.remove()}var NOTIFICATION_REMOVE_DELAY=2e3,template="<div></div>",templateProperties={class:"notification"};return{add:function(message){var newNotification=$(template,templateProperties);newNotification.text(message),newNotification.appendTo(ChatUI.playerHeader.element),setTimeout(function(){remove(newNotification)},NOTIFICATION_REMOVE_DELAY)}}}();return{isEnabled:isChatlessPlayer,reconnect:reconnect,disconnect:function(){isChatlessPlayer()&&(setState("disconnected"),JsSender.disconnectStream())},showGuestGS:function(){"undefined"!=typeof NewShowReceiver&&this.gsState!==NewShowState.guestInGroupShow&&(NewShowReceiver.onNewShowStateChanged(NewShowState.guestInGroupShow),this.gsState=NewShowState.guestInGroupShow)},hideGuestGS:function(){"undefined"!=typeof NewShowReceiver&&this.gsState===NewShowState.guestInGroupShow&&(NewShowReceiver.onNewShowStateChanged(NewShowState.guest),this.gsState=NewShowState.guest)},mute:function(){volume.mute()},unmute:function(){volume.unmute()},volume:volume,resolution:resolution,tippingSound:tippingSound,resize:resize,ignore:ignore,notification:notification,roomMessage:roomMessage,getState:function(){return state},setState:setState,setToken:function(arg){void 0!==arg.playToken&&(playToken=arg.playToken,JsSender.setPlayToken(playToken),console.log("ChatlessPlayerSource.setToken",arguments),reconnect(!0))},clearToken:function(){playToken=""},getToken:function(){return playToken},getType:function(){return type},showPlayer:function(show){show?$j("#Cam4VChat").css("display",""):$j("#Cam4VChat").css("display","none")}}}();ChatlessPlayer.stop=ChatlessPlayer.disconnect,ChatlessPlayer.connect=function(){console.log("ChatlessPlayerSource.connect",arguments)},ChatlessPlayer.resume=function(){console.log("ChatlessPlayerSource.resume",arguments)};var deviceOrientation=function(){function setPortrait(){$("#video").after(privateShowContainer),$("#NSBar").prepend(mobileShows.show())}function setLandscape(){$(window).width()>videoBesideChatBreakpoint&&($("#broadcastingApp").after(privateShowContainer),$("#mainPSButton").after(mobileShows))}if(UserAgent.phone){var Orientation=window.matchMedia("(orientation: portrait)"),privateShowContainer=$("#privateShowContainer"),mobileShows=$("#mobileShows"),videoBesideChatBreakpoint=728;Orientation.matches||setLandscape(),Orientation.addListener(function(m){m.matches?setPortrait():setLandscape()})}}();
var Trie=function(){function findNextTrieUser(username,lastNode){var position;if(nextFoundUser="",findedNode=parseTrieOnLeft(lastNode),findedNode&&(nextFoundUser=username+nextFoundUser),""==nextFoundUser){var index=username.length-1;for(parentNode=lastNode;void 0!=parentNode.parentNode&&(parentNode=parentNode.parentNode,position=getNextChild(parentNode,trieMap[username.charCodeAt(index)]),nextFoundUser=username.substr(0,index)+nextFoundUser,index--,!(position>-1&&(findedNode=parseTrieOnLeft(parentNode.link[position]),findedNode))););}return nextFoundUser=""==nextFoundUser?TRIE_TERMINAL_ENTRY:nextFoundUser}function parseTrieOnLeft(startNode){var position;if(void 0==startNode.link)return!1;for(node=startNode;0==node.end;)position=getFirstChild(node),nextFoundUser+=charMap[position],node=node.link[position];return""!=nextFoundUser&&node}function getFirstChild(node){var position=-1;for(i=0;i<mapSize;i++)if(void 0!=node.link[i]){position=i;break}return position}function getNextChild(node,ord){nextFoundUser="";var position=-1;for(i=ord+1;i<mapSize;i++)if(void 0!=node.link[i]){position=i,nextFoundUser+=charMap[position];break}return position}function searchUsernameInTrie(username){for(var node=rootNode,i=0;i<username.length;i++){if(void 0===node)return node;node=node.link[trieMap[username.charCodeAt(i)]]}return node}function combineUsernameAndInfo(username,roomname,access_level,userType){return username=username==roomname?"a"+username:userType===FirebaseStructure.ViewerType.VR?"f"+username:"general"!=access_level?"g"+username:"n"+username}var index,TRIE_TERMINAL_ENTRY="zzzzzzzzzzzzz",nextFoundUser="",acceptedSet=" -0123456789abcdefghijklmnopqrstuvwxyz_",mapSize=acceptedSet.length,charMap=[],trieMap=[],rootNode={link:new Array(mapSize),end:0,children:0};return{addUsername:function(username,roomname,access_level,userType){if("admin"!=access_level&&"moderator"!=access_level){username!=TRIE_TERMINAL_ENTRY&&(username=combineUsernameAndInfo(username,roomname,access_level,userType));var newNode,lastNode,nextNode=rootNode;for(parentNode=rootNode,nextFoundUser="",i=0;i<username.length;i++)index=trieMap[username.charCodeAt(i)],void 0==nextNode.link||void 0==nextNode.link[index]?(newNodeArray=new Array(mapSize),i<username.length-1?end=0:end=1,newNode={link:newNodeArray,end:end,parentNode:parentNode,children:0},nextNode.link[index]=newNode,nextNode.children++,nextNode=newNode):(nextNode=nextNode.link[index],i==username.length-1&&(nextNode.end=1)),lastNode=nextNode,parentNode=nextNode;return nextFoundUser=findNextTrieUser(username,lastNode)}},deleteUsername:function(username,roomname,access_level,userType){"admin"!=access_level&&(username=combineUsernameAndInfo(username,roomname,access_level,userType));var node=searchUsernameInTrie(username);if(void 0===node)return!1;if(index=username.length-1,node.children>0)node.end=0;else for(;void 0!=node.parentNode&&(node=node.parentNode,node.link[trieMap[username.charCodeAt(index)]]=null,delete node.link[trieMap[username.charCodeAt(index)]],node.children--,index--,!(node.children>0)););return!0},mapChars:function(){for(i=0;i<acceptedSet.length;i++)charMap[i]=acceptedSet.charAt(i),trieMap[acceptedSet.charCodeAt(i)]=i},rootNode:rootNode,TRIE_TERMINAL_ENTRY:TRIE_TERMINAL_ENTRY}}();
var ChatSettings=function(){function showDropdownMenu(visible){return visible?$("#chatSettingsList").css("top",$("#showChatSettings").height()).show():$("#chatSettingsList").hide(),menuVisible=visible,visible}function toggleDropDownMenu(){menuVisible=showDropdownMenu(menuVisible?!1:!0)}function enableFilters(status,skipSelf){status?$j("#enabledFilters").addClass("enabled").find("input, select").removeAttr("disabled"):$j("#enabledFilters").removeClass("enabled").find("input, select").attr("disabled","disabled"),skipSelf||$j("#enableFilters").attr("checked",status)}function enableGender(enabled,gender){$j("#allowByGender").prop("checked",enabled),enabled&&$("#selectedGender").val(gender)}function saveChatSettings(obj){console.log("saveChatSettings ",obj);var url=cam4WebChatHost+"chatSettings";$j.ajax({type:"POST",url:url,data:obj,success:function(e){e.hasOwnProperty("jwtToken")&&window.location.reload()},error:function(err){console.log(err)}})}function loadChatSettings(){var url=cam4WebChatHost+"chatSettings?userName="+Cam4User.userName;$j.ajax({type:"GET",url:url,success:function(data){processChatSettings(data),ConnectionLogger.logEvent("CHAT_SETTINGS_SUCCESS","","")},error:function(jqXHR,textStatus){ConnectionLogger.logEvent("CHAT_SETTINGS_ERROR",textStatus,"")}})}function settingsPrivateChat(disablePrivateChat){Chat.privateMessageOn(),disablePrivateChat?(ChatUIController.closeAllPrivateMessageTabs(),Chat.privateMessageOff(),$("#sendMessageTo").hide()):(ChatUIController.clearPrivateMessageDOM(),$("#sendMessageTo").show())}function settingsAvatars(showAvatarsInChat){$("#showAvatarsInChat").prop("checked",showAvatarsInChat),showAvatarsInChat?ChatUIController.avatarsOn():ChatUIController.avatarsOff()}function settingsFontSize(fontSize){$("#fontSizeSelector").find("option").removeAttr("selected").end().find("option[value="+fontSize+"]").attr("selected","selected"),ChatUIController.setFontSize(fontSize)}function settingsStealthMode(stealthMode){~stealthMode.lastIndexOf("|")&&(settings.stealthToken=stealthMode.substr(stealthMode.lastIndexOf("|")+1,stealthMode.length),stealthMode=stealthMode.substr(0,stealthMode.lastIndexOf("|"))),Cam4User.stealthModeValue="hidden_anonymous"===stealthMode?settings.stealthToken:"",$("#stealthModeValue").val(stealthMode)}function processChatSettings(data){data.disablePrivateChat!=settings.disablePrivateChat&&settingsPrivateChat(data.disablePrivateChat),$("#disablePrivateChat").prop("checked",data.disablePrivateChat),$("#allowPrivateMessagesFromOtherViewers").prop("checked",data.allowPrivateMessagesFromOtherViewers),$("#turnOffRoomInvites").prop("checked",data.turnOffRoomInvites),enableFilters(data.enableFilters),data.allowMyLanguage!=settings.allowMyLanguage&&$("#allowMyLanguage").prop("checked",data.allowMyLanguage),data.allowGender!=settings.allowGender&&enableGender(data.allowGender,data.selectedGender),settingsAvatars(data.showAvatarsInChat),settingsFontSize(data.normalScreenFontSize),data.notifyIEnterRoom!=settings.notifyIEnterRoom&&$("#notifyIEnterRoom").prop("checked",data.notifyIEnterRoom),data.allowByTokensOnly!=settings.allowByTokensOnly&&$("#allowByTokensOnly").prop("checked",data.allowByTokensOnly),data.allowFriends!=settings.allowFriends&&$("#allowFriendsFavorites").prop("checked",data.allowFriends),Cam4User.isBroadcastingWindow&&void 0!==data.receiveGoldEnterNotification&&$("#doNotShowGoldNotification").prop("checked",!data.receiveGoldEnterNotification),"MBA"===Cam4User.broadcastSource&&Chat.privateMessageOff(),Cam4User.performerName!=Cam4User.userName&&data.stealthModeValue!=settings.stealthModeValue&&settingsStealthMode(data.stealthModeValue);for(var key in data)data.hasOwnProperty(key)&&(settings[key]=data[key]);Cam4User.isBroadcaster()&&($("#mutePrivateShowSound").prop("checked",!data.privateShowSound),data.privateShowSound!=settings.privateShowSound&&(settings.privateShowSound=data.privateShowSound))}function showChatSettings(){Utils.closeModalPops(),$j("#chatSettings").modal("show"),$j("#enableFilters").off().on("click",function(){Cam4User.isPayingMember()||Cam4User.isBroadcastingWindow?enableFilters($j("#enableFilters").is(":checked"),!0):(Registration.showGoldUpgradeOverlay("chat-filters"),$j("#enableFilters").attr("checked",!1))}),PageStatus.has("online_performer")&&$("#notifyLine").hide(),Cam4User.accessLevel<=AccessLevel.GENERAL&&!ControlledFeatures.GOLD_FREE_FEATURES&&$("#stealthModeBar").hide()}function updateSettings(listInDirectory,password){Cam4User.streamingData.broadcastSettings.listInDirectory=listInDirectory,Cam4User.streamingData.broadcastSettings.password=password}function validateRoomPass(){var roomPassInput=$j("#RoomPassword"),check=Utils.isAlphanumericString(roomPassInput.val());return check?roomPassInput.css("border-color","black"):roomPassInput.css("border-color","red"),check}function appendUsers(container,html){container.append(html)}function buildUser(type,username){return'<li id="'+type+username+'"><span>'+username+'</span><span data-username="'+username+'" class="removeButton btn btn-xs btn-link grey-link">'+js_i18n.remove+"</span></li>"}function isUserInList(type,userName){return $("#"+type+userName).length>0}function removeUser(self,type,user){var data={recipient:user};switch(type){case"bu_":data.type="unBan";break;case"su_":data.type="unsilence";break;case"mu_":data.type="remove_moderator"}$j(self).empty().addClass("spinner"),LogicObj.callWebchat("sendNotification",data)}var settings={username:Cam4User.userName,roomName:roomName,accessHash:Cam4User.kN,stealthModeValue:"visible",allowMyLanguage:!1,enableFilters:!1,selectedGender:"male",fullScreenFontSize:22,normalScreenFontSize:14,showAvatarsInChat:!0,allowFriends:!1,disablePrivateChat:!0,allowPrivateMessagesFromOtherViewers:!0,turnOffRoomInvites:!1,allowGender:!1,notifyIEnterRoom:!1,stealthToken:"",allowByTokensOnly:!1,receiveGoldEnterNotification:!0,privateShowSound:!0},lastTabIndex=1,menuVisible=!1,privateMode=!1;return{initSettingsPanel:function(){$j("#closeChatSettings").on("click",function(){Utils.closeModalPops()}),loadChatSettings(),$j("#saveChatSettingsButton").on("click",function(){var data={username:Cam4User.userName,accessHash:Cam4User.kN,disablePrivateChat:$j("#disablePrivateChat").is(":checked"),allowPrivateMessagesFromOtherViewers:$j("#allowPrivateMessagesFromOtherViewers").is(":checked"),turnOffRoomInvites:$j("#turnOffRoomInvites").is(":checked"),normalScreenFontSize:$j("#normalScreenFontSize").val(),showAvatarsInChat:$j("#showAvatarsInChat").is(":checked"),enableFilters:$j("#enableFilters").is(":checked"),allowFriends:$j("#allowFriendsFavorites").is(":checked"),allowMyLanguage:$j("#allowMyLanguage").is(":checked"),allowGender:$j("#allowByGender").is(":checked"),selectedGender:$j("#selectedGender").val(),notifyIEnterRoom:$j("#notifyIEnterRoom").is(":checked"),stealthModeValue:$j("#stealthModeValue").val(),allowByTokensOnly:$j("#allowByTokensOnly").is(":checked"),roomName:settings.roomName};Cam4User.isBroadcastingWindow&&(data.receiveGoldEnterNotification=!$j("#doNotShowGoldNotification").is(":checked"),data.privateShowSound=!$j("#mutePrivateShowSound").is(":checked"),ControlledFeatures.EXTERNAL_ENCODER_NO_VIDEO&&"external_encoder"==Chat.getBroadcastSettings().streamSource&&BroadcastStatus.setStatus($j("#settingsStatusMessage").val())),processChatSettings(data),saveChatSettings(data),Utils.closeModalPops()}),$j("body").on("click",function(){menuVisible&&!PageStatus.has("online_viewer")&&(menuVisible=showDropdownMenu(!1))}),$j("#showChatSettings").on("click",function(e){if(e.stopPropagation(),PageStatus.has("online_viewer")){if(ControlledFeatures.SILENCE_FEATURE)return 1==Chat.getUser(Cam4User.userName).isRoomModerator?($("#chatSettingsList").find("li").not(":nth-child(1)").hide(),void ChatSettings.showScreen(ChatSettings.broadcasterSettingsMenu.chatSettings)):($("#chatSettingsList li").show(),$("#chatSettingsList li").not("#chatSettingsList li:eq(0), #manageSilences").hide(),void toggleDropDownMenu());$("#chatSettingsList").find("li").not(":nth-child(1)").hide(),ChatSettings.showScreen(ChatSettings.broadcasterSettingsMenu.chatSettings)}else toggleDropDownMenu()})},showChatSettings:showChatSettings,updatePrivateRoom:function(privateModeParam){if(!privateModeParam||validateRoomPass()){var obj={username:Cam4Performer.name,accessHash:Cam4User.kN,roomName:Cam4Performer.name,listInDirectory:!privateModeParam,allowFriends:$("#AllowFriends").is(":checked"),password:$("#RoomPassword").val(),privateMode:privateModeParam,usersString:function(){for(var selectedItems=$("#PrivateBroadcastList li.selected span"),names=[Cam4Performer.name],i=0;i<selectedItems.length;i++)names.push($(selectedItems[i]).text());return names.join(",")}(),chatless:!0};$("#AllowSexUsers").is(":checked")&&(obj.autoAllowSex=$("#SexUserType").val().toLowerCase());var url=cam4WebChatHost+"privateRoom";$j.ajax({type:"POST",url:url,data:obj,success:function(){Utils.closeModalPops(),privateMode=privateModeParam,Cam4User.streamingData.broadcastSettings.privateRoom=privateMode,updateSettings(obj.listInDirectory,obj.password),ChatSettings.setPrivate(privateMode)}})}},showScreen:function(index){if(Cam4User.accessLevel<=AccessLevel.GENERAL&&index==ChatSettings.broadcasterSettingsMenu.privateMode&&!Cam4User.intercomEnabled&&!ControlledFeatures.GOLD_FREE_FEATURES)return Utils.closeModalPops(),void Chat.newShowsConfirmation("Cam4",js_i18n.requiresCam4Gold.replace("{0}",js_i18n.toStartPrivateRoom),"basicPrivateRoom");showChatSettings(),showDropdownMenu(!1),$("#csTab1, .csTab").hide(),$("#csTab"+index).show();var settingsPanelTitle=$("#chatSettingsTitle");switch(index){case ChatSettings.broadcasterSettingsMenu.chatSettings:$("#settingsStatusMessage").val(BroadcastStatus.getStatus()),settingsPanelTitle.text(js_i18n.chatSettings);break;case ChatSettings.broadcasterSettingsMenu.manageBans:settingsPanelTitle.text(js_i18n.manageBans);break;case ChatSettings.broadcasterSettingsMenu.manageSilences:settingsPanelTitle.text(js_i18n.manageSilences);break;case ChatSettings.broadcasterSettingsMenu.manageModerators:settingsPanelTitle.text(js_i18n.manageModerators);break;case ChatSettings.broadcasterSettingsMenu.privateMode:if(privateMode)$("#chatSettingsTitle").text(js_i18n.changePrivateRoomSettings),$("#StartPrivateRoom").text(js_i18n.saveSettings),$("#csTab4").find(".userlist, .button-list, .message").hide(),$("#StartPublicRoom").css("display","inline-block"),$("#StartPrivateRoom").attr("onclick","ChatSettings.updatePrivateRoom(true)"),$("#StartPublicRoom").attr("onclick","ChatSettings.updatePrivateRoom(false)");else{settingsPanelTitle.text(js_i18n.startPrivateRoom),$("#StartPrivateRoom").text(js_i18n.startPrivateBroadcast),$("#csTab4").find(".userlist, .button-list, .message").show(),$("#StartPublicRoom").hide(),$("#StartPrivateRoom").attr("onclick","ChatSettings.updatePrivateRoom(true)");var htmltext="";for(var user in Chat.globalUsers)if(Chat.globalUsers.hasOwnProperty(user)){if(user==Cam4Performer.name.toLowerCase()||"admin"==Chat.globalUsers[user].access_level)continue;Chat.globalUsers[user].showOnline&&Chat.globalUsers[user].isOnline&&(htmltext+='<li onclick="ChatSettings.toogleUser(this)"><div class="thmbImg"><img src="'+Chat.globalUsers[user].imageCDN+'"/></div> <span>'+Chat.globalUsers[user].original_username+"</span></li>")}$("#PrivateBroadcastList").html(htmltext)}}lastTabIndex=index},toogleUser:function(element){$(element).hasClass("selected")?$(element).removeClass("selected"):$(element).addClass("selected")},selectAllPrivate:function(){$j("#PrivateBroadcastList li").each(function(){$(this).hasClass("selected")||$(this).addClass("selected")})},unselectAllPrivate:function(){$j("#PrivateBroadcastList li").removeClass("selected")},validateRoomPass:validateRoomPass,buildUser:buildUser,removeUser:removeUser,removeUserFromList:function(type,userName){$("#"+type+userName).remove()},bindRemoveUser:function(container,type){container.on("click",".removeButton",function(){removeUser(this,type,this.dataset.username)})},removeAllSilencedUsers:function(){var data={type:"unSilenceAll"};LogicObj.callWebchat("sendNotification",data)},removeAllBannedUsers:function(){var data={type:"unBanAll"};LogicObj.callWebchat("sendNotification",data)},removeAllModerators:function(){var data={type:"removeAllModerators"};LogicObj.callWebchat("sendNotification",data)},toggleDropDownMenu:toggleDropDownMenu,setFontSize:function(){var value=$("#fontSizeSelector").find("option:selected").val();$("#normalScreenFontSize").val(value)},addUserInList:function(container,type,userName){isUserInList(type,userName)||appendUsers(container,buildUser(type,userName))},appendUsers:appendUsers,loadChatSettings:loadChatSettings,setPrivate:function(status){(privateMode=status)?$j("#privateModeMenu").text(js_i18n.changePrivateRoomSettings):$j("#privateModeMenu").text(js_i18n.goPrivate)},setPassword:function(password){$j("#RoomPassword").val(password)},goldNotification:function(){return settings.receiveGoldEnterNotification},broadcasterSettingsMenu:{chatSettings:1,manageBans:2,manageSilences:3,manageModerators:5,privateMode:4},cancel:function(){loadChatSettings(),ChatSettings.hide()},hide:function(){showDropdownMenu(!1);try{$("#chatSettings").modal("hide")}catch(ex){console.warn("Error on closing chat settings modal : ",ex)}},getSettings:function(){return settings},isPrivate:function(){return privateMode}}}();
var GoldEnteredRoom=function(){function currentTimeStamp(){return(new Date).getTime()/1e3}var goldPresenceList={},goldEnteredRoomExpireTime=20;return{goldEnteredRoom:function(username){return(void 0===goldPresenceList[username]||currentTimeStamp()-goldPresenceList[username]>goldEnteredRoomExpireTime)&&(goldPresenceList[username]=currentTimeStamp(),!0)}}}();
var ChatPreview=function(){function handlePreviewState(username,showState,preview,overlay){var cssStyle={"padding-top":"30%","font-size":parseInt(.1*overlay.width())+"px"};switch(showState){case"d":case"m":overlay.hasClass("fakeOffline")&&(closePreview(preview,username),openPreview(username));break;case"ps":overlay.addClass("fakeOffline").css(cssStyle).html(Cam4Chat.inPrivateShow);break;case"gs":overlay.addClass("fakeOffline").css(cssStyle).html(Cam4Chat.inGroupShow);break;case"pr":overlay.addClass("fakeOffline").css(cssStyle).html(Cam4Chat.inPrivateRoom);break;default:overlay.addClass("fakeOffline").css(cssStyle).html(Cam4Chat.closed)}}function preparePreview(username,currentCamContainer){var container=$j("#containerFirebase"),currentCam=$("#"+currentCamContainer),currentHeight=currentCam.height(),currentWidth=currentCam.width(),previewDiv=document.createElement("div");previewDiv.id=username+"_preview",previewDiv.className="preview-window",container.prepend(previewDiv);var preview=$j("#"+username+"_preview");preview.zIndex(++previewValues.zIndex),preview.width("210px").height(parseInt(currentHeight*(1/3))).css({left:currentWidth+previewValues.position-6,top:previewValues.position}),previewValues.position>position.limit&&(previewValues.position=0),previewValues.position+=position.increment,preview.prepend('<div id="frameOverlay-'+username+'" class="frameOverlay"></div>');var frameOverlay=preview.find(".frameOverlay");return preview.draggable({containment:"#broadcastingApp",handle:".frameOverlay .preview-name"}),preview.resizable({containment:"#broadcastingApp",aspectRatio:!0,minWidth:100,minHeight:71.4,maxHeight:currentHeight,maxWidth:currentWidth,resize:function(){frameOverlay.height()>70?frameOverlay.find("#preview-message").css("margin-top","10px"):frameOverlay.find("#preview-message").css("margin-top","5px"),frameOverlay.css("font-size",parseInt(.1*frameOverlay.width())+"px")}}),window.matchMedia("(orientation: portrait)").addListener(function(m){preview.css({top:previewValues.Pos+"px",left:previewValues.Pos-position.increment+"px"}),preview.width(parseInt(currentWidth*(1/3))).height(parseInt(currentHeight*(1/3))),frameOverlay&&frameOverlay.css("font-size",parseInt(.1*frameOverlay.width())+"px"),previewValues.Pos+=position.increment,previewValues.Pos>position.reset&&(previewValues.Pos=position.increment)}),preview.prepend('<div class="preview-name">'+username+'<p class="preview-close"><span style="cursor:pointer">X</span></p></div>'),preview.find(".preview-close").on("click",function(){closePreview(preview,username)}),preview.show(),preview}function openPreview(username){UserAgent.desktop&&!Cam4User.cameraData.useHlsVideoOnMobile&&"webrtc"!=Cam4User.streamingData.broadcastSettings.streamSource?flashPreview(username):mobilePreview(username)}function closePreview(preview,username){previewValues.position-=position.increment,preview.remove(),"hls"==previewValues.objects[username].type&&previewValues.objects[username].hls.stop(),delete previewValues.objects[username]}function checkIfAlreadyPreviewed(username){return $j("#containerFirebase").find("#"+username+"_preview").length}function flashPreview(username){checkIfAlreadyPreviewed(username)||(preparePreview(username,"Cam4VChat"),$.ajax({url:"/"+username+"/flashVars",success:function(data){var id=username+"_preview";data.flashVars.isPictureInPicture=!0,data.flashVars.flashId=id,SwfUtils.generateSwfTag(data,!1,id).into("frameOverlay-"+username),previewValues.objects[username]={type:"flash"}},error:function(xhr,ajaxOptions,thrownError){if(401==xhr.status){var overlay=$j("#"+username+"_preview").find(".frameOverlay"),cssStyle={"padding-top":"30%","font-size":parseInt(.1*overlay.width())+"px"};overlay.addClass("fakeOffline").css(cssStyle).html(Cam4Chat.previewNotAvailable)}}}))}function mobilePreview(username){if(!checkIfAlreadyPreviewed(username)){var hlsContainer=Cam4User.useWebGl?"webGLcontainer":"Cam4HLSPlayer",preview=preparePreview(username,hlsContainer),hlsPreview=StreamSource.getInstance();previewValues.objects[username]={type:"hls",hls:hlsPreview};var hlsElement=document.getElementById("Cam4HLSPlayer"),hlsWidth=hlsElement.width,hlsHeight=hlsElement.height;$j("#frameOverlay-"+username).append('<video muted loop data-setup="{}" width="'+hlsWidth+'" height="'+hlsHeight+'" style="width:100%; height:100%" preload="auto" id="video'+username+'"></video>'),$.ajax({url:"/_profile/streamURL?username="+username,success:function(data){var edgeURL=data.edgeURL,previewHls=new hls("video"+username,"",edgeURL);previewHls.init(Hls),previewHls.connect(),previewValues.objects[username]={type:"hls",hls:previewHls}},error:function(xhr,ajaxOptions,thrownError){if(401==xhr.status){var overlay=$j("#"+username+"_preview").find(".frameOverlay"),cssStyle={"padding-top":"30%","font-size":parseInt(.1*overlay.width())+"px"};overlay.addClass("fakeOffline").css(cssStyle).html(Cam4Chat.previewNotAvailable)}}}),hlsPreview.connect(mobileStreamingURL,username.toLowerCase(),"","canvas"+username,""),preview.bind("touchstart",function(){preview.zIndex()<previewValues.zIndex&&preview.zIndex(++previewValues.zIndex)})}}var previewValues={zIndex:20,position:16,Pos:16,objects:{}},position={limit:200,increment:16,reset:140};return{togglePreviewInUserList:function(username,showState,container){if("m"===showState||"d"===showState?$j("#previewbtn-"+container+username).off().on("click",function(){Cam4User.isPayingMember()||void 0!==Cam4User.userFeatures.C4BND_MULTI_CAM_PIP||Cam4User.isBroadcastingWindow||ControlledFeatures.GOLD_FREE_FEATURES?openPreview(username):Registration.showGoldUpgradeOverlay("picture-in-picture")}).show():($j("#previewbtn-"+container+username).hide().off(),$j("#br-"+username).text("")),$j("#"+username+"_preview").length>0){var preview=$j("#"+username+"_preview"),overlay=preview.find(".frameOverlay");handlePreviewState(username,showState,preview,overlay)}},openPreview:openPreview,setPreviewContainerSize:function(previewWindow,width,height){var containerWindow=$j("#"+previewWindow),previewWidth=containerWindow.width();height>width&&(previewWidth/=2);var previewHeight=previewWidth/function(width,height){return width/height}(width,height);containerWindow.css({width:previewWidth+"px",height:previewHeight+"px"})}}}();
if(!UserAgent.desktop)var mobileNewShows={container:$("#mobileShows"),PS:{request:$("#privateShowRequest"),cancel:$("#cancelPrivateShowRequest"),end:$("#endPrivateShow"),addTime:$("#NSAddMoreTimePhone"),all:$(".privateShow")},SPY:{cancel:$("#cancelSpy")},GS:{buy:$("#buyTicket"),purchased:$("#ticketPurchased"),all:$(".showButton")},timer:$("#timerString"),price:$(".ticketPrice"),goal:$("#mobileGoal"),buyTicket:function(){mobileNewShows.container.show(),mobileNewShows.GS.purchased.hide(),mobileNewShows.PS.all.hide(),mobileNewShows.GS.buy.show()},ticketPurchased:function(){mobileNewShows.container.show(),mobileNewShows.PS.all.hide(),mobileNewShows.GS.buy.hide(),mobileNewShows.GS.purchased.show()},requestPrivate:function(){mobileNewShows.PS.all.hide(),mobileNewShows.PS.request.show()},sendPrivateRequest:function(){mobileNewShows.PS.all.hide(),mobileNewShows.PS.cancel.show()},notRequestingPrivate:function(){mobileNewShows.PS.all.hide()},showTimer:function(){mobileNewShows.container.show(),mobileNewShows.timer.show()},insidePrivateShow:function(withBlocksOfTime){mobileNewShows.container.show(),mobileNewShows.PS.all.hide(),mobileNewShows.PS.end.show(),withBlocksOfTime&&mobileNewShows.PS.addTime.show()},updateTicketPrice:function(ticketPrice){mobileNewShows.price.text(ticketPrice+" tokens")}};
var ChatEvent={ROOM_STATE_UPDATED:"roomState_updated",ROOM_TIP_NOTIFICATION_ADDED:"roomState_tip_notification_added"};
var ChatUtils=function(){function cloneObject(obj){if(null===obj||"object"!=typeof obj)return obj;var temp=obj.constructor();for(var key in obj)obj.hasOwnProperty(key)&&(temp[key]=cloneObject(obj[key]));return temp}return{cloneObject:cloneObject,fromShortBoolean:function(shortBoolean){return"1"==shortBoolean},toShortBoolean:function(_boolean){return 1==_boolean?"1":"0"},countExactSeconds:new function(){return{start:function(callback,extra){this.secondsElapsed=0,clearInterval(this.timerHandler),this.currentTimestamp=(new Date).getTime(),this.startTimestamp=this.currentTimestamp,this.timerHandler=setInterval(this.processTime,500,callback,this,extra)},processTime:function(c1,self,extra){self.currentTimestamp=(new Date).getTime();var secondsElapsedNew=Math.floor((self.currentTimestamp-self.startTimestamp)/1e3);secondsElapsedNew>self.secondsElapsed&&(self.secondsElapsed=secondsElapsedNew,c1(self.secondsElapsed,extra))},stop:function(){clearInterval(this.timerHandler),this.secondsElapsed=0}}},formatTimeValue:function(timeValue){var hours=Math.floor(timeValue/3600),mins=Math.floor(timeValue%3600/60),seconds=Math.floor(timeValue%60);return hours<10&&(hours="0"+hours),mins<10&&(mins="0"+mins),seconds<10&&(seconds="0"+seconds),"00"==hours?mins+":"+seconds:hours+":"+mins+":"+seconds}}}();
var TippingGamesUtils=new function(){var _countExactTime=ChatUtils.cloneObject(ChatUtils.countExactSeconds);this.initiateCoolDown=function(elemSelector,timeValue,callback){elemSelector.html(ChatUtils.formatTimeValue(timeValue)),_countExactTime.start(function(tVal){var diff=timeValue-tVal;diff<=0&&(_countExactTime.stop(),"function"==typeof callback&&callback()),elemSelector.html(ChatUtils.formatTimeValue(diff))})},this.getGameSettings=function(){var details={};return Cam4User.isBroadcaster()&&"undefined"!=typeof TippingGames?details=TippingGames.currentSettings:"undefined"!=typeof TippingGamesViewer&&(details=TippingGamesViewer.gameSettings),details},this.isGameActive=function(){var details=TippingGamesUtils.getGameSettings();return!(!details||"1"!=details.active)},this.getUpdatedGameSettings=function(oldSettings,newSettings){var settingsDiff=Utils.getObjectsDiff(oldSettings,newSettings);for(var key in settingsDiff)"price"!=key&&-1==key.indexOf("option")&&delete settingsDiff[key];return settingsDiff},this.buildNotificationHTML=function(type,updatedSettings){var notifHTML="",highlightClass="",details=TippingGamesUtils.getGameSettings();switch(notifHTML+='<div class="chat-notif game">',type){case"ended":return notifHTML+='<span class="title simple">'+js_i18n.tippingGames.performerEndedGame+"</span></div>";case"enabled":notifHTML+='<p class="title">'+js_i18n.tippingGames.performerEnabledGame.replace("{0}",Cam4User.performerName)+"</p>";break;case"updated":notifHTML+='<p class="title simple">'+js_i18n.tippingGames.performerUpdatedGame+"</p>"}if("enabled"==type||"updated"==type&&function(){if("object"==typeof updatedSettings)for(var k in updatedSettings)if(-1!=k.indexOf("option"))return!0;return!1}()){notifHTML+='<div class="game-roll-options">';for(var i=details.minOptions;i<=details.maxOptions;i++)highlightClass="object"==typeof updatedSettings&&updatedSettings.hasOwnProperty("option"+i)?"highlight":"",notifHTML+=i%2==1?'<div class="row">':"",notifHTML+='<div class="col-xs-12 col-lg-6 game-option"><span class="dice-face side-'+i+'"></span><div class="game-input"><span class="'+highlightClass+'">'+details["option"+i]+"</span></div></div>",notifHTML+=i%2==0?"</div>":"";notifHTML+="</div>"}return"object"==typeof updatedSettings&&updatedSettings.hasOwnProperty("price")&&(notifHTML+='<div><span class="highlight">'+updatedSettings.price+" tokens per roll</span></div>"),notifHTML+="</div>"}};
var TippingGamesViewer=new function(){function _setState(state,data){if(!diceAnimation.isRunning)switch($j(dom.stateQueryPrefix).hide(),$j(dom.stateQueryPrefix+"-"+state).show(),state){case"init":gameCoolingDown&&(dom.actionBtnElem.show(),gameCoolingDown=!1,TippingGamesUtils.initiateCoolDown(dom.timerDisplayElems,0),dom.diceBarCoolDownTimer.hide()),dom.bigDieWrap.removeClass("rolled"),dom.viewerOverlay.find(".game-roll-options .action-txt").removeClass("winner").end().find(".game-option").removeClass("dim"),TippingGamesViewer.toggleActionBtn(!0);break;case"rolled":if(!data||!data.result)return;dom.bigDieWrap.addClass("rolled"),dom.diceResultBox.html(data.result),dom.viewerOverlay.find(".game-roll-options .action-txt").removeClass("winner").end().find(".game-option").addClass("dim"),$j("#diceOption"+data.result).parents(".game-option").removeClass("dim").end().addClass("winner"),ChatUIController.scrollToBottom("chatTabPanel");break;case"cooldown":if(data&&data.response){var coolDownTime=data.response.split(":")[1];if(isNaN(coolDownTime)||coolDownTime<=0)return void console.log("Error on cooldown: ",data);gameCoolingDown=!0,dom.actionBtnElem.hide(),dom.diceBarCoolDownTimer.show(),TippingGamesUtils.initiateCoolDown(dom.timerDisplayElems,coolDownTime,function(){_setState("init")})}break;case"error":dom.rollDiceOverlayBtn.show(),TippingGamesViewer.toggleActionBtn(!1)}}if(!Cam4User.isBroadcaster()){var dom={actionBtnElem:$j("#rollTheDicePlay"),rollDiceOverlayBtn:$j("#rollDiceOverlayBtn"),diceBarCoolDownTimer:$j("#diceBarCoolDownTimer"),chatPanelParent:$j("#tab1C"),chatPanel:$j("#chatTabPanel"),viewerOverlay:$j("#tippingGamesViewerOverlay"),stateQueryPrefix:"#tippingGamesViewerOverlay .state",diceResultBox:$j("#diceResultBox"),dicePricePoint:$j("#dicePricePoint"),videoWrap:$j("#broadcastingApp .chatlessPlayer"),mobileVideoWrap:$j("#video"),timerDisplayElems:$j(".timer-display"),bigDie:$j("#bigDiePic"),bigDieWrap:$j("#bigDiePic").parent(),gameActiveMessage:null},timers={untilCloseOverlay:3e3,animationDuration:1500},gameCoolingDown=!1,diceAnimation={interval:null,isRunning:!1},notificationsDisplayed={enabled:!!ControlledFeatures.USE_GAME_CENTER,ended:!1};this.gameSettings={},this.userData={type:"GAME",operation:"ROLL_THE_DICE",sessionId:"",modelId:Cam4Performer.name,game:"DICE",viewer:Cam4User.userName,accessHash:Cam4User.kN},this.update=function(tippingSessionObj){if(tippingSessionObj.DICE){var settingsDiff=TippingGamesUtils.getUpdatedGameSettings(TippingGamesViewer.gameSettings,tippingSessionObj.DICE);if(TippingGamesViewer.gameSettings=tippingSessionObj.DICE,TippingGamesViewer.updateOverlayInfo(),"1"==TippingGamesViewer.gameSettings.active){var diff=TippingGamesViewer.gameSettings.currentTimestamp-TippingGamesViewer.gameSettings.throw;!diceAnimation.isRunning&&diff>TippingGamesViewer.gameSettings.fast_dice_limit?(TippingGamesViewer.resetOverlayState(),dom.actionBtnElem.is("visible")||dom.actionBtnElem.show()):_setState("cooldown",{response:"fast dice:"+(TippingGamesViewer.gameSettings.fast_dice_limit-diff)}),notificationsDisplayed.enabled||TippingGamesViewer.displayGameActiveNotification(),Utils.sizeOfObject(settingsDiff)&&(Cam4Event.dispatch(TipEvent.DICE_GAME_UPDATED,settingsDiff),SoundPlayer.playTippingSound(TippingGamesViewer.gameSettings.price,"dice"))}else notificationsDisplayed.ended||!notificationsDisplayed.enabled||ControlledFeatures.USE_GAME_CENTER||(Cam4Event.dispatch(TipEvent.DICE_GAME_ENDED),notificationsDisplayed.ended=!0),notificationsDisplayed.enabled=!1,gameCoolingDown&&_setState("init"),dom.actionBtnElem.hide(),dom.viewerOverlay.hide()}TippingGamesViewer.userData.sessionId=tippingSessionObj.session_id},this.toggleActionBtn=function(activeState){activeState?(dom.actionBtnElem.removeClass("dim").removeAttr("disabled"),dom.rollDiceOverlayBtn.removeAttr("disabled")):(dom.actionBtnElem.addClass("dim").attr("disabled","disabled"),dom.rollDiceOverlayBtn.attr("disabled","disabled"))},this.handleActionResponse=function(data){switch(data.status){case"0":case"1":data.rollresult&&TippingGamesViewer.animateRollResult(data.rollresult,function(){_setState("cooldown",{response:"fast dice:"+TippingGamesViewer.gameSettings.fast_dice_limit}),TippingGamesViewer.toggleActionBtn(!0)});break;case"-2":if(diceAnimation.isRunning&&TippingGamesViewer.stopAnimationOnFace(),data.response==nstiplang.serverMessages.InsufficientFunds)return TippingGamesViewer.toggleActionBtn(!0),void TipFactory.popTokens();TippingGamesViewer.toggleActionBtn(!1),_setState("error",data)}},this.executeGameAction=function(){if(!Cam4User.isLoggedIn)return dom.viewerOverlay.is(":visible")&&TippingGamesViewer.toggleViewerOverlay(),void(Cam4User.isLoggedInAsGuest?Registration.activateGuestRegisterModal():Utils.decideOffer());TippingGamesViewer.toggleActionBtn(!1),TippingGamesViewer.animateRoll(),SoundPlayer.playTippingSound(TippingGamesViewer.gameSettings.price,"dice");var dataObj=ChatUtils.cloneObject(TippingGamesViewer.userData);TipCommunicator.sendGameAction(dataObj,function(res){TipBalance.getBalance(),TippingGamesViewer.handleActionResponse(res)})},this.displayGameActiveNotification=function(){BrowserDetect.isPhoneDevice()||(Cam4Event.dispatch(TipEvent.DICE_GAME_ENABLED),notificationsDisplayed.enabled=!0,SoundPlayer.playTippingSound(TippingGamesViewer.gameSettings.price,"dice"))},this.updateOverlayInfo=function(){dom.dicePricePoint.html(TippingGamesViewer.gameSettings.price);for(var i=TippingGamesViewer.gameSettings.minOptions;i<=TippingGamesViewer.gameSettings.maxOptions;i++)$j("#diceOption"+i).html(TippingGamesViewer.gameSettings["option"+i])},this.resetOverlayState=function(){_setState("init"),TippingGamesViewer.toggleActionBtn(!0)},this.animateRoll=function(){if(dom.bigDie.is(":visible")){var index=0;diceAnimation.isRunning=!0,diceAnimation.interval=setInterval(function(){index>=24&&(index=0);var frameClass="dice-pic frame-"+index++;dom.bigDie.attr("class",frameClass)},50)}},this.stopAnimationOnFace=function(faceNumber,callback){diceAnimation.interval&&(clearInterval(diceAnimation.interval),diceAnimation.isRunning=!1),faceNumber||(faceNumber=6);var frameClass="dice-pic face-"+faceNumber;dom.bigDie.attr("class",frameClass),"function"==typeof callback&&callback()},this.animateRollResult=function(gameResult,callback){setTimeout(function(){TippingGamesViewer.stopAnimationOnFace(gameResult,function(){_setState("rolled",{result:gameResult}),setTimeout(function(){dom.viewerOverlay.is(":visible")&&TippingGamesViewer.toggleViewerOverlay()},timers.untilCloseOverlay),"function"==typeof callback&&callback()})},timers.animationDuration)},this.toggleViewerOverlay=function(){if(0!=dom.viewerOverlay.length)if(dom.viewerOverlay.is(":visible"))dom.viewerOverlay.hide();else if(TippingGamesViewer.resetOverlayState(),BrowserDetect.isDesktop()){var positionLeft=dom.videoWrap.width()+18;dom.viewerOverlay.css("left",positionLeft+"px").css("top","-"+(dom.viewerOverlay.height()+37)+"px").show()}else dom.viewerOverlay.css("right","0px").css("top","-"+dom.viewerOverlay.height()+"px").show();else console.error("Viewer overlay not loaded!")}}};$j(document).ready(function(){!Cam4User.isBroadcaster()&&ControlledFeatures&&ControlledFeatures.TIPPING_GAMES&&(Cam4Event.hasEventListener(Cam4Event.FULL_SCREEN_CHANGED,"gameOverlayOnFullScreen")||Cam4Event.addEventListener(Cam4Event.FULL_SCREEN_CHANGED,function(){$j("#tippingGamesViewerOverlay").is(":visible")&&TippingGamesViewer.toggleViewerOverlay()},"gameOverlayOnFullScreen"),Cam4Event.hasEventListener(TipEvent.ON_GET_SESSION,"updateViewerGameData")||Cam4Event.addEventListener(TipEvent.ON_GET_SESSION,function(response){"object"==typeof response&&TippingGamesViewer.update(response)},"updateViewerGameData"),Cam4Event.hasEventListener(TipEvent.DICE_ROLLED,"onDiceNotificationAdded")||Cam4Event.addEventListener(TipEvent.DICE_ROLLED,function(args){ServiceTipViewer.getSessionOnce()},"onDiceNotificationAdded"))});
var FirebaseConnector=function(){return{onMessageSent:function(){},send:function(message,to){Chat.sendMessage(message,to)}}}();
var AccessLevel=function(){return{fromShortName:function(shortName){switch(shortName){case"u":return"unverified";case"x":return"guest";case"b":return"general";case"g":return"gold";case"gf":case"f":return"goldFree";case"gp":case"r":return"goldPromo";case"p":return"performer";case"um":case"e":return"userModerator";case"c":return"coach";case"m":return"moderator";case"a":return"admin";case"v":return"verifiedRoomModerator";default:return"unknown"}},UNVERIFIED:0,GUEST:5,GENERAL:10,GOLD:30,GOLDFREE:31,GOLDPROMO:33,PERFORMER:40,VERIFIED_ROOM_MODERATOR:46,USERMODERATOR:47,COACH:48,MODERATOR:50,ADMIN:60}}();_.extend(Cam4User,{isRoomModerator:function(){return Cam4User.accessLevel>=AccessLevel.USERMODERATOR},isRoomAdmin:function(){return Cam4User.accessLevel>=AccessLevel.MODERATOR},isAnyTypeOfGold:function(level){return"gold"==level||"goldFree"==level||"goldPromo"==level}}),"undefined"!=typeof module&&module.exports&&(module.exports=AccessLevel);
var Gender=function(){return{fromShortName:function(shortName){switch(shortName){case"m":return"male";case"f":return"female";case"t":return"transgender";default:return"unknown"}}}}();
var FirebaseNode={WEB_USERS_PRESENCE:"webUsersPresence",WEB_USER_ROOM_NOTIFICATIONS:"webUserNotifications",BROADCASTER_CONNECTION:"broadcasterConnection",CHATLESS_WEB_GUESTS:"chatlessWebGuests",CHATLESS_ROOM_USER_COUNT_LIGHT:"uc",CHATLESS_GLOBAL_PRESENCE_SUBNODE:"chatless"};
var FirebaseStructure={RoomBroadcasterConnectionLabels:{IS_CONNECTED:"connected",WEBCHAT_SERVER:"webchat"},RoomStateLabels:{WEBCHAT_HOSTNAME:"webChatHost"},WebUsersRoomNotificationLabels:{STATUS:"s"},WebUsersRoomNotificationValues:{PERMA_BANNED:"pb",BANNED:"b",KICKED:"k",PS_ENDED_SPY_NO_FUNDS:"ps_nf",PS_ENDED_SPY_NOT_ALLOWED:"ps_na",PENDING:"p"},UsersSessionLabels:{ONLINE:"online",TYPE:"t"},WebUsersPresence:{ROOMNAME:"r",PRESENCE:"p"},RosterLabels:{USER_INFO:"i",PRESENCE:"p",STEALTH_LEVEL:"a",ACCESS_LEVEL:"l",GENDER:"g",IS_BROADCASTING:"br",IS_ROOM_MODERATOR:"rm",HAS_TOKENS:"ht",IS_SILENCED:"s",ORIGINAL_USERNAME:"ou",USER_ID:"id",IS_FANCLUB_SUBSCRIBED:"fc",NOTIFY_BROADCASTER:"nb",VIEWER_TYPE:"wt"},ChatMessageLabels:{TYPE:"t",TOKENS:"tk",TIP_TO_REACH_GOAL:"tg",TIPPER_ROOM_STATUS:"ts",GIFT_ID:"id",FANCLUB:"fc",JOIN_FANCLUB:"jfc",ANONYMOUS:"a",ORIGINAL_USERNAME:"ou",MESSAGE:"m",ACCESS_LEVEL:"l",IS_ROOM_MODERATOR:"rm",MESSAGE_HASH:"mh",GENDER:"g",LANGUAGE:"lg",GAME_RESULT:"gr",VIDEO_TITLE:"vt",VIDEO_PRICE:"vp",VIDEO_COUNT:"vc",GIFT_VALUE:"gv",GIFT_IMAGE:"gi",TIMESTAMP:"tm",PROPERTIES:"p",IS_BROADCASTING:"b"},ViewerType:{UNKNOWN:0,DESKTOP:1,MOBILE:2,VR:3},TipperRoomStatus:{IN_PUBLIC_ROOM:0,INSIDE_GS:1,INSIDE_PS:2},NotificationType:{FAN_ENTERED_ROOM:2,SEND_TIP:3,GIFT:4,GOLD_ENTERED_ROOM:5,JOIN_FANCLUB:15,GAME:20,ID_APPROVED:23,ID_REJECTED:24,GO_PUBLIC:26,MARKETPLACE_PURCHASE:27,MARKETPLACE_BULK_PURCHASE:28,ROOM_PASSWORD_CHANGED:29}};
var FirebaseMessageObject=function(){function getLightChatMessageKey(timestamp){return"chat_message_"+timestamp}return{fromParameters:function(msg,sndOriginalUsername,type,sndAccessLevel,sndIsRoomModerator,hash,isFanclubSubscribed,viewerType){var ret={};return ret.type=type,ret.message=msg,ret.senderOriginalUsername=sndOriginalUsername,ret.senderAccessLevel=sndAccessLevel,ret.senderIsRoomModerator=sndIsRoomModerator,ret.hash=hash,ret.isFanclubSubscribed=isFanclubSubscribed,ret.viewerType=viewerType||FirebaseStructure.ViewerType.UNKNOWN,ret.isBroadcasting=!1,ret},fromChatMessageSnapshot:function(key,data){var ret={};ret.message=data[FirebaseStructure.ChatMessageLabels.MESSAGE],ret.senderOriginalUsername=data[FirebaseStructure.ChatMessageLabels.ORIGINAL_USERNAME],ret.gender=Gender.fromShortName(data[FirebaseStructure.ChatMessageLabels.GENDER]),ret.language=data[FirebaseStructure.ChatMessageLabels.LANGUAGE],ret.type=void 0===data[FirebaseStructure.ChatMessageLabels.TYPE]?1:data[FirebaseStructure.ChatMessageLabels.TYPE],ret.notificationExtra=data[FirebaseStructure.ChatMessageLabels.TOKENS]||data[FirebaseStructure.ChatMessageLabels.GIFT_ID]||data[FirebaseStructure.ChatMessageLabels.FANCLUB]||data[FirebaseStructure.ChatMessageLabels.GAME_RESULT],ret.anonymous=data[FirebaseStructure.ChatMessageLabels.ANONYMOUS]||0,ret.senderAccessLevel=AccessLevel.fromShortName(data[FirebaseStructure.ChatMessageLabels.ACCESS_LEVEL]),ret.isFanclubSubscribed=data[FirebaseStructure.ChatMessageLabels.FANCLUB],ret.isInsideGrupShowTipping=data[FirebaseStructure.ChatMessageLabels.TIPPER_ROOM_STATUS]===FirebaseStructure.TipperRoomStatus.INSIDE_GS;var isModeratorValue=data[FirebaseStructure.ChatMessageLabels.IS_ROOM_MODERATOR];ret.senderIsRoomModerator="1"==isModeratorValue,ret.messageKey=key,ret.viewerType=data[FirebaseStructure.RosterLabels.VIEWER_TYPE]||0,ControlledFeatures&&ControlledFeatures.FIREBASE_LIGHT_CHAT||(ret.isGoalReached="1"==data[FirebaseStructure.ChatMessageLabels.TIP_TO_REACH_GOAL]),ret.type==FirebaseStructure.NotificationType.MARKETPLACE_PURCHASE&&(ret.videoTitle=data[FirebaseStructure.ChatMessageLabels.VIDEO_TITLE],ret.videoPrice=data[FirebaseStructure.ChatMessageLabels.VIDEO_PRICE]),ret.type==FirebaseStructure.NotificationType.MARKETPLACE_BULK_PURCHASE&&(ret.videoCount=data[FirebaseStructure.ChatMessageLabels.VIDEO_COUNT],ret.videoPrice=data[FirebaseStructure.ChatMessageLabels.VIDEO_PRICE]),ret.type==FirebaseStructure.NotificationType.GIFT&&(ret.giftImage=data[FirebaseStructure.ChatMessageLabels.GIFT_IMAGE],ret.giftValue=data[FirebaseStructure.ChatMessageLabels.GIFT_VALUE]);var messageHash="";return FirebaseStructure.ChatMessageLabels.MESSAGE_HASH in data&&(messageHash=data[FirebaseStructure.ChatMessageLabels.MESSAGE_HASH]),ret.hash=messageHash,ret.timestamp=data[FirebaseStructure.ChatMessageLabels.TIMESTAMP]||Date.now(),ret.isBroadcasting="1"==data[FirebaseStructure.ChatMessageLabels.IS_BROADCASTING],ret},fromLightChatMessageSnapshot:function(data){var properties=data[FirebaseStructure.ChatMessageLabels.PROPERTIES],ret={};if(ret.isBroadcasting=!1,void 0!==properties){ret.message=data[FirebaseStructure.ChatMessageLabels.MESSAGE];var offset="0"!=properties.charAt(1)&&"1"!=properties.charAt(1)?1:0;ret.senderAccessLevel=AccessLevel.fromShortName(properties.substring(0,1+offset)),ret.senderIsRoomModerator="1"==properties.charAt(1+offset),ret.isFanclubSubscribed=properties.charAt(2+offset),ret.gender=Gender.fromShortName(properties.charAt(3+offset)),ret.language=properties.substring(4+offset,6+offset),ret.viewerType=properties.charAt(6+offset);var firstDelimiter=properties.indexOf("$");ret.hash=properties.substring(firstDelimiter-translatorHashLength,firstDelimiter);var secondDelimiter=properties.indexOf("$",firstDelimiter+1);ret.senderOriginalUsername=properties.substring(firstDelimiter+1,secondDelimiter);var thirdDelimiter=properties.indexOf("$",secondDelimiter+1);thirdDelimiter>0?(ret.timestamp=properties.substring(secondDelimiter+1,thirdDelimiter),ret.isBroadcasting="1"==properties.charAt(thirdDelimiter+1)):ret.timestamp=properties.substring(secondDelimiter+1),ret.type=1}else ret.senderOriginalUsername=data[FirebaseStructure.ChatMessageLabels.ORIGINAL_USERNAME],ret.type=data[FirebaseStructure.ChatMessageLabels.TYPE],ret.notificationExtra=data[FirebaseStructure.ChatMessageLabels.TOKENS]||data[FirebaseStructure.ChatMessageLabels.GIFT_ID]||data[FirebaseStructure.ChatMessageLabels.FANCLUB]||data[FirebaseStructure.ChatMessageLabels.GAME_RESULT],ret.anonymous=data[FirebaseStructure.ChatMessageLabels.ANONYMOUS]||0,ret.timestamp=data[FirebaseStructure.ChatMessageLabels.TIMESTAMP]||Date.now(),ret.isGoalReached="1"==data[FirebaseStructure.ChatMessageLabels.TIP_TO_REACH_GOAL],ret.isInsideGrupShowTipping=data[FirebaseStructure.ChatMessageLabels.TIPPER_ROOM_STATUS]===FirebaseStructure.TipperRoomStatus.INSIDE_GS,ret.senderAccessLevel=AccessLevel.fromShortName(data[FirebaseStructure.ChatMessageLabels.ACCESS_LEVEL]),ret.type==FirebaseStructure.NotificationType.MARKETPLACE_PURCHASE&&(ret.videoTitle=data[FirebaseStructure.ChatMessageLabels.VIDEO_TITLE],ret.videoPrice=data[FirebaseStructure.ChatMessageLabels.VIDEO_PRICE]),ret.type==FirebaseStructure.NotificationType.MARKETPLACE_BULK_PURCHASE&&(ret.videoCount=data[FirebaseStructure.ChatMessageLabels.VIDEO_COUNT],ret.videoPrice=data[FirebaseStructure.ChatMessageLabels.VIDEO_PRICE]),ret.type==FirebaseStructure.NotificationType.GIFT&&(ret.giftImage=data[FirebaseStructure.ChatMessageLabels.GIFT_IMAGE],ret.giftValue=data[FirebaseStructure.ChatMessageLabels.GIFT_VALUE]);return ret.messageKey=getLightChatMessageKey(ret.timestamp),ret},getLightChatMessageKey:getLightChatMessageKey}}();
var UserRosterInfoObject=function(){return{fromRosterSnapshot:function(data){this.isOnline=!1;var presenceInfo=data[FirebaseStructure.RosterLabels.PRESENCE];void 0!==presenceInfo&&"1"==presenceInfo&&(this.isOnline=!0);var userInfo=data[FirebaseStructure.RosterLabels.USER_INFO];switch(this.stealth_level=userInfo[FirebaseStructure.RosterLabels.STEALTH_LEVEL]||0,this.access_level=AccessLevel.fromShortName(userInfo[FirebaseStructure.RosterLabels.ACCESS_LEVEL]),this.gender=Gender.fromShortName(userInfo[FirebaseStructure.RosterLabels.GENDER]),this.isBroadcasting=userInfo[FirebaseStructure.RosterLabels.IS_BROADCASTING],this.isSilenced=ChatUtils.fromShortBoolean(userInfo[FirebaseStructure.RosterLabels.IS_SILENCED]),this.original_username=userInfo[FirebaseStructure.RosterLabels.ORIGINAL_USERNAME],this.user_id=userInfo[FirebaseStructure.RosterLabels.USER_ID],this.isRoomModerator=userInfo[FirebaseStructure.RosterLabels.IS_ROOM_MODERATOR],this.isFanclubSubscribed=userInfo[FirebaseStructure.RosterLabels.IS_FANCLUB_SUBSCRIBED]||0,this.hasTokens=parseInt(userInfo[FirebaseStructure.RosterLabels.HAS_TOKENS],10)||0,this.notifyBroadcaster=userInfo[FirebaseStructure.RosterLabels.NOTIFY_BROADCASTER]||0,this.viewerType=userInfo[FirebaseStructure.RosterLabels.VIEWER_TYPE]||0,this.access_level){case"coach":this.displayUsername="Cam4 Coach",this.imageCDN=WEB_CDN+"/images/avatar_cam4coach.gif";break;case"admin":case"moderator":this.displayUsername="Cam4 Admin",this.imageCDN=WEB_CDN+"/images/avatar_cam4admin.gif";break;default:this.displayUsername=this.original_username,this.imageCDN=ImageServer.GET_CHAT_AVATAR(userInfo[FirebaseStructure.RosterLabels.ORIGINAL_USERNAME].toLowerCase())}return ChatUtils.cloneObject(this)},fromRosterLightSnapshot:function(userInfo,originalUsername){if(void 0!==userInfo){this.isOnline=!0,this.gender=Gender.fromShortName(userInfo.charAt(0)),this.access_level=AccessLevel.fromShortName(userInfo.charAt(1)),this.isRoomModerator=userInfo.charAt(2),this.isSilenced=ChatUtils.fromShortBoolean(userInfo.charAt(3)),this.stealth_level=parseInt(userInfo.charAt(4)),this.isFanclubSubscribed=userInfo.charAt(5),this.notifyBroadcaster=userInfo.charAt(6),this.viewerType=parseInt(userInfo.charAt(7)),this.isFriendWithBroadcaster=parseInt(userInfo.charAt(8)),this.isFavoriteOfBroadcaster=parseInt(userInfo.charAt(9)),this.hasTokens=parseInt(userInfo.charAt(10),10);var firstDelimiter=userInfo.indexOf("$"),secondDelimiter=userInfo.indexOf("$",firstDelimiter+1),thirdDelimiter=userInfo.indexOf("$",secondDelimiter+1);switch(this.user_id=parseInt(userInfo.substring(firstDelimiter+1,secondDelimiter)),this.original_username=originalUsername,this.isBroadcasting=userInfo.substring(thirdDelimiter+1),this.access_level){case"coach":this.displayUsername="Cam4 Coach",this.imageCDN=WEB_CDN+"/images/avatar_cam4coach.gif";break;case"admin":case"moderator":this.displayUsername="Cam4 Admin",this.imageCDN=WEB_CDN+"/images/avatar_cam4admin.gif";break;default:this.displayUsername=this.original_username,this.imageCDN=ImageServer.GET_CHAT_AVATAR(this.original_username.toLowerCase())}}return ChatUtils.cloneObject(this)},toGlobalUsersInfo:function(isUserOnline,showOnline){return{stealth_level:this.stealth_level,access_level:this.access_level,imageCDN:this.imageCDN,isBroadcasting:this.isBroadcasting,isRoomModerator:this.isRoomModerator,isSilenced:this.isSilenced,isOnline:isUserOnline,showOnline:showOnline,original_username:this.original_username,isFanclubSubscribed:this.isFanclubSubscribed,gender:this.gender,hasTokens:this.hasTokens}},isOnline:void 0,access_level:void 0,stealth_level:void 0,gender:void 0,imageCDN:void 0,isBroadcasting:void 0,isSilenced:void 0,original_username:void 0,user_id:void 0,isFanclubSubscribed:void 0,displayUsername:void 0,viewerType:void 0}}();
var ChatFriendsFavorites=function(){function getAjaxFriendsFavorites(type,online,offset,callback){var containerPrefix=type,container=containerPrefix+(online?"Online":""),containerObj=$("#chat"+container+"List .users-loader");type=type.toLowerCase(),tabWasClicked&&(containerObj.show(),$j("#chat"+container+"Users").text(""),tabWasClicked=!1);$j.ajax({url:cam4WebChatHost+"requestChatlessPresenceInformation?username="+Cam4User.userName+"&accessHash="+Cam4User.kN+"&online="+online+"&type="+type+"&offset="+offset+"&limit="+LIMIT_USERS_PER_PAGE+"&agent=flash",context:document.body}).done(function(data){if(containerObj.hide(),"success"==data.status){var userData=data.users,loadmore={nextPage:data.loadMore,prevPage:friendsOffset[container+"Offset"]>0},totalUsers=data.count;$("#nr"+containerPrefix).text(totalUsers),callback(container,userData,loadmore)}actionRunning=!1})}function callCurrentUpdate(){switch(currentTab){case"FriendsOnline":getAjaxFriendsFavorites("Friends",!0,friendsOffset.FriendsOnlineOffset,ChatUIController.populateFriendsAndFavoritesList);break;case"Friends":getAjaxFriendsFavorites("Friends",!1,friendsOffset.FriendsOffset,ChatUIController.populateFriendsAndFavoritesList);break;case"FavoritesOnline":getAjaxFriendsFavorites("Favorites",!0,friendsOffset.FavoritesOnlineOffset,ChatUIController.populateFriendsAndFavoritesList);break;case"Favorites":getAjaxFriendsFavorites("Favorites",!1,friendsOffset.FavoritesOffset,ChatUIController.populateFriendsAndFavoritesList)}}var friendsAndFavotiresTimer,LIMIT_USERS_PER_PAGE=100,friendsOffset={FriendsOnlineOffset:0,FriendsOffset:0,FavoritesOnlineOffset:0,FavoritesOffset:0},initialised=!1,actionRunning=!1,tabWasClicked=!1,currentTab="",refreshTimeFriendsAndFavorites=1e3*Cam4User.friendsListReloadInterval;return $j(".prevFFPage").on("click",function(){ChatFriendsFavorites.prevPage()}),$j(".nextFFPage").on("click",function(){ChatFriendsFavorites.nextPage()}),{init:function(username){initialised||(initialised=!0,friendsAndFavotiresTimer=setInterval(function(){Chat.isFriendsFavoritesVisible()?callCurrentUpdate():ChatFriendsFavorites.stop()},refreshTimeFriendsAndFavorites))},stop:function(){clearInterval(friendsAndFavotiresTimer),initialised=!1},currentTab:currentTab,setCurrentTab:function(value){currentTab!=value&&(currentTab=value,tabWasClicked=!0,callCurrentUpdate())},nextPage:function(){actionRunning||(actionRunning=!0,tabWasClicked=!0,friendsOffset[currentTab+"Offset"]+=LIMIT_USERS_PER_PAGE,callCurrentUpdate())},prevPage:function(){actionRunning||(actionRunning=!0,tabWasClicked=!0,friendsOffset[currentTab+"Offset"]>LIMIT_USERS_PER_PAGE?friendsOffset[currentTab+"Offset"]-=LIMIT_USERS_PER_PAGE:friendsOffset[currentTab+"Offset"]=0,callCurrentUpdate())}}}();
var ChatCam2Cam=function(){function initUI(){(cam2camContainer=$j("#newCam2CamContainer")).draggable({containment:"#broadcastingApp",handle:".cam2camHeader"}).resizable({containment:"#broadcastingApp",aspectRatio:!0,minWidth:100,minHeight:71.4}),external?$j("#closeC2C").hide():($j("#closeC2C").show(),$j("#closeC2C").on("click",function(){NewShowSender.stopCam2Cam(),close()}))}function close(){active&&(active=!1,$("#flashC2CContainer").empty(),$("#newCam2CamContainer").hide())}var cam2camContainer,active=!1,initialized=!1,external=!1;return{init:function(playerType,username,cam2camStream,origServerId){var url="";active||(playerType?url="CHATLESS_BROADCASTER"==playerType?"/"+username+"/flashVars?playerType="+playerType+"&cam2cam=true":"/"+username+"/flashVars?playerType="+playerType+"&cam2cam=true&originId="+origServerId+"&streamName="+cam2camStream:external=!0,initialized||(initUI(),initialized=!0),active=!0,external||$("#newCam2CamContainer").show(),""!=url&&$.ajax({url:url,success:function(data){var flashId=username+"_cam2cam";data.flashVars.isCam2Cam=!0,data.flashVars.flashId=flashId,"CHATLESS_BROADCASTER"==playerType&&(data.flashVars.cam2CamRoom=Cam4User.performerName.toLowerCase()),SwfUtils.generateSwfTag(data,!1,flashId).into("flashC2CContainer")}}))},setActive:function(){active=!0},close:close}}();
var Chat=function(){function setOrientation(value){orientation=value}function setMbaVersion(version){var initResize=mbaVersion!==version;mbaVersion=version,initResize&&(Cam4User.isBroadcaster()?($("#slider").hide(),ChatlessPlayer.tippingSound.init()):(Cam4User.cameraData.useFlashPlayer||ChatlessPlayer.volume.init(),UserAgent.desktop&&(ChatlessPlayer.ignore.init(),ChatlessPlayer.tippingSound.init(),Cam4User.cameraData.camEmbedded||ChatlessPlayer.resize.init())),UserAgent.tablet&&($("#fullScreen").hide(),ChatlessPlayer.resize.init()))}function getTraceId(){return traceId}function setKiiroo(flag){isKiiroo=flag}function getKiiroo(){return isKiiroo}function setBlocksOfTimeParsed(blocksAsString){blocksOfTimeParsed=blocksAsString.split("|")}function getBlocksOfTimeParsed(){return blocksOfTimeParsed}function setBlocksOfTimeEnd(newValue){void 0!==newValue&&(blocksOfTimeEnd=newValue)}function getBlocksOfTimeEnd(){return blocksOfTimeEnd}function chatDisconnected(){handleErrors(Cam4ChatErrors.DISCONNECTED_FROM_CHAT,"","","Cam4")}function disconnectedTimer(seconds){Cam4User.isBroadcastingWindow&&(clearTimeout(disconnectedTimerId),disconnectedTimerId=setTimeout(chatDisconnected,seconds))}function setBroadcastSettings(initializeRoomInfo){broadcastSettings=JSON.parse(initializeRoomInfo.details),decodeStatusMessage(),Cam4User.streamingData.broadcastSettings=broadcastSettings}function decodeStatusMessage(){void 0!==broadcastSettings.statusMessage&&(broadcastSettings.statusMessage=decodeURIComponent(broadcastSettings.statusMessage))}function initializeRoomBroadcastId(initializeRoomInfo){initializeRoomRequestData=initializeRoomInfo;try{setBroadcastSettings(initializeRoomInfo)}catch(e){console.log("error in initializeRoomBroadcastId/setBroadcastSettings",e)}broadcastSettings.streamUuid&&-1!=broadcastSettings.streamUuid.indexOf("-2D")&&(broadcastSettings.streamUuid=broadcastSettings.streamUuid.replace(/-2D$/,"")),ChatSettings.setPassword(broadcastSettings.password),ChatlessPlayer.volume.init();var details="";broadcastSettings.cam2Cam&&(details="cam2cam"),initializeRoomInfo.details=JSON.stringify(broadcastSettings),ConnectionLogger.logEvent("REQUEST_BROADCAST_ID",details,cam4WebChatHost);var settings={url:cam4WebChatHost+"/broadcast",type:"POST",data:initializeRoomInfo,timeout:INITIALIZE_ROOM_TIMEOUT};ControlledFeatures.DISTRIBUTED_TRACING&&(settings.headers={"X-B3-TraceId":getTraceId(),"X-B3-SpanId":generateSpanId(),"X-B3-Sampled":1});var request=$.ajax(settings);request.done(function(response){void 0!==response.error?(ConnectionLogger.logEvent("ON_BROADCAST_ID_ERROR","error: "+response.error,chatHost),"NO_ROOM"!==response.error?handleErrors(Cam4ChatErrors.generalErrorRefresh+" Error: "+response.error,"","","Cam4"):console.warn("Received NO_ROOM")):initializeRoomSuccess(response)}),request.fail(function(jqXHR,status){initializeRoomFail(status+" "+jqXHR.status)})}function generateTraceId(){function s4(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return s4()+s4()+s4()+s4()+s4()+s4()+s4()+s4()}function generateSpanId(){function s4(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return s4()+s4()+s4()+s4()}function getFormattedResolution(width,height){return width+":"+height}function initializeRoomSuccess(response){if(initializeRoomRetries=0,broadcastSettings.cam2Cam)ConnectionLogger.logEvent("ON_BROADCAST_ID_RECEIVED","cam2cam",cam4WebChatHost);else{if(ConnectionLogger.logEvent("ON_BROADCAST_ID_RECEIVED","broadcastId: "+response.broadcastId,cam4WebChatHost),!Cam4User.performerAcceptTips||""!=previousState&&"ACCEPTING"!=previousState||(NewShowReceiver.showMain(!0),NewShowReceiver.onNewShowStateChanged(NewShowState.AcceptingPrivateShow)),BroadcastStatus.init(broadcastSettings.statusMessage),$("#chatLoadingWheel").remove(),ChatlessPlayer.resize.showChat(),JsSender.isReady=!0,""!=previousState&&"ACCEPTING"!=previousState||Cam4Event.dispatch(Cam4Event.PLAYER_LOADED),!broadcastRoomInitialized){if(broadcastRoomInitialized=!0,dataLayer.push({event:"BroadcastStartSource",eventCategory:"Broadcast Settings",eventAction:"Set Stream Source",eventLabel:"external_encoder"==broadcastSettings.streamSource?"EXTERNAL_ENCODER":"FLASH_ENCODER"}),"desktop"==broadcastSettings.streamSource){var eventLabelResolution="";void 0!==broadcastSettings.autoResolution&&broadcastSettings.autoResolution&&(eventLabelResolution="Auto_",Cam4User.lastBroadcastDate||(eventLabelResolution+="first_")),eventLabelResolution+=broadcastSettings.width+"x"+broadcastSettings.height,dataLayer.push({event:"BroadcastStartResolution",eventCategory:"Broadcast Settings",eventAction:"Set Broadcast Resolution",eventLabel:eventLabelResolution}),dataLayer.push({event:"BroadcastStartCamera",eventCategory:"Broadcast Settings",eventAction:"Set Camera Name",eventLabel:void 0===broadcastSettings.cameraName?"":broadcastSettings.cameraName})}initRoom(Cam4User.userName.toLowerCase(),Cam4User.userName.toLowerCase(),Cam4User.kN,!1,"")}if("external_encoder"==broadcastSettings.streamSource){var flashData=Cam4User.cameraData.flashData;ControlledFeatures&&ControlledFeatures.USE_JS_BROADCAST_SETTINGS||(flashData.flashVars.videoPlayUrl=response.videoPlayUrl,response.isVrStream&&ControlledFeatures.USE_BROADCASTER_2D_VR&&(flashData.flashVars.videoPlayUrl+="-2D",BROADCAST_RESOLUTION=getFormattedResolution(response.width,response.height)),flashData.flashVars.videoAppUrl=response.videoAppUrl,flashData.flashVars.edgeConnectToken=response.connectToken,flashData.playerUrl=Cam4User.cameraData.chatlessViewerFlashUrl,document.getElementById("Cam4VChat").remove()),ControlledFeatures.EXTERNAL_ENCODER_NO_VIDEO&&$("#toggleOBS, #statusMessagePlaceholder").show(),"true"!=Cam4Cookies.getCookie("hideVideoOBS")||$("body").hasClass("no-video")||ChatUIController.toggleOBS()}$(".broadcast-control-bar").show(),EverCookie.getInt("nsNewRatesViewedV2")<=0&&30==GSSelectOpts.defaultPrices.privateShow&&6==GSSelectOpts.defaultPrices.spyShow&&ToolTip.removeAll()}}function initializeRoomFail(error){ConnectionLogger.logEvent("ON_BROADCAST_ID_ERROR","error: "+error,chatHost),initializeRoomRetries<INITIALIZE_ROOM_MAX_RETRIES?(initializeRoomRetries++,initializeRoomBroadcastId(initializeRoomRequestData)):handleErrors("<strong>"+Cam4ChatErrors.couldNotConnectToChat+"</strong><br/>"+Cam4ChatErrors.pleaseRefresh+"<br/>"+Cam4ChatErrors.pleaseContact,"","","Cam4 Error")}function disconnectIfNotFlash(){"flash"!=(streamSource=StreamSource.getInstance()).getType()&&streamSource.disconnect()}function initRoom(roomName,username,accessHash,mobilePhoneUsr,pass){function roomRequestFailed(textStatus){++roomRequestRetries>Cam4User.maxRoomRequestRetries?"MBA"!==Cam4User.broadcastSource&&handleErrors(Cam4ChatErrors.generalErrorRefresh+" "+textStatus,"","","Cam4 Error"):initRoom(Cam4User.performerName.toLowerCase(),Cam4User.userName.toLowerCase(),Cam4User.kN,mobilePhoneUser,"")}Cam4User.isBroadcastingWindow&&"MBA"!==Cam4User.broadcastSource&&!Cam4User.cameraData.useHlsVideoOnMobile||ConnectionLogger.init("webChat"),Cam4User.isBroadcastingWindow&&"MBA"!==Cam4User.broadcastSource&&ChatlessPlayer.resize.updateChat(),ControlledFeatures.USE_EMOJI||setTimeout(function(){Emoticons.init()},0),streamSource=StreamSource.getInstance(),Cam4User.isSpy=!1,mobilePhoneUser=mobilePhoneUsr,chatAccessHash=accessHash,chatUsername=username,chatRoomName=roomName;var password="";""!==pass&&(password="&pass="+pass),""!==username&&""!==accessHash&&(isGuest=!1),isGuest||ChatUIController.roomModerator(),chatHost=cam4WebChatHost;var rnd=Math.floor(1e8*Math.random()+1);chatHost+=""==username||""==accessHash?"requestAccess?r="+rnd+"&roomname="+roomName:"requestAccess?r="+rnd+"&roomname="+roomName+"&accessHash="+accessHash+"&username="+username+password,Trie.mapChars();var roomRequest=$j.ajax({url:chatHost,context:document.body});roomRequest.done(function(data){switch(ConnectionLogger.logEvent("WEBCHAT_ACCESS_SUCCESS","",chatHost),void 0!==data.shard&&(cam4FirebaseHost=data.shard),void 0!==data.jwt&&jwt.resolve(data.jwt),data.status){case"bannedForRoom":return void errorOverlay("#errorBanned");case"alreadyInTheRoom":return void errorOverlay("#errorAlreadyInRoom");case"privateRoom":return void(isGuest?errorOverlay("#errorPrivateRoom"):(ChatUIController.showEnterPassword(""),disconnectIfNotFlash(),inPrivateRoom=!0));case"userIsFromBlockedCountryOrRegion":return void errorOverlay("#errorBlocked");case"wrongPassword":return ChatUIController.showEnterPassword("error"),void disconnectIfNotFlash();case"success":if($("#wrongPassword").hide(),streamSource.setToken(data),setGoldShowAccess(data.goldShowAccess),!1===inPrivateRoom&&(inPrivateRoom=data.privateRoom),ChatUI.showVideoContainer(),inPrivateRoom&&(correctPassword=!0),!0===firebaseOffline)return firebaseOffline=!1,streamSource.setToken(data),streamSource.resume(),void Firebase.goOnline();break;default:return void roomRequestFailed(JSON.stringify(data))}roomRequestRetries=0,tokenChat=data.token,webChatHostName=data[FirebaseStructure.RoomStateLabels.WEBCHAT_HOSTNAME],disconnectedTimer(3e4),isGuest?(guestNodeName=data.guestNodeName,firebaseAuth(cam4FirebaseHost,tokenChat,roomName,username,guestNodeName)):firebaseAuth(cam4FirebaseHost,tokenChat,roomName,username,"")}),roomRequest.fail(function(jqXHR,textStatus){roomRequestFailed(textStatus)}),$j("#li3").removeAttr("onclick"),Cam4User.isBroadcastingWindow||Cam4User.isLoggedIn&&(Cam4User.isPayingMember()||void 0!==Cam4User.userFeatures.C4BND_FULL_SCREEN)?$j(".fullscreen, #li3").on("click",function(){UserAgent.desktop?JsReceiver.goFullScreen():mobileFullScreenAPI.toggleFullScreen()}):$j(".fullscreen, #li3").on("click",function(){Registration.showGoldUpgradeOverlay("theater-mode")})}function firebaseAuth(cam4FirebaseHost,tokenChat,roomName,username,guestNodeName,onComplete){connectedRef=new Firebase(cam4FirebaseHost+".info/connected"),serverTimeOffsetRef=new Firebase(cam4FirebaseHost+".info/serverTimeOffset"),baseConnectionAuth=new Firebase(cam4FirebaseHost),broadcasterConnectionRef=baseConnectionAuth.child(FirebaseNode.BROADCASTER_CONNECTION),(baseConnection=baseConnectionAuth.child("chatRooms")).authWithCustomToken(tokenChat,function(error){startTimeGoldEnteredRoom=Date.now(),error?ConnectionLogger.logEvent("FIREBASE_AUTH_ERROR","",cam4FirebaseHost):(isChatAuthenticated=!0,ConnectionLogger.logEvent("FIREBASE_AUTH_SUCCESS","",cam4FirebaseHost)),myWebUsersPresenceRef=baseConnectionAuth.child(FirebaseNode.WEB_USERS_PRESENCE+"/"+username),myRoomNotificationsRef=baseConnection.child(roomName+"/"+FirebaseNode.WEB_USER_ROOM_NOTIFICATIONS+"/"+username),roomStateRef=baseConnection.child(roomName+"/roomState"),usersRef=baseConnection.child(roomName+"/roster"),messagesRef=baseConnection.child(roomName+"/chatMessages"),streamRef=baseConnection.child(roomName+"/s"),rosterLightRef=baseConnectionAuth.child("r").child(roomName),useBroadcasterFirebaseChat&&(psRequestsRef=baseConnectionAuth.child("privateShowRequests/"+roomName),psBillingInfoRef=baseConnection.child(roomName+"/ps/br"),bannedListRef=baseConnection.child(roomName+"/filterInfo/bannedUsers"),silenceListRef=baseConnection.child(roomName+"/filterInfo/silencedUsers"),moderatorListRef=baseConnection.child(roomName+"/filterInfo/moderatorUsers")),chatlessGuestConnectionRef=baseConnectionAuth.child(FirebaseNode.CHATLESS_WEB_GUESTS+"/"+roomName+"/"+guestNodeName),chatlessRoomUserCountRefLight=baseConnectionAuth.child(FirebaseNode.CHATLESS_ROOM_USER_COUNT_LIGHT).child(roomName),globalUserPresence=baseConnectionAuth.child("globalPresence/"+FirebaseNode.CHATLESS_GLOBAL_PRESENCE_SUBNODE+"/"+username+"/"+roomName),privateMessages=baseConnection.child(roomName+"/privateMessages/"+username),GSMessages=baseConnection.child(roomName+"/groupShowMessages"),monitorUsers(roomName,onComplete),""!=guestNodeName&&guestsPresence(roomName,guestNodeName),""!=username&&(initWebPresence(roomName,username),ChatSettings.initSettingsPanel()),useBroadcasterFirebaseChat?(monitorPSRequests(),$("#manageBans").one("click",function(){initUserList(bannedListRef,"#bannedUsersList","bu_")}),$("#manageSilences").one("click",function(){initUserList(silenceListRef,"#silencedUsersList","su_")}),$("#manageModerators").one("click",function(){initUserList(moderatorListRef,"#moderatorsList","mu_")})):ControlledFeatures.SILENCE_FEATURE&&$("#manageSilences").on("click",function(){renderSilencedUsers(Cam4User.silencedUsers,"#silencedUsersList","su_")}),baseConnectionAuth.onAuth(function(authData){if(authData)console.log("Authenticated to Firebase.",authData.auth);else{console.log("Firebase Client unauthenticated.");var params={};params[FirebaseStructure.RoomBroadcasterConnectionLabels.WEBCHAT_SERVER]=webChatHostName,LogicObj.callWebchat("clientUnauthenticated",params)}})})}function monitorPSRequests(){psRequestsRef.on("child_added",function(snapshot){var userRequestInfo=snapshot.val(),userName=snapshot.key(),userJson={userName:userRequestInfo.ou,gender:Gender.fromShortName(userRequestInfo.g),goldMember:Cam4User.isAnyTypeOfGold(AccessLevel.fromShortName(userRequestInfo.l)),tokenBalance:userRequestInfo.dt,imageCDN:ImageServer.GET_CHAT_AVATAR(userName.toLowerCase()),countryFlag:"flag-"+userRequestInfo.cf,timeout:userRequestInfo.timeout,sexualPreference:userRequestInfo.sp,cam2cam:"1"===userRequestInfo.c2c,extend:"1"===userRequestInfo.extend};if("INSIDE_PS"==previousState&&userJson.cam2cam&&(userJson.cam2camInPrivate=!0),void 0!==userRequestInfo.bt&&(userJson.blocksOfTime=userRequestInfo.bt,userJson.blocksOfTimeActive=1),ControlledFeatures.USE_NEW_CAM2CAM)if(ControlledFeatures.USE_NEW_CAM2CAM_WITH_OBS)userJson.cam2camExternal="undefined"!=typeof VidyoConnector&&VidyoConnector.isAvailable()&&"1"===userRequestInfo.c2ce;else{var streamSource=Cam4User&&Cam4User.streamingData&&Cam4User.streamingData.broadcastSettings&&Cam4User.streamingData.broadcastSettings.streamSource,isExternalEncoder="external_encoder"===streamSource||"external-encoder"===streamSource;userJson.cam2camExternal=!isExternalEncoder&&"undefined"!=typeof VidyoConnector&&VidyoConnector.isAvailable()&&"1"===userRequestInfo.c2ce}NewShowReceiver.addPrivateShowRequest(userJson)}),psRequestsRef.on("child_removed",function(snapshot){var userRequestInfo=snapshot.val(),userName=userRequestInfo.ou;"1"!==userRequestInfo.extend&&NewShowReceiver.removePrivateShowRequest(userName)}),psBillingInfoRef.on("value",function(snapshot){var info=snapshot.val();null!=info&&(NewShowReceiver.updateBillingPrivateShow("",info.viewerEarnings+info.spyEarnings,info.spyEarnings,info.spyCount),null!=info.cam2CamStream&&ChatCam2Cam.init("CHATLESS_VIEWER",info.u,info.cam2CamStream,info.originServerId))})}function renderSilencedUsers(arr,selector,type){var users,container=$(selector);container.find("li").slice(1).remove(),users=arr.map(function(user){return ChatSettings.buildUser(type,user)}).join(""),ChatSettings.appendUsers(container,users),$(".removeButton").on("click",function(){this.dataset.username;ChatUIController.silenceRequest(Cam4User.userName,this.dataset.username,"unsilence_user"),ChatSettings.removeUserFromList(type,this.dataset.username)}),container.find("button").on("click",function(){ChatUIController.silenceRequest(Cam4User.userName,this.dataset.username,"unsilence_all"),container.find("li").slice(1).remove();var obj={type:"unSilenceAll",roomname:Cam4User.performerName,username:Cam4User.userName,userIp:Cam4User.currentIp,accessHash:Cam4User.kN};Chat.sendRoomNotification("sendNotification",obj)})}function initUserList(reference,selector,type){var search,container=$(selector),startingTimestamp=0;reference.once("value",function(dataSnapshot){var usersMap=dataSnapshot.val(),html="";if(null!=usersMap){for(var prop in usersMap)usersMap.hasOwnProperty(prop)&&(html+=ChatSettings.buildUser(type,usersMap[prop].ou),startingTimestamp<usersMap[prop].tm&&(startingTimestamp=usersMap[prop].tm));ChatSettings.appendUsers(container,html)}reference.orderByChild("tm").startAt(startingTimestamp+1).on("child_added",function(snapshot){var userName=snapshot.val().ou;ChatSettings.addUserInList(container,type,userName),search instanceof Jets&&search.update()}),reference.on("child_removed",function(snapshot){var userName=snapshot.val().ou;ChatSettings.removeUserFromList(type,userName)}),"undefined"!=typeof Jets&&(search=new Jets({searchTag:selector+" input",contentTag:selector,columns:[0]}))}),ChatSettings.bindRemoveUser(container,type)}function getWebUsersPresenceUpdateData(isOnline){var updateData={};return updateData[FirebaseStructure.WebUsersPresence.ROOMNAME]=chatRoomName,null!=isOnline&&(updateData[FirebaseStructure.WebUsersPresence.PRESENCE]=1==isOnline?"1":"0"),updateData}function getBroadcasterConnectionUpdateData(isOnline){var updateData={};return updateData[FirebaseStructure.RoomBroadcasterConnectionLabels.WEBCHAT_SERVER]=webChatHostName,null!=isOnline&&(updateData[FirebaseStructure.RoomBroadcasterConnectionLabels.IS_CONNECTED]=1==isOnline?"true":"false"),updateData[FirebaseStructure.ChatMessageLabels.TIMESTAMP]=Firebase.ServerValue.TIMESTAMP,updateData}function guestsPresence(roomName,guestNodeName){connectedRef.on("value",function(snap){!0===snap.val()?(firebaseConnected(),chatlessGuestConnectionRef.onDisconnect().set(null),chatlessGuestConnectionRef.set({o:1})):firebaseDisconnected()}),serverTimeOffsetRef.once("value",function(snap){firebaseServerOffset=snap.val()})}function setGoldShowAccess(status){goldShowAccess=status}function initWebPresence(roomName,username){connectedRef.on("value",function(snap){if(!0===snap.val()){if(firebaseConnected(),clearTimeout(disconnectedTimerId),$j("#chatConnectionStatus").removeClass().addClass("chatConnected"),roomName===username){var roomBroadcasterConnectionRef=broadcasterConnectionRef.child(roomName);roomBroadcasterConnectionRef.onDisconnect().set(getBroadcasterConnectionUpdateData(!1));var updateData=getBroadcasterConnectionUpdateData(!0);roomBroadcasterConnectionRef.set(updateData)}if(ControlledFeatures.MULTI_DEVICE_PRESENCE){var pushNode=baseConnectionAuth.child(FirebaseStructure.WebUsersPresence.PRESENCE).child(roomName).child(username).push();pushNode.onDisconnect().remove();var pushNodeContent={t:Firebase.ServerValue.TIMESTAMP};pushNode.set(pushNodeContent)}else myWebUsersPresenceRef.onDisconnect().set(getWebUsersPresenceUpdateData(!1)),myWebUsersPresenceRef.set(getWebUsersPresenceUpdateData(!0))}else $j("#chatConnectionStatus").removeClass().addClass("chatNotConnected"),disconnectedTimer(1e3*INITIAL_DISCONNECT_TIMER_SECONDS),firebaseDisconnected()}),serverTimeOffsetRef.once("value",function(snap){firebaseServerOffset=snap.val()})}function firebaseConnected(){PollingChat.stopPollingChat(),Chat.setFbStatus(!0);try{if(0!=disconnectLogTime){var data={disconnectTime:Date.now()-disconnectLogTime};LogicObj.callWebchat("notifyDisconnect",data),disconnectLogTime=0}}catch(ex){console.log("Loggin Firebase Error: ",ex)}}function firebaseDisconnected(){if(0==disconnectLogTime&&(disconnectLogTime=Date.now()),Chat.setFbStatus(!1),!roomIsPrivate||inPrivateRoom){isGuest||PollingChat.startPollingChat();var firebaseReconnectTimerID=setInterval(function(){Chat.getFbStatus()?(console.log("Reconnect to Firebase completed: ",firebaseReconnectTimerID),clearInterval(firebaseReconnectTimerID)):(console.log("Trying to reconnect to Firebase: ",firebaseReconnectTimerID),Firebase.goOnline())},1e3)}}function setWebPresenceOffline(){ControlledFeatures.MULTI_DEVICE_PRESENCE||myWebUsersPresenceRef.set(getWebUsersPresenceUpdateData(!1))}function formatAndAddUserOn(snapshot,roomName,lightVersion){var userRosterObject,username=snapshot.key().toLowerCase(),snapshotValue=snapshot.val();if(lightVersion)userRosterObject=UserRosterInfoObject.fromRosterLightSnapshot(snapshotValue,snapshot.key());else{if(void 0===snapshotValue.p)return;userRosterObject=UserRosterInfoObject.fromRosterSnapshot(snapshotValue)}void 0===globalUsers[username]&&(globalUsers[username]={isRoomModerator:!1,isBroadcasting:!1,showOnline:!1,stealth_level:0,isOnline:!1});var showOnline=globalUsers[username].showOnline;!globalUsers[username].isOnline||userRosterObject.isOnline?(userRosterObject.stealth_level!=globalUsers[username].stealth_level&&0!=userRosterObject.stealth_level&&!canSeeStealth||globalUsers[username].isOnline&&!userRosterObject.isOnline?(ChatUIController.deleteUserFromDOM(username),showOnline=!1):(showOnline||addUserToTrieAndDom(roomName,username,userRosterObject,!0),ChatUIController.toggleModeratorInUserList(username,userRosterObject.isRoomModerator),showOnline=!0),showOnline=!(0!=userRosterObject.stealth_level&&!canSeeStealth&&Cam4User.performerName.toLowerCase()!=username),"admin"!=userRosterObject.access_level&&"moderator"!=userRosterObject.access_level||(showOnline=!1),username==Cam4User.userName.toLowerCase()&&ChatUIController.changeRoomModeratorState(globalUsers[username].isRoomModerator,userRosterObject.isRoomModerator,!0),userRosterObject.isRoomModerator!=globalUsers[username].isRoomModerator&&ChatUIController.toggleModeratorInUserList(username,userRosterObject.isRoomModerator),userRosterObject.isBroadcasting!=globalUsers[username].isBroadcasting&&username!=Cam4User.performerName.toLowerCase()&&ChatPreview.togglePreviewInUserList(username,userRosterObject.isBroadcasting,""),globalUsers[username].isOnline,globalUsers[username]=userRosterObject.toGlobalUsersInfo(!0,showOnline)):userLeftRoom(snapshot,roomName,lightVersion)}function userLeftRoom(snapshot,roomName,lightVersion){var userRosterObject,username=snapshot.key().toLowerCase(),snapshotValue=snapshot.val();if(lightVersion)userRosterObject=UserRosterInfoObject.fromRosterLightSnapshot(snapshot.val(),snapshot.key());else{if(void 0===snapshotValue[FirebaseStructure.RosterLabels.PRESENCE])return;userRosterObject=UserRosterInfoObject.fromRosterSnapshot(snapshot.val())}userRosterObject.isOnline=!1,void 0!==globalUsers[username]&&(globalUsers[username].isOnline=!1),"admin"!=userRosterObject.access_level&&"moderator"!=userRosterObject.access_level&&deleteUsernameFromTrieAndDOM(roomName,username,userRosterObject)&&(totalUsersChatting--,ChatUIController.updateChatCounter(totalUsersChatting,totalLoggedInUsers,globalTotalGuests),Cam4User.useVrPlayer&&streamSource.removeUser&&streamSource.updateUsersCount&&(streamSource.removeUser(username),streamSource.updateUsersCount(totalUsersChatting,totalLoggedInUsers,globalTotalGuests)))}function formatAndAddUserOnce(snapshot,roomName,lightVersion){roomName=roomName.toLowerCase();var showOnline,userRosterObject,snapshotValue=snapshot.val();if(lightVersion)userRosterObject=UserRosterInfoObject.fromRosterLightSnapshot(snapshot.val(),snapshot.key());else{if(void 0===snapshotValue.p)return;userRosterObject=UserRosterInfoObject.fromRosterSnapshot(snapshot.val())}var isOnline=userRosterObject.isOnline,username=snapshot.key().toLowerCase();void 0!==userRosterObject.isFanclubSubscribed&&1==userRosterObject.isFanclubSubscribed&&Cam4User.userName==userRosterObject.original_username&&Chat.sendRoomNotification("sendNotification","join","1"),showOnline=!(username!=roomName&&(!isOnline||"admin"==userRosterObject.access_level||"moderator"==userRosterObject.access_level||0!=userRosterObject.stealth_level)),canSeeStealth&&(showOnline=!0),"admin"!=userRosterObject.access_level&&"moderator"!=userRosterObject.access_level||(showOnline=!1);var currentTime=Date.now();if(Cam4User.isLoggedIn&&username!==Cam4User.performerName&&(ChatSettings.goldNotification()||!Cam4User.isBroadcastingWindow)&&void 0===Chat.getUser(username)&&(username==chatUsername||Cam4User.isBroadcastingWindow&&currentTime-startTimeGoldEnteredRoom>postponedGoldEnterdRoomTime)&&Cam4User.isAnyTypeOfGold(userRosterObject.access_level)&&"1"==userRosterObject.notifyBroadcaster&&"1"!==userRosterObject.isFanclubSubscribed&&"0"===userRosterObject.isBroadcasting){var msgObject=FirebaseMessageObject.fromParameters("",userRosterObject.original_username,FirebaseStructure.NotificationType.GOLD_ENTERED_ROOM);ChatUIController.addNotificationMessage(msgObject)}globalUsers[username]=userRosterObject.toGlobalUsersInfo(isOnline,showOnline),void 0!==userRosterObject.isRoomModerator&&username==Cam4User.userName.toLowerCase()&&1==userRosterObject.isRoomModerator&&(ChatUIController.changeRoomModeratorState("0",userRosterObject.isRoomModerator,!1),ChatUIController.toggleModeratorInUserList(username,userRosterObject.isRoomModerator)),addUserToTrieAndDom(roomName,username,userRosterObject,showOnline)}function errorOverlay(param){closeEverything(param)}function closeCam(){Cam4User.cameraData.useHlsVideoOnMobile&&streamSource.disconnect(),JsReceiver.roomWentOffline(closeEverything)}function closeEverything(param){ChatUI.element.firebaseContainer.remove(),ChatUI.element.video.remove(),ChatUI.element.privateShowContainer.remove(),ChatUI.element.tippingDiv.remove(),ChatUI.element.tippingViewer.remove(),param&&$j(param).show(),Firebase.goOffline(),baseConnection.unauth()}function notifyMBA(reason,msg){if("MBA"===Cam4User.broadcastSource)try{window.JsHandler.jsFnCallKick(reason,msg)}catch(ex){console.log(ex)}}function handleRoomNotification(snapshot){var status=snapshot.val();switch(status){case FirebaseStructure.WebUsersRoomNotificationValues.KICKED:notifyMBA("kick",$j("#errorKicked").text()),errorOverlay("#errorKicked");break;case FirebaseStructure.WebUsersRoomNotificationValues.BANNED:notifyMBA("ban",$j("#errorBanned").text()),errorOverlay("#errorBanned");break;case FirebaseStructure.WebUsersRoomNotificationValues.PERMA_BANNED:notifyMBA("ban",$j("#errorBanned").text()),errorOverlay("#errorBanned"),MobileMenusManager.triggerLogout();break;case FirebaseStructure.WebUsersRoomNotificationValues.PENDING:notifyMBA("kickPendingId",$j("#errorPending").text()),errorOverlay("#errorPending");break;case FirebaseStructure.WebUsersRoomNotificationValues.PS_ENDED_SPY_NO_FUNDS:case FirebaseStructure.WebUsersRoomNotificationValues.PS_ENDED_SPY_NOT_ALLOWED:var modalType,modalMessage;status==FirebaseStructure.WebUsersRoomNotificationValues.PS_ENDED_SPY_NO_FUNDS?(modalType="insufficientFunds",modalMessage=nstiplang.serverMessages.InsufficientFunds):(modalType="notAllowedToSpy",modalMessage=Cam4ChatErrors.noSpiesAllowed),Chat.newShowsConfirmation("Cam4",modalMessage,modalType),Cam4User.isSpy=!1,streamSource.clearToken(),ChatUI.hideVideoContainer(),ChatUI.overlay.privateShow.show(),ChatUtils.countExactSeconds.stop(),ChatUI.element.sellingTicketsBar.hide(),"insufficientFunds"===modalType?NewShowReceiver.onNewShowStateChanged(NewShowState.accesDenied):"notAllowedToSpy"===modalType&&NewShowReceiver.onNewShowStateChanged(NewShowState.noPrivateShow)}}function calculateShowTimer(startTimestamp,showDuration){var diffInMilliseconds,timerInSeconds,newTimestamp;$.ajax({url:cam4WebChatHost+"/webServerTimestamp",dataType:"text"}).done(function(response){diffInMilliseconds=(newTimestamp=response)-startTimestamp,timerInSeconds=Math.round(parseInt(showDuration-diffInMilliseconds)/1e3),globalCountdown=timerInSeconds})}function monitorStream(){streamRef.on("value",function(snapshot){if(console.log("Snapshot value: ",snapshot.val()),isInitialLoad()){if(!snapshot.val())return void broadcasterOffline((new Date).getTime()+firebaseServerOffset);streamUUID=Object.keys(snapshot.val())[0]}}),streamRef.on("child_added",function(snapshot){isInitialLoad()||(console.log("Child added: ",snapshot.key()),streamUUID=snapshot.key(),toggleAbrElements(snapshot.val().a),broadcasterOnline(),canPlay&&StreamSource.getInstance().reconnect(null,{streamName:streamUUID,abr:snapshot.val().a}))}),streamRef.on("child_removed",function(snapshot){console.log("Child removed: ",snapshot.key()," ",streamUUID),snapshot.key()==streamUUID&&(streamSource.disconnect(),broadcasterOffline((new Date).getTime()+firebaseServerOffset))})}function isInitialLoad(){return""===streamUUID}function toggleAbrElements(abr){abr?($("#resolutionList").show(),$("#Cam4VChat").length&&(Cam4VChat.children.flashvars.value=Cam4VChat.children.flashvars.value.replace("useAbr=false","useAbr=true"))):($("#resolutionList").hide(),$("#Cam4VChat").length&&(Cam4VChat.children.flashvars.value=Cam4VChat.children.flashvars.value.replace("useAbr=true","useAbr=false")))}function broadcasterOnline(){clearInterval(reconnectTimer),clearTimeout(reconnectTimeout),secondsToReconnect=INITIAL_DISCONNECT_TIMER_SECONDS,reconnectEnabled=!0,ControlledFeatures.LOAD_VIDEO_ADS&&"undefined"!=typeof Cam4VideoAds?Cam4VideoAds.cleanUpVast():(ChatUI.volume.element.on("click",clickHandler),ChatUI.volume.slider.slider("enable")),ChatlessPlayer.volume.isMuted()||ChatlessPlayer.volume.unmute(),UserAgent.desktop?ChatlessPlayer.showPlayer(!0):ChatUI.element.video.find("#videoContainer, #Cam4HLSPlayer").show(),ChatUI.overlay.reconnect.parent().hide(),ControlledFeatures.USE_GAME_CENTER&&GameCenter.checkIfGameIsActive()&&$("#pausedGameDock").hasClass("hidden")&&$("#openGameDock").removeClass("hidden"),dataLayer.push({performerOnline:1})}function broadcasterOffline(disconnectTimestamp){var nowMillis=(new Date).getTime()+firebaseServerOffset;reconnectInterval=1e3*(secondsToReconnect=INITIAL_DISCONNECT_TIMER_SECONDS-(nowMillis-disconnectTimestamp)/1e3),reconnectEnabled=!1,streamSource.disconnect(),Cam4User.useVrPlayer&&changeVrShowState("ACCEPTING","ACCEPTING"),UserAgent.desktop&&ChatUI.volume.element.length&&ChatUI.volume.element.data("events").click&&(clickHandler=ChatUI.volume.element.data("events").click[0].handler),ChatUI.overlay.pausedGS.hide(),reconnectTimer=setInterval(function(){if(secondsToReconnect>0){secondsToReconnect--;var displayTimer=ChatUtils.formatTimeValue(secondsToReconnect);ChatUI.overlay.reconnect.text(Cam4Chat.reconnectMessage.replace("{0}",displayTimer))}},1e3),ChatUI.overlay.reconnect.parent().detach().appendTo(ChatUI.element.video).show(),ControlledFeatures.USE_GAME_CENTER&&(GameCenter.closeViewerDock(),$("#openGameDock").addClass("hidden")),UserAgent.desktop?ChatlessPlayer.showPlayer(!1):ChatUI.element.video.find("#videoContainer, #Cam4HLSPlayer").hide(),reconnectTimeout=setTimeout(function(){isGuest||setWebPresenceOffline(),mobileFullScreenAPI.exitFullScreen(),clearInterval(reconnectTimer),closeCam()},reconnectInterval),ControlledFeatures.LOAD_VIDEO_ADS&&"undefined"!=typeof Cam4VideoAds?Cam4VideoAds.init("isHls","postroll"):(ChatUI.volume.element.off("click"),ChatUI.volume.slider.slider("disable")),dataLayer.push({performerOnline:0})}function setResolutionFromFirebase(resolution){if(Cam4User.cameraData.useFlashPlayer||Cam4User.cameraData.useHlsVideoOnMobile){var isVr2DStream="undefined"!=typeof BROADCAST_RESOLUTION&&~["1200:800","720:2560","1440:1280","2560:960","3840:1920"].indexOf(BROADCAST_RESOLUTION);~[90,-90].indexOf(orientation)&&(resolution=resolution.split(":").reverse().join(":")),BROADCAST_RESOLUTION=resolution,!useNewChatlessResolution&&!orientation||!UserAgent.desktop||JsReceiver.playerInFs||ChatlessPlayer.resolution.getCurrentResolution()==resolution||Cam4User.cameraData.camEmbedded||isVr2DStream||(ChatlessPlayer.resolution.setResolution(resolution),ChatlessPlayer.resize.loadSavedDimensions())}}function monitorBroadcasterRoomState(){roomStateRef.on("value",function(snapshot){roomState=snapshot.val();var newShowsState=snapshot.val().newShowsState,newShowsDetails=snapshot.val().newShowsDetails||"",pauseTimestamp=snapshot.val().pTS;allowSpy=snapshot.val().allow_spy||"",allowPS=snapshot.val().allow_ps||"",allowC2C=snapshot.val().allow_c2c||"",spyPPM=snapshot.val().spy_ppm||"",c2cPPM=snapshot.val().c2c_ppm||"",viewerPPM=snapshot.val().viewer_ppm||"",Chat.setBlocksOfTime(snapshot.val().ps_bt||""),Chat.setBlocksOfTimeActive(snapshot.val().ps_bt_a||"0"),setKiiroo(snapshot.val().kiirooRoom||!1),setResolutionFromFirebase(snapshot.val().rez||""),setMbaVersion(snapshot.val().mba_v||0);var privateRoom=snapshot.val().privateRoom||"";ChatSettings.setPrivate(privateRoom),BroadcastStatus.setPrivateRoom(privateRoom),broadcastId=snapshot.val().bId||"",processRoomStateBroadcaster(previousState,newShowsState,newShowsDetails,pauseTimestamp),previousState=newShowsState}),roomStateRef.on("child_removed",function(snapshot){snapshot&&snapshot.val()&&snapshot.val().newShowsState&&stopShow()})}function showBlackFridayOverlay(){$(".video-animation").removeClass("hidden"),$(".bf_anim_wrapper").removeClass("hidden"),$(".bf_anim_background").removeClass("hidden"),$(".bf_anim_wrapper p").removeClass("hidden"),$(".bf_close").removeClass("hidden")}function monitorRoomState(roomName,onComplete){monitorRoomNotifications(),roomStateRef.on("value",function(snapshot){if(null!==snapshot.val()){roomState=snapshot.val(),setResolutionFromFirebase(snapshot.val().rez||""),setMbaVersion(snapshot.val().mba_v||0);var broadcasterStatus=snapshot.val().broadcasterStatus,newShowsState=snapshot.val().newShowsState,newShowsDetails=snapshot.val().newShowsDetails||"",roomOnline=snapshot.val().online,disconnectTimestamp=snapshot.val().dTS||0,roomStatusMessage="",privateRoom=!1;setOrientation(snapshot.val().mba_o||null);var isPublicStream="ACCEPTING"==newShowsState;if(isInitialLoad()&&roomOnline&&dataLayer.push({performerOnline:1}),""!=previousState||"ACCEPTING"!=newShowsState&&"GS_SELLING_TICKETS"!=newShowsState&&"GS_GOAL_REACHED"!=newShowsState&&"GS_SELLING_TICKETS_UNSUCCESSFUL"!=newShowsState||(chatReady=!0),!ControlledFeatures.LOAD_VIDEO_ADS||"undefined"==typeof Cam4VideoAds||"INSIDE_PS"!=newShowsState&&"INSIDE_GS"!=newShowsState||Cam4VideoAds.cleanUpVast(),CURRENT_STATE==NewShowState.requestingPrivateShow&&(Chat.getBlocksOfTimeActive()!==snapshot.val().ps_bt_a?Chat.newShowsConfirmation(js_i18n.psRequest,Cam4Chat.privateShowRequestMessage,"request_PS"):"1"===Chat.getBlocksOfTimeActive()?snapshot.val().ps_bt!==Chat.getBlocksOfTime()&&Chat.newShowsConfirmation(js_i18n.psRequest,Cam4Chat.privateShowRequestMessage,"request_PS"):spyPPM==snapshot.val().spy_ppm&&viewerPPM==snapshot.val().viewer_ppm||Chat.newShowsConfirmation(js_i18n.psRequest,Cam4Chat.privateShowRequestMessage,"request_PS")),allowC2C!=snapshot.val().allow_c2c&&privateModalOpened&&("1"==snapshot.val().allow_c2c?$("#tryCam2Cam").show():$("#tryCam2Cam").hide()),allowSpy=snapshot.val().allow_spy||"",allowPS=snapshot.val().allow_ps||"",allowC2C="","mobile"!=Cam4Performer.statusModel.source&&(allowC2C=snapshot.val().allow_c2c||""),spyPPM=snapshot.val().spy_ppm||"",viewerPPM=snapshot.val().viewer_ppm||"",c2cPPM=snapshot.val().c2c_ppm||"",Chat.setBlocksOfTime(snapshot.val().ps_bt||""),Chat.setBlocksOfTimeActive(snapshot.val().ps_bt_a||"0"),!ControlledFeatures.USE_NEW_STREAMING_NODE){var oldStreamUUID=streamUUID;if((streamUUID=snapshot.val().streamUUID)!==oldStreamUUID){var videoPlayUrl=snapshot.val().originUrl+"/"+snapshot.val().streamUUID;Cam4User.hideEdgeOriginIp&&(videoPlayUrl=streamUUID),""!=oldStreamUUID&&Cam4User.cameraData.useFlashPlayer&&JsSender.playStream(videoPlayUrl)}}if(broadcastId=snapshot.val().bId||"",console.log("Received stream UUID",snapshot.val().streamUUID,"old url",Cam4User.cameraData.hlsUrl),BrowserDetect.isIOS()){var videoPlayer=document.getElementById("Cam4HLSPlayer");videoPlayer&&!function(video){return!!(video.currentTime>0&&!video.paused&&!video.ended&&video.readyState>2)}(videoPlayer)&&(videoPlayer.muted=!0)}if(setTimeout(function(){showBlackFridayOverlay()},45e3),hlsReady=snapshot.val().hlsReady,setKiiroo(snapshot.val().kiirooRoom||!1),ControlledFeatures.KIIROO_ENABLED&&Cam4Event.dispatch("KIIROO_UPDATED",{status:"true"==getKiiroo()}),privateModalOpened&&(Chat.newShowsConfirmation(js_i18n.psRequest,Cam4Chat.privateShowRequestMessage,"request_PS"),Chat.privateModal=!1),spyModalOpened&&(Chat.newShowsConfirmation(Cam4Chat.spyRequestTitle,Cam4Chat.spyRequestMessage,"request_SPY"),spyModalOpened=!1),"PAUSED_GS"!=newShowsState)switch(1==allowSpy||Cam4User.accessLevel>=AccessLevel.MODERATOR?($("#allowSPY").show(),NewShowReceiver.onNewShowStateChanged(NewShowState.accesDenied)):($("#allowSPY").hide(),NewShowReceiver.onNewShowStateChanged(NewShowState.noPrivateShow)),allowPS){case"0":UserAgent.phone&&mobileNewShows.notRequestingPrivate(),NewShowReceiver.onNewShowStateChanged(NewShowState.noPrivateShow),Chat.closeErrorBox();break;case"1":UserAgent.phone?"ACCEPTING"==newShowsState?(mobileNewShows.container.show(),mobileNewShows.requestPrivate(),mobileNewShows.timer.hide(),mobileNewShows.GS.all.hide()):mobileNewShows.notRequestingPrivate():NewShowReceiver.onNewShowStateChanged(NewShowState.notRequestingPrivateShow)}if(snapshot.val().hasOwnProperty("privateRoom")&&(privateRoom=snapshot.val().privateRoom,roomIsPrivate=privateRoom,privateRoom!=previousPrivateRoom&&!1===previousPrivateRoom&&(""==previousState&&""!=streamSource.getState()?streamSource.reconnect(!isPublicStream||privateRoom):(ChatUI.hideVideoContainer(),Firebase.goOffline(),firebaseOffline=!0,Chat.getPrivateRoomAccess("noPass"))),privateRoom&&(returningFromPrivateRoom=!0),previousPrivateRoom=privateRoom,(inPrivateRoom=privateRoom)||(correctPassword=!1)),snapshot.val().hasOwnProperty("goldShow")){var goldShow=snapshot.val().goldShow;if("1"==goldShow&&Cam4User.accessLevel>=AccessLevel.GOLD?ChatUI.header.superShow.removeClass("hidden"):ChatUI.header.superShow.addClass("hidden"),snapshot.val().hasOwnProperty("goldShowTicketHolders")){var ticketHolders=[];for(var ticketHolder in snapshot.val().goldShowTicketHolders)snapshot.val().goldShowTicketHolders.hasOwnProperty(ticketHolder)&&ticketHolders.push(ticketHolder.toLowerCase());goldShowAccess=~ticketHolders.indexOf(Cam4User.userName.toLowerCase())}"1"==goldShow&&!goldShowAccess&&Cam4User.accessLevel<AccessLevel.GOLD?ChatUI.overlay.goldShow.detach().appendTo(ChatUI.element.video).removeClass("force-hide").show():ChatUI.overlay.goldShow.addClass("force-hide")}if("status"in snapshot.val()&&(roomStatusMessage=snapshot.val().status),"undefined"!=newShowsDetails.showDescription){var showDescription=newShowsDetails.showDescription;$j("#viewerScreenTxt").text(showDescription)}if(ChatlessPlayer.isEnabled()&&ChatlessPlayer.roomMessage.update(roomStatusMessage),!ControlledFeatures.USE_NEW_STREAMING_NODE){if(0==roomOnline&&reconnectEnabled)return void broadcasterOffline(disconnectTimestamp);!reconnectEnabled&&roomOnline&&(broadcasterOnline(),streamSource.reconnect(!isPublicStream||privateRoom))}processRoomState(broadcasterStatus,newShowsState,previousState,newShowsDetails,privateRoom),previousState=newShowsState,isGuest&&Cam4Event.dispatch(ChatEvent.ROOM_STATE_UPDATED,{broadcasterStatus:broadcasterStatus,newShowsState:newShowsState,newShowsDetails:newShowsDetails,privateRoom:privateRoom,allowSpy:allowSpy})}void 0!==onComplete&&onComplete()}),Cam4User.isLoggedIn&&monitorViewerCount()}function monitorRoomNotifications(){myRoomNotificationsRef.on("child_added",function(snapshot){handleRoomNotification(snapshot)}),myRoomNotificationsRef.on("child_changed",function(snapshot){handleRoomNotification(snapshot)})}function monitorBroadcasterStream(){streamRef.on("child_removed",function(snapshot){snapshot.key()==Cam4User.streamingData.broadcastSettings.streamUuid&&0==backupRequested&&ControlledFeatures.BROADCAST_ISSUES_INFO_ALERT&&Chat.handleBroadcastStreamError()})}function monitorViewerCount(){chatlessRoomUserCountRefLight.on("value",function(snapshot){if(null!=snapshot.val()){var countStr=snapshot.val(),splitIndex=countStr.indexOf("$");totalLoggedInUsers=parseInt(countStr.substring(0,splitIndex)),globalTotalGuests=parseInt(countStr.substring(splitIndex+1)),ChatUIController.updateChatCounter(totalUsersChatting,totalLoggedInUsers,globalTotalGuests),Cam4User.useVrPlayer&&streamSource.updateUsersCount&&streamSource.updateUsersCount(totalUsersChatting,totalLoggedInUsers,globalTotalGuests)}})}function calculateExactShowTimer(startTimestamp,showDuration,callBack){calculateExactRemainingTime(startTimestamp+showDuration,callBack)}function calculateExactRemainingTime(end,callBack){var remainingMilliseconds,timerInSeconds,newTimestamp;$.ajax({url:cam4WebChatHost+"/webServerTimestamp",dataType:"text"}).done(function(response){remainingMilliseconds=end-(newTimestamp=response),timerInSeconds=parseInt(Math.round(remainingMilliseconds/1e3)),callBack(timerInSeconds)})}function broadcasterReturningIn(newShowsState){globalCountdown=10,ChatUI.overlay.returnCountdown.detach().appendTo(ChatUI.element.video).show(),timer=setInterval(function(){countdownTimer(ChatUI.overlay.returnCountdown.find(".timer"),newShowsState,"")},intervalTimerStep),ControlledFeatures.USE_GAME_CENTER&&GameCenter.resumeActiveGame()}function clearBroadcasterReturning(){ChatUI.overlay.returnCountdown.hide(),clearInterval(timer)}function startPrivateShowTimer(displayTimerCallback,timerThreshold,offsetSeconds){if(ChatUtils.countExactSeconds.stop(),"1"===Chat.getBlocksOfTimeActive()){var thresholdDisplayed=!1;calculateExactRemainingTime(getBlocksOfTimeEnd(),function(secondsRemaining){displayTimerCallback(secondsRemaining),ChatUtils.countExactSeconds.start(function(secondsElapsed){var secondsToDisplay=secondsRemaining-secondsElapsed;displayTimerCallback&&displayTimerCallback(secondsToDisplay),timerThreshold>0&&secondsToDisplay<=timerThreshold&&!thresholdDisplayed&&(Chat.newShowsConfirmation(js_i18n.psRequest,Cam4Chat.privateShowRequestMessage,"extend_PS"),thresholdDisplayed=!0)})})}else displayTimerCallback(offsetSeconds=offsetSeconds||0),ChatUtils.countExactSeconds.start(function(seconds){displayTimerCallback(seconds+offsetSeconds)})}function startSpyTimer(displayTimerCallback,offsetSeconds){ChatUtils.countExactSeconds.stop(),displayTimerCallback(offsetSeconds=offsetSeconds||0),ChatUtils.countExactSeconds.start(function(seconds){displayTimerCallback(seconds+offsetSeconds)})}function updatePrivateShowTimer(displayTimerCallback,timerThreshold){startPrivateShowTimer(displayTimerCallback,timerThreshold,0)}function checkIfExtendBlocksOfTime(currentValue,newValue){return newValue&&0!==currentValue&&currentValue<newValue}function disablePSSettingsTabNavigation(){$(".nav-link").removeAttr("data-toggle")}function enablePSSettingsTabNavigation(){$(".nav-link").attr("data-toggle","pill")}function computePSElapsedTime(firebaseServerOffset,newShowsDetails){var nowMillis=(new Date).getTime()+firebaseServerOffset,psStartTime=newShowsDetails.startTime||0,elapsedSeconds=0;return 0!==psStartTime&&(elapsedSeconds=(nowMillis-psStartTime)/1e3),elapsedSeconds}function computeSpyElapsedTime(firebaseServerOffset,newShowsDetails,currentUser){var nowMillis=(new Date).getTime()+firebaseServerOffset,psStartTime=newShowsDetails.spyTicketHolders[currentUser]||0,elapsedSeconds=0;return 0!==psStartTime&&(elapsedSeconds=(nowMillis-psStartTime)/1e3),elapsedSeconds}function processBroadcasterInsidePS(previousState,newShowsState,newShowsDetails){var blocksOfTimeExtended=checkIfExtendBlocksOfTime(getBlocksOfTimeEnd(),newShowsDetails.set);if(setBlocksOfTimeEnd(newShowsDetails.set),blocksOfTimeExtended)updatePrivateShowTimer(ChatUIController.updateBroadcasterPSTimer,-1);else{if(NewShowReceiver.dropAllRequests(),newShowsDetails.cam2cam?NewShowReceiver.onNewShowStateChanged(NewShowState.InCam2Cam,newShowsDetails.c2ce):(NewShowReceiver.onNewShowStateChanged(NewShowState.InPrivateShow),"undefined"!=typeof VidyoConnector&&VidyoConnector.isLoaded()&&(VidyoConnector.disconnect(),VideoCommunicator.remountClient(null,"broadcaster")),ChatCam2Cam.close()),previousState!==newShowsState){newShowsDetails.cam2cam&&newShowsDetails.c2ce&&(requestTokenAndConnect(Cam4User.userName.toLowerCase(),Cam4User.performerName.toLowerCase(),"vidyoClient","flashC2CContainer"),StreamSource.getInstance().showPlayer(!1),StreamSource.getInstance().disconnect()),privateMessageOn();var elapsedSeconds=computePSElapsedTime(firebaseServerOffset,newShowsDetails);startPrivateShowTimer(ChatUIController.updateBroadcasterPSTimer,-1,elapsedSeconds),disablePSSettingsTabNavigation()}var user=newShowsDetails.ticketHolders[0],userObj=getUser(user);ChatUIController.addMessageTab(user,"",userObj.original_username,!0,userObj),$("#"+userObj.original_username+"Tab").click()}}function requestTokenAndConnect(username,room,localView,remoteView,callback){"undefined"!=typeof VidyoConnector?$.ajax({url:"/generateVidyoToken?roomname="+encodeURIComponent(room)+"&bid="+broadcastId}).success(function(data){if(data&&data.token&&data.resourceId){ChatCam2Cam.init();var camera="default",microphone="default";"undefined"!=typeof VideoCommunicator&&VideoCommunicator.getCurrentSettings&&(camera=VideoCommunicator.getCurrentSettings().cameraName,microphone=VideoCommunicator.getCurrentSettings().microphoneName),VidyoConnector.connect(host,data.token,data.resourceId,username,localView,remoteView,callback,camera,microphone)}else data&&data.error&&console.error("Failed to generate vidyo token: "+data.error)}).error(function(request,status,error){console.error("Something went wrong. Please refresh the page.")}):console.error("Vidyo connector is undefined")}function processBroadcasterExitPS(newShowsState){if(setBlocksOfTimeEnd(0),ChatUtils.countExactSeconds.stop(),"undefined"!=typeof VidyoConnector&&VidyoConnector.isLoaded()){VidyoConnector.disconnect();"undefined"==typeof Cam4User&&Cam4User.streamingData&&Cam4User.streamingData.broadcastSettings&&"external_encoder"===Cam4User.streamingData.broadcastSettings.streamSource&&"viewer",StreamSource.getInstance().reconnect(),StreamSource.getInstance().showPlayer(!0)}else"ACCEPTING"===newShowsState&&broadcasterReturningIn(newShowsState);NewShowReceiver.onNewShowStateChanged(NewShowState.AcceptingPrivateShow),ChatCam2Cam.close(),enablePSSettingsTabNavigation(),SoundPlayer.privateShowEnd()}function processRoomStateBroadcaster(previousState,newShowsState,newShowsDetails,pauseStart){if("GS_SELLING_TICKETS"==newShowsState&&(console.log("newShowsDetails: ",newShowsDetails),NewShowReceiver.dropAllRequests(),NewShowReceiver.stopCountDown(!0),calculateExactShowTimer(newShowsDetails.currentStart,newShowsDetails.currentDuration,Chat.sellingTicketsTimer),NewShowReceiver.onNewShowStateChanged(NewShowState.SellingTickets),"undefined"!=newShowsDetails.showDescription)){var showDescription=newShowsDetails.showDescription;$j("#viewerScreenTxt").text(showDescription)}if("GS_GOAL_REACHED"==newShowsState&&"GS_GOAL_REACHED"!=previousState&&(NewShowReceiver.stopCountDown(!0),NewShowReceiver.initCountDown(120,"startIn"),NewShowReceiver.onNewShowStateChanged(NewShowState.GoalReached),Chat.newShowsConfirmation(Cam4Chat.goalReachedBroadcasterTitle,Cam4Chat.goalReachedBroadcaster,"goal_reached")),"GS_SELLING_TICKETS_UNSUCCESSFUL"==newShowsState&&(NewShowReceiver.stopCountDown(!0),Chat.newShowsConfirmation(Cam4Chat.goalNotReachedTitle,Cam4Chat.goalNotReached+Cam4Chat.goalNotReachedStart,"goal_not_reached")),"INSIDE_GS"!=previousState&&"INSIDE_GS"==newShowsState&&(GSMessagesOn(),NewShowReceiver.showMain(!0),NewShowReceiver.stopCountDown(!0),NewShowReceiver.initCountDown(newShowsDetails.currentDuration/1e3,"endIn"),NewShowReceiver.onNewShowStateChanged(NewShowState.InGroupShow),""==previousState&&Chat.newShowsConfirmation(Cam4ChatErrors.groupShowResumeTitle,Cam4ChatErrors.groupShowResume,"gs_reload")),"BONUS_GS"==newShowsState&&(NewShowReceiver.stopCountDown(!0),NewShowReceiver.onNewShowStateChanged(NewShowState.InBonusTime),NewShowReceiver.initCountDown(newShowsDetails.bonusTime/1e3,"bonusTime")),"INSIDE_GS"==newShowsState||"GS_SELLING_TICKETS"==newShowsState||"GS_GOAL_REACHED"==newShowsState||"BONUS_GS"==newShowsState){var showInfo={ticketPrice:newShowsDetails.ticketPrice,showLength:newShowsDetails.gsTime/1e3,tokensGoal:newShowsDetails.goal,tokensProgress:(void 0===newShowsDetails.gsReservedTokens?0:newShowsDetails.gsReservedTokens)+(void 0===newShowsDetails.gsTippedTokens?0:newShowsDetails.gsTippedTokens),timeLeft:newShowsDetails.currentDuration/1e3,bonusTime:void 0===newShowsDetails.bonusTime||"BONUS_GS"==newShowsState?0:newShowsDetails.bonusTime/1e3};NewShowReceiver.setBroadcasterGroupShowInfo(JSON.stringify(showInfo))}if("INSIDE_GS"!=previousState&&"BONUS_GS"!=previousState&&"PAUSED_GS"!=previousState||"ACCEPTING"!=newShowsState||broadcasterReturningIn(newShowsState),"INSIDE_GS"!=previousState&&"GS_SELLING_TICKETS"!=previousState&&"GS_SELLING_TICKETS_UNSUCCESSFUL"!=previousState&&"BONUS_GS"!=previousState&&"GS_GOAL_REACHED"!=previousState||"ACCEPTING"!=newShowsState&&"PAUSED"!=newShowsState||(ChatUIController.closeGSTab(),GSMessagesOff(),NewShowReceiver.stopCountDown(!0),NewShowReceiver.onNewShowStateChanged(NewShowState.AcceptingPrivateShow)),"INSIDE_GS"!=previousState&&"BONUS_GS"!=previousState||"ACCEPTING"!=newShowsState||LogicObj.requestReceipt("gs"),"INSIDE_PS"===newShowsState&&processBroadcasterInsidePS(previousState,newShowsState,newShowsDetails),"INSIDE_PS"!==previousState||"ACCEPTING"!==newShowsState&&"PAUSED"!==newShowsState||processBroadcasterExitPS(newShowsState),"PAUSE_TIMEOUT"===newShowsState&&"PAUSED"===previousState&&stopShow(),ControlledFeatures.SHOW_PAUSE_BUTTON&&("ACCEPTING"!=newShowsState&&"NOT_ACCEPTING"!=newShowsState||ChatSettings.isPrivate()?$("#pauseButton").hide():($("#pauseButton").show(),clearInterval(pauseTimer),ChatUI.overlay.broadcasterPauseOverlay.hide()),"PAUSED"==newShowsState)){clearBroadcasterReturning(),ChatUI.overlay.broadcasterPauseOverlay.show();var element=ChatUI.overlay.broadcasterPauseOverlay.find(".timer");calculateShowTimer(pauseStart,3e5),pauseTimer=setInterval(function(){countdownTimer(element,newShowsState,0)},intervalTimerStep)}ChatSettings.isPrivate()?VideoCommunicator.stopSnapshots():newShowsState!=previousState&&(streamIsPrivate(newShowsState)?VideoCommunicator.stopSnapshots():VideoCommunicator.startSnapshots())}function streamIsPrivate(newShowsState){return"INSIDE_PS"==newShowsState||"INSIDE_GS"==newShowsState||"PAUSED"==newShowsState}function processViewerInsidePS(previousState,newShowsState,newShowsDetails){if(roomAccepting=!1,isGuest)return ChatUI.overlay.privateShow.detach().appendTo(ChatUI.element.video).show(),ChatUI.hideVideoContainer(),void(Cam4User.useVrPlayer&&changeVrShowState("INSIDE_PS","NOT_PLAYING",!1));if(isTicketHolder){var blocksOfTimeExtended=checkIfExtendBlocksOfTime(getBlocksOfTimeEnd(),newShowsDetails.set);if(setBlocksOfTimeEnd(newShowsDetails.set),UserAgent.phone&&mobileNewShows.insidePrivateShow("1"===Chat.getBlocksOfTimeActive()),newShowsDetails.cam2cam&&UserAgent.desktop?(NewShowReceiver.onNewShowStateChanged(NewShowState.inCam2Cam,newShowsDetails.c2ce),previousState!==newShowsState&&(newShowsDetails.c2ce?(requestTokenAndConnect(Cam4User.userName.toLowerCase(),Cam4User.performerName.toLowerCase(),"vidyoPlayer","none",vidyoConnected),StreamSource.getInstance().showPlayer(!1),StreamSource.getInstance().disconnect()):ChatCam2Cam.init("CHATLESS_BROADCASTER",Cam4User.userName.toLowerCase(),"",""))):(UserAgent.desktop&&(ChatCam2Cam.close(),"undefined"!=typeof VidyoConnector&&VidyoConnector.isLoaded()&&(VidyoConnector.disconnect(),StreamSource.getInstance().reconnect(),StreamSource.getInstance().showPlayer(!0),LogicObj.requestPlayToken())),NewShowReceiver.onNewShowStateChanged(NewShowState.inPrivateShow),"1"!==allowC2C||!UserAgent.desktop||Cam4User.isInPending||ControlledFeatures.DISABLE_C2C_PS||NewShowReceiver.onCam2CamUpdate(NewShowState.cam2cam.requestEnabled)),privateMessageEnabled||privateMessageOn(),clearTimeout(LogicObj.timeout),previousState!==newShowsState){elapsedSeconds=computePSElapsedTime(firebaseServerOffset,newShowsDetails);startPrivateShowTimer(ChatUIController.privateShowTimer,60,elapsedSeconds)}else blocksOfTimeExtended&&updatePrivateShowTimer(ChatUIController.privateShowTimer,60);"INSIDE_PS"!==previousState&&(newShowsDetails.c2ce||LogicObj.requestPlayToken()),roomName=Cam4User.performerName;var thatUser=Chat.getUser(roomName);ChatUIController.addMessageTab(thatUser.original_username,thatUser.imageCDN,roomName,!0,thatUser),$("#"+roomName+"Tab").click(),Cam4User.useVrPlayer&&changeVrShowState("INSIDE_PS","INSIDE_PS",!1)}else if(!0===Cam4User.isSpy)if(1==allowSpy&&1==allowPS){if(NewShowReceiver.onNewShowStateChanged(NewShowState.inSpy),clearTimeout(LogicObj.timeout),previousState!==newShowsState){var elapsedSeconds=computeSpyElapsedTime(firebaseServerOffset,newShowsDetails,Cam4User.userName.toLowerCase());startSpyTimer(ChatUIController.privateShowTimer,elapsedSeconds),Cam4User.cameraData.useHlsVideoOnMobile&&!UserAgent.desktop&&(mobileNewShows.container.show(),mobileNewShows.SPY.cancel.show()),NewShowReceiver.onNewShowStateChanged(NewShowState.inSpy),LogicObj.requestPlayToken()}Cam4User.useVrPlayer&&changeVrShowState("INSIDE_PS","SPYING",!1)}else NewShowReceiver.onNewShowStateChanged(NewShowState.noPrivateShow);else(1==allowSpy||Cam4User.accessLevel>=AccessLevel.MODERATOR)&&1==allowPS&&!newShowsDetails.c2ce?($j("#allowSPY").show(),NewShowReceiver.onNewShowStateChanged(NewShowState.accesDenied)):($j("#allowSPY").hide(),NewShowReceiver.onNewShowStateChanged(NewShowState.noPrivateShow)),ChatUI.overlay.privateShow.detach().appendTo(ChatUI.element.video),ChatUI.overlay.privateShow.show(),ChatUI.hideVideoContainer(),Cam4User.useVrPlayer&&changeVrShowState("INSIDE_PS","NOT_PLAYING",!0)}function vidyoConnected(){var details={cam2CamExternal:!0,roomName:Cam4User.performerName,cam2Cam:!0,streamUUID:Cam4User.performerName};initializeRoomBroadcastId({details:JSON.stringify(details),username:Cam4User.userName,accessHash:Cam4User.kN})}function processRoomState(broadcasterStatus,newShowsState,previousState,newShowsDetails,privateRoom){var stateIsPrivate=function(state){return"INSIDE_PS"===state||"INSIDE_GS"===state||"BONUS_GS"===state||"PAUSED_GS"===state||"PAUSED"===state};if(""===previousState&&(chatReady=!0),("ACCEPTING"===newShowsState&&stateIsPrivate(previousState)&&!privateRoom||!privateRoom&&returningFromPrivateRoom)&&((!isTicketHolder&&!Chat.viewerAllowedInPrivateStream||Cam4User.cameraData.useHlsVideoOnMobile&&ControlledFeatures.USE_CDN_FOR_HLS_VIEWERS)&&setTimeout(function(){streamSource.reconnect(!1)},8e3),Chat.viewerAllowedInPrivateStream=!1),!privateRoom&&returningFromPrivateRoom&&(returningFromPrivateRoom=!1),privateRoom&&!Cam4User.isLoggedIn)return ChatUI.overlay.privateRoom.detach().appendTo(ChatUI.element.video),ChatUI.overlay.privateRoom.show(),void setTimeout(function(){closeCam()},privateRoomCloseCamDelay);if(!idVerificationEnabled&&"PENDING"==broadcasterStatus)return NetVerify.showViewerNotification(!0),NewShowReceiver.hideTippingActions(),ChatUI.element.sellingTicketsBar.addClass("force-hide"),void ChatUI.overlay.groupShow.addClass("force-hide");idVerificationEnabled||"APPROVED"!=broadcasterStatus||(NetVerify.showViewerNotification(!1),NewShowReceiver.showTippingActions(),ChatUI.element.sellingTicketsBar.removeClass("force-hide"),ChatUI.overlay.groupShow.removeClass("force-hide"),streamSource.reconnect());var currentUser=Cam4User.userName.toLowerCase();if(void 0!==newShowsDetails.ticketHolders&&(-1!=newShowsDetails.ticketHolders.lastIndexOf(currentUser)?(isTicketHolder=!0,UserAgent.phone&&"INSIDE_PS"!=newShowsState&&mobileNewShows.ticketPurchased(),"GS_SELLING_TICKETS"!=newShowsState&&"GS_SELLING_TICKETS_UNSUCCESSFUL"!=newShowsState&&"GS_GOAL_REACHED"!=newShowsState&&"INSIDE_GS"!=newShowsState||NewShowReceiver.onNewShowStateChanged(NewShowState.sellingTicketsTicketPurchased),isGroupShowAuthenticated||"INSIDE_GS"!=newShowsState&&"BONUS_GS"!=newShowsState||reauthentificateFirebaseForGS(newShowsState),"INSIDE_GS"==newShowsState&&"PAUSED_GS"==previousState&&streamSource.reconnect(!0)):isTicketHolder=!1),void 0!==newShowsDetails.spyTicketHolders&&void 0!==newShowsDetails.spyTicketHolders[currentUser]&&(Cam4User.isSpy=!0),isGuest&&"GS_SELLING_TICKETS"!=newShowsState&&"ACCEPTING"!=newShowsState||function(){var element,bonusTime="";if("ACCEPTING"!=newShowsState||"ACCEPTING"!=previousState){switch(clearInterval(timer),void 0!==newShowsDetails.bonusTime&&isTicketHolder&&(bonusTime=newShowsDetails.bonusTime),newShowsState){case"GS_SELLING_TICKETS":case"GS_GOAL_REACHED":case"GS_SELLING_TICKETS_UNSUCCESSFUL":case"BONUS_GS":element=ChatUI.element.sellingTicketsBar;break;case"INSIDE_GS":element=isTicketHolder?ChatUI.element.sellingTicketsBar:ChatUI.overlay.groupShow.find(".timer");break;case"PAUSED_GS":element=ChatUI.overlay.pausedGS.find("span");break;case"ACCEPTING":return void(roomAccepting||(globalCountdown=10,ChatUI.overlay.returnCountdown.detach().appendTo(ChatUI.element.video).show(),timer=setInterval(function(){countdownTimer(ChatUI.overlay.returnCountdown.find(".timer"),newShowsState,"")},intervalTimerStep)));case"INSIDE_PS":return void ChatUI.overlay.returnCountdown.hide();case"PAUSED":return}UserAgent.phone&&(mobileNewShows.showTimer(),element=mobileNewShows.timer,"PAUSED_GS"==newShowsState&&(element=ChatUI.overlay.pausedGS.find("span")),isTicketHolder||"INSIDE_GS"!=newShowsState||(element=ChatUI.overlay.groupShow.find(".timer"))),calculateShowTimer(newShowsDetails.currentStart,newShowsDetails.currentDuration),timer=setInterval(function(){countdownTimer(element,newShowsState,bonusTime)},intervalTimerStep)}}(),void 0!==newShowsDetails.ticketPrice&&(ticketPrice=newShowsDetails.ticketPrice,UserAgent.phone&&mobileNewShows.updateTicketPrice(ticketPrice)),"INSIDE_PS"===newShowsState&&processViewerInsidePS(previousState,newShowsState,newShowsDetails),"GS_SELLING_TICKETS"==newShowsState&&(ChatUI.overlay.returnCountdown.hide(),ChatUI.showVideoContainer(),TippingGamesUtils.isGameActive()&&$("#rollTheDicePlay").hide(),isTicketHolder||($("#mainPSButton").show(),NewShowReceiver.onNewShowStateChanged(NewShowState.requestGroupShow),UserAgent.phone&&mobileNewShows.buyTicket())),"GS_GOAL_REACHED"!=newShowsState&&"GS_SELLING_TICKETS_UNSUCCESSFUL"!=newShowsState||(isGuest||isTicketHolder&&previousState!=newShowsState&&""!=previousState&&"GS_SELLING_TICKETS_UNSUCCESSFUL"!=newShowsState&&Chat.newShowsConfirmation(Cam4Chat.goalReachedTitle,Cam4Chat.goalReached,"goal_reached"),isTicketHolder||(UserAgent.phone&&mobileNewShows.buyTicket(),NewShowReceiver.onNewShowStateChanged(NewShowState.requestGroupShow))),"INSIDE_GS"==newShowsState){var buyTicketState="";isTicketHolder&&(isGroupShowAuthenticated||(reauthentificateFirebaseForGS(NewShowState),""!=previousState&&Chat.newShowsConfirmation(Cam4Chat.groupShowStartedTitle,Cam4Chat.groupShowStarted,"show_started"))),"PAUSED_GS"==previousState&&ChatUI.overlay.pausedGS.hide(),Cam4User.useVrPlayer&&changeVrShowState("INSIDE_GS","NOT_PLAYING",!1),isGuest||(UserAgent.phone&&!isTicketHolder&&mobileNewShows.buyTicket(),isTicketHolder?(buyTicketState=NewShowState.inGroupShow,ChatUI.overlay.groupShow.hide(),ChatUI.showVideoContainer()):("PAUSED_GS"==previousState&&(streamSource.stop(),ChatUI.overlay.pausedGS.hide(),ChatUI.overlay.groupShow.detach().appendTo(ChatUI.element.video).show()),buyTicketState=NewShowState.requestGroupShow,$("#buyTicketGroupShow").show(),ChatUI.element.sellingTicketsBar.hide())),isTicketHolder||(ChatUI.hideVideoContainer(),ChatUI.overlay.groupShow.detach().appendTo(ChatUI.element.video).show(),"PAUSED_GS"==previousState&&streamSource.reconnect()),isGuest&&(buyTicketState=NewShowState.guestInGroupShow),NewShowReceiver.onNewShowStateChanged(buyTicketState),roomAccepting=!1}if("PAUSED_GS"==newShowsState&&(streamSource.stop(),ChatUI.element.sellingTicketsBar.hide(),ChatUI.hideVideoContainer(),ChatUI.overlay.groupShow.hide(),isGuest?($("#buyTicketGroupShow").hide(),ChatUI.overlay.groupShow.detach().appendTo(ChatUI.element.video).show(),ChatUI.overlay.groupShow.find(".timer").hide()):ChatUI.overlay.pausedGS.detach().appendTo(ChatUI.element.video).show(),NewShowReceiver.setBuyTicketButton(!1)),"BONUS_GS"==newShowsState&&(console.log(" newShowsState = "+newShowsState),roomAccepting=!1,parseInt(Cam4User.accessLevel)<AccessLevel.ADMIN&&$("#buyTicketGroupShow").hide(),ChatUI.overlay.groupShow.find(".timer").hide(),isTicketHolder?(ChatUI.overlay.groupShow.hide(),ChatUI.showVideoContainer(),NewShowReceiver.onNewShowStateChanged(NewShowState.goalReachedTicketPurchased)):(UserAgent.phone&&mobileNewShows.container.hide(),NewShowReceiver.onNewShowStateChanged(NewShowState.accessDeniedInBonusTime),ChatUI.overlay.groupShow.detach().appendTo(ChatUI.element.video).show(),ChatUI.hideVideoContainer())),"ACCEPTING"!=newShowsState&&"INSIDE_PS"!=newShowsState&&!isGuest){var tippingData={gsTime:newShowsDetails.gsTime,gsTippedTokens:newShowsDetails.gsTippedTokens||0,gsReservedTokens:newShowsDetails.gsReservedTokens||0,goal:newShowsDetails.goal,showDescription:newShowsDetails.showDescription,ticketPrice:newShowsDetails.ticketPrice};LogicObj.updateTippingData(tippingData)}if("ACCEPTING"==newShowsState||"PAUSED"==newShowsState){if("PAUSED"==previousState&&"ACCEPTING"==newShowsState&&(clearOverlays(),ChatUI.showVideoContainer(),Cam4User.useVrPlayer&&changeVrShowState("ACCEPTING","ACCEPTING")),"INSIDE_PS"==previousState&&(isTicketHolder||void 0!==Cam4User.isSpy&&!0===Cam4User.isSpy)&&(ChatCam2Cam.close(),"undefined"!=typeof VidyoConnector&&VidyoConnector.isLoaded()&&(VidyoConnector.disconnect(),StreamSource.getInstance().reconnect(),StreamSource.getInstance().showPlayer(!0)),ChatUtils.countExactSeconds.stop(),ChatUI.element.sellingTicketsBar.hide()),"INSIDE_PS"!=previousState||isGuest||TipBalance.getBalance(),"INSIDE_PS"==previousState&&void 0!==Cam4User.isSpy&&!0===Cam4User.isSpy&&(Cam4User.isSpy=!1,ChatUI.unmuteAudio(streamSource),LogicObj.requestReceipt("ss")),streamSource.hideGuestGS(),UserAgent.phone&&!isGuest&&"ACCEPTING"!=previousState&&"INSIDE_PS"!=previousState&&mobileNewShows.goal.text(""),!isTicketHolder||"INSIDE_GS"!=previousState&&"BONUS_GS"!=previousState||(ChatUIController.closeGSTab(),GSMessagesOff()),isTicketHolder)switch(previousState){case"":break;case"GS_SELLING_TICKETS":case"GS_GOAL_REACHED":case"GS_SELLING_TICKETS_UNSUCCESSFUL":Chat.newShowsConfirmation(Cam4Chat.refundViewerTitle,Cam4Chat.refundViewer,"tickets_refunded");break;case"INSIDE_PS":LogicObj.requestReceipt("ps");break;case"INSIDE_GS":case"BONUS_GS":LogicObj.requestReceipt("gs")}isTicketHolder=!1,isGroupShowAuthenticated=!1,privateRoom||streamSource.clearToken()}"ACCEPTING"==newShowsState&&0==roomAccepting&&(roomAccepting=!0,ChatUI.element.sellingTicketsBar.hide(),ChatUI.hideVideoContainer(),ChatUI.overlay.privateShow.hide(),ChatUI.overlay.groupShow.hide(),Cam4User.useVrPlayer&&changeVrShowState("ACCEPTING","ACCEPTING")),"PAUSED"==newShowsState&&(roomAccepting=!0,streamSource.disconnect(),canPlay=!1,clearOverlays(),ChatUI.overlay.pausedShow.detach().appendTo(ChatUI.element.video).show(),ChatUI.hideVideoContainer(),NewShowReceiver.onNewShowStateChanged(NewShowState.notRequestingPrivateShow)),"PAUSE_TIMEOUT"==newShowsState&&closeCam(),!function(state){return stateIsPrivate(state)||privateRoom}(newShowsState)||function(){var allowed="INSIDE_PS"===newShowsState&&Chat.viewerAllowedInPrivateStream;return allowed=allowed||privateRoom&&correctPassword,allowed=allowed||("INSIDE_GS"===newShowsState||"BONUS_GS"===newShowsState||"PAUSED_GS"===newShowsState)&&isTicketHolder}()?canPlay=!0:(canPlay=!1,streamSource.disconnect())}function clearOverlays(){ChatUI.overlay.privateShow.hide(),ChatUI.overlay.groupShow.hide(),ChatUI.overlay.returnCountdown.hide(),ChatUI.overlay.reconnect.hide(),ChatUI.overlay.goldShow.hide(),ChatUI.overlay.pausedShow.hide(),clearInterval(timer)}function countdownTimer(element,showState,bonusTime){if(globalCountdown--,showLengthFormated=ChatUtils.formatTimeValue(globalCountdown),globalCountdown>0){switch(displayTimer="",showState){case"GS_SELLING_TICKETS":case"GS_SELLING_TICKETS_UNSUCCESSFUL":displayTimer=js_i18n.timeRemaining,UserAgent.phone&&(displayTimer=Cam4Chat.timeLeft);break;case"GS_GOAL_REACHED":displayTimer=js_i18n.showStartsIn;break;case"INSIDE_GS":isTicketHolder?displayTimer=Cam4Chat.showEndsIn:isGuest||(displayTimer=Cam4Chat.timeLeft);break;case"PAUSED_GS":break;case"BONUS_GS":displayTimer=Cam4Chat.bonusTimeLeft;break;case"ACCEPTING":Cam4User.isViewer()&&NewShow.enableRequestPrivateShowButton(!1),displayTimer=Cam4Chat.broadcasterReturnsIn.replace("{0}",globalCountdown)}"ACCEPTING"!=showState&&(displayTimer+=" "+showLengthFormated),"INSIDE_GS"==showState&&""!=bonusTime&&(displayTimer+=" + ("+(bonusTime/=6e4)+")",UserAgent.phone||(displayTimer+=nstiplang.minutes)),element.html(displayTimer).css("display","inline")}else element.hide(),ChatUI.overlay.returnCountdown.hide(),clearInterval(timer),"ACCEPTING"==showState&&(ChatUI.showVideoContainer(),Cam4User.isViewer()&&NewShow.enableRequestPrivateShowButton(!0))}function monitorUsers(roomName,onComplete){if(trie.addUsername(trie.TRIE_TERMINAL_ENTRY,roomName,""),isGuest)startChat(roomName,onComplete);else{var userListFirebaseRef=usersRef.child("webUsers"),lightVersion=!1;ControlledFeatures.FIREBASE_LIGHT_ROSTER&&(userListFirebaseRef=rosterLightRef,lightVersion=!0),userListFirebaseRef.on("child_changed",function(snapshot){(lightVersion||null!=snapshot.child(FirebaseStructure.RosterLabels.USER_INFO).val())&&formatAndAddUserOn(snapshot,roomName,lightVersion)}),userListFirebaseRef.on("child_added",function(snapshot){(lightVersion||null!=snapshot.child(FirebaseStructure.RosterLabels.USER_INFO).val())&&formatAndAddUserOnce(snapshot,roomName,lightVersion)}),userListFirebaseRef.on("child_removed",function(snapshot){(lightVersion||null!=snapshot.child(FirebaseStructure.RosterLabels.USER_INFO).val())&&userLeftRoom(snapshot,roomName,lightVersion)}),startChat(roomName,onComplete)}}function privateMessageInit(){privateMessages.on("child_added",function(snapshot){var data=snapshot.val(),message=data.m,from=data.ou,to=data.recipient,hash=data.mh,isFanclubSubscribed=data.fc,senderAccessLevel=AccessLevel.fromShortName(data.l),senderIsRoomModerator="1"==data.rm,showToRecipient="1"==data.sr,messageObject=FirebaseMessageObject.fromParameters(message,from,1,senderAccessLevel,senderIsRoomModerator,hash,isFanclubSubscribed,data[FirebaseStructure.RosterLabels.VIEWER_TYPE]);messageObject.messageKey=snapshot.key(),from.toLowerCase()==chatUsername&&(from=to);var specialPermission="moderator"==senderAccessLevel||"admin"==senderAccessLevel||messageObject.senderOriginalUsername.toLowerCase()==Cam4User.userName.toLowerCase(),isRecipient=chatUsername==to.toLowerCase(),showMessage=isPrivateMessageEnabled()&&(isRecipient&&showToRecipient||!isRecipient);(!isUserIgnored(from)&&showMessage||specialPermission)&&handleMessage(messageObject,roomName,"",from)})}function privateMessageOn(){privateMessageInitialised||(privateMessageInit(),privateMessageInitialised=!0),privateMessageEnabled=!0}function isPrivateMessageEnabled(){return privateMessageEnabled}function reauthentificateFirebaseForGS(showState){""!=previousState&&streamSource.disconnect(),isGroupShowAuthenticated=!0;var authGSChat=cam4WebChatHost+"requestGroupShowToken?roomname="+roomName+"&accessHash="+Cam4User.kN+"&username="+Cam4User.userName;$j.ajax({url:authGSChat,context:document.body}).done(function(data){tokenChat=data.token,GSMessages.authWithCustomToken(tokenChat,function(error){error?(isGroupShowAuthenticated=!1,console.log("GS error!")):(GSMessagesOn(),"INSIDE_GS"==showState&&(streamSource.setToken(data),streamSource.resume()),ChatUI.showVideoContainer(),ChatUI.overlay.returnCountdown.hide(),ChatUI.overlay.groupShow.hide(),"INSIDE_GS"!=showState||Cam4User.cameraData.useHlsVideoOnMobile||streamSource.reconnect())})})}function ajaxGroupShow(path,action,data){var url=cam4WebChatHost+path;data.roomname=roomName,data.accessHash=Cam4User.kN,data.username=Cam4User.userName,data.action=action,$j.ajax({url:url,context:document.body,type:"post",data:data})}function endGroupShow(){ajaxGroupShow("groupShowAction","endGS",{})}function GSMessagesOn(){UserAgent.phone&&ChatUIController.addMessageTab("GSChat","","GS",!0),ChatUIController.showTab("GS"),ChatUIController.tabClick($j("#GSTab")),GSMessages.limitToLast(nrOfMessagesLoadedFromHistory).on("child_added",function(snapshot){var data=snapshot.val(),key=snapshot.key();data[FirebaseStructure.ChatMessageLabels.TYPE]===FirebaseStructure.NotificationType.SEND_TIP?(messageObject=FirebaseMessageObject.fromLightChatMessageSnapshot(data),ChatUIController.addNotificationMessage(messageObject,data,!0,"GS")):(messageObject=FirebaseMessageObject.fromChatMessageSnapshot(key,data),handleMessage(messageObject,roomName,"","GS"))})}function GSMessagesOff(){GSMessages.off()}function messageExists(messageKey){return _messages.model.messagesList.some(function(message){return message.messageKey()===messageKey})}function addFirebaseMessages(key,data,lightVersion,firstLoadMessages){var messageObject={};if(messageObject=lightVersion?FirebaseMessageObject.fromLightChatMessageSnapshot(data):FirebaseMessageObject.fromChatMessageSnapshot(key,data),!messageExists(messageObject.messageKey)){lastMessageTimestamp=messageObject.timestamp;var username=messageObject.senderOriginalUsername.toLocaleLowerCase();if(1==messageObject.type)(void 0===globalUsers[username]||void 0!==globalUsers&&void 0!==globalUsers[username]&&!globalUsers[username].isSilenced||chatUsername==username)&&ChatUIController.filterMessage(messageObject)&&(!pendingVerification||Cam4User.isBroadcaster()||Cam4User.isRoomAdmin())&&handleMessage(messageObject,roomName,"","chat");else switch(messageObject.type){case FirebaseStructure.NotificationType.ROOM_PASSWORD_CHANGED:roomIsPrivate&&(ChatUIController.showEnterPassword(""),disconnectIfNotFlash(),inPrivateRoom=!0);break;case FirebaseStructure.NotificationType.ID_APPROVED:idVerificationEnabled&&!firstLoadMessages&&Cam4User.isBroadcaster()&&pendingVerification&&(verification.update("pendingUserAction"),IdVerificationStatus&&IdVerificationStatus.clearInterface()),pendingVerification=!1;break;case FirebaseStructure.NotificationType.GO_PUBLIC:Cam4User.isBroadcaster()||$("#pendingVerification").hide();break;case FirebaseStructure.NotificationType.ID_REJECTED:pendingVerification=!0,idVerificationEnabled&&!firstLoadMessages&&(Cam4User.userName==Cam4User.performerName?"MBA"==Cam4User.broadcastSource?notifyMBA("kickPendingId",$j("#errorPending").text()):idVerificationRetry?(verification.update("takeID"),verificationUI.overlay.retry.hide(),verificationUI.overlay.submit.hide(),verificationUI.overlay.capture.show(),IdVerificationStatus=new IdVerification(JsReceiver.roomInfo,flashObj),verificationUI.overlay.container.detach().appendTo(ChatUI.element.video).show()):(verification.update("unapproved"),idVerificationRetry=!0):Cam4User.isRoomAdmin()||$("#pendingVerification").detach().appendTo(ChatUI.element.video).show());break;default:Cam4User.useVrPlayer&&streamSource.addChatObject&&streamSource.addChatObject(messageObject),ChatUIController.addNotificationMessage(messageObject,data,lightVersion)}}}function startChat(roomName,onComplete){messagesRef.limitToLast(nrOfMessagesLoadedFromHistory).once("value",function(snapshots){var index="",firstIndex="",values=snapshots.val();if(null!=values)for(var key in values)if(values.hasOwnProperty(key))try{if(ControlledFeatures.FIREBASE_LIGHT_CHAT){var msgObj=FirebaseMessageObject.fromChatMessageSnapshot(key,values[key]);addFirebaseMessages(FirebaseMessageObject.getLightChatMessageKey(msgObj.timestamp),values[key],"",!0)}else addFirebaseMessages(key,values[key],"",!0);index<key&&(index=key),(""==firstIndex||firstIndex>key)&&(firstIndex=key)}catch(err){console.error(err)}ControlledFeatures.FIREBASE_LIGHT_CHAT?baseConnectionAuth.child("c").child(roomName).on("value",function(snapshot){var msgData=snapshot.val();if(msgData)if(void 0===msgData.delete)addFirebaseMessages("",msgData,!0);else{var msgObj=FirebaseMessageObject.fromLightChatMessageSnapshot(msgData);translatorRemoveMessage(msgObj.messageKey)}}):(messagesRef.orderByKey().startAt(index+1).on("child_added",function(snapshot){addFirebaseMessages(snapshot.key(),snapshot.val())}),messagesRef.orderByKey().startAt(firstIndex).on("child_removed",function(snapshot){var data=snapshot.val(),key=snapshot.key();1==FirebaseMessageObject.fromChatMessageSnapshot(key,data).type&&translatorRemoveMessage(key)}))}),useBroadcasterFirebaseChat?(monitorBroadcasterRoomState(),monitorViewerCount(),monitorRoomNotifications(),monitorBroadcasterStream()):(monitorRoomState(roomName,onComplete),ControlledFeatures.USE_NEW_STREAMING_NODE&&monitorStream())}function handleErrors(statusMessage,extra,customActionString,title){switch(statusMessage){case"THROTTLER_TOO_MANY_MESSAGES":case"THROTTLER_MESSAGE_TWICE":case"THROTTLER_MUST_WAIT":$j(".modal-gold-overlay").is(":visible")||Registration.showGoldUpgradeOverlay("unlimited-chat");break;case"ONLY_PAYING_MEMBERS_CAN_CHAT_IN_SUPER_SHOWS":Registration.showGoldUpgradeOverlay("super-show-chat")}$j("#Cam4DialogContainer").is(":visible")||(void 0!=Cam4ChatErrors[statusMessage]?$j("#textErrorMessage").text(Cam4ChatErrors[statusMessage].replace("{0}",extra)):$j("#textErrorMessage").html(statusMessage),$j(".errorTitle").text(title||"Cam4"),$j(".customField").hide(),$j("#errorMessage").show(),$j("#confirm-button").css("display","inline-block"),customActionString&&$("#confirm-button").length>0?$("#confirm-button")[0].setAttribute("onclick","Chat.closeErrorBox(); "+customActionString):$("#confirm-button").length>0&&$("#confirm-button")[0].setAttribute("onclick","Chat.closeErrorBox(); "))}function spyStopCallback(){$j("#requestPrivateShow").removeClass("disabledLink");var errorMessageContainer=$j("#errorMessage");errorMessageContainer.find(".errorTitle").text(Cam4ChatErrors.internalErrorMessageTitle),errorMessageContainer.find("#textErrorMessage").text(Cam4ChatErrors.internalErrorMessage),errorMessageContainer.show()}function spyRequestFinished(){Chat.closeErrorBox()}function enablePSRequestButton(){$("#sendRequest").attr("disabled",!1)}function disablePSRequestButton(){$("#sendRequest").attr("disabled",!0)}function displayRequestPrivateShowBlocksOfTimeOverlay(header,message,extend){!0===extend?($("#selectBlocksOfTimeTitle").text(js_i18n.addTimeToYourPS).show(),$("#errorMessage").find(".errorTitle").text(js_i18n.extendYourPS).end().show(),$("#tryCam2Cam").hide()):($("#selectBlocksOfTimeTitle").text(js_i18n.selectBlockOfTimePS).show(),$("#errorMessage").find(".errorTitle").text(js_i18n.psRequest).end().show());var index=0;$(".time-blocks-option-container").hide(),getBlocksOfTimeParsed().forEach(function(element){element=element.split(":"),index++;var nbOfBlocks=getBlocksOfTimeParsed().length,radioButton=$("#timeBlocksOption"+index),c2cRadioButton=$("#timeBlocksCam2CamOption"+index);radioButton.on("change",function(event){for(var i=1;i<=nbOfBlocks;i++)$("#timeBlocksCam2CamOption"+i).prop("checked",!1);enablePSRequestButton()}),radioButton.prop("checked",!1),c2cRadioButton.on("change",function(event){for(var i=1;i<=nbOfBlocks;i++)$("#timeBlocksOption"+i).prop("checked",!1);enablePSRequestButton()}),c2cRadioButton.prop("checked",!1);var pricePerMin=Number.isInteger(element[1]/element[0])?element[1]/element[0]:Number.parseFloat(element[1]/element[0]).toFixed(1),c2cPricePerMin=Number.isInteger(element[3]/element[0])?element[3]/element[0]:Number.parseFloat(element[3]/element[0]).toFixed(1);"1"==allowC2C&&UserAgent.desktop&&c2cPricePerMin>0&&!extend?$("#timeBlocksCam2CamLabel"+index).show():$("#timeBlocksCam2CamLabel"+index).hide(),$("#timeBlocksMinutes"+index).text(element[0]+" "+js_i18n.minutes),extend&&NewShowState.currentCam2CamState==NewShowState.cam2cam.inCam2Cam?$("#timeBlocksTokens"+index).text(c2cPricePerMin+" "+nstiplang.tokens.toLowerCase()+"/"+js_i18n.minutes):$("#timeBlocksTokens"+index).text(pricePerMin+" "+nstiplang.tokens.toLowerCase()+"/"+js_i18n.minutes),$("#timeBlocksCam2Cam"+index).text(js_i18n.c2cExternalFee.replace("{0}",c2cPricePerMin)),element.length>2&&$("#timeBlocksRequestDescription"+index).text(element[2].replace(/`\^&/g,":").replace(/`#&/g,"|")),$("#timeBlocksOptionContainer"+index).show()}),disablePSRequestButton(),$("#blocksOfTimeContainer").show()}function handleMessage(messageObject,room,specialMessage,tab){var userType,originalUsername=messageObject.senderOriginalUsername,lowercaseUsername=originalUsername.toLowerCase();room=room.toLowerCase();var imageURL=ImageServer.GET_CHAT_AVATAR(lowercaseUsername);switch(messageObject.senderAccessLevel){case"admin":case"moderator":userType="admin",originalUsername="CAM4 Admin",imageURL=WEB_CDN+"/images/avatar_cam4admin.gif";break;case"coach":userType="coach",originalUsername="CAM4 Coach",imageURL=WEB_CDN+"/images/avatar_cam4coach.gif";break;case"performer":case"gold":case"goldFree":case"goldPromo":case"userModerator":userType="gold";break;case"verifiedRoomModerator":userType="verifiedRoomModerator";break;default:userType="basic"}if(room==lowercaseUsername&&(userType="broadcaster"),void 0!==specialMessage)switch(specialMessage){case"tippingNotification":userType="tippingNotification"}lastUserMessage[lowercaseUsername]=messageObject,Cam4User.useVrPlayer&&streamSource.addMessage&&streamSource.addMessage(messageObject,tab);var sender=globalUsers[lowercaseUsername];firebaseConnector.onMessage({message:messageObject.message,roomModerator:messageObject.senderIsRoomModerator,isFanclubSubscribed:parseInt(messageObject.isFanclubSubscribed,10),original_username:originalUsername,access_level:userType,imageCDN:imageURL,tab:tab,lowercaseUsername:lowercaseUsername,hash:messageObject.hash,messageKey:messageObject.messageKey,viewerType:messageObject.viewerType,isBroadcasting:messageObject.isBroadcasting,hasTokens:sender?sender.hasTokens:null})}function addUserToTrieAndDom(roomname,username,info,showOnline){showOnline="admin"!=info.access_level&&"moderator"!=info.access_level&&(canSeeStealth||0==info.stealth_level),roomname.toLowerCase()==username.toLowerCase()&&(showOnline=!0),(!mobilePhoneUser||void 0!==RequestParameters.broadcastSource&&"MBA"==RequestParameters.broadcastSource)&&showOnline&&(nextFoundUser=trie.addUsername(username,roomname,info.access_level,info.viewerType),ChatUIController.addUserInDOM(username,nextFoundUser.substr(1),info),Cam4User.useVrPlayer&&streamSource.addUser&&streamSource.addUser(username,info),totalUsersChatting++),Cam4User.useVrPlayer&&streamSource.updateUsersCount&&streamSource.updateUsersCount(totalUsersChatting,totalLoggedInUsers,globalTotalGuests),ChatUIController.updateChatCounter(totalUsersChatting,totalLoggedInUsers,globalTotalGuests)}function deleteUsernameFromTrieAndDOM(roomname,username,info){var exists=trie.deleteUsername(username,roomname,info.access_level,info.viewerType);return ChatUIController.deleteUserFromDOM(username),delete globalUsers[username],exists}function changeVrShowState(broadcasterState,viewerState,allowSpying){streamSource&&streamSource.changeVrShowState&&streamSource.changeVrShowState(broadcasterState,viewerState,allowSpying)}function isUserIgnored(username){return-1!=ignoreList.indexOf(username.toLowerCase())}function getUser(username){return void 0===username?username:globalUsers[username.toLowerCase()]}function getLastMessage(username){return void 0===username?"":lastUserMessage[username.toLowerCase()]}function requestBackupRtmpFail(flashId,serverType,error,params){"ORIGIN"==serverType?ConnectionLogger.logEvent("ON_ORIGIN_RTMP_ERROR","error: "+error):ConnectionLogger.logEvent("ON_EDGE_RTMP_ERROR","error: "+error),setTimeout(requestBackupRtmp,2e3,flashId,params,!0)}function requestBackupRtmpSuccess(flashId,response){if(Cam4User.isBroadcaster()&&ControlledFeatures&&ControlledFeatures.USE_JS_BROADCAST_SETTINGS&&"encoder-settings"==BroadcastSettings.getCurrentSettings().activeTab&&!BroadcastSettings.getCurrentSettings().isBroadcasting&&""!=response.videoPlayUrl){var originInfo=VideoCommunicator.getOriginInfo();response.videoPlayUrl=originInfo.originUrl+"/"+originInfo.streamUuid}flashId&&JsSender.setNewRtmp&&JsSender.setNewRtmp(flashId,response),Cam4Event.dispatch(Cam4Event.broadcastSettings.BACKUP_RTMP_URL_REQUESTED,response)}function requestBackupRtmp(flashId,params,retry){if(!backupRequested||retry){backupRequested=!0;var parameters=params;"string"==typeof params&&(parameters=JSON.parse(params)),parameters.rand=Math.round(9999999*Math.random());var requestObj={};requestObj.details=JSON.stringify(parameters);var request=$.ajax({url:"/direct",type:"GET",data:requestObj,timeout:5e3});request.done(function(response){void 0!==response.error?(backupRequested=!1,requestBackupRtmpFail(parameters.serverType,response.error,params)):(backupRequested=!1,requestBackupRtmpSuccess(flashId,response))}),request.fail(function(jqXHR,status){requestBackupRtmpFail(flashId,parameters.serverType,status+" "+jqXHR.status,params)})}}function stopShow(){VideoCommunicator.unmountClient(),location.reload()}var reconnectTimeout,reconnectTimer,baseConnection,connectedRef,myWebUsersPresenceRef,roomStateRef,usersRef,messagesRef,GSMessages,rosterLightRef,serverTimeOffsetRef,streamRef,firebaseServerOffset,baseConnectionAuth,nextFoundUser,psRequestsRef,psBillingInfoRef,bannedListRef,silenceListRef,moderatorListRef,broadcasterConnectionRef,myRoomNotificationsRef,globalUserPresence,chatlessGuestConnectionRef,chatlessRoomUserCountRefLight,privateMessages,webChatHostName,timer,pauseTimer,disconnectedTimerId,streamSource,goldShowAccess,clickHandler,isSkypeBillincConnected,roomState,startTimeGoldEnteredRoom,host="prod.vidyo.io",tokenChat="",totalUsersChatting=0,totalLoggedInUsers=0,globalTotalGuests=0,privateRoomCloseCamDelay=3e3,canPlay=!0,INITIAL_DISCONNECT_TIMER_SECONDS=100,reconnectInterval=1e3*INITIAL_DISCONNECT_TIMER_SECONDS,reconnectEnabled=!0,guestNodeName="",secondsToReconnect=INITIAL_DISCONNECT_TIMER_SECONDS,disconnectLogTime=0,idVerificationRetry=!1,pendingVerification=!1,chatAccessHash="",chatUsername="",chatRoomName="",chatHost="",isGuest=!0,isTicketHolder=!1,isGroupShowAuthenticated=!1,globalCountdown=0,allowPS=1,allowSpy=1,allowC2C=0,spyPPM="",c2cPPM="",viewerPPM="",blocksOfTime="",blocksOfTimeEnd=0,blocksOfTimeParsed=[],blocksOfTimeActive="0",showLengthFormated="",canSeeStealth=Cam4User.accessLevel>=AccessLevel.COACH||Cam4User.isBroadcastingWindow,displayTimer="",intervalTimerStep=1e3,previousState="",ticketPrice="",globalUsers={},lastUserMessage={},ignoreList=[],mobilePhoneUser=!1,roomAccepting=!0,trie=Trie,firebaseConnector=FirebaseConnector,chatReady=!1,privateMessageInitialised=!1,privateMessageEnabled=!1,previousPrivateRoom=null,firebaseOffline="",isRunningMethod=!1,privateModalOpened=!1,spyModalOpened=!1,lastNewShowState="undefined",inPrivateRoom=!1,roomIsPrivate=!1,returningFromPrivateRoom=!1,correctPassword=!1,broadcastSettings={},broadcastId="",initializeRoomRequestData={},INITIALIZE_ROOM_TIMEOUT=15e3,INITIALIZE_ROOM_MAX_RETRIES=10,initializeRoomRetries=0,roomRequestRetries=0,broadcastRoomInitialized=!1,nrOfMessagesLoadedFromHistory=3,userContextualMenu={name:"",friend:"unknown",favorite:"unknown"},streamUUID="",isFbAuth=!1,isKiiroo=!1,hlsReady=!1,lastMessageTimestamp=0,mbaVersion=-1,orientation=0,jwt=$j.Deferred(),traceId=generateTraceId(),isSkypeBillingFetched=!1,postponedGoldEnterdRoomTime=1e4;$("#silencedUsersList input").keyup(function(){var searchedUsers,value=$(this).val(),container=$("#silencedUsersList");container.find("li").slice(1).remove(),searchedUsers=Cam4User.silencedUsers.map(function(user){if(user.indexOf(value)>-1)return ChatSettings.buildUser("su_",user)}).join(""),ChatSettings.appendUsers(container,searchedUsers)}),void 0===Number.parseFloat&&(Number.parseFloat=parseFloat),Number.isInteger=Number.isInteger||function(value){return"number"==typeof value&&isFinite(value)&&Math.floor(value)===value};var backupRequested=!1;return{jwt:jwt,firebaseAuth:firebaseAuth,hideBlackFridayOverlay:function(){$(".bf_anim_wrapper").addClass("hidden"),$(".bf_close").addClass("hidden")},hideSpringPromoOverlay:function(){$(".sexy_bunny_anim_wrapper").addClass("hidden"),$(".sexy_bunny_close").addClass("hidden")},getUser:getUser,getBroadcastSettings:function(){return broadcastSettings},setBroadcastSettings:setBroadcastSettings,initializeRoomBroadcastId:initializeRoomBroadcastId,init:initRoom,showLoginAlert:function(){$j("#msgbox").val("");var winW=$j(window).width();$j("#loginAlert").css("left",winW/2-$j("#loginAlert").width()/2).show(),$j("usernameAlertBox").focus()},handleMessage:handleMessage,sendMessage:function(message,to){var url,messageContent;if(Cam4User.isLoggedInAsGuest)Registration.activateGuestRegisterModal();else if(Cam4User.isLoggedIn)if(""!=message.trim())if(void 0!==globalUsers[Cam4User.userName.toLowerCase()]&&globalUsers[Cam4User.userName.toLowerCase()].isSilenced&&"chat"==to){var username=Cam4User.userName;handleMessage({message:message,senderOriginalUsername:username,senderAccessLevel:Chat.globalUsers[username.toLowerCase()].access_level},roomName,"",to)}else{switch(to){case"chat":if(pendingVerification&&Cam4User.isViewer()&&!Cam4User.isRoomAdmin())return void handleErrors(Cam4Chat.cannotWriteMessage);url=cam4WebChatHost+"writeMessage",messageContent={username:Cam4User.userName,accessHash:chatAccessHash,roomname:chatRoomName,message:message};break;case"GSTab":case"GS":url=cam4WebChatHost+"writeGroupShowMessage",messageContent={username:Cam4User.userName,accessHash:chatAccessHash,roomname:chatRoomName,message:message};break;default:url=cam4WebChatHost+"writePrivateMessage",messageContent={username:Cam4User.userName,recipient:to,roomname:chatRoomName,message:message,accessHash:chatAccessHash}}$j.ajax({type:"POST",encoding:"UTF-8",data:messageContent,url:url,success:function(data){var statusMessage=data.status;if("success"!=statusMessage){var maxSlots=0;void 0!=data.maxSlots&&(maxSlots=data.maxSlots),handleErrors(statusMessage,maxSlots)}}})}else handleErrors("noMessage","");else Utils.decideOffer()},closeErrorBox:function(){"buy_ticket"===lastNewShowState&&NewShowReceiver.setBuyTicketButton(!0),privateModalOpened=!1,spyModalOpened=!1,$(".errorMessage, .customField").hide(),$("#yesButton, #noButton, #sendRequest").off("click").hide(),$("#spyNow, #spyCancel").hide(),$("#sendRequest").removeAttr("disabled"),$("#selectBlocksOfTimeTitle").hide(),$("#blocksOfTimeContainer").hide(),$("#textErrorMessage").empty()},toggleChatMenu:function(){$j("#usersTabs li").on("click",function(){$j("#usersTabs .active").removeClass("active"),$j(this).addClass("active");var tabID=$j(this).attr("id");if("chatFavorites"==tabID||"chatFriends"==tabID){var toggleID="chatFavorites"==tabID?"Favorites":"Friends";$j("#toggle"+toggleID+"List").is(":checked")?(ChatUIController.showUsersPanel(toggleID,"Online"),ChatFriendsFavorites.setCurrentTab(toggleID+"Online")):(ChatUIController.showUsersPanel(toggleID,""),ChatFriendsFavorites.setCurrentTab(toggleID+"")),ChatFriendsFavorites.init()}else ChatUIController.showUsersPanel("Users","")})},globalUsers:globalUsers,formatAndAddUserOn:formatAndAddUserOn,activeChatTab:"chat",chatUsername:chatUsername,closeCam:closeCam,mobilePhoneUser:mobilePhoneUser,privateMessageOn:privateMessageOn,privateMessageOff:function(){"undefined"!=typeof _messages&&_messages.model.removePrivateMessages(),privateMessageEnabled=!1},isPrivateMessageEnabled:isPrivateMessageEnabled,reauthentificateFirebaseForGS:reauthentificateFirebaseForGS,groupShowTickets:function(data,action){ajaxGroupShow("groupShowSettingsServlet",action,{description:data.showDescription,ticketGoal:data.ticketGoal,showLength:data.showLength,ticketSaleTime:data.timeLimit,ticketValue:data.costOfTicket})},startGroupShow:function(){ajaxGroupShow("groupShowAction","startGS",{})},endGroupShow:endGroupShow,newShowsConfirmation:function(header,message,type,targetUser,argument){if(console.log("newShowsConfirmation",arguments),$("#tryCam2Cam").hide(),!isRunningMethod){switch(lastNewShowState=type,Chat.closeErrorBox(),type){case"buy_ticket":var amount=ticketPrice;Cam4User.isModerator&&(amount=0),$("#confirm-button").hide(),header=header.replace("{0}",roomName),message=message.replace("{0}",amount),$("#yesButton").on("click",function(){LogicObj.groupShowSendTip(ticketPrice),Chat.closeErrorBox()}).css("display","inline-block"),$("#noButton").on("click",function(){Chat.closeErrorBox()}).css("display","inline-block");break;case"request_PS":case"extend_PS":var cam2CamInProgress=NewShowState.currentCam2CamState==NewShowState.cam2cam.inCam2Cam;if(privateModalOpened=!0,$("#confirm-button").hide(),"1"==allowC2C&&UserAgent.desktop&&!Cam4User.isInPending&&("0"!==Chat.getBlocksOfTimeActive()&&0!=c2cPPM||($("#tryCam2Cam").show(),c2cPPM>0&&$("#ppmCam2CamLabel").text(js_i18n.c2cExternalFee.replace("{0}",c2cPPM)))),header=header.replace("{0}",Cam4User.userName),message=message.replace("{0}",viewerPPM).replace("{1}",privateShow.privateShowMinimumCharge),$("#sendRequest").off("click").on("click",function(){var data={action:"request",extend:"extend_PS"===type};if("1"===Chat.getBlocksOfTimeActive())for(var blockId=1;blockId<=Chat.getBlocksOfTimeParsed().length;blockId++)($("#timeBlocksOption"+blockId).is(":checked")||$("#timeBlocksCam2CamOption"+blockId).is(":checked"))&&(data.blockOfTime=Chat.getBlocksOfTimeParsed()[blockId-1],$("#sendRequest").attr("disabled",!0)),UserAgent.desktop&&"1"==allowC2C&&($("#tryCam2CamCheckbox").is(":checked")||$("#timeBlocksCam2CamOption"+blockId).is(":checked")||cam2CamInProgress)&&(data.cam2cam=!0,data.cam2camExternal="undefined"!=typeof VidyoConnector&&VidyoConnector.isAvailable());else($("#tryCam2CamCheckbox").is(":checked")||cam2CamInProgress)&&UserAgent.desktop&&"1"==allowC2C&&(data.cam2cam=!0,data.cam2camExternal="undefined"!=typeof VidyoConnector&&VidyoConnector.isAvailable());LogicObj.callWebchat("privateShowAction",data),Chat.closeErrorBox()}).css("display","inline-block"),"1"===Chat.getBlocksOfTimeActive())return void displayRequestPrivateShowBlocksOfTimeOverlay(0,0,"extend_PS"===type);break;case"request_C2C":$("#confirm-button, #tryCam2Cam").hide(),header=header.replace("{0}",Cam4User.performerName),message=message.replace("{0}",Cam4User.performerName),$("#sendRequest").off("click").on("click",function(){var data={action:"requestCam2Cam"};data.cam2camExternal="undefined"!=typeof VidyoConnector&&VidyoConnector.isAvailable(),LogicObj.callWebchat("privateShowAction",data),Chat.closeErrorBox()}).css("display","inline-block");break;case"request_SPY":spyModalOpened=!0,$("#confirm-button").hide(),$("#spyNow, #spyCancel").css("display","inline-block"),message=Cam4User.accessLevel>=AccessLevel.MODERATOR||Cam4User.isSubscribedToFanClub()?REQ_FREE_SPY:message.replace("{0}",Cam4User.performerName).replace("{1}",spyPPM).replace("{2}",privateShow.spyShowMinimumCharge),$("#spyNow").off("click").on("click",function(){var data={action:"startSpy"};Chat.closeErrorBox(),Chat.newShowsConfirmation(js_i18n.privateShowLoading,"","request_SPY_LOADING"),LogicObj.callWebchat("privateShowAction",data,spyRequestFinished,!0,!0)}),$("#spyCancel").on("click",function(){Chat.closeErrorBox()});break;case"request_SPY_LOADING":spyModalOpened=!1,$("#confirm-button, #closeBox").hide();break;case"request_SPY_FREE":return data={action:"startSpy"},void LogicObj.callWebchat("privateShowAction",data,"");case"stopSpy":var data={action:"stopSpy"};return $j("#requestPrivateShow").addClass("disabledLink"),LogicObj.callWebchat("privateShowAction",data,spyStopCallback,!0),void(isRunningMethod=!0);case"insufficientFunds":return void TipFactory.popTokens();case"insufficientWarning":message=message.replace("{0}",argument).replace("{1}",Cam4User.performerName);case"notAllowedToSpy":case"timeoutPenalty":case"tickets_refunded":case"goal_reached":case"show_started":case"cannot_tip_in_bonus":case"gs_reload":$j("#confirm-button").css("display","inline-block"),$("#noButton, #yesButton").hide(),$("#spyNow, #spyCancel").hide();break;case"goal_not_reached":$("#noButton, #yesButton").css("display","inline-block"),$("#confirm-button, #spyNow, #spyCancel").hide(),$("#yesButton").on("click",function(){NewShowSender.startGroupShow(),$(".customField").hide(),Chat.closeErrorBox()}),$("#noButton").on("click",function(){$(".customField").hide(),Chat.closeErrorBox(),endGroupShow()});break;case"ignore_user":case"unignore_user":$("#noButton, #yesButton").css("display","inline-block"),$("#confirm-button, #spyNow, #spyCancel").hide(),$("#yesButton").on("click",function(){"ignore_user"==type?_messages.model.ignoreAndRedraw(targetUser.toLowerCase()):Chat.unignoreUser(targetUser.toLowerCase()),$(".customField").hide(),Chat.closeErrorBox()}),$("#noButton").on("click",function(){$(".customField").hide(),Chat.closeErrorBox()});break;case"endGS":$("#noButton, #yesButton").css("display","inline-block"),$j("#modifyNewShowsOverlay").hide(),$("#confirm-button").hide(),$("#yesButton").on("click",function(){NewShow.toggleShowNewShowsButton("off");var data={action:"endGS"};LogicObj.callWebchat("groupShowAction",data),Chat.closeErrorBox()}),$("#noButton").on("click",function(){$(".customField").hide(),Chat.closeErrorBox()});break;case"basicPrivateRoom":$("#noButton, #yesButton").css("display","inline-block"),$j("#modifyNewShowsOverlay").hide(),$("#confirm-button").hide(),$("#yesButton").on("click",function(){Utils.decideOffer("",{pageType:"gold",contextClass:"default"}),Chat.closeErrorBox()}),$("#noButton").on("click",function(){$(".customField").hide(),Chat.closeErrorBox()});break;case"ban":case"banFanClubMember":case"kick":case"silence":case"unsilence":case"perma_ban":case"delete_kick":case"close_room":case"feature_room":case"moderator":case"remove_moderator":$("#confirm-button").hide(),$("#noButton, #yesButton").css("display","inline-block"),$("#spyNow","#spyCancel").hide();var messageModal=$("#errorMessage");if("banFanClubMember"===type?(messageModal.addClass("banFanClubMember"),$("#yesButton").addClass("btn-orange"),$("#noButton").text(Cam4Chat.cancel).removeClass("btn-grey btn-link").addClass("btn-white")):(messageModal.removeClass("banFanClubMember"),$("#yesButton").removeClass("btn-orange"),$("#noButton").addClass("btn-grey btn-link").removeClass("btn-white")),ControlledFeatures.SILENCE_FEATURE){var userIsModerator=1==Chat.getUser(Cam4User.userName).isRoomModerator,userIsAdmin=Cam4User.accessLevel>=60,userIsNotBroadcaster=!Cam4User.isBroadcaster();"silence"==type&&(userIsModerator||!userIsNotBroadcaster||userIsAdmin||ChatUIController.addSilencedUserToList(targetUser)),"unsilence"==type&&(userIsModerator||!userIsNotBroadcaster||userIsAdmin||ChatUIController.unsilenceUserFromList(targetUser))}"perma_ban"==type&&($("#permaBanReasonContainer").show(),$("#permaBanReason").val("")),"feature_room"==type&&($("#featureRoomPosition").val(Cam4Performer.statusModel.featureIndex),$("#featureRoomContainer").show()),$("#yesButton").on("click",function(){var info={recipient:targetUser,reason:""};"perma_ban"==type&&(info.reason=$("#permaBanReason").val()),"feature_room"==type&&(info.index=$("#featureRoomPosition").val(),info.indexMinutes=$("#featureRoomTime").val()),"banFanClubMember"===type&&(type="ban"),Chat.sendRoomNotification("sendNotification",type,info,""),$(".customField").hide(),Chat.closeErrorBox()}),$("#noButton").on("click",function(){$(".customField").hide(),Chat.closeErrorBox()})}$("#textErrorMessage").text(message),$("#errorMessage").find(".errorTitle").text(header).end().show()}},sendRoomNotification:function(action,notificationType,additional,anonymous){console.log("sendRoomNotification",arguments);var data={roomname:roomName,username:Cam4User.userName,accessHash:Cam4User.kN,accessLevel:Cam4User.accessLevel,type:notificationType};switch(notificationType){case"join":data.user_type=additional;break;case"ban":case"kick":case"silence":case"unsilence":case"moderator":case"remove_moderator":data.recipient=additional.recipient;break;case"perma_ban":case"delete_kick":data.recipient=additional.recipient,data.reason=additional.reason;break;case"feature_room":data.recipient=roomName,data.index=additional.index,data.indexMinutes=additional.indexMinutes;break;case"close_room":data.recipient=roomName;break;case"joinInvite":data.recipient=additional.recipient}$.ajax({url:cam4WebChatHost+action,context:document.body,type:"POST",data:data,success:function(response){"ok"==response.status&&"feature_room"==notificationType&&(Cam4Performer.statusModel.featureIndex=additional.index)}})},getPrivateRoomAccess:function(accessType){var pass="";if("withPass"==accessType){var roomPassword=$("#passwordForPrivateRoom");if(""==roomPassword.val().trim())return;pass=roomPassword.val(),$("#authWithPass").hide(),roomPassword.val("")}initRoom(chatRoomName,chatUsername,chatAccessHash,mobilePhoneUser,pass)},setPrivateMessagesLS:function(room,user,messageKey){if("undefined"!=typeof Storage){var key=room.toLowerCase()+"&"+user.toLowerCase();localStorage.setItem(key,messageKey)}},verifyPrivateMessageLS:function(room,user,messageKey){if("undefined"!=typeof Storage){var key=room.toLowerCase()+"&"+user.toLowerCase(),status=localStorage.getItem(key);return"undefined"===status?(localStorage.removeItem(key),!0):null===status||status<messageKey}return!0},isRunning:function(){return isRunningMethod},setRunning:function(running){isRunningMethod=running},ignoreUser:function(username){username=username.toLowerCase();var aL=globalUsers[username].access_level;"admin"==aL&&"moderator"==aL||ignoreList.push(username)},unignoreUser:function(username){username=username.toLowerCase(),ignoreList.splice(ignoreList.indexOf(username.toLowerCase()),1)},getLastNewShowState:function(){return lastNewShowState},isUserIgnored:isUserIgnored,isChatReady:function(){return chatReady},handleErrors:handleErrors,handleBroadcastStreamError:function(){$j("#textErrorMessage").html(Cam4ChatErrors.broadcastStreamErrorMessage),$j(".errorTitle").text("Cam4"),$j(".customField").hide(),$j("#errorMessage").show(),$j("#confirm-button").css("display","inline-block"),$("#confirm-button")[0].setAttribute("onclick","Chat.closeErrorBox(); ")},isCorrectPassword:function(){return correctPassword},isFriendsFavoritesVisible:function(){return $j(".chatFriendsFavorites").is(":visible")},updatePrivateOverlay:function(){$j("#allowPrivate").attr("checked",1==allowPS),$j("#allowSpy").attr("checked",1==allowSpy),ControlledFeatures.USE_NEW_CAM2CAM&&1==allowC2C&&("undefined"==typeof VidyoConnector||!VidyoConnector.isAvailable()||VidyoConnector.isEdgeBrowser()||VidyoConnector.isSafariBrowser())?$j("#allowCam2Cam").attr("checked",!1):$j("#allowCam2Cam").attr("checked",1==allowC2C),NewShowReceiver.onPrivateShowPrice(viewerPPM,spyPPM,c2cPPM,Chat.getBlocksOfTimeActive(),blocksOfTime)},sellingTicketsTimer:function(seconds){NewShowReceiver.initCountDown(seconds,"sellingTickets")},setFbStatus:function(status){isFbAuth=status},getFbStatus:function(){return isFbAuth},setGoldShowAccess:setGoldShowAccess,getStreamName:function(){return streamUUID},setContextualUser:function(user,friend,favorite){userContextualMenu.name=user,""!=friend&&(userContextualMenu.friend=friend),""!=favorite&&(userContextualMenu.favorite=favorite)},getContextualUser:function(){return userContextualMenu},userIsBroadcasting:function(username){if(username==Cam4User.performerName.toLowerCase())return!1;var user=getUser(username);return void 0!==user&&("d"==user.isBroadcasting||"m"==user.isBroadcasting)},userIsBroadcastingNew:function(username){if(username==Cam4User.performerName.toLowerCase())return!1;var lastMessage=getLastMessage(username);return void 0!==lastMessage&&""!==lastMessage&&lastMessage.isBroadcasting},sendBroadcastResolutionToGA:function(resolutionLabel){"desktop"==broadcastSettings.streamSource&&dataLayer.push({event:"BroadcastCurrentResolution",eventCategory:"Broadcast Settings",eventAction:"Set Broadcast Current Resolution",eventLabel:resolutionLabel})},getKiiroo:getKiiroo,getTraceId:getTraceId,generateTraceId:generateTraceId,generateSpanId:generateSpanId,getBlocksOfTime:function(){return blocksOfTime},setBlocksOfTime:function(blocks){blocksOfTime=blocks,setBlocksOfTimeParsed(blocks)},getBlocksOfTimeParsed:getBlocksOfTimeParsed,getBlocksOfTimeActive:function(){return blocksOfTimeActive},setBlocksOfTimeActive:function(blocksActive){blocksOfTimeActive=blocksActive},getMbaVersion:function(){return mbaVersion},getOrientation:function(){return orientation},getLastMessageTimestamp:function(){return lastMessageTimestamp},setLastMessageTimestamp:function(timestamp){lastMessageTimestamp=timestamp},addFirebaseMessages:addFirebaseMessages,requestBackupRtmp:requestBackupRtmp,updateBroadcastSettings:function(auto,width,height){if(BroadcastSettings.getCurrentSettings().isBroadcasting){broadcastSettings.autoResolution=auto,auto?(broadcastSettings.autoWidth=width,broadcastSettings.autoHeight=height):(broadcastSettings.width=width,broadcastSettings.height=height),Cam4User.streamingData.broadcastSettings=broadcastSettings;var requestObj;requestObj=ControlledFeatures.BROADCAST_SETTINGS_V2?{auto:auto,width:width,height:height,sourceType:broadcastSettings.streamSource,userName:Cam4User.userName,accessHash:Cam4User.accessHash}:{broadcastSettings:JSON.stringify(broadcastSettings),userName:Cam4User.userName,accessHash:Cam4User.accessHash},$.ajax({url:"/updateBroadcastSettings",type:"POST",data:requestObj})}},setIdVerificationRetry:function(value){idVerificationRetry=value},getStreamSource:function(){return streamSource},viewerAllowedInPrivateStream:!1,stopShow:stopShow,pauseShow:function(pause){var action="PAUSE";pause||(action="RESUME");var pauseData={accessHash:Cam4User.kN,username:Cam4User.userName,action:action,duration:0};$.ajax({url:cam4WebChatHost+"/pauseBroadcast",type:"POST",data:pauseData,timeout:INITIALIZE_ROOM_TIMEOUT})},vidyoConnected:vidyoConnected,fetchSkypeBillingStatus:function(callback){if(isSkypeBillingFetched)callback(isSkypeBillincConnected);else{var url="/rest/v1.0/invisibill/user/"+Cam4User.userName+"?login_user_name="+Cam4User.userName+"&accessHash="+Cam4User.kN,request=$.ajax({url:url,type:"GET",processData:!1,contentType:"application/json",mimeType:"application/json"});request.done(function(response){var connected=response.user.active;isSkypeBillingFetched=!0,isSkypeBillincConnected=connected,connected&&callback(isSkypeBillincConnected)}),request.fail(function(jqXHR,textStatus,errorThrown){isSkypeBillingFetched=!0,callback(isSkypeBillincConnected=!1),console.error("The following error occurred: "+textStatus,errorThrown)})}},getRoomState:function(){return roomState}}}();
var PollingChat=function(){function pollChat(){if(pollingChatEnabled){var url=cam4WebChatHost+"chat/"+roomName+"?username="+Cam4User.userName+"&startTimestamp="+Chat.getLastMessageTimestamp()+"&accessHash="+Cam4User.kN,request=$.ajax({url:url,type:"GET",dataType:"text"});request.done(function(response){if(pollingChatEnabled){$j("#chatConnectionStatus").removeClass().addClass("chatPolling");var info=JSON.parse(response);for(key in info)Chat.addFirebaseMessages(key,info[key],!1),Chat.setLastMessageTimestamp(info[key][FirebaseStructure.ChatMessageLabels.TIMESTAMP]);pollingChatTimer=setTimeout(pollChat,pollingChatInterval)}}),request.fail(function(jqXHR,status){pollingChatEnabled&&($j("#chatConnectionStatus").removeClass().addClass("chatNotConnected"),pollingChatTimer=setTimeout(pollChat,pollingChatInterval))})}}var pollingChatTimer=0,pollingChatEnabled=!1,pollingChatInterval=1e3;return{startPollingChat:function(){pollingChatEnabled=!0,pollChat()},stopPollingChat:function(){pollingChatEnabled=!1,clearTimeout(pollingChatTimer)}}}();
var EmoticonTabs=[{emoticons:{":DEF1:":"chatSprite-01_EmoticonsHDcom",":DEF2:":"chatSprite-02_EmoticonsHDcom",":DEF3:":"chatSprite-03_EmoticonsHDcom",":DEF4:":"chatSprite-04_EmoticonsHDcom",":DEF5:":"chatSprite-05_EmoticonsHDcom",":DEF6:":"chatSprite-06_EmoticonsHDcom",":DEF7:":"chatSprite-07_EmoticonsHDcom",":DEF8:":"chatSprite-08_EmoticonsHDcom",":DEF9:":"chatSprite-09_EmoticonsHDcom",":DEF10:":"chatSprite-10_EmoticonsHDcom",":DEF11:":"chatSprite-11_EmoticonsHDcom",":DEF12:":"chatSprite-12_EmoticonsHDcom",":DEF13:":"chatSprite-13_EmoticonsHDcom",":DEF14:":"chatSprite-14_EmoticonsHDcom",":DEF15:":"chatSprite-15_EmoticonsHDcom",":DEF16:":"chatSprite-16_EmoticonsHDcom",":DEF17:":"chatSprite-17_EmoticonsHDcom",":DEF18:":"chatSprite-18_EmoticonsHDcom",":DEF19:":"chatSprite-19_EmoticonsHDcom",":DEF20:":"chatSprite-20_EmoticonsHDcom",":DEF21:":"chatSprite-21_EmoticonsHDcom",":DEF22:":"chatSprite-22_EmoticonsHDcom",":DEF23:":"chatSprite-23_EmoticonsHDcom",":DEF24:":"chatSprite-24_EmoticonsHDcom",":DEF25:":"chatSprite-25_EmoticonsHDcom",":DEF26:":"chatSprite-26_EmoticonsHDcom",":DEF27:":"chatSprite-27_EmoticonsHDcom",":DEF28:":"chatSprite-28_EmoticonsHDcom",":DEF29:":"chatSprite-29_EmoticonsHDcom",":DEF30:":"chatSprite-30_EmoticonsHDcom",":DEF31:":"chatSprite-31_EmoticonsHDcom",":DEF32:":"chatSprite-32_EmoticonsHDcom",":DEF33:":"chatSprite-33_EmoticonsHDcom",":DEF34:":"chatSprite-34_EmoticonsHDcom",":DEF35:":"chatSprite-35_EmoticonsHDcom",":DEF36:":"chatSprite-36_EmoticonsHDcom",":DEF37:":"chatSprite-37_EmoticonsHDcom",":DEF38:":"chatSprite-38_EmoticonsHDcom",":DEF39:":"chatSprite-39_EmoticonsHDcom",":DEF40:":"chatSprite-40_EmoticonsHDcom",":DEF41:":"chatSprite-41_EmoticonsHDcom",":DEF42:":"chatSprite-42_EmoticonsHDcom",":DEF43:":"chatSprite-43_EmoticonsHDcom",":DEF44:":"chatSprite-44_EmoticonsHDcom",":DEF45:":"chatSprite-45_EmoticonsHDcom",":DEF46:":"chatSprite-46_EmoticonsHDcom",":DEF47:":"chatSprite-47_EmoticonsHDcom",":DEF48:":"chatSprite-48_EmoticonsHDcom",":DEF49:":"chatSprite-49_EmoticonsHDcom",":DEF50:":"chatSprite-50_EmoticonsHDcom",":DEF51:":"chatSprite-51_EmoticonsHDcom",":DEF52:":"chatSprite-52_EmoticonsHDcom",":DEF53:":"chatSprite-53_EmoticonsHDcom",":DEF54:":"chatSprite-54_EmoticonsHDcom",":DEF55:":"chatSprite-55_EmoticonsHDcom",":DEF56:":"chatSprite-56_EmoticonsHDcom",":DEF57:":"chatSprite-57_EmoticonsHDcom",":DEF58:":"chatSprite-58_EmoticonsHDcom",":DEF59:":"chatSprite-59_EmoticonsHDcom",":DEF60:":"chatSprite-60_EmoticonsHDcom",":DEF61:":"chatSprite-61_EmoticonsHDcom",":DEF62:":"chatSprite-62_EmoticonsHDcom",":DEF63:":"chatSprite-63_EmoticonsHDcom",":DEF64:":"chatSprite-64_EmoticonsHDcom",":DEF65:":"chatSprite-65_EmoticonsHDcom",":DEF66:":"chatSprite-66_EmoticonsHDcom",":DEF67:":"chatSprite-67_EmoticonsHDcom",":DEF68:":"chatSprite-68_EmoticonsHDcom",":DEF69:":"chatSprite-69_EmoticonsHDcom",":DEF70:":"chatSprite-70_EmoticonsHDcom",":DEF71:":"chatSprite-71_EmoticonsHDcom",":DEF72:":"chatSprite-72_EmoticonsHDcom",":DEF73:":"chatSprite-73_EmoticonsHDcom",":DEF74:":"chatSprite-74_EmoticonsHDcom",":DEF75:":"chatSprite-75_EmoticonsHDcom",":DEF76:":"chatSprite-76_EmoticonsHDcom",":DEF77:":"chatSprite-77_EmoticonsHDcom",":DEF78:":"chatSprite-78_EmoticonsHDcom",":DEF79:":"chatSprite-79_EmoticonsHDcom",":DEF80:":"chatSprite-80_EmoticonsHDcom"},tabImage:"chatSprite-01_EmoticonsHDcom",spriteSource:"sprites/yellow_default.png",activationRule:function(){return!0}},{emoticons:{":L01VE:":"chatSpritePink-01_EmoticonsHDcom",":L2VE:":"chatSpritePink-02_EmoticonsHDcom",":L3VE:":"chatSpritePink-03_EmoticonsHDcom",":L4VE:":"chatSpritePink-04_EmoticonsHDcom",":L5VE:":"chatSpritePink-05_EmoticonsHDcom",":L6VE:":"chatSpritePink-06_EmoticonsHDcom",":L7VE:":"chatSpritePink-07_EmoticonsHDcom",":L8VE:":"chatSpritePink-08_EmoticonsHDcom",":L9VE:":"chatSpritePink-09_EmoticonsHDcom",":L10VE:":"chatSpritePink-10_EmoticonsHDcom",":L11VE:":"chatSpritePink-11_EmoticonsHDcom",":L12VE:":"chatSpritePink-12_EmoticonsHDcom",":L13VE:":"chatSpritePink-13_EmoticonsHDcom",":L14VE:":"chatSpritePink-14_EmoticonsHDcom",":L15VE:":"chatSpritePink-15_EmoticonsHDcom",":L16VE:":"chatSpritePink-16_EmoticonsHDcom",":L17VE:":"chatSpritePink-17_EmoticonsHDcom",":L18VE:":"chatSpritePink-18_EmoticonsHDcom",":L19VE:":"chatSpritePink-19_EmoticonsHDcom",":L20VE:":"chatSpritePink-20_EmoticonsHDcom",":L21VE:":"chatSpritePink-21_EmoticonsHDcom",":L22VE:":"chatSpritePink-22_EmoticonsHDcom",":L23VE:":"chatSpritePink-23_EmoticonsHDcom",":L24VE:":"chatSpritePink-24_EmoticonsHDcom",":L25VE:":"chatSpritePink-25_EmoticonsHDcom",":L26VE:":"chatSpritePink-26_EmoticonsHDcom",":L27VE:":"chatSpritePink-27_EmoticonsHDcom",":L28VE:":"chatSpritePink-28_EmoticonsHDcom",":L29VE:":"chatSpritePink-29_EmoticonsHDcom",":L30VE:":"chatSpritePink-30_EmoticonsHDcom",":L31VE:":"chatSpritePink-31_EmoticonsHDcom",":L32VE:":"chatSpritePink-32_EmoticonsHDcom",":L33VE:":"chatSpritePink-33_EmoticonsHDcom",":L34VE:":"chatSpritePink-34_EmoticonsHDcom",":L35VE:":"chatSpritePink-35_EmoticonsHDcom",":L36VE:":"chatSpritePink-36_EmoticonsHDcom",":L37VE:":"chatSpritePink-37_EmoticonsHDcom",":L38VE:":"chatSpritePink-38_EmoticonsHDcom",":L39VE:":"chatSpritePink-39_EmoticonsHDcom",":L40VE:":"chatSpritePink-40_EmoticonsHDcom",":L41VE:":"chatSpritePink-41_EmoticonsHDcom",":L42VE:":"chatSpritePink-42_EmoticonsHDcom",":L43VE:":"chatSpritePink-43_EmoticonsHDcom",":L44VE:":"chatSpritePink-44_EmoticonsHDcom",":L45VE:":"chatSpritePink-45_EmoticonsHDcom",":L46VE:":"chatSpritePink-46_EmoticonsHDcom",":L47VE:":"chatSpritePink-47_EmoticonsHDcom",":L48VE:":"chatSpritePink-48_EmoticonsHDcom",":L49VE:":"chatSpritePink-49_EmoticonsHDcom",":L50VE:":"chatSpritePink-50_EmoticonsHDcom",":L51VE:":"chatSpritePink-51_EmoticonsHDcom",":L52VE:":"chatSpritePink-52_EmoticonsHDcom",":L53VE:":"chatSpritePink-53_EmoticonsHDcom",":L54VE:":"chatSpritePink-54_EmoticonsHDcom",":L55VE:":"chatSpritePink-55_EmoticonsHDcom",":L56VE:":"chatSpritePink-56_EmoticonsHDcom",":L57VE:":"chatSpritePink-57_EmoticonsHDcom",":L58VE:":"chatSpritePink-58_EmoticonsHDcom",":L59VE:":"chatSpritePink-59_EmoticonsHDcom",":L60VE:":"chatSpritePink-60_EmoticonsHDcom",":L61VE:":"chatSpritePink-61_EmoticonsHDcom",":L62VE:":"chatSpritePink-62_EmoticonsHDcom",":L63VE:":"chatSpritePink-63_EmoticonsHDcom",":L64VE:":"chatSpritePink-64_EmoticonsHDcom",":L65VE:":"chatSpritePink-65_EmoticonsHDcom",":L66VE:":"chatSpritePink-66_EmoticonsHDcom",":L67VE:":"chatSpritePink-67_EmoticonsHDcom",":L68VE:":"chatSpritePink-68_EmoticonsHDcom",":L69VE:":"chatSpritePink-69_EmoticonsHDcom",":L70VE:":"chatSpritePink-70_EmoticonsHDcom",":L71VE:":"chatSpritePink-71_EmoticonsHDcom",":L72VE:":"chatSpritePink-72_EmoticonsHDcom",":L73VE:":"chatSpritePink-73_EmoticonsHDcom",":L74VE:":"chatSpritePink-74_EmoticonsHDcom",":L75VE:":"chatSpritePink-75_EmoticonsHDcom",":L76VE:":"chatSpritePink-76_EmoticonsHDcom",":L77VE:":"chatSpritePink-77_EmoticonsHDcom",":L78VE:":"chatSpritePink-78_EmoticonsHDcom",":L79VE:":"chatSpritePink-79_EmoticonsHDcom",":L80VE:":"chatSpritePink-80_EmoticonsHDcom"},tabImage:"chatSpritePink-01_EmoticonsHDcom",spriteSource:"sprites/pink_default.png",activationRule:function(){var now=new Date;return 1===now.getMonth()&&14==now.getDate()}},{emoticons:{":)":"default/smile.gif",":p":"default/silly.gif",";)":"default/wink.gif",":?":"default/ponder.gif",":(":"default/depressed.gif","8)":"default/cool.gif",":x":"default/heart.gif",":D":"default/smiley.gif",":w":"default/confused.gif",":l":"default/smoker.gif",":a":"default/ogre.gif",":g":"default/grin.gif",":e":"default/evil.gif",":r":"default/surprised.gif",":YES:":"default/approve_16.jpg",":TNG:":"default/tongue_16.jpg",":DRL:":"default/drool_16.jpg",":GRR:":"default/angry_16.jpg",":LVL:":"default/inlove_16.jpg",":LV2:":"default/love_16.jpg",":KUL:":"default/cool_16.jpg",":LOL:":"default/lol_16.jpg",":AHH:":"default/shock_16.jpg",":HUH:":"default/confused_16.jpg",":NO:":"default/reject_16.jpg",":KSS:":"default/kiss_16.jpg",":NRD:":"default/geek_16.jpg",":UP:":"default/thumbup_16.jpg",":SNAKE:":"default/cobra.gif",":COCKTAIL:":"default/cocktail.gif",":DRAGON:":"default/dragon.gif",":DRINK:":"default/drink.gif",":GLASS:":"default/glasses.gif",":TEACH:":"default/graduate.gif",":HAMMER:":"default/hammer.gif",":mushroom:":"default/mushroom.gif",":music:":"default/music.gif",":pill:":"default/pill.png",":rambo:":"default/rambo.gif",":tv:":"default/tv.gif"},tabImage:"default/smile.gif",activationRule:function(){return!0}}],Emoticons=function(){function getCdnChatImage(imageName){return WEB_CDN&&""!=WEB_CDN||(WEB_CDN=location.protocol+"//"+document.domain),WEB_CDN+"/images/chat/emoticons/"+imageName}function createImage(imageName,code){var text='<img alt="'+Cam4Chat.emoticonsImgAlt+'" src="'+getCdnChatImage(imageName)+'"';return code&&(text+=" onclick=\"Emoticons.insertEmoticon('"+code+"')\""),text+="/>"}function createDivElement(divName,code){var text='<div class="'+divName.split("-")[0]+" "+divName+'"';return code&&(text+="onclick=\"Emoticons.insertEmoticon('"+code+"')\""),text+="></div>"}function createElement(elementName,code){return 0===elementName.indexOf("chatSprite")?createDivElement(elementName,code):createImage(elementName,code)}function styleTab(tabDomElement,name){0!==name.indexOf("chatSprite")?$j(tabDomElement).css("background","url("+getCdnChatImage(name)+") no-repeat 5px 5px"):$j(tabDomElement).append(createDivElement(name,!1))}function clearTabs(){$j(".emoticonList").hide(),$j(".emoticonTab").removeClass("active")}function toggleEmoticons(toggle){var msgboxObj=$j("#msgbox"),emoticonsObj=$j("#emoticons");"show"==toggle&&emoticonsObj.show(),"hide"==toggle&&(emoticonsObj.hide(),"MBA"===Cam4User.broadcastSource||UserAgent.tablet||msgboxObj.focus()),"toggle"==toggle&&(emoticonsObj.toggle(),"none"==emoticonsObj.css("display")?"MBA"!==Cam4User.broadcastSource&&msgboxObj.focus():msgboxObj.blur())}function getMap(){for(var answer=[],i=0;i<EmoticonTabs.length;i++){var currentTab=EmoticonTabs[i];for(var j in currentTab.emoticons)if(currentTab.activationRule()){var imageSource,type="image",coordinates=[];if(0===currentTab.emoticons[j].indexOf("chatSprite")){type="sprite";try{if(!initialised){var item=document.createElement("div");item.setAttribute("class",currentTab.emoticons[j].split("-")[0]+" "+currentTab.emoticons[j]),document.body.appendChild(item),item.style.display="none"}imageSource=$j("."+currentTab.emoticons[j]).css("background-image").split('"')[1],coordinates=$j("."+currentTab.emoticons[j]).css("background-position").split(" "),imageSource||(imageSource=getCdnChatImage(currentTab.spriteSource))}catch(ex){console.log(ex,"for ",currentTab.emoticons[j])}}else imageSource=getCdnChatImage(currentTab.emoticons[j]);answer.push({key:j,name:currentTab.emoticons[j],type:type,imageSource:imageSource,coordinates:coordinates})}}return answer}for(var emoticons={},initialised=!1,i=0;i<EmoticonTabs.length;i++)for(var j in EmoticonTabs[i].emoticons)emoticons[j]=EmoticonTabs[i].emoticons[j];return{toggleEmoticons:toggleEmoticons,toggleEmoticonTab:function(value){clearTabs(),$j("#emoticonList"+value).show(),$j("#emoticonTab"+value).addClass("active")},insertEmoticon:function(emoticonCode){toggleEmoticons("hide"),Cam4User.isPayingMember()||!Cam4User.isViewer()?$j("#msgbox").val($j("#msgbox").val()+emoticonCode+" "):Registration.showGoldUpgradeOverlay("enhanced-chat")},processEmoticons:function(msg){msg=msg.concat(" ");for(var emoticon in emoticons)if(emoticons.hasOwnProperty(emoticon)){var re=new RegExp(emoticon.escapeRegEx()+"(?=[: ;])","ig"),htmltxt=createElement(emoticons[emoticon],!1);msg=msg.replace(re,htmltxt)}return msg},getMap:getMap,getMapToJson:function(){return JSON.stringify(getMap())},init:function(){if(!initialised){for(var tabIndex=0,createdTabs=[],i=0;i<EmoticonTabs.length;i++){var currentTab=EmoticonTabs[i];if(currentTab.activationRule()){tabIndex++;var listDiv=document.createElement("div");listDiv.id="emoticonList"+tabIndex,listDiv.setAttribute("class","emoticonList"),$j("#emoticons").append(listDiv);var tabDiv=document.createElement("div");tabDiv.id="emoticonTab"+tabIndex;var className="emoticonTab";for(var j in currentTab.emoticons)$j(listDiv).append(createElement(currentTab.emoticons[j],j)),emoticons[j]=currentTab.emoticons[j];createdTabs.push(tabDiv),$j("#emoticonTabsContainer").append(tabDiv),1==tabIndex&&(className+=" active first",$j(listDiv).css("display","block")),tabDiv.setAttribute("class",className),styleTab(tabDiv,currentTab.tabImage),tabDiv.setAttribute("onclick","Emoticons.toggleEmoticonTab("+tabIndex+")")}}$j(createdTabs[createdTabs.length-1]).addClass("last"),$j("#emoticonPicker").on("click",function(event){event.stopPropagation(),toggleEmoticons("toggle")}),initialised=!0}}}}();
var ChatUIController=function(){function sanitizeMessage(msg){return msg.replace(/</g,"&lt;").replace(/>/g,"&gt;")}function tabClick(elem){Emoticons.toggleEmoticons("hide"),$j(".tabChat").removeClass("active"),$j(elem).addClass("active");var t=$j(elem).attr("id");"usersTab"==t?($j(".fakechatbutton").hide(),$j("#tab1C").hide(),$j("#tab2C").show()):"GamesTab"==t?($j(".chatPanel").hide(),$j("#GamesTabPanel").show(),$j("#tab1C").show(),$j("#tab2C").hide(),$j(".fakechatbutton").show().find("input, button").attr("disabled","disabled"),scrollToBottom(t+"Panel")):($j(".chatPanel").hide(),$j("#tab1C").show(),$j(".fakechatbutton").show().find("input, button").removeAttr("disabled"),$j("#"+t+"Panel").show(),scrollToBottom(t+"Panel"),$j("#tab2C").hide(),UserAgent.phone&&$j("#dropdownMenu1 div").text($j("#"+t).data("username")),$("#msgbox").focus()),Chat.activeChatTab=t.substring(0,t.lastIndexOf("Tab")),stopBlinkMessageTab(Chat.activeChatTab),0===$j("#tab1C").height()&&$j("#tab1C").height($("#videoContainer").height()-$("#chat_main").find(".containerHeader").height()-$j("#tabsBar").height())}function scrollToBottom(id){var scroll=document.getElementById(id);void 0!==scroll&&null!==scroll&&(scroll.scrollTop=scroll.scrollHeight)}function countVisibleElements(selector){var visibleElements=0;return $j(selector).each(function(){"none"!=$(this).css("display")&&visibleElements++}),visibleElements}function closeTab(id){$j("#"+id).hide(),$j("#chatTab").click(),Chat.activeChatTab="chat",UserAgent.phone?countVisibleElements("#dropDownPrivateMessage ul li")<2?$j("#dropDownPrivateMessage").hide().removeClass("visible"):$j("#dropDownPrivateMessage").show().addClass("visible"):checkScrollTabs()}function showTab(id){$j("#"+id+"Tab").css("background","").show(),UserAgent.phone&&(countVisibleElements("#dropDownPrivateMessage ul li")<2?$j("#dropDownPrivateMessage").hide().removeClass("visible"):$j("#dropDownPrivateMessage").show().addClass("visible"))}function checkScrollTabs(){for(var offset=document.getElementById("chatTab").offsetWidth+document.getElementById("usersTab").offsetWidth+document.getElementById("usersTab").offsetWidth+document.getElementById("GamesTab").offsetWidth+20,total=0,c=document.getElementById("privateMessageUserList").childNodes,i=0;i<c.length;i++)void 0!==c[i].offsetWidth&&"tabChat"==c[i].className&&(total+=c[i].offsetWidth);$j("#tabs").width()-offset<total?$j("#scrollRight, #scrollLeft").show():$j("#scrollRight, #scrollLeft").hide()}function addMessageTab(username,imageURL,tab,visible,extra){var chatWrapper;if(null===document.getElementById(tab+"Tab")){if(UserAgent.phone){var mobilePrivateTab='<li data-username="'+username+'" id="'+tab+'Tab" role="presentation">'+username;"GS"!==tab&&(mobilePrivateTab+='<a class="closeMobilePM nopop">X</a></li>'),mobilePrivateTab+="</li>",$j("#dropDownPrivateMessage ul").append(mobilePrivateTab);var mobilePM=$j("#"+tab+"Tab");return mobilePM.on("click",function(){tabClick($j("#"+tab+"Tab"))}),mobilePM.find(".closeMobilePM").on("click",function(event){var parentId=this.parentNode.id;event.stopPropagation(),closeTab(parentId)}),$j("#tab1C").append('<div id="'+tab+'TabPanel" class="chatPanel" style="display:none"></div>'),"undefined"!=typeof useFirebaseTranslator&&useFirebaseTranslator&&(chatWrapper=document.getElementById(tab+"TabPanel"),m.mount(chatWrapper,m.component(_messages,{tab:tab,wrapper:chatWrapper}))),void(visible&&showTab(username))}var privateMessageTab=$j("#userConversationTabTemplate").clone();privateMessageTab.attr("id",tab+"Tab"),"admin"==extra.access_level||"moderator"==extra.access_level?(privateMessageTab.find(".usernameTab").text("Cam4 Admin"),extra.imageCDN=imageURL):"coach"==extra.access_level?privateMessageTab.find(".usernameTab").text("Cam4 Coach"):privateMessageTab.find(".usernameTab").text(tab),privateMessageTab.find("#imgTabUser").attr("src",extra.imageCDN),privateMessageTab.on("click",function(){tabClick(this)}),privateMessageTab.find(".closePrivateUserChat").on("click",function(event){var parentId=this.parentNode.id;event.stopPropagation();var messageKey=$j("#"+tab+"TabPanel .chat").filter(":last").data("messagekey");Chat.setPrivateMessagesLS(roomName,tab,messageKey),stopBlinkMessageTab(tab),closeTab(parentId)}),visible||privateMessageTab.hide(),privateMessageTab.prependTo("#privateMessageUserList"),$j("#tab1C").append('<div id="'+tab+'TabPanel" class="chatPanel" style="display:none"></div>'),"undefined"!=typeof useFirebaseTranslator&&useFirebaseTranslator&&(chatWrapper=document.getElementById(tab+"TabPanel"),m.mount(chatWrapper,m.component(_messages,{tab:tab,wrapper:chatWrapper})))}else visible&&($("#"+tab+"Tab").prependTo("#privateMessageUserList"),showTab(tab));UserAgent.phone||checkScrollTabs()}function getLiveTouchLevel(amount,user,anonymous){var message=[{translation:nstiplang.userTippedTokensLiveTouchPoked,lower:1,upper:4},{translation:nstiplang.userTippedTokensLiveTouchTouched,lower:5,upper:49},{translation:nstiplang.userTippedTokensLiveTouchFelt,lower:50,upper:249},{translation:nstiplang.userTippedTokensLiveTouchFucked,lower:250,upper:9999999}].filter(function(level){return level.lower<=amount&&level.upper>=amount}).shift(),usernameReplacement=1==anonymous?nstiplang.anonymous:user;return message.translation.replace("%1",usernameReplacement).replace("%2",Cam4User.performerName)+" "}function getTippingMessage(amount,user,anonymous){return"true"===Chat.getKiiroo()?getLiveTouchLevel(amount,user,anonymous):1==anonymous?$.trim(nstiplang.anonymousUserTipped.substr(0,nstiplang.anonymousUserTipped.lastIndexOf("%1")))+"! ":nstiplang.userTippedTokens.substr(0,nstiplang.userTippedTokens.lastIndexOf("%2")-1).replace("%1",user)+"! "}function handleSpecialTipMessage(amount,user,isGoalReached,tipType){var tokensDisplay=1==amount?"token":"tokens",message="";switch(tipType){case"ttg":message=nstiplang.userCompletedGoal;break;case"ctl":message=nstiplang.userCrushedTheLeader;break;case"btl":message=nstiplang.userBeatTheLeader}var html='<span class="glyphicon tipLeaderIconMessage"></span>'+(message=message.replace("{1}",user))+'<span class="tokensAmount"> ('+amount+" "+tokensDisplay+")</span>";try{Cam4Event.dispatch(ChatEvent.ROOM_TIP_NOTIFICATION_ADDED),isGoalReached&&Cam4Event.dispatch(TipEvent.PERFORMER_GOAL_REACHED)}catch(ex){console.error(ex)}return html}function handleTipMessage(amount,user,anonymous,isGoalReached,isInsideGroupShowTipping){var tokensDisplay=1==amount?"token":"tokens";isInsideGroupShowTipping&&(tokensDisplay+=" "+js_i18n.duringGroupShow);var html='<span class="glyphicon glyphicon-usd tipIcon"></span>'+getTippingMessage(amount,user,anonymous)+'<span class="tokensAmount">('+amount+" "+tokensDisplay+")</span>";try{Cam4Event.dispatch(ChatEvent.ROOM_TIP_NOTIFICATION_ADDED),isGoalReached&&Cam4Event.dispatch(TipEvent.PERFORMER_GOAL_REACHED)}catch(ex){console.error(ex)}return html}function handleStickyNotificationForTippingBar(gameData){var stickyMessage;switch(gameData.status){case"t":case"ttg":case"ctl":case"btl":stickyMessage=1==gameData.anonymous?nstiplang.anonymousUserTipped.replace("%1",gameData.response.a):(stickyMessage=nstiplang.userTippedTokens.replace("%1",gameData.username)).replace("%2",gameData.response.a)}void 0!==stickyMessage&&"undefined"!=typeof ncTip&&ncTip.displayMessage(stickyMessage)}function blinkMessageTab(tab,visible){Chat.activeChatTab===tab||!visible||void 0!==PM_BlinkingList[tab]&&PM_BlinkingList[tab].blinking||($j("#"+tab+"Tab").addClass("blinkTabCSS3"),PM_BlinkingList[tab]=!0)}function stopBlinkMessageTab(tab){$j("#"+tab+"Tab").removeClass("blinkTabCSS3"),PM_BlinkingList[tab]=!1}function isFriendsOnlineTabVisible(){return $j("#chatFriendsOnlineList").is(":visible")}function processRelationshipStatus(obj){var actionFriend,actionFavorite,friendStatus=obj.response.friend_status,favoriteStatus=obj.response.favorite_status,menuFriend=$j("#contextualAddFriend"),menuFavorite=$j("#contextualAddFavorite");switch(friendStatus){case"friend":case"friend_request_sent":menuFriend.text("Remove Friend"),actionFriend="cancel";break;case"none":menuFriend.text("Add Friend"),actionFriend="accept";break;case"friend_request_received":menuFriend.text("Accept Friend"),actionFriend="accept"}"favorite"==favoriteStatus?(menuFavorite.text("Remove Favorite"),actionFavorite="deleteFavoritesUsername"):(menuFavorite.text("Add Favorite"),actionFavorite="addFavorite");var user=Chat.getContextualUser();Chat.setContextualUser(user.name,actionFriend,actionFavorite),menuFriend.show(),menuFavorite.show()}function getRelationshipStatus(username){$j("#contextualAddFriend, #contextualAddFavorite").hide(),$j.ajax({url:"/relationshipStatus?partner="+username,type:"GET",dataType:"json",beforeSend:function(){$j(".contextualLoading").show()},success:function(response){$j(".contextualLoading").hide(),processRelationshipStatus(response)},error:function(){$j(".contextualLoading").hide()}})}function updateFriendsOrFavoritesDOM(container,userinfo){var userNameTmp="",username=userinfo.username,lowercaseUsername=username.toLowerCase(),accessLevelClass="general";if(userinfo.access_level!=accessLevelClass&&(accessLevelClass="gold"),userinfo.isBroadcasting=void 0!==userinfo.isBroadcasting&&userinfo.isBroadcasting,userinfo.imageCDN=ImageServer.GET_CHAT_AVATAR(lowercaseUsername),userNameTmp+='<div  data-username="'+username+'" class="divUsername '+accessLevelClass+'" id="'+username+container+'" >',userNameTmp+='<img src="'+userinfo.imageCDN+'" width="30" height="25"/>',userNameTmp+='<a href="/'+lowercaseUsername+'" target="_blank" class="name">'+username+"</a>",userNameTmp+='<div class="userOptions contextualMenu" data-user="'+username+'"><span class="glyphicon glyphicon-option-vertical"></span></div>',UserAgent.phone||(userNameTmp+='<div class="userOptions disabled peek" id="previewbtn-'+container+username+'" value="'+Cam4Chat.preview+'"><span class="glyphicon glyphicon-facetime-video"></span></div>'),ControlledFeatures&&ControlledFeatures.USER_NOTES){var notecolor=checkUserNotes(username);""!=notecolor&&(userNameTmp+='<div class="userOptions editNote" data-user="'+username+'" id="notesbtn-'+username+'"><span class="hidden glyphicon '+notecolor+' glyphicon-duplicate"></span></div>')}userNameTmp+="</div>",$j("#chat"+container+"Users").append(userNameTmp),ChatPreview.togglePreviewInUserList(username,!!userinfo.isBroadcasting&&"d",container)}function roomAdmin(targetIsBroadcaster){var targetUser,action,adminUI={permanentBan:$("#adminPerma_Ban"),deleteAndKick:$("#adminDelete_Kick"),closeRoom:$("#adminClose_Room"),featureRoom:$("#adminFeature_Room")},actions=["perma_ban","delete_kick","close_room","feature_room"],adminOptions=$(".contextualNotBroadcaster, .contextualBroadcaster");adminOptions.show(),targetIsBroadcaster||(adminUI.closeRoom.hide(),adminUI.featureRoom.hide());var checkAction=function(action){if(-1!=actions.lastIndexOf(action)){var message=Cam4Chat[action].replace("{0}",targetUser)+" ?";Chat.newShowsConfirmation(Cam4Chat.domain,message,action,targetUser)}};adminOptions.off().on("click",function(){targetUser=Chat.getContextualUser().name,action=this.id.replace("admin","").toLowerCase(),checkAction(action)})}function roomModerator(){if(!isRoomModerator)return isRoomModerator;var action,moderatorUI={silence:$("#moderatorSilence"),unsilence:$("#moderatorUnsilence"),kick:$("#moderatorKick"),ban:$("#moderatorBan"),assignMod:$("#moderatorModerator"),unAssignMod:$("#moderatorRemove_Moderator")},actions=["silence","kick","ban","unsilence","moderator","remove_moderator"],moderatorOptions=$(".contextualModerator"),targetUser=Chat.getContextualUser().name,targetUserInfo=Chat.getUser(targetUser);Cam4Chat.moderatorSilence=Cam4Chat.moderatorSilence.replace("{0}"," "),Cam4Chat.moderatorUnsilence=Cam4Chat.moderatorUnsilence.replace("{0}"," "),Cam4Chat.moderatorKick=Cam4Chat.moderatorKick.replace("{0}"," "),Cam4Chat.moderatorBan=Cam4Chat.moderatorBan.replace("{0}"," ");var checkAction=function(action,userIsFanClubMember){if(-1!=actions.lastIndexOf(action))if(userIsFanClubMember&&"ban"===action){var header=Cam4Chat.areYouSure,message=Cam4Chat.banFanClubMember.replace("{0}",targetUser).replace("{1}",targetUser);Chat.newShowsConfirmation(header,message,"banFanClubMember",targetUser)}else{message=Cam4Chat[action].replace("{0}",targetUser)+" ?";Chat.newShowsConfirmation(Cam4Chat.domain,message,action,targetUser)}};moderatorOptions.off().on("click",function(){targetUser=Chat.getContextualUser().name.toLowerCase();var userIsFanClubMember=$("#"+targetUser).attr("data-fan");action=this.id.replace("moderator","").toLowerCase(),checkAction(action,userIsFanClubMember)}),void 0!==targetUserInfo&&0==targetUserInfo.isSilenced?(moderatorUI.silence.text(Cam4Chat.moderatorSilence).show(),moderatorUI.unsilence.hide()):(moderatorUI.unsilence.text(Cam4Chat.moderatorUnsilence).show(),moderatorUI.silence.hide()),Cam4User.isBroadcastingWindow&&(void 0!==targetUserInfo?0==targetUserInfo.isRoomModerator?(moderatorUI.assignMod.text(Cam4Chat.assignModerator).show(),moderatorUI.unAssignMod.hide()):(moderatorUI.assignMod.hide(),moderatorUI.unAssignMod.text(Cam4Chat.unAssignModerator).show()):(moderatorUI.assignMod.hide(),moderatorUI.unAssignMod.hide())),moderatorUI.kick.text(Cam4Chat.moderatorKick),moderatorUI.ban.text(Cam4Chat.moderatorBan),void 0===targetUserInfo?($("#moderatorUnsilence").hide(),moderatorUI.silence.hide(),moderatorUI.kick.hide()):moderatorUI.kick.show(),moderatorUI.ban.show()}function addSilencedUserToList(targetUser){Cam4User.silencedUsers.push(targetUser)}function checkIfUserIsSilenced(user){return-1!==jQuery.inArray(user,Cam4User.silencedUsers)}function renderSilencedUserThumb(username,imgSource,onlineStatus){return"<div data-user='"+username+"' class=\"ff_thumb\"><div class=\"user_wrap\"><div class=\"ff_img\"><a href='#'><img width='60' height='60' src="+imgSource+" alt=''></a></div><div class=\"ff_name\">"+username+"<div class="+(onlineStatus?"online":"offline")+"><span>"+(onlineStatus?"online":"offline")+"</span></div></div></div><a href='/"+username+'\' class="view-profile">\n<span class="glyphicon glyphicon-user"></span>\n<span class="hidden-xs"></span>\n</a></div>'}function getSilencedUsersOnPage(){var html;$j.ajax({url:"/rest/v1.0/profile/"+Cam4User.userName+"/silence",type:"GET",success:function(response){var silencedUsers=response.usersList.map(function(user){return user.username});html=0==silencedUsers.length?"<div>Your silence list is currently empty.</div>":response.usersList.map(function(user){return renderSilencedUserThumb(user.username,user.profileThumbnailUrl,user.online)}).join(""),$("#silencedUsersContainer").html(html),$(".ff_thumb").on("click",function(){$(this).toggleClass("selected")}),Cam4User.silencedUsers=silencedUsers}})}function unsilenceUserFromList(targetUser){var silencedUsers=jQuery.grep(Cam4User.silencedUsers,function(user){if(user!==targetUser)return user});Cam4User.silencedUsers=silencedUsers}function unsilenceAllUsersFromList(){Cam4User.silencedUsers=[]}function silenceRequest(username,targetUser,action,isProfilePage){var requestAction,url;"silence_user"===action&&(requestAction="POST",url="/rest/v1.0/profile/"+username+"/silence/"+targetUser),"unsilence_user"===action&&(requestAction="DELETE",url="/rest/v1.0/profile/"+username+"/silence/"+targetUser),"unsilence_all"===action&&(requestAction="DELETE",url="/rest/v1.0/profile/"+username+"/silence"),$j.ajax({url:url,type:requestAction,success:function(response){if(isProfilePage&&($(".successMessage").removeClass("hidden"),$(".errorMessage").addClass("hidden"),$("#addUserToSilenceListInput").val("")),"silence_user"===action){if(isProfilePage)return void getSilencedUsersOnPage();addSilencedUserToList(targetUser)}if("unsilence_user"===action){if(isProfilePage)return void getSilencedUsersOnPage();unsilenceUserFromList(targetUser)}if("unsilence_all"===action){if(isProfilePage)return void getSilencedUsersOnPage();unsilenceAllUsersFromList()}},error:function(request){isProfilePage&&(400==request.status&&($(".successMessage").addClass("hidden"),$(".errorMessage").removeClass("hidden").text(js_i18n.silenceErrors.invalidUser)),404==request.status&&($(".successMessage").addClass("hidden"),$(".errorMessage").removeClass("hidden").text(js_i18n.silenceErrors.invalidUser)),500==request.status&&($(".successMessage").addClass("hidden"),$(".errorMessage").removeClass("hidden").text(js_i18n.silenceErrors.invalidUser)))}})}function changeBroadcastResolution(){var resolutionList=$("#broadcastResolutionList");resolutionList.find("li").on("click",function(){var label=$(this).data("label");if(resolutionList.find("span").removeClass("bull").html(""),$(this).find("span").addClass("bull").html("&bull;"),ControlledFeatures&&(ControlledFeatures.USE_JS_BROADCAST_SETTINGS||VideoCommunicator.isWebrtcSupported())){var resolutionSelected=BroadcastSettings.getResolutionByObjectKey($(this).data("resolution"));Cam4Event.dispatch(Cam4Event.broadcastSettings.SET_BROADCAST_RESOLUTION,resolutionSelected)}else JsSender.setBroadcastResolution($(this).data("resolution"));$(".broadcast-tool-resolution .currentRes").html(label)})}function updateResolutionMenu(jsonData,selectedResolution){resolutionObj=jsonData,$("#resolutionList").show();var list="<ul>";$.each(resolutionObj,function(key,data){var bulletResolution=selectedResolution==key?'<div class="bull">&bull;</div>':"";list+="<li onclick=\"ChatUIController.changeResolution(event,'"+key+"')\">"+data.label+bulletResolution+"</li>"}),list+="</ul>",$("#resolutionListMenu").html(list)}function activateResolutionMenu(){$("#resolutionList").off().on("click",function(){$("#resolutionListMenu").toggle()}),$("#selectedResolution").addClass("activate")}function deactivateResolutionMenu(){$("#resolutionList").off(),$("#selectedResolution").removeClass("activate")}function streamIsPlaying(isPlaying){isPlaying?activateResolutionMenu():deactivateResolutionMenu()}function hideContextualMenu(){contextualMenuVisible&&(contextualMenuVisible=!1,$("#userContextualMenu, #moderatorOptions, #adminOptions").hide(),$(".contextualMenu").removeClass("active"))}function showContextualNotes(username,note,color){Utils.closeModalPops(),$j("#contextualNotesValue").val(note),$j("#contextualNotesUser").text(username),$j("#contextualNotesForm").modal("show"),$j("#"+color+"-option").click()}function getAjaxNotes(username){Chat.setContextualUser(username,"",""),$j.ajax({url:"/userNotes",type:"GET",data:{peer:username},success:function(response){showContextualNotes(username,response.note,response.color)}})}function checkUserNotes(username){var lowercaseUsername=username.toLowerCase();return void 0!==userNotesColors[lowercaseUsername]?userNotesColors[lowercaseUsername]:""}function updateNotes(username,notecolor){var lowercaseUsername=username.toLowerCase();userNotesColors[lowercaseUsername]=notecolor,$j("#"+lowercaseUsername+" #notesbtn-"+lowercaseUsername).remove();var noteHtml='<div class="userOptions editNote" data-user="'+username+'" id="notesbtn-'+username.toLowerCase()+'"><span class="hidden glyphicon '+notecolor+' glyphicon-duplicate"></span></div>';$j("#"+lowercaseUsername).append(noteHtml),m.redraw()}function onSkypeBillingNotificationClick(){var link;link=Cam4User.isBroadcaster()?"/"+Cam4User.userName+"/performerhub/skype-billing":"/"+Cam4User.userName+"/edit/payment";var eventAction=Cam4User.isBroadcaster()?"Click Skype Chat Message Performer":"Click Skype Chat Message Viewer";dataLayer.push({event:"SkypeBilling",eventCategory:"Skype",eventAction:eventAction}),$(this).attr("href",link)}function attachEventOnSkypeBillingAction(){$(document).on("click",".skypeBillingNotification__action",onSkypeBillingNotificationClick)}var chatConnector=FirebaseConnector,resolutionObj={},buttonTimerId=!1,isRoomModerator=Cam4User.accessLevel>=46||Cam4User.userName==Cam4User.performerName,isRoomAdmin=Cam4User.accessLevel>=50,PM_BlinkingList={chat:{blinking:!1,timerHandler:""}},contextualMenuVisible=!1,isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobi/i.test(navigator.userAgent),CustomNotification={SKYPE_BILLING:"SKYPE_BILLING"},attachedSkypeNotificationEvent=!1;Cam4User.isBroadcaster()&&!Cam4Event.hasEventListener(TipEvent.DICE_GAME_ENDED,"stopGamesTabBlinking")&&Cam4Event.addEventListener(TipEvent.DICE_GAME_ENDED,function(){stopBlinkMessageTab("Games"),$j("#GamesTab").hide()},"stopGamesTabBlinking"),chatConnector.onMessage=function(data){if(!ControlledFeatures.SILENCE_FEATURE||!checkIfUserIsSilenced(data.original_username)){if((ControlledFeatures.SKYPE_BILLING_NOTIFICATION_PERFORMER||ControlledFeatures.SKYPE_BILLING_NOTIFICATION_VIEWER)&&window.Chat&&Chat.hasOwnProperty("getRoomState")&&function(message){return!!/skype|skp/.test(message.toLowerCase())}(data.message)){var checkBillingKeywordCount=localStorage.getItem("skypeBillingKeywordCount"),parsedKey=JSON.parse(checkBillingKeywordCount);Chat.fetchSkypeBillingStatus(function(connected){var messageObject=Object.assign(data,{type:CustomNotification.SKYPE_BILLING,messageKey:""});if("INSIDE_PS"!==Chat.getRoomState().newShowsState&&"INSIDE_GS"!==Chat.getRoomState().newShowsState&&!connected&&(attachedSkypeNotificationEvent||(attachedSkypeNotificationEvent=!0,attachEventOnSkypeBillingAction()),parsedKey%5==0)){ChatUIController.addNotificationMessage(messageObject,{},{},messageObject.tab);var eventAction=Cam4User.isBroadcaster()?"View Skype Chat Message Performer":"View Skype Chat Message Viewer";dataLayer.push({event:"SkypeBilling",eventCategory:"Skype",eventAction:eventAction})}}),localStorage.setItem("skypeBillingKeywordCount",JSON.stringify(parsedKey+1))}ChatUIController.addMessage(data)}};var tabIndex=0;return $("#removeSelectedSilencedUsers").on("click",function(){var selectedusers=$(".ff_thumb.selected").toArray(),allThumbs=$(".ff_thumb").toArray();if(0==selectedusers.length)return $(".successMessage").addClass("hidden"),void $(".errorMessage").removeClass("hidden").text(js_i18n.silenceErrors.invalidUser);selectedusers.length==allThumbs.length?silenceRequest(Cam4User.userName,void 0,"unsilence_all",!0):selectedusers.forEach(function(item){silenceRequest(Cam4User.userName,item.dataset.user,"unsilence_user",!0)})}),$("#selectAllUsersFromSilenceList").on("click",function(){$(".ff_thumb").addClass("selected")}),$("#clearAllUsersFromSilenceList").on("click",function(){$(".ff_thumb.selected").removeClass("selected")}),$("#addUserToSilenceList").on("click",function(){var inputValue=$("#addUserToSilenceListInput").val().trim();$(".successMessage").addClass("hidden"),$(".errorMessage").addClass("hidden"),0!=inputValue.length?silenceRequest(Cam4User.userName,inputValue,"silence_user",!0):$(".errorMessage").removeClass("hidden").text("User is not selected.")}),{addSkypeBillingNotification:function(){return"<div class='skypeBillingNotification'><div class='skypeBillingNotification__bck'></div><div class='skypeBillingNotification__logo'></div><div class='skypeBillingNotification__content'><h5 class='skypeBillingNotification__title'>"+js_i18n.skypeBilling.title+"</h5><p class='skypeBillingNotification__text'>"+js_i18n.skypeBilling.notificationDesc+"</p><a target='_blank' class='skypeBillingNotification__action'>"+js_i18n.skypeBilling.notificationAction+"</a></div><div>"},scrollToBottom:scrollToBottom,addUserInDOM:function(username,beforeUsername,info){var userNameTmp="",fanClubMember=info.isFanclubSubscribed>0?' data-fan="true" ':"";if(userNameTmp+='<div data-username="'+info.displayUsername+'" class="divUsername" id="'+username+'"'+fanClubMember+">",userNameTmp+="MBA"==Cam4User.broadcastSource?"<a>":'<a href="/'+username+'" target="_blank">',userNameTmp+='<img class="imgAvatar userListAvatar" data-src="'+info.imageCDN+'" src="/images/loader1.gif" />',userNameTmp+="MBA"==Cam4User.broadcastSource?'</a><a class="name">':'</a><a href="/'+username+'" target="_blank" class="name">',userNameTmp+=info.displayUsername,Cam4User.isAnyTypeOfGold(info.access_level)&&(userNameTmp+='<span class="goldBadge"></span>'),!Cam4User.isBroadcaster()||!info.hasTokens||"general"!=info.access_level||1*info.isFanclubSubscribed||(userNameTmp+='<span class="chat-msg-has-tokens"></span>'),userNameTmp+='<span class="br-message" id="br-'+username+'"></span>',userNameTmp+="</a>",info.viewerType==FirebaseStructure.ViewerType.VR&&(userNameTmp+='<img src="'+WEB_CDN+'/images/chat/vr-icon.png" class="vrIcon">'),"MBA"!=Cam4User.broadcastSource&&username!=Cam4User.userName.toLowerCase()&&(userNameTmp+='<div class="userOptions contextualMenu" data-user="'+info.displayUsername+'"><span class="glyphicon glyphicon-option-vertical"></span></div>'),UserAgent.phone||"MBA"===Cam4User.broadcastSource||username==Cam4User.performerName.toLowerCase()||username==Cam4User.userName.toLowerCase()||(userNameTmp+='<div class="peek userOptions disabled" id="previewbtn-'+username+'" value="'+Cam4Chat.preview+'"><span class="glyphicon glyphicon-facetime-video"></span></div>'),ControlledFeatures&&ControlledFeatures.USER_NOTES){var notecolor=checkUserNotes(username);""!=notecolor&&(userNameTmp+='<div class="userOptions editNote" data-user="'+info.displayUsername+'" id="notesbtn-'+username+'"><span class="hidden glyphicon '+notecolor+' glyphicon-duplicate"></span></div>')}userNameTmp+="</div>",$j(userNameTmp).insertBefore("#"+beforeUsername),"MBA"!==Cam4User.broadcastSource&&username!=Cam4User.performerName.toLowerCase()&&(ChatPreview.togglePreviewInUserList(username,info.isBroadcasting,""),ChatUIController.toggleModeratorInUserList(username,info.isRoomModerator)),ChatUIController.renderVisibleAvatars("#"+username+" .imgAvatar")},deleteUserFromDOM:function(userID){$j("#"+userID).remove()},updateChatCounter:function(totalUsersChatting,loggedInUsers,guestUsers){$j("#totalChatting").text(totalUsersChatting);var displayNumber=loggedInUsers+guestUsers;Cam4User.accessLevel>=AccessLevel.MODERATOR?$j("#totalUsers").text(displayNumber+" -> l:"+loggedInUsers+" g:"+guestUsers):$j("#totalUsers").text(displayNumber)},showContextualMenu:function(thisObj){var user=String(thisObj.attr("data-user")),fakeChatDiv=$("#fakechatDiv").offset(),contextualMenuWidth=$("#userContextualMenu").width(),targetIsBroadcaster=user.toLowerCase()==Cam4User.performerName.toLowerCase(),userOnline=!0,userInfo=Chat.getUser(user),targetIsModerator=void 0!==userInfo&&"1"==userInfo.isRoomModerator;hideContextualMenu(),contextualMenuVisible=!0,thisObj.addClass("active"),Chat.setContextualUser(user,"unknown","unknown"),getRelationshipStatus(user);var contextualUsernameLink=$j("#contextualUsernameLink");contextualUsernameLink.attr("href","/"+user.toLowerCase()),contextualUsernameLink.text(user),UserAgent.desktop&&Chat.userIsBroadcasting(user)?$j("#peekContextual").show():$j("#peekContextual").hide(),ControlledFeatures.SILENCE_FEATURE?(Cam4User.accessLevel>=60&&$("#moderatorSilence").show(),checkIfUserIsSilenced(user)?($("#silenceUser").hide(),$("#unsilenceUser").show()):($("#silenceUser").show(),$("#unsilenceUser").hide()),Cam4User.isBroadcaster()&&($("#silenceUser").hide(),$("#unsilenceUser").hide())):($("#silenceUser").hide(),$("#unsilenceUser").hide()),targetIsBroadcaster&&"mobile"==Cam4Performer.statusModel.source&&Chat.getMbaVersion()<100?$j("#sendMessageTo").hide():$j("#sendMessageTo").show(),void 0===userInfo&&(userOnline=!1),targetIsBroadcaster?($("#ignoreUser, #unignoreUser").hide(),$("#complaintsAboutUser").show()):userOnline?Chat.isUserIgnored(user)?($("#unignoreUser").show(),$("#ignoreUser").hide()):($("#ignoreUser").show(),$("#unignoreUser").hide()):$("#ignoreUser, #unignoreUser, #complaintsAboutUser").hide(),isRoomModerator?(targetIsBroadcaster||targetIsModerator&&!isRoomAdmin)&&!Cam4User.isBroadcastingWindow?($(".contextualModerator").hide(),ControlledFeatures.SILENCE_FEATURE&&($("#silenceUser").hide(),$("#unsilenceUser").hide())):(roomModerator(),ControlledFeatures.SILENCE_FEATURE&&($("#silenceUser").hide(),$("#unsilenceUser").hide())):$(".contextualModerator").hide(),isRoomAdmin&&roomAdmin(targetIsBroadcaster),void 0===Chat.getUser(user)&&Cam4User.isBroadcastingWindow&&isFriendsOnlineTabVisible()?$("#inviteJoinMyRoom").show():$("#inviteJoinMyRoom").hide();var x=thisObj.offset().left-fakeChatDiv.left-contextualMenuWidth,y=thisObj.offset().top-fakeChatDiv.top;$("#userContextualMenu").css({left:x,top:y}).show()},populateFriendsAndFavoritesList:function(container,dataUsers,loadMore){$j("#chat"+container+"Users").text(""),$j(".prevFFPage").toggle(loadMore.prevPage),$j(".nextFFPage").toggle(loadMore.nextPage);for(var i=0;i<dataUsers.length;i++)updateFriendsOrFavoritesDOM(container,dataUsers[i]);if(contextualMenuVisible){var user=Chat.getContextualUser();$j("#"+user.name.toLowerCase()+container+" .contextualMenu").addClass("active")}},addMessage:function(data){var badgeUrl="",messageKey=void 0!==data.messageKey?data.messageKey:"",visible=!0;data.message=sanitizeMessage(data.message),"chat"!=data.tab&&(visible=Chat.verifyPrivateMessageLS(roomName,data.tab,messageKey),addMessageTab(data.original_username,data.imageCDN,data.tab,visible,data),"admin"!=data.access_level&&"moderator"!=data.access_level||$j("#"+data.tab+"Tab").click()),badgeUrl="",1==data.isFanclubSubscribed&&void 0!==Cam4Performer.fanclubBadgeUrl&&""!==Cam4Performer.fanclubBadgeUrl&&(badgeUrl=Cam4Performer.fanclubBadgeUrl);var cFrame=data.tab+"TabPanel";blinkMessageTab(data.tab,visible),"undefined"!=typeof useFirebaseTranslator&&translatorAddMessage({messageKey:messageKey,msg:data.message,user:data.original_username,userType:data.access_level,roomModerator:data.roomModerator,isFanclubSubscribed:data.isFanclubSubscribed,imageURL:data.imageCDN,tab:data.tab,lower_username:data.lowercaseUsername,hash:data.hash||"",badgeUrl:badgeUrl,viewerType:data.viewerType||0,isBroadcasting:data.isBroadcasting||!1,hasTokens:data.hasTokens}),scrollToBottom(cFrame)},sendMessage:function(message){Cam4User.isLoggedInAsGuest?Registration.activateGuestRegisterModal():(message||(message=$j("#msgbox").val()),chatConnector.send(message,Chat.activeChatTab),$j("#msgbox").val(""))},showTab:showTab,hideTabMenu:function(){$j("#tabs").hide()},showTabMenu:function(){$j("#tabs").show()},connector:chatConnector,tabClick:tabClick,addMessageTab:addMessageTab,closeGSTab:function(){closeTab("GSTab"),$j("#GSTabPanel").empty()},showUsersPanel:function(container,status){$j(".infoUsersBar").hide(),$j("#chat"+container+status+"List").show()},addNotificationMessage:function(messageObject,gameDataObject,isRealTimeMessage,tab){function getGameDisplayUsername(username,anonymous){return Cam4User.isBroadcaster()?username+(1==anonymous?"("+nstiplang.anonymous+")":""):1==anonymous?nstiplang.anonymous:username}var message,html="",classes="",user=messageObject.senderOriginalUsername,accessLevel=messageObject.senderAccessLevel,type=messageObject.type,extra=messageObject.notificationExtra,anonymous=messageObject.anonymous,messageKey=messageObject.messageKey,isGoalReached=messageObject.isGoalReached;switch(messageKey=void 0!==messageKey?messageKey:"",type){case CustomNotification.SKYPE_BILLING:html=ChatUIController.addSkypeBillingNotification();break;case FirebaseStructure.NotificationType.FAN_ENTERED_ROOM:if(1==extra){var defaulFanBadge=WEB_CDN+"/images/fanclub/badges/icon_fanclub_default.png",badgeUrl=ControlledFeatures&&ControlledFeatures.FAN_CLUB_IN_PERFORMER_DASHBOARD?defaulFanBadge:Cam4Performer.fanclubBadgeUrl;(Cam4User.isAnyTypeOfGold(accessLevel)||void 0===accessLevel||"unknown"==accessLevel)&&(classes+="fanclub"),html='<span class="'+classes+'"><img class="badge" src = '+badgeUrl+' alt="badge"/>'+(message=Cam4Chat.fanclubMember+" "+user+" "+Cam4Chat.hasEnteredChat)+"</span>"}break;case FirebaseStructure.NotificationType.SEND_TIP:html=handleTipMessage(extra,user,anonymous,isGoalReached,messageObject.isInsideGrupShowTipping);break;case FirebaseStructure.NotificationType.GIFT:if(0===messageObject.giftValue&&-1!=messageObject.giftImage.indexOf("gold-star")){var goldStarMsg=Cam4Chat.choseGoldFavorite.replace("{0}",user).replace("{1}",Cam4User.performerName).replace("{2}",'<span class="gold-msg">').replace("{3}","</span>");html+='<img class="giftImage" src="'+messageObject.giftImage+'"/><span>'+goldStarMsg+"</span>"}else html+='<img class="giftImage" src="'+messageObject.giftImage+'"/><span> '+user+" "+Cam4Chat.sentAGift+'! </span><span class="tokensAmount">('+messageObject.giftValue+" tokens)</span>";break;case FirebaseStructure.NotificationType.GOLD_ENTERED_ROOM:html='<span class="'+(classes+="fanclub")+'">'+(message=user+" "+Cam4Chat.hasEnteredChat)+"</span>";break;case FirebaseStructure.NotificationType.JOIN_FANCLUB:html='<span class="'+(classes+="fanclub")+'">'+(message=Cam4User.isBroadcastingWindow?Cam4Chat.broadcasterJoinedFanclub.replace("{0}",user):Cam4Chat.viewerJoinedFanclub.replace("{0}",user).replace("{1}",Cam4User.performerName))+"</span>";break;case"INTERVAL_GAME_NOTIFICATION":html=GameCenter.intervalGameNotificationTemplate(messageObject.activeGame);break;case FirebaseStructure.NotificationType.GAME:if(isMobile)return;if(ControlledFeatures.USE_GAME_CENTER){var ctaBtn,parsedExtra=jQuery.parseJSON(extra),gameData={status:gameDataObject.go,response:jQuery.parseJSON(gameDataObject.gr),activeGame:gameDataObject.gt,username:gameDataObject.ou,anonymous:anonymous},isBroadCaster=Cam4User.isBroadcaster();if(isRealTimeMessage&&void 0!==gameData.response.refApps&&void 0!==gameData.response.refApps.TippingBar&&(Cam4User.isBroadcaster()?ServiceTipPerformer.getTippingBar():(ServiceTipViewer.getTippingBar(),Cam4User.userName.toLowerCase()===gameData.username.toLowerCase()&&TipBalance.getBalance())),"TippingBar"===gameData.activeGame)switch(isRealTimeMessage&&(Cam4User.isBroadcaster()?ServiceTipPerformer.tippingBarUpdate(gameData.response,gameData.status):ServiceTipViewer.tippingBarUpdate(gameData.response,gameData.status),handleStickyNotificationForTippingBar(gameData)),gameData.status){case"t":html=handleTipMessage(gameData.response.a,user,anonymous,isGoalReached,messageObject.isInsideGrupShowTipping);break;case"ttg":case"ctl":case"btl":html=handleSpecialTipMessage(gameData.response.a,user,isGoalReached,gameData.status);break;case"u":default:return}if("TippingBar"!==gameData.activeGame&&isRealTimeMessage&&GameCenter.updateGameCenterState(gameData,parsedExtra),"TippingBar"!==gameData.activeGame&&isRealTimeMessage&&"e"!==gameData.status&&($(".game-center-button .status").addClass("is-active"),$("#openGameDock").removeClass("hidden").addClass("btn btn-openGameDock").attr("data-game",gameData.activeGame),$(".btn-openGameDock__text").text(js_i18n.tippingGames.viewerPlayButton+" '"+GameCenter.getGameText(gameData.activeGame)+"'")),"ChatPolls"===gameData.activeGame)switch(gameData.status){case"s":isRealTimeMessage&&(GameCenter.setGameStartedData(gameData.response),SoundPlayer.playTippingSound(0,"tipping_game_start"),SoundPlayer.playTippingSound(0,"clock_ticking"),gameData.response.eg&&(buttonTimerId&&clearInterval(buttonTimerId),buttonTimerId=GameCenter.addTimerToButton(gameData))),message=GameCenter.getStartGameMessage(gameData),html+=GameCenter.getHtmlForMessage(message,gameData.activeGame);break;case"e":buttonTimerId&&clearInterval(buttonTimerId);var removeChatPollsDock,chatPollsResult=gameData.response.o;clearTimeout(removeChatPollsDock),isRealTimeMessage&&($("#back-gamelist").show(),chatPollsResult.sort(function(a,b){return b.v-a.v}),$(".game-center-button").removeClass("hidden"),$(".game-center-button .status").removeClass("is-active"),$("#openGameDock").addClass("hidden"),$("#game-center-button-text").text(js_i18n.tippingGames.gameCenterText),removeChatPollsDock=setTimeout(function(){GameCenter.removeFromTheDom(),GameCenter.closeViewerDock()},5e3),GameCenter.updateViewer({s:"END",w:chatPollsResult}),$("#broadcasterGameWiningOverlay").html('<span class="blink">'+function(result){return result[0].v>0?js_i18n.tippingGames.chatPolls.winningActionIs+': <p class="blink">'+_.escape(result[0].o)+"</p>":js_i18n.tippingGames.chatPolls.noWinningAction}(chatPollsResult)+"</span>").fadeIn(250).delay(4500).fadeOut(250),SoundPlayer.playTippingSound(0,"chat_polls_win")),html+='<div class="gameNotificationIcon gameNotificationIcon--ChatPolls"></div><div class="gameGradientBck"></div><div class="chatPollsResults"><span class="game-result-msg game-result-msg-ended">'+(message=GameCenter.getStopGameMessage(gameData.activeGame))+'</span><div class="chatPollsResults__container">',html+='<ul><li class="chatPollsQuestionMain">Q: '+_.escape(gameData.response.q)+"</li>";var totalVotes=0;chatPollsResult.forEach(function(option){totalVotes+=parseInt(option.v)});for(var i=0;i<chatPollsResult.length;i++){var chatPollOption=chatPollsResult[i],percentage=0===totalVotes?0:parseInt(100*parseInt(chatPollOption.v)/totalVotes),progressBarColor=0==i?"#a2e229":"#9d9d9d";html+='<li class="clearfix"><span class="chat-poll-mini"></span><span class="chatPollsQuestion">'+_.escape(chatPollOption.o)+'</span><span class="chatPollsPercentage">'+percentage+'% </span><div class="chatPollProgressBar"><div class="chatPollProgressBarInner" style="width:'+percentage+"%;background-color:"+progressBarColor+';"></div></div></li>'}html+="</ul></div></div>";break;case"v":if(isRealTimeMessage){GameCenter.updateViewer(gameData.response);var chatPollsVoteDetails=GameCenter.getGameDetails(gameData.activeGame);Cam4User.isBroadcaster()||gameData.username!==Cam4User.profileName||GameCenter.pushDataLayer("chatPolls","vote_poll",chatPollsVoteDetails.o[gameData.response.i].o,chatPollsVoteDetails.p),SoundPlayer.playTippingSound(0,"chat_polls_vote")}message=js_i18n.tippingGames.chatPolls.userVoted.replace("{0}",getGameDisplayUsername(gameData.username,anonymous)),html+=GameCenter.getHtmlForMessage(message,gameData.activeGame)}if("SpinTheWheel"===gameData.activeGame)switch(gameData.status){case"s":isRealTimeMessage&&(GameCenter.setGameStartedData(gameData.response),$("#game-center-button-text").text(GameCenter.getGameText(gameData.activeGame)),SoundPlayer.playTippingSound(0,"tipping_game_start")),message=GameCenter.getStartGameMessage(gameData),ctaBtn=isBroadCaster?'<button class="hidden">'+js_i18n.tippingGames.spinTheWheel.ctaBtn+"</button>":'<button class="cta-btn-openGameDock">'+js_i18n.tippingGames.spinTheWheel.ctaBtn+"</button>",ControlledFeatures.TIPPING_GAME_NOTIFICATIONS?html+='<div class="gameRollTheDiceStarted"><div class="gameIntroWrapper"><div class="gameIntro spinTheWheel"><p>'+message+"</p>"+ctaBtn+'</div></div><div class="gameRollTheDiceStarted__container">':html+='<div class="gameNotificationIcon gameNotificationIcon--SpinTheWheel"></div><div class="gameGradientBck"></div><div class="gameRollTheDiceStarted"><span class="game-result-msg game-result-msg-ended">'+message+'</span><div class="gameRollTheDiceStarted__container">';var spinTheWheelOptions=gameData.response.o,toArrayWheelOptions=Object.keys(spinTheWheelOptions).map(function(key){return spinTheWheelOptions[key]}),sum=toArrayWheelOptions.length,leftSideLength=Math.ceil(sum/2),rightSideLength=sum-leftSideLength;html+='<ul class="left">'+toArrayWheelOptions.filter(function(item,index){if(rightSideLength==leftSideLength){if(index<=leftSideLength-1)return item}else if(index<leftSideLength)return item}).map(function(item){return'<li class="clearfix"><span class="spin-the-wheel-mini"></span>'+_.escape(item.o)+"</li>"}).join("")+'</ul><ul class="right">'+toArrayWheelOptions.filter(function(item,index){if(rightSideLength==leftSideLength){if(index>=rightSideLength)return item}else if(index>rightSideLength)return item}).map(function(it){return'<li class="clearfix"><span class="spin-the-wheel-mini"></span>'+_.escape(it.o)+"</li>"}).join("")+"</ul>";break;case"e":GameCenter.setGameEnd(isRealTimeMessage),message=GameCenter.getStopGameMessage(gameData.activeGame),html+=GameCenter.getHtmlForMessage(message,gameData.activeGame);break;case"r":if(isRealTimeMessage){SoundPlayer.playTippingSound(0,"spin_the_wheel"),$(".game-center-button").addClass("hidden"),$(".game-center-allow").removeClass("hidden"),$("#pausedGameDock").removeClass("hidden"),$(".pausedGameDock__resumeGameText").text(js_i18n.tippingGames.spinTheWheel.spinPrize),$("#openGameDock").addClass("hidden");var arrayResponse=Object.keys(gameData.response.o).map(function(key){return gameData.response.o[key]}),arrayResponseCompare=arrayResponse.filter(function(item){if(item.hasOwnProperty("dis")&&1==item.dis)return item});1==gameData.response.rwf?arrayResponseCompare.length<arrayResponse.length?$(".game-center-allow-btn").text(js_i18n.tippingGames.spinTheWheel.allowSpin):($(".game-center-allow-btn").text(js_i18n.tippingGames.performerEndGameBtn).attr("data-action","end"),$(".pausedGameDock__resumeGameText").text(js_i18n.tippingGames.spinTheWheel.endsIn)):$(".game-center-allow-btn").text(js_i18n.tippingGames.spinTheWheel.allowSpin),Cam4User.isBroadcaster()||gameData.username!==Cam4User.profileName||GameCenter.pushDataLayer("spinTheWheel","spin_the_wheel",gameData.response.o[gameData.response.r].o,gameData.response.p),SoundPlayer.playTippingSound(0,"spin_the_wheel_win"),GameCenter.updateViewer(gameData.response),GameCenter.setPauseCountdown(gameData.response.ep)}var details=GameCenter.getGameDetails(gameData.activeGame);if(!details)return;message=js_i18n.tippingGames.spinTheWheel.spinIn.replace("{0}",getGameDisplayUsername(gameData.username,anonymous)).replace("{1}",details.o[gameData.response.r].o),html+=GameCenter.getHtmlForMessage(message,gameData.activeGame);break;case"res":if(message=GameCenter.getGameText(gameData.activeGame)+" "+js_i18n.tippingGames.performerResumedGame,html+=GameCenter.getHtmlForMessage(message,gameData.activeGame),isRealTimeMessage){$(".game-center-button").removeClass("hidden"),$(".game-center-allow").addClass("hidden"),$(".game-center-allow-btn").attr("disabled",!1).removeClass("isClicked"),$("#pausedGameDock").addClass("hidden"),$("#openGameDock").removeClass("hidden");var resumeData=GameCenter.getSpinTheWheelData();GameCenter.updateViewer(resumeData),GameCenter.updateBroadcaster(gameData.response),GameCenter.stopPauseCountdown()}}if("Draw"===gameData.activeGame)switch(gameData.status){case"s":isRealTimeMessage&&(GameCenter.setGameStartedData(gameData.response),gameData.response.eg&&(buttonTimerId&&clearInterval(buttonTimerId),buttonTimerId=GameCenter.addTimerToButton(gameData)),SoundPlayer.playTippingSound(0,"tipping_game_start"),SoundPlayer.playTippingSound(0,"clock_ticking")),message=GameCenter.getStartGameMessage(gameData),html+=GameCenter.getHtmlForMessage(message,gameData.activeGame);break;case"e":var timerToRemove,timeToUpdate;isRealTimeMessage&&(clearTimeout(timerToRemove),clearTimeout(timeToUpdate),$("#back-gamelist").show(),$(".game-center-button").removeClass("hidden"),$(".game-center-button .status").removeClass("is-active"),$("#openGameDock").addClass("hidden"),$("#game-center-button-text").text(js_i18n.tippingGames.gameCenterText),timeToUpdate=setTimeout(function(){GameCenter.updateViewer(gameData.response)},2e3),SoundPlayer.playTippingSound(0,"lucky_draw_selection"),SoundPlayer.playTippingSound(0,"lucky_draw_selection"),SoundPlayer.playTippingSound(0,"lucky_draw_selection"),timerToRemove=setTimeout(function(){GameCenter.removeFromTheDom(),GameCenter.closeViewerDock(),SoundPlayer.playTippingSound(0,"lucky_draw_win")},8e3),buttonTimerId&&clearInterval(buttonTimerId));var winner=gameData.response.w;if(!GameCenter.getGameDetails(gameData.activeGame))return;if(void 0===winner)message=js_i18n.tippingGames.luckyDraw.withoutWinner;else{var winningPrize=GameCenter.getLuckyDrawWinningPrize();if(void 0===winningPrize)return;message=js_i18n.tippingGames.luckyDraw.withWinner.replace("{0}",getGameDisplayUsername(winner.u,winner.inv?1:0)).replace("{1}",winningPrize).replace("{2}",winner.i)}html+=GameCenter.getHtmlForMessage(message,gameData.activeGame);break;case"b":if(isRealTimeMessage){var luckyDrawPricePerTicket=GameCenter.getGameDetails(gameData.activeGame).p;Cam4User.isBroadcaster()||gameData.username!==Cam4User.profileName||GameCenter.pushDataLayer("luckyDraw","buy_ticket",gameData.response.r,luckyDrawPricePerTicket),SoundPlayer.playTippingSound(0,"lucky_draw_buy_ticket")}message=js_i18n.tippingGames.luckyDraw.boughtTicket.replace("{0}",getGameDisplayUsername(gameData.username,anonymous)).replace("{1}",gameData.response.r),html+=GameCenter.getHtmlForMessage(message,gameData.activeGame)}if("RollTheDice"===gameData.activeGame){if("s"===gameData.status&&(isRealTimeMessage&&(GameCenter.setGameStartedData(gameData.response),$("#game-center-button-text").text(GameCenter.getGameText(gameData.activeGame)),SoundPlayer.playTippingSound(0,"tipping_game_start")),message=js_i18n.tippingGames.rollTheDice.performerEnabledGame.replace("{0}",gameData.username),ctaBtn=isBroadCaster?'<button class="hidden">'+js_i18n.tippingGames.rollTheDice.ctaBtn+"</button>":'<button class="cta-btn-openGameDock">'+js_i18n.tippingGames.rollTheDice.ctaBtn+"</button>",ControlledFeatures.TIPPING_GAME_NOTIFICATIONS?html+='<div class="gameRollTheDiceStarted"><div class="gameIntroWrapper"><div class="gameIntro rollTheDice"><p>'+message+"</p>"+ctaBtn+'</div></div><div class="gameRollTheDiceStarted__container"><ul class="left"><li class="clearfix"><span class="dice-face side-1"></span><span>'+_.escape(gameData.response.o[1])+'</span></li><li class="clearfix"><span class="dice-face side-3"></span><span>'+_.escape(gameData.response.o[3])+'</span></li><li class="clearfix"><span class="dice-face side-5"></span><span>'+_.escape(gameData.response.o[5])+'</span></li></ul><ul class="right"><li class="clearfix"><span class="dice-face side-2"></span><span>'+_.escape(gameData.response.o[2])+'</span></li><li class="clearfix"><span class="dice-face side-4"></span><span>'+_.escape(gameData.response.o[4])+'</span></li><li class="clearfix"><span class="dice-face side-6"></span><span>'+_.escape(gameData.response.o[6])+"</span></li></ul></div></div>":html+='<div class="gameNotificationIcon gameNotificationIcon--rollTheDice"></div><div class="gameGradientBck"></div><div class="gameRollTheDiceStarted"><span class="game-result-msg game-result-msg-started">'+message+'</span><div class="gameRollTheDiceStarted__container"><ul class="left"><li class="clearfix"><span class="dice-face side-1"></span><span>'+_.escape(gameData.response.o[1])+'</span></li><li class="clearfix"><span class="dice-face side-3"></span><span>'+_.escape(gameData.response.o[3])+'</span></li><li class="clearfix"><span class="dice-face side-5"></span><span>'+_.escape(gameData.response.o[5])+'</span></li></ul><ul class="right"><li class="clearfix"><span class="dice-face side-2"></span><span>'+_.escape(gameData.response.o[2])+'</span></li><li class="clearfix"><span class="dice-face side-4"></span><span>'+_.escape(gameData.response.o[4])+'</span></li><li class="clearfix"><span class="dice-face side-6"></span><span>'+_.escape(gameData.response.o[6])+"</span></li></ul></div></div>"),"r"===gameData.status){var rollTheDiceDetails=GameCenter.getGameDetails(gameData.activeGame),rollTheDicePrize=rollTheDiceDetails.o[gameData.response.r];if(isRealTimeMessage&&(SoundPlayer.playTippingSound("20","dice"),$(".game-center-button").addClass("hidden"),$(".game-center-allow").removeClass("hidden"),$("#pausedGameDock").removeClass("hidden"),$(".pausedGameDock__resumeGameText").text(js_i18n.tippingGames.rollTheDice.rollIn),$("#openGameDock").addClass("hidden"),$(".game-center-allow-btn").text(js_i18n.tippingGames.rollTheDice.allowRoll),GameCenter.closeViewerDockWithDelay(5e3),GameCenter.updateViewer(gameData.response),GameCenter.updateBroadcaster(gameData.response),GameCenter.setPauseCountdown(gameData.response.ep),Cam4User.isBroadcaster()||gameData.username!==Cam4User.profileName||GameCenter.pushDataLayer("rollTheDice","roll_the_dice",rollTheDicePrize,rollTheDiceDetails.p)),!rollTheDiceDetails)return;message=js_i18n.tippingGames.rollTheDice.rolledPrize.replace("{0}",getGameDisplayUsername(gameData.username,anonymous)).replace("{1}",gameData.response.r).replace("{2}",_.escape(rollTheDicePrize)),html+='<div class="gameNotificationIcon gameNotificationIcon--rollTheDice"></div><span class="game-result-msg"><span class="dice-face side-'+gameData.response.r+'"></span>'+message+"</span>"}"e"===gameData.status&&(GameCenter.setGameEnd(isRealTimeMessage),html+='<div class="gameGradientBck"></div><span class="game-result-msg game-result-msg-ended">'+(message=js_i18n.tippingGames.rollTheDice.performerEndedGame)+"</span>"),"res"===gameData.status&&(isRealTimeMessage&&($(".game-center-button").removeClass("hidden"),$(".game-center-allow").addClass("hidden"),$(".game-center-allow-btn").attr("disabled",!1).removeClass("isClicked"),$("#pausedGameDock").addClass("hidden"),$("#openGameDock").removeClass("hidden"),GameCenter.stopPauseCountdown(),GameCenter.updateBroadcaster(gameData.response),GameCenter.updateViewer(gameData.response)),message=GameCenter.getGameText(gameData.activeGame)+" "+js_i18n.tippingGames.performerResumedGame,html+=GameCenter.getHtmlForMessage(message,gameData.activeGame))}if("TokenSquares"===gameData.activeGame){if("s"===gameData.status&&(isRealTimeMessage&&(GameCenter.setGameStartedData(gameData.response),$("#game-center-button-text").text(GameCenter.getGameText(gameData.activeGame)),SoundPlayer.playTippingSound(0,"tipping_game_start")),message=js_i18n.tippingGames.tokenSquares.performerEnabledGame.replace("{0}",gameData.username),ctaBtn=isBroadCaster?'<button class="hidden">'+js_i18n.tippingGames.tokenSquares.ctaBtn+"</button>":'<button class="cta-btn-openGameDock">'+js_i18n.tippingGames.tokenSquares.ctaBtn+"</button>",ControlledFeatures.TIPPING_GAME_NOTIFICATIONS?html+='<div class="gameRollTheDiceStarted"><div class="gameIntroWrapper"><div class="gameIntro tokenKeno"><p>'+message+"</p>"+ctaBtn+"</div></div>":html+='<div class="gameGradientBck"></div><div class="gameNotificationIcon gameNotificationIcon--tokenSquares"></div><span class="game-result-msg game-result-msg-started">'+message+"</span>"),"e"===gameData.status&&(GameCenter.setGameEnd(isRealTimeMessage),html+='<div class="gameGradientBck"></div><span class="game-result-msg game-result-msg-ended">'+(message=js_i18n.tippingGames.tokenSquares.performerEndedGame)+"</span>"),"c"===gameData.status){if(isRealTimeMessage){if(SoundPlayer.playTippingSound(0,"token_keno_action"),SoundPlayer.playTippingSound(0,"token_keno_end"),$(".game-center-button").addClass("hidden"),$(".game-center-allow").removeClass("hidden"),$("#pausedGameDock").removeClass("hidden"),$(".pausedGameDock__resumeGameText").text(js_i18n.tippingGames.tokenSquares.unlockIn),$("#openGameDock").addClass("hidden"),$(".game-center-allow-btn").text(js_i18n.tippingGames.tokenSquares.allowUnlock),GameCenter.closeViewerDockWithDelay(1e4),GameCenter.setPauseCountdown(gameData.response.ep),GameCenter.updateViewer(gameData.response),GameCenter.updateBroadcaster(gameData.response),!Cam4User.isBroadcaster()&&gameData.username===Cam4User.profileName){var price=GameCenter.getGameDetails(gameData.activeGame).o.filter(function(item,index){if(item.dis&&item.pr===gameData.response.r)return item})[0];GameCenter.pushDataLayer("tokenKeno","select_square",gameData.response.r,price.p)}gameData.response.o.filter(function(item){if(!0===item.dis)return item}).length==gameData.response.o.length&&($(".game-center-allow-btn").text(js_i18n.tippingGames.performerEndGameBtn),$(".pausedGameDock__resumeGameText").text(js_i18n.tippingGames.tokenSquares.endsIn))}html+='<div class="gameNotificationIcon gameNotificationIcon--tokenSquares"></div><span class="game-result-msg">'+(message=js_i18n.tippingGames.tokenSquares.unlockedPrize.replace("{0}",getGameDisplayUsername(gameData.username,anonymous)).replace("{1}",_.escape(gameData.response.r)))+"</span>"}"res"===gameData.status&&(isRealTimeMessage&&($(".game-center-button").removeClass("hidden"),$(".game-center-allow").addClass("hidden"),$(".game-center-allow-btn").attr("disabled",!1).removeClass("isClicked"),$("#pausedGameDock").addClass("hidden"),$("#openGameDock").removeClass("hidden"),GameCenter.stopPauseCountdown(),GameCenter.updateViewer(gameData.response),GameCenter.updateBroadcaster(gameData.response)),message=GameCenter.getGameText(gameData.activeGame)+" "+js_i18n.tippingGames.performerResumedGame,html+=GameCenter.getHtmlForMessage(message,gameData.activeGame))}"TippingBar"!==gameData.activeGame&&Cam4User.isBroadcaster()&&(translatorAddMessage({msg:html,user:"",userType:"roomNotification",roomModerator:"",imageURL:"",tab:"games",lower_username:user,hash:""}),blinkMessageTab("Games",!0),scrollToBottom("GamesTabPanel"))}else{var actionText="";Cam4User.isBroadcaster()?TippingGames&&TippingGames.currentSettings&&void 0!==TippingGames.currentSettings["option"+extra]&&(actionText=TippingGames.currentSettings["option"+extra]):TippingGamesViewer&&TippingGamesViewer.gameSettings&&void 0!==TippingGamesViewer.gameSettings["option"+extra]&&(actionText=TippingGamesViewer.gameSettings["option"+extra]),classes+="game dice",html+='<span class="game-result-msg"><span class="dice-face side-'+extra+'"></span>'+(message=1==anonymous?Cam4User.isBroadcaster()?js_i18n.tippingGames.userRolledAnonymously.replace("{0}",user).replace("{1}",extra).replace("{2}",actionText):js_i18n.tippingGames.anonymousRolled.replace("{0}",extra).replace("{1}",actionText):js_i18n.tippingGames.userRolled.replace("{0}",user).replace("{1}",extra).replace("{2}",actionText))+"</span>",Cam4User.isBroadcaster()&&TippingGamesUtils.isGameActive()&&(translatorAddMessage({msg:html,user:"",userType:"roomNotification",roomModerator:"",imageURL:"",tab:"games",lower_username:user,hash:"",rollthedice:!0}),blinkMessageTab("Games",!0));try{Cam4Event.dispatch(ChatEvent.ROOM_TIP_NOTIFICATION_ADDED),Cam4Event.dispatch(TipEvent.DICE_ROLLED,arguments)}catch(ex){console.error(ex)}}break;case FirebaseStructure.NotificationType.MARKETPLACE_PURCHASE:html="<span>"+(message=marketLocales.purchaseMessage.replace("{0}",user).replace("{1}",messageObject.videoTitle).replace("{2}",Cam4User.performerName))+"</span>";break;case FirebaseStructure.NotificationType.MARKETPLACE_BULK_PURCHASE:html="<span>"+(message=marketLocales.purchaseMessage.replace("{0}",user).replace('"{1}"',messageObject.videoCount+" "+marketLocales.videos).replace("{2}",Cam4User.performerName))+"</span>"}tab||(tab="chat");var options={messageKey:messageKey,msg:html,user:"",userType:"roomNotification",roomModerator:"",imageURL:"",tab:tab,lower_username:user,hash:""};if(type===FirebaseStructure.NotificationType.GAME&&(ControlledFeatures.USE_GAME_CENTER||(options.rollthedice=!0)),isRealTimeMessage){if("Draw"===gameDataObject.gt&&"e"===gameDataObject.go){var delayMessageTimer;return clearTimeout(delayMessageTimer),void(delayMessageTimer=setTimeout(function(){translatorAddMessage(options),scrollToBottom("chatTabPanel")},5e3))}if("SpinTheWheel"===gameDataObject.gt&&"r"===gameDataObject.go){var delayMessageResultTimer;return clearTimeout(delayMessageResultTimer),void(delayMessageResultTimer=setTimeout(function(){translatorAddMessage(options),scrollToBottom("chatTabPanel")},3500))}}translatorAddMessage(options),scrollToBottom("chatTabPanel")},roomModerator:roomModerator,showSpeakerOn:function(){$("#enableAudio").hide(),$("#pauseAudio").show()},showSpeakerOff:function(){$("#enableAudio").show(),$("#pauseAudio").hide()},showEnterPassword:function(error){$j("#authWithPass").show(),"error"===error&&$j("#wrongPassword").show()},changeRoomModeratorState:function(previousModeratorState,currentModeratorState,displayNotification){previousModeratorState!=currentModeratorState&&(1==currentModeratorState?(!0===displayNotification&&$("#accessLevelNotification").text(Cam4Chat.userGainModerator),isRoomModerator=!0,roomModerator()):(!0===displayNotification&&$("#accessLevelNotification").text(Cam4Chat.userLoseModerator),isRoomModerator=!1),!0===displayNotification&&$("#accessLevelNotification").fadeIn("slow").delay(1e3).fadeOut("slow"))},toggleModeratorInUserList:function(username,isModerating){var text="";1==isModerating&&(text=" moderator"),$j("#br-"+username).text(text)},updateTipLeaderIcon:function(tipLeader){Cam4User.tipLeader!=tipLeader&&($(".tipLeaderIcon").hide(),PageStatus.has("embed")||$(".tipLeaderIcon_"+tipLeader).css("display","inline-block")),Cam4User.tipLeader=tipLeader},avatarsOn:function(){$j(".chatPanel").removeClass("hideavatars")},avatarsOff:function(){$j(".chatPanel").addClass("hideavatars")},setFontSize:function(fontsize){var lineHeight=Math.floor(1.23*fontsize);$j("#tab1C").css({fontSize:fontsize+"px",lineHeight:lineHeight+"px"})},filterMessage:function(message){if(Chat.isUserIgnored(message.senderOriginalUsername))return!1;if(Cam4User.performerName==Cam4User.userName)return!0;if(message.senderOriginalUsername.toLowerCase()==Cam4User.userName.toLowerCase()||message.senderOriginalUsername.toLowerCase()==Cam4User.performerName.toLowerCase()||"gold"!=message.senderAccessLevel&&"general"!=message.senderAccessLevel)return!0;var settings=ChatSettings.getSettings();if(!settings.enableFilters)return!0;var ismyLanguage=message.language==Cam4User.userLanguage,ismyGender=message.gender==settings.selectedGender;return settings.allowMyLanguage&&!settings.allowGender?ismyLanguage:settings.allowGender&&!settings.allowMyLanguage?ismyGender:!settings.allowGender||!settings.allowMyLanguage||ismyGender||ismyLanguage},scrollTabs:function(direction){var offset=document.getElementById("chatTab").offsetWidth+document.getElementById("usersTab").offsetWidth+20+document.getElementById("usersTab").offsetWidth+document.getElementById("GamesTab").offsetWidth,total=0;if("right"==direction?tabIndex++:tabIndex--,tabIndex<0)tabIndex=0;else{for(var index=0,c=document.getElementById("privateMessageUserList").childNodes,i=0;i<c.length;i++)void 0!==c[i].offsetWidth&&"tabChat"==c[i].className&&index<=tabIndex&&(total+=c[i].offsetWidth,index++);offset-=total,document.getElementById("privateMessageUserList").style.left=offset+"px"}},closeAllPrivateMessageTabs:function(){$j("#privateMessageUserList .tabChat").each(function(){"userConversationTabTemplate"!==this.id&&$([this,"#"+this.id+"Panel"]).remove()}),checkScrollTabs(),$j("#chatTab").click()},clearPrivateMessageDOM:function(){$j("#tab1C").find(".chatPanel:not(#chatTabPanel, #GSTabPanel, #GamesTabPanel, #tippingCulture)").remove()},ignoreUserConfirmation:function(targetUser,action){if(Cam4User.isLoggedIn){var message=Cam4Chat[action].replace("{0}",Chat.getUser(targetUser).original_username)+"?";Chat.newShowsConfirmation(Cam4Chat.domain,message,action,targetUser)}else Cam4User.isLoggedInAsGuest?Registration.activateGuestRegisterModal():Utils.decideOffer()},renderVisibleAvatars:function(users){if("none"!=$j("#chatUsersList").css("display")&&"users"==Chat.activeChatTab)for(var parentPos=document.getElementById("chatUsersList").getBoundingClientRect(),imgDefer=$j(users),containerHeight=$j("#chatUsersList").height(),i=0;i<imgDefer.length;i++){var el=imgDefer[i],childrenPos=el.getBoundingClientRect();if(childrenPos.top-parentPos.top<containerHeight&&childrenPos.top-parentPos.top>0&&(el.setAttribute("src",el.getAttribute("data-src")),el.className="imgAvatar"),childrenPos.top-parentPos.top>containerHeight)return}},toEmoticon:function(message){return message?Emoticons.processEmoticons(message.concat(" ")):null},updateBroadcasterPSTimer:function(seconds){$j("#broadcasterTime").text(ChatUtils.formatTimeValue(seconds))},privateShowTimer:function(seconds){ChatUI.element.sellingTicketsBar.html(ChatUtils.formatTimeValue(seconds)).show()},getOnlineUsers:function(){var userList=[];for(var key in Chat.globalUsers)Chat.globalUsers.hasOwnProperty(key)&&Chat.globalUsers[key].showOnline&&key!=Cam4User.userName.toLowerCase()&&userList.push(Chat.globalUsers[key].original_username);return userList},showInvitationBubble:function(username){var text=js_i18n.inviteRequest.replace("{0}",username);$j("#invitationToRoomText").text(text),$j("#invitationToRoomAccept").off().on("click",function(){window.open("/"+username,"_blank")}),$j("#invitationToRoom").show().delay(7e3).fadeOut()},closeInvitationBubble:function(event){event.stopPropagation(),$j("#invitationToRoom").hide()},toggleOBS:function(){$("body").hasClass("no-video")?($("body").removeClass("no-video"),$("#toggleOBS").find(".status").css("background-color","#00e410"),Cam4Cookies.setCookie("hideVideoOBS","false")):($("body").addClass("no-video"),$("#toggleOBS").find(".status").css("background-color","#000"),Cam4Cookies.setCookie("hideVideoOBS","true"))},updateResolutionMenu:updateResolutionMenu,changeResolution:function(event,selectedResolution){event.preventDefault(),$("#selectedResolution").text(resolutionObj[selectedResolution].label),updateResolutionMenu(resolutionObj,selectedResolution),streamIsPlaying(!1),$("#resolutionListMenu").hide(),Cam4User.cameraData.useHlsVideoOnMobile?HLS.setHLSLevel(resolutionObj[selectedResolution].key):JsSender.setAbrResolution(resolutionObj[selectedResolution].key)},streamIsPlaying:streamIsPlaying,getRelationshipStatus:getRelationshipStatus,friendAction:function(username,friendUsername){var actionUrl="/rest/v1.0/friends/"+username+"/"+friendUsername.name,actionType="";switch(friendUsername.friend){case"accept":actionType="POST";break;case"cancel":actionType="DELETE"}$j.ajax({url:actionUrl,type:actionType,data:"",success:function(){"accept"==friendUsername.friend&&updateFriendButton(friendUsername.name,"addFriend"),"cancel"==friendUsername.friend&&updateFriendButton(friendUsername.name,"deleteFriends")},error:function(message){403===message.status&&""!==message.responseText&&"FRIEND_LIMIT_REACHED"===JSON.parse(message.responseText).status&&$("#friend-limit-reached-chat").modal("show")}})},favoriteAction:function(user){"addFavorite"==user.favorite?addFriendFavorite("addFavorite",user.name):removeFriendFavorite(Cam4User.userName,user.name,"deleteFavoritesUsername")},populateResolutionMenu:function(jsonData){if($("#broadcastResolutionList").length){var resolutions=jsonData.resolutions,broadcastResolutionList=$("#broadcastResolutionList"),list="<ul>";$.each(resolutions,function(key,data){var bulletResolution=jsonData.selection==data.key?'<span class="bull">&bull;</span>':"<span></span>";list+='<li data-resolution="'+data.key+'" data-label="'+data.label+'">'+data.label+bulletResolution+"</li>"}),list+="</ul>",broadcastResolutionList.html(list),$(".broadcast-tool-resolution .currentRes").html(jsonData.selection),$(".broadcast-tool-resolution").on("click",function(){broadcastResolutionList.toggle()}),changeBroadcastResolution()}},hideContextualMenu:hideContextualMenu,getContextualNotes:function(){getAjaxNotes(Chat.getContextualUser().name)},saveContextualNotes:function(){var user=Chat.getContextualUser(),note=$j("#contextualNotesValue").val(),color=$('input[name="notesClasification"]:checked').val(),info={note:note,color:color,peer:user.name};$j.ajax({url:"/userNotes",type:"POST",data:info}),updateNotes(user.name,color),$j("#contextualNotesForm").modal("hide")},deleteContextualNotes:function(){var user=Chat.getContextualUser(),lowercaseUsername=user.name.toLowerCase();$j.ajax({url:"/userNotes?peer="+user.name,type:"DELETE"}),$j("#contextualNotesForm").modal("hide"),delete userNotesColors[lowercaseUsername],$j("#"+lowercaseUsername+" #notesbtn-"+lowercaseUsername).remove(),m.redraw()},checkUserNotes:checkUserNotes,getAjaxNotes:getAjaxNotes,changeNoteClasification:function(val){$("#contextualNotesValue").removeClass("red blue").addClass(val)},silenceUserConfirmation:function(username,targetUser,action){"silence_user"===action&&($("#errorMessage").show(),$("#textErrorMessage").text(Cam4Chat.silence.replace("{0}",targetUser)+" ?"),$("#yesButton").on("click",function(){silenceRequest(username,targetUser,action),Chat.closeErrorBox()}).css("display","inline-block"),$("#noButton").on("click",function(){Chat.closeErrorBox()}).css("display","inline-block")),"unsilence_user"===action&&($("#errorMessage").show(),$("#textErrorMessage").text(Cam4Chat.unsilence.replace("{0}",targetUser)+" ?"),$("#yesButton").on("click",function(){silenceRequest(username,targetUser,action),Chat.closeErrorBox()}).css("display","inline-block"),$("#noButton").on("click",function(){Chat.closeErrorBox()}).css("display","inline-block"))},silenceRequest:silenceRequest,unsilenceUserFromList:unsilenceUserFromList,unsilenceAllUsersFromList:unsilenceAllUsersFromList,addSilencedUserToList:addSilencedUserToList,getSilencedUsersOnPage:getSilencedUsersOnPage,renderSilencedUserThumb:renderSilencedUserThumb,getSilencedUsers:function(){$j.ajax({url:"/rest/v1.0/profile/"+Cam4User.userName+"/silence",type:"GET",success:function(response){var silencedUsers=response.usersList.map(function(user){return user.username});Cam4User.silencedUsers=silencedUsers}})}}}();
var StreamSource=function(){return this.roomname=Cam4User.performerName,{getDirectEdge:function(username,callback){var details={room:username,serverType:"EDGE"};$j.ajax({url:"/direct?details="+JSON.stringify(details),success:function(result){callback&&callback(result)}})},getInstance:function(){return isVrStream&&ControlledFeatures.USE_VR_PLAYER&&Cam4User.cameraData.useHlsVideoOnMobile?vrPlayer:Cam4User.cameraData.useWebRTCPlayer?WebRTCPlayer:Cam4User.cameraData.useHlsVideoOnMobile&&"MBA"!=Cam4User.broadcastSource?HLS:ChatlessPlayer}}}();
var ConnectionLogger=function(){function getTags(){var tags="NA";return"undefined"!=typeof Cam4Analytics&&(tags=Cam4Analytics.getCurrentTags()),tags}function generateSessionUuid(){return md5(BrowserDetect.getBrowserUID()+JSON.stringify(new Date)+JSON.stringify(Cam4User))}function setLoggingServer(value){""!==value&&null!==value&&"false"!==value.toLowerCase()?(_loggingServer=value,_sendLogData=!0):_sendLogData=!1}function sendSession(){if(_sendLogData){var obj={};obj.session=_session;var urlVariables={};urlVariables.data=JSON.stringify(obj),_pendingResponse=!0,sendDataToLoggerServer(_loggingServer,urlVariables)}}function sendDataToLoggerServer(server,data){if(numberOfErrors>MAX_ALLOWED_NUMBER_OF_ERRORS+1)numberOfErrors--;else if(Cam4User.userAcceptedSexualProfiling){clearTimeout(_failTimeoutId);var request=$.ajax({url:server,type:"POST",data:data,contentType:"application/x-www-form-urlencoded",timeout:RETRY_SEND_TIMEOUT,headers:{"X-Data-Encrypted":!1,"X-Room":_session.room,"X-Username":_session.username,"X-State":"undefined"!=typeof CURRENT_STATE&&CURRENT_STATE||"UNKNOWN","X-Tags":getTags()}});request.done(function(response){loadCompleteHandler(),numberOfErrors=0}),request.fail(function(jqXHR,status){_failTimeoutId=setTimeout(loadErrorHandler,RETRY_FAIL_TIMEOUT)})}}function loadCompleteHandler(){for(sessionSentWithSuccess||(sessionSentWithSuccess=!0),_pendingResponse=!1;_eventsToDestroy>0;)_pendingArray.shift(),_eventsToDestroy--;_pendingArray.length>0&&prepareData()}function loadErrorHandler(){numberOfErrors++,sessionSentWithSuccess?(_pendingResponse=!1,_pendingArray.length>0&&prepareData()):sendSession()}function prepareData(){if(!0!==_pendingResponse&&_sendLogData){for(var obj={},events=[],metrics=[],systemInfos=[],i=0;i<_pendingArray.length;i++)"EventLog"===_pendingArray[i].type?events.push(_pendingArray[i]):"MetricLog"===_pendingArray[i].type?metrics.push(_pendingArray[i]):"SystemInfoLog"===_pendingArray[i].type&&systemInfos.push(_pendingArray[i]);if(events.length>0&&(obj.events=events),metrics.length>0&&(obj.metrics=metrics),systemInfos.length>0&&(obj.sysinfos=systemInfos),void 0!==_session&&void 0===obj.session&&(obj.session=_session),performance){var elapsed=performance.now()-startedAt;obj.elapsed=elapsed}if("undefined"!=typeof $){var sel=$("#viewerScreenTxt");sel&&sel.text&&(obj.broadcastGoal=sel.text()+"")}var urlVariables={};urlVariables.data=JSON.stringify(obj),_pendingResponse=!0,sendDataToLoggerServer(_loggingServer,urlVariables),_eventsToDestroy=_pendingArray.length}}var _session,_failTimeoutId,_loggingServer="",_sendLogData=!1,_pendingResponse=!1,_pendingArray=[],_eventsToDestroy=-1,sessionSentWithSuccess=!1,RETRY_SEND_TIMEOUT=2e4,RETRY_FAIL_TIMEOUT=3e3,numberOfErrors=0,MAX_ALLOWED_NUMBER_OF_ERRORS=500,startedAt=performance&&performance.now();return{init:function(playerType){var _statusModel=(Cam4Performer||{}).statusModel||{};setLoggingServer(Cam4User.cameraData.streamLoggerServer),_session={sessionUuid:generateSessionUuid(),type:playerType,domain:document.domain,username:Cam4User.userName,room:Cam4User.performerName,profileCountry:Cam4User.profileCountry,realCountry:Cam4User.countryCode,locale:Cam4User.localeString,ip:Cam4User.currentIp,source:_statusModel.source||"N/A",technology:_statusModel.technology||"N/A",showState:_statusModel.showState||"N/A",tags:getTags()},sendSession()},logEvent:function(eventName,details,server){if(null!=_session){var timeStamp=(new Date).getTime(),domain=UrlDecoder.getDomainFromUrl(server),eventLog={sessionUuid:_session.sessionUuid,clientTimestamp:timeStamp,type:"EventLog",eventName:eventName,server:domain,details:details};_pendingArray.push(eventLog),prepareData()}},logEventFlash:function(data){null!=_session&&(data.sessionUuid=_session.sessionUuid,data.type="EventLog",_pendingArray.push(data),prepareData())},logMetricFlash:function(data){null!=_session&&(data.sessionUuid=_session.sessionUuid,data.type="MetricLog",data.focus=Cam4User.windowFocused,data.platform="flash",_pendingArray.push(data),prepareData())},logMetricHls:function(data){null!=_session&&(data.sessionUuid=_session.sessionUuid,data.type="MetricLog",data.focus=Cam4User.windowFocused,data.platform="hls",_pendingArray.push(data),prepareData())},logSystemInfoFlash:function(data){null!=_session&&(data.sessionUuid=_session.sessionUuid,data.type="SystemInfoLog",_pendingArray.push(data),prepareData())},getSessionUuid:function(){return null!=_session?_session.sessionUuid:""},logMetricBroadcaster:function(data,platform){null!=_session&&(data.sessionUuid=_session.sessionUuid,data.type="MetricLog",data.focus=Cam4User.windowFocused,data.platform=platform,_pendingArray.push(data),prepareData())},getNumErrors:function(){return numberOfErrors}}}();
var Surveys={openGoldSurvey:function(){Utils.popWithAjaxContent("/surveys/survey_gold.html",{overflow:"hidden",width:"780px",height:"760px",top:"40px",background:"#fff"},!0)}};
var DomainName=function(){var domain=document.domain,p=domain.split(".");return domain=p.slice(1,p.length).join(".")}(),HeaderQuestions=HeaderQuestions||{};HeaderQuestions.nextIndex=0,HeaderQuestions.showOptions=function(item,id){if("security"===id)return $j("#securityQuestionOption").show(),$j(item).hide(),!1;$j("#securityQuestionOption").hide();for(var i=0;i<HeaderQuestions.notificationsIds.length;i++)$j("#notificationOpt"+HeaderQuestions.notificationsIds[i]).hide();$j("#notificationOpt"+id).css("top","16px"),$j("#notificationOpt"+id).show()},HeaderQuestions.manageCookies=function(id,period){var cookieName,expireDate=new Date;switch($j("#notificationOpt"+id).hide(),$j("#headerNotification"+id).hide(),period){case"week":cookieName="cam4-NOTIF_BAR_HIDDEN_WEEK_"+Cam4User.userName;expireDate=new Date(expireDate.getTime()+6048e5);break;case"year":cookieName="cam4-NOTIF_BAR_HIDDEN_YEAR_"+Cam4User.userName,expireDate.setFullYear(expireDate.getFullYear()+1)}Cam4Cookies.getCookie(cookieName)?Cam4Cookies.setCookie(cookieName,Cam4Cookies.getCookie(cookieName)+"and"+id,expireDate,"","."+DomainName):Cam4Cookies.setCookie(cookieName,id,expireDate,"","."+DomainName),HeaderQuestions.nextIndex++,$j($j("#headerQuestionsArea .alert")[HeaderQuestions.nextIndex]).show()},HeaderQuestions.hideNotification=function(id){HeaderQuestions.manageCookies(id,"week")},HeaderQuestions.removeNotification=function(id){HeaderQuestions.manageCookies(id,"year")},HeaderQuestions.hide=function(duration){var securityURL="/"+Cam4User.userName+"/edit/securityQuestions?ajax=true&hideBarPeriod="+duration;$j.ajax({type:"GET",url:securityURL,success:function(msg){console.log("ajax done with"+msg),$j("#securityQuestions").hide(),HeaderQuestions.nextIndex++,$j($j("#headerQuestionsArea .alert")[HeaderQuestions.nextIndex]).show()}})},$j(document).ready(function(){$j($j("#headerQuestionsArea div")[HeaderQuestions.nextIndex]).show()});
function addFriendFavorite(actionCode,objName){if(Cam4User.isLoggedInAsGuest)Registration.activateGuestRegisterModal();else{var life=Cam4Notifications.cookieLife||3,now=new Date,over=new Date(now.getFullYear(),now.getMonth(),now.getDay(),now.getHours()+life);Cam4Cookies.setCookie("favOnline-"+objName,objName,over),$j.ajax({type:"GET",cache:!1,url:"/profiles/addFriendFavorite",data:"action="+actionCode+"&object="+objName,success:function(){Cam4User.performerName==objName&&ffUpdate.update(actionCode);var tags;tags="undefined"!=typeof Cam4Analytics?Cam4Analytics.getCurrentTags():"NA","addFavorite"===actionCode||"removeFavorite"===actionCode?dataLayer.push({event:"socialEvents",eventCategory:"favorite",eventAction:actionCode,eventLabel:tags}):"addFriend"!==actionCode&&"removeFriend"!==actionCode||dataLayer.push({event:"socialEvents",eventCategory:"friend",eventAction:actionCode,eventLabel:tags})}})}}function showFriendFavoriteAdd(){friendFavoriteRemove.style.display="none",friendFavoriteAdd.style.display="block"}function hideFriendFavoriteAdd(){friendFavoriteRemove.style.display="block",friendFavoriteAdd.style.display="none"}function showFriendApprovedAdd(){friendApprovedRemove.style.display="none",friendApprovedAdd.style.display="block"}function hideFriendApprovedAdd(){friendApprovedRemove.style.display="block",friendApprovedAdd.style.display="none"}function checkPerformerName(broadcasterName){return Cam4Performer.userId==broadcasterName||Cam4User.performerName.toLowerCase()==broadcasterName.toLowerCase()}function removeFriendFavorite(userName,broadcasterName,action){$j.ajax({type:"POST",cache:!1,url:"/"+userName+"/edit/friends_favorites",data:action+"="+broadcasterName+"&simpleresult=true",success:function(){checkPerformerName(broadcasterName)&&("deleteFriends"===action?(showFriendApprovedAdd(),showFriendFavoriteAdd(),waitingApprove&&(waitingApprove.style.display="none")):showFriendFavoriteAdd());var tags;tags="undefined"!=typeof Cam4Analytics?Cam4Analytics.getCurrentTags():"NA","deleteFavorites"===action?dataLayer.push({event:"socialEvents",eventCategory:"favorite",eventAction:"removeFavorite",eventLabel:tags}):"deleteFriends"===action&&dataLayer.push({event:"socialEvents",eventCategory:"friend",eventAction:"removeFriend",eventLabel:tags})}})}function updateFriendButton(broadcasterName,action){if(checkPerformerName(broadcasterName)){if("addFriend"==action)return void hideFriendApprovedAdd();"deleteFriends"===action?(showFriendApprovedAdd(),waitingApprove&&(waitingApprove.style.display="none")):showFriendFavoriteAdd()}}function addFriendFavoriteDomUpdate(actionCode){"addFriend"==actionCode?hideFriendApprovedAdd():hideFriendFavoriteAdd(),subscribeButton.style.display="none",unsubscribeButton.style.display="block"}function subscribeToUser(actionCode,username,page,subscribeButtonAction){Cam4User.isLoggedInAsGuest?Registration.activateGuestRegisterModal():($j("#NSReceiptSubscribeBtn").addClass("disabled"),$j.ajax({type:"POST",cache:!1,url:"/profiles/performerSubscribe",data:"action="+actionCode+"&username="+username,dataType:"text",success:function(showsCount){if(-1!=showsCount){if(showsCount){if(isNaN(showsCount))return;$j("#myAccountShowsCount").text(showsCount)}"add"==actionCode&&("superShow"==page?(subscribeButtonAction.hide(),subscribeButtonAction.next().show(),$j("#NSReceiptSubscribeBtn").addClass("disabled")):($j(".newProfileHeader #subscribeButton").hide(),$j(".newProfileHeader #unsubscribeButton").show()),Cam4User.isSubscribedToShow=function(){return!0},$j("#NSReceiptSubscribeBtn").html(js_i18n.unsubscribe),$j("#NSReceiptSubscribeBtn").attr("onclick","subscribeToUser('remove', '"+Cam4User.performerName+"')")),"remove"==actionCode&&("superShow"==page?(subscribeButtonAction.hide(),subscribeButtonAction.prev().show()):($j(".newProfileHeader #unsubscribeButton").hide(),$j(".newProfileHeader #subscribeButton").show()),Cam4User.isSubscribedToShow=function(){return!1},$j("#NSReceiptSubscribeBtn").html(js_i18n.subscribe),$j("#NSReceiptSubscribeBtn").attr("onclick","subscribeToUser('add', '"+Cam4User.performerName+"')")),$j("#NSReceiptSubscribeBtn").removeClass("disabled")}else generalSplash("/gold?overlay=1&pageVersion=initSignup")},error:function(jqXHR,textStatus,errorThrown){405==jqXHR.status&&$j("#subscribeMsg").dialog({autoOpen:!0,dialogClass:"confirm",position:"absolute",resizable:!1,height:90,width:270,zIndex:10004,buttons:{OK:function(){$j("#subscribeMsg").dialog("close")}}}),$j("#NSReceiptSubscribeBtn").removeClass("disabled")}}))}function addNewFriend(username,friendUsername){showGuestRegisterModal(),createCookie(friendUsername),ajaxCall("POST","/rest/v1.0/friends/"+username+"/"+friendUsername,"","addFriend","friend",friendUsername,handleShowFriendLimitModal)}function removeFriend(username,friendUsername){ajaxCall("DELETE","/rest/v1.0/friends/"+username+"/"+friendUsername,"","deleteFriends","friend",friendUsername,handleUserNotFound)}function handleShowFriendLimitModal(message){403===message.status&&""!==message.responseText&&"FRIEND_LIMIT_REACHED"===JSON.parse(message.responseText).status&&$("#friend-limit-reached").modal("show")}function handleUserNotFound(message){console.log(message)}function showGuestRegisterModal(){Cam4User.isLoggedInAsGuest&&Registration.activateGuestRegisterModal()}function createCookie(username){var life=Cam4Notifications.cookieLife||3,now=new Date,over=new Date(now.getFullYear(),now.getMonth(),now.getDay(),now.getHours()+life);Cam4Cookies.setCookie("favOnline-"+username,username,over)}function ajaxCall(callType,callUrl,callData,action,category,oppositeUser,errorFunc){$j.ajax({type:callType,cache:!1,url:callUrl,data:callData,success:function(){Cam4User.performerName==oppositeUser&&("deleteFriends"===action?(showFriendApprovedAdd(),showFriendFavoriteAdd(),waitingApprove&&(waitingApprove.style.display="none")):ffUpdate.update(action));var tags;tags="undefined"!=typeof Cam4Analytics?Cam4Analytics.getCurrentTags():"NA",dataLayer.push({event:"socialEvents",eventCategory:category,eventAction:action,eventLabel:tags})},error:function(err){errorFunc(err)}})}var ffUpdate={};ffUpdate.update=function(actionCode){addFriendFavoriteDomUpdate(actionCode)};var friendFavoriteRemove=document.getElementById("friendFavoriteRemove"),friendFavoriteAdd=document.getElementById("friendFavoriteAdd"),friendApprovedRemove=document.getElementById("friendApprovedRemove"),friendApprovedAdd=document.getElementById("friendApprovedAdd"),waitingApprove=document.getElementById("waitingApprove"),subscribeButton=document.getElementById("subscribeButton"),unsubscribeButton=document.getElementById("unsubscribeButton");$j("#superShowListingContainer").on("click",".sshow button",function(){subscribeToUser($j(this).data("action"),$j(this).data("username"),$j(this).data("page"),$j(this))});
var PlayerTranslate={animating:!1,barIsVisible:!1,animationFrames:10,currentState:"OFF",ON:"ON",OFF:"OFF",ASK:"ASK",ON_HIDDEN:"ON-HIDDEN",active:!1,initialValue:!1,fixBroadcastWindow:function(maximized){if(Cam4User.isBroadcastingWindow)try{maximized?window.resizeTo(900,730):window.resizeTo(900,680)}catch(ex){console.log(ex)}},useModalLayout:function(){return Cam4User.cameraData.useHlsVideoOnMobile},closeModal:function(event){event&&event.target&&"playerTranslateModal"===event.target.id&&PlayerTranslate.hideOptions()},animateIn:function(){if(Cam4User.isBroadcastingWindow&&$("#offerToTranslateMain a.btn").hide(),PlayerTranslate.useModalLayout())return document.getElementById("playerTranslateModal")||($j("#offerToTranslateMain").wrap('<div id="playerTranslateModal"></div>'),$j("#playerTranslateModal").click(function(event){PlayerTranslate.closeModal(event)})),$j("#playerTranslateModal").show(),$j("#offerToTranslateMain").show(),void(PlayerTranslate.barIsVisible=!0);if(!Cam4User.isBroadcaster()&&Cam4User.isViewer())return $j("#offerToTranslateMain").show(),PlayerTranslate.barIsVisible=!0,PlayerTranslate.fixBroadcastWindow(!0),void Overlays.closeAll();if(!PlayerTranslate.animating){PlayerTranslate.animating=!0,$j("#offerToTranslateMain").show();var tween=new Tween(0,100,PlayerTranslate.animationFrames);tween.onUpdate=function(value){var n=value/100;$j("#offerToTranslateMain").css({transform:"scale("+n+", "+n+")","-webkit-transform":"scale("+n+", "+n+")","-ms-transform":"scale("+n+", "+n+")","-moz-transform":"scale("+n+", "+n+")"})},tween.onComplete=function(){$j("#offerToTranslateMain").css({overflow:"visible",height:"auto",overflow:"visible",transform:"none","-ms-transform":"none","-webkit-transform":"none","-moz-transform":"none"}),PlayerTranslate.animating=!1,PlayerTranslate.barIsVisible=!0,Overlays.closeAll()},tween.start()}},animateOut:function(){if(PlayerTranslate.useModalLayout())return document.getElementById("playerTranslateModal")||($j("#offerToTranslateMain").wrap('<div id="playerTranslateModal"></div>'),$j("#playerTranslateModal").click(function(event){PlayerTranslate.closeModal(event)})),$j("#playerTranslateModal").hide(),$j("#offerToTranslateMain").hide(),void(PlayerTranslate.barIsVisible=!1);if(!Cam4User.isBroadcaster()&&Cam4User.isViewer())return $j("#offerToTranslateMain").hide(),PlayerTranslate.barIsVisible=!1,PlayerTranslate.fixBroadcastWindow(!1),void Overlays.closeAll();if(!PlayerTranslate.animating){PlayerTranslate.animating=!0,$j("#offerToTranslateMain").css({"margin-left":"auto","margin-right":"auto"});var tween=new Tween(100,0,PlayerTranslate.animationFrames);tween.onUpdate=function(value){var n=value/100;$j("#offerToTranslateMain").css({transform:"scale("+n+", "+n+")","-ms-transform":"scale("+n+", "+n+")","-webkit-transform":"scale("+n+", "+n+")","-moz-transform":"scale("+n+", "+n+")"})},tween.onComplete=function(){$j("#offerToTranslateMain").hide(),PlayerTranslate.animating=!1,PlayerTranslate.barIsVisible=!1,Overlays.closeAll()},tween.start()}},showOptions:function(){PlayerTranslate.animateIn()},turnOff:function(){PlayerTranslate.animateOut(),PlayerTranslate.active=!1,PlayerTranslate.showOriginalMessages=!1,PlayerTranslate.currentState=PlayerTranslate.OFF,Cam4Event.dispatch(Cam4Event.TRANSALTOR_UPDATE,{currentState:PlayerTranslate.currentState,language:PlayerTranslate.selectedLanguage}),PlayerTranslate.saveTranslationSettings()},hideOptions:function(){PlayerTranslate.animateOut(),PlayerTranslate.currentState=PlayerTranslate.ON_HIDDEN,Cam4Event.dispatch(Cam4Event.TRANSALTOR_UPDATE,{currentState:PlayerTranslate.currentState,language:PlayerTranslate.selectedLanguage})},dismissTranslation:function(){PlayerTranslate.animateOut(),JsSender.setTranslationSettings(JSON.stringify({showOriginalMessage:PlayerTranslate.showOriginalMessages,enableTranslation:!1,ask:!1,language:PlayerTranslate.selectedLanguage,showBar:!1})),PlayerTranslate.currentState=PlayerTranslate.OFF,Cam4Event.dispatch(Cam4Event.TRANSALTOR_UPDATE,{currentState:PlayerTranslate.currentState,language:PlayerTranslate.selectedLanguage})},initAskState:function(){JsSender.setTranslationSettings(JSON.stringify({showOriginalMessage:!0,enableTranslation:!1,ask:!0,language:PlayerTranslate.selectedLanguage,showBar:!0})),PlayerTranslate.setState(!0,PlayerTranslate.selectedLanguage,!0,!0,PlayerTranslate.showOriginalMessages)},setState:function(askMode,language,showBar,skipToggle,showOriginalMessage){if(PlayerTranslate.askState=askMode,showOriginalMessage&&(PlayerTranslate.showOriginalMessages=!0,$j("#offerToTranslateShowOriginal").prop("checked",!0)),skipToggle||(showBar?PlayerTranslate.animateIn():PlayerTranslate.animateOut()),PlayerTranslate.askState){PlayerTranslate.currentState=PlayerTranslate.ASK,$j("#offerToTranslateMsg").html(js_i18n.askTranslateChat),$j("#offerToTranslateShowOriginalWrap").hide();try{$("#translatorSelect").selectpicker("refresh")}catch(ex){console.log(ex)}$j("#offToTransHref").hide(),$j("#offToTransBtn").attr("onclick","PlayerTranslate.dismissTranslation();").show(),PlayerTranslate.setLanguageList(!0)}else PlayerTranslate.currentState=showBar?PlayerTranslate.ON:PlayerTranslate.ON_HIDDEN,$j("#offerToTranslateMsg").html(js_i18n.translateChat),PlayerTranslate.useModalLayout()?$j("#offerToTranslateShowOriginalWrap").css({display:"block"}):$j("#offerToTranslateShowOriginalWrap").css({display:"inline-block"}),$j("#offToTransHref").show(),$j("#offToTransBtn").attr("onclick","PlayerTranslate.hideOptions();").show(),PlayerTranslate.setLanguageList(!1);language&&!PlayerTranslate.askState&&(PlayerTranslate.selectedLanguage=language,Cam4User.isBroadcaster(),$("#translatorSelect").val(PlayerTranslate.selectedLanguage).selectpicker("refresh")),Cam4Event.dispatch(Cam4Event.TRANSALTOR_UPDATE,{askMode:askMode,language:language,showBar:showBar,skipToggle:skipToggle,currentState:PlayerTranslate.currentState,showOriginalMessage:showOriginalMessage})},updateState:function(showSaveAnimation){PlayerTranslate.active=!0;var animationSaved=$(".animationSaved");PlayerTranslate.showOriginalMessages=$j("#offerToTranslateShowOriginal")[0].checked,PlayerTranslate.selectedLanguage=$j("#translatorSelect option:selected").val(),Cam4User.isBroadcaster()&&showSaveAnimation&&(animationSaved.addClass("animate"),setTimeout(function(){animationSaved.removeClass("animate")},2e3)),PlayerTranslate.askState&&PlayerTranslate.setState(!1,PlayerTranslate.selectedLanguage,!0,!0,PlayerTranslate.showOriginalMessages)},selectedLanguage:Cam4User.lang,showOriginalMessages:!1,setLanguageList:function(showSelect){var selectHtml="";showSelect&&(selectHtml+='<option data-hidden="true" selected> '+js_i18n.selectLanguage+" </option>");for(var i in TranslationLanguages)selectHtml+='<option value="'+i+'">'+TranslationLanguages[i]+"</option>";$j("#translatorSelect").html(selectHtml),Cam4User.isBroadcaster()||showSelect?Cam4User.isBroadcaster()&&!showSelect&&$j("#translatorSelect").val(PlayerTranslate.selectedLanguage):$("#translatorSelect").val(PlayerTranslate.selectedLanguage),$("#translatorSelect").selectpicker("refresh")},getUserSettings:function(){$j.ajax({type:"GET",dataType:"json",contentType:"application/json; charset=utf-8",url:"/rest/v1.0/translationProfiles/"+Cam4User.userName,success:function(res){res?(PlayerTranslate.active=res.active,PlayerTranslate.initialValue=res.active,JsSender.setTranslationSettings(JSON.stringify({showOriginalMessage:res.showOriginalLanguage,enableTranslation:res.active,language:res.languageCode,ask:!1,showBar:!1}))):PlayerTranslate.initAskState()},error:function(err){console.log("translation err",err)}})},saveTranslationSettings:function(){$j.ajax({type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",url:"/rest/v1.0/translationProfiles/"+Cam4User.userName,data:JSON.stringify({active:PlayerTranslate.active,languageCode:PlayerTranslate.selectedLanguage,showOriginalLanguage:PlayerTranslate.showOriginalMessages}),success:function(res){JsSender.setTranslationSettings(JSON.stringify({showOriginalMessage:PlayerTranslate.showOriginalMessages,enableTranslation:PlayerTranslate.active,language:PlayerTranslate.selectedLanguage,ask:!1,showBar:!1}));var dataLayerEvent=PlayerTranslate.active?"translatorOn":"translatorOff";dataLayer.push({event:"cam4Translator",eventCategory:"cam4Translator",eventAction:dataLayerEvent,eventLabel:TranslationLanguages[PlayerTranslate.selectedLanguage]})},error:function(err){console.log("translation err",err)}})},turnOn:function(){PlayerTranslate.active&&PlayerTranslate.saveTranslationSettings(),PlayerTranslate.dismissTranslation()}};$j(document).ready(function(){if(Cam4User.isBroadcaster())$j("#translatorSelect").attr("onchange","PlayerTranslate.updateState(true); PlayerTranslate.saveTranslationSettings();"),$j("#offerToTranslateShowOriginal").attr("onchange","PlayerTranslate.updateState(true); PlayerTranslate.saveTranslationSettings();");else{try{$("#translatorSelect").selectpicker()}catch(ex){console.log(ex)}$("#translatorSelect").on("change",function(){PlayerTranslate.updateState()})}});
var PlayerNotification={opened:!0,initWidth:0,toggleArea:function(){PlayerNotification.opened?(0==PlayerNotification.initWidth&&(PlayerNotification.initWidth=$j("#NotificationBellArea .msg-contain").width()+3),$j("#NotificationBellArea .msg-contain div").css("visibility","hidden"),$j("#NotificationBellArea .msg-contain").animate({width:"0px"},1e3,function(){PlayerNotification.opened=!1,PlayerNotification.animateBellGlyph()})):$j("#NotificationBellArea .msg-contain").animate({width:PlayerNotification.initWidth+"px"},1e3,function(){PlayerNotification.opened=!0,$j("#NotificationBellArea .msg-contain div").css("visibility","visible"),PlayerNotification.animateBellGlyph()})},openModal:function(){var _url="/"+Cam4User.performerName+"/modal/playerFeatureNotification";Utils.popWithAjaxContent(_url)},animateBellGlyph:function(){PlayerNotification.BellGlyph||(PlayerNotification.BellGlyph=$j("#NotificationBellGlyph"),PlayerNotification.BellGlyph._animated=!1);var BellGlyph=PlayerNotification.BellGlyph;BellGlyph._animated||(BellGlyph._animated=!0,BellGlyph.animate({color:"#FC531D"},function(){BellGlyph.animate({color:"white"},function(){BellGlyph._animated=!1})}))}},NSHacks=NSHacks||{};NSHacks.transaltorInAsk=function(){JsReceiver.setTranslationSettings(JSON.stringify({ask:!0,enableTranslation:!0,language:"en",showOriginalMessage:!0,showBar:!0}))},NSHacks.transaltorOn=function(){JsReceiver.setTranslationSettings(JSON.stringify({ask:!1,enableTranslation:!0,language:"en",showOriginalMessage:!0}))};
var GoogleTrackNewShow={viewer:Cam4User.userName,performer:Cam4User.performerName,getPersonas:function(){return GoogleTrackNewShow.performer+":"+GoogleTrackNewShow.viewer},requestPrivateShow:function(){dataLayer.push({event:"Private Show",eventAction:"Request Private Show",eventValue:GoogleTrackNewShow.getPersonas()})},startPrivateShowWithCam2Cam:function(){dataLayer.push({event:"Private Show",eventAction:"Start Private Show with C2C",eventValue:GoogleTrackNewShow.getPersonas()})},startPrivateShow:function(){dataLayer.push({event:"Private Show",eventAction:"Start Private Show",eventValue:GoogleTrackNewShow.getPersonas()})},requestCam2Cam:function(){dataLayer.push({event:"Private Show",eventAction:"Request C2C",eventValue:GoogleTrackNewShow.getPersonas()})},stopPrivateShow:function(){dataLayer.push({event:"Private Show",eventAction:"End Private Show",eventValue:GoogleTrackNewShow.getPersonas()})},acceptPrivateShowFromPop:function(viewerName){viewerName&&(GoogleTrackNewShow.viewer=viewerName),dataLayer.push({event:"Private Show",eventAction:"Accept Private Show from Pop",eventValue:GoogleTrackNewShow.getPersonas()})},acceptCam2CamFromPop:function(viewerName){viewerName&&(GoogleTrackNewShow.viewer=viewerName),dataLayer.push({event:"Private Show",eventAction:"Accept Private Show with C2C from Pop",eventValue:GoogleTrackNewShow.getPersonas()})},acceptPrivateShowFromTable:function(viewerName){viewerName&&(GoogleTrackNewShow.viewer=viewerName),dataLayer.push({event:"Private Show",eventAction:"Accept Private Show from Request Table",eventValue:GoogleTrackNewShow.getPersonas()})},acceptCam2CamFromTable:function(viewerName){viewerName&&(GoogleTrackNewShow.viewer=viewerName),dataLayer.push({event:"Private Show",eventAction:"Accept Private Show with C2C from Request Table",eventValue:GoogleTrackNewShow.getPersonas()})}},StreamTrack=function(){function surveyTimeSpent(){function createTimeouts(index){times[index]&&(timeEventsAdded=!0,setTimeout(function(){var tags="NA";"undefined"!=typeof Cam4Analytics&&(tags=Cam4Analytics.getCurrentTags());var data="watchBroadcast"+times[index]+"Seconds";dataLayer.push({event:data,eventLabel:tags})},1e3*times[index]),createTimeouts(index+1))}if(Cam4User.isViewer()&&!timeEventsAdded){var times=[60,180,300,600,1800];createTimeouts(0)}}var timeEventsAdded=!1;Cam4Event.addEventListener(Cam4Event.VIEWER_STREAM_LOADED,function(args){surveyTimeSpent()})}();
var JsReceiver=JsReceiver||{};JsReceiver.playerInFs=!1;var FullScreenApi=function(){function exitFullScreen(){(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement)&&(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen())}function calculateAppHeight(){var nonPlayerDiv=$j("#privateShowContainer").height()+$j("#newTipAreaMain").height();return useBroadcasterFirebaseChat?nonPlayerDiv+=$j("#broadcastOpts").height()+$j("#newTippingBroadcaster").height():nonPlayerDiv+=$j("#playerOptionsBar").height(),screen.height-nonPlayerDiv}function playerGoFullScreen(){return!!FullScreenApi.init(document.getElementById("camPaneBig"))&&(ControlledFeatures&&ControlledFeatures.USE_JS_BROADCAST_SETTINGS||$j("#Cam4VChat").css({height:"100%",width:"100%"}),$j("#broadcastingApp").height(calculateAppHeight()),$(".chatlessPlayer, #video").length>0&&!JsReceiver.playerInFs&&chatlessGoFullscreen(),!0)}function setActive(_state){fullscreenLogic.currentState=_state}function toggleFullscreen(currentState){var aspectRatio=ChatlessPlayer.resolution.getAspectRatio();if("undefined"!=typeof VidyoConnector&&VidyoConnector&&VidyoConnector.isInitialized()||$(".chatlessPlayer object").removeAttr("style"),currentState==fullscreenLogic.states.theater)$("#toggleVideo").removeClass("glyphicon-arrow-right").addClass("glyphicon-arrow-left"),editElementsInRealFullscreen(),fullscreenDom.video.container.width($("#camPaneBig").height()*aspectRatio),fullscreenDom.video.vrWrapper.css({width:"100%",height:"100%"});else{fullscreenDom.mainContainer.removeClass("fullscreen"),fullscreenDom.mainContainer.addClass("theaterMode"),$("#toggleVideo").removeClass("glyphicon-arrow-left").addClass("glyphicon-arrow-right"),fullscreenDom.wrapper.removeClass("desktopFullscreenTheater"),setActive(fullscreenLogic.states.theater);var newHeightForObject,maxWidth=screen.width*maxWidthTehater,newWidth=fullscreenLogic.settings.video.width,newHeight=fullscreenLogic.settings.video.height;if(newWidth>=maxWidth&&(newWidth=maxWidth),newHeightForObject=Math.round(newWidth/aspectRatio),fullscreenDom.video.container.height(newHeight).width(newWidth),"undefined"==typeof VidyoConnector||!VidyoConnector||!VidyoConnector.isInitialized()){var topValue=(newHeight+fullscreenDom.video.offset-newHeightForObject-fullscreenDom.video.offset)/2;fullscreenDom.video.container.find("object").height(newHeightForObject).width(newWidth).css("top",topValue)}fullscreenDom.chat.container.css({"padding-left":newWidth}),fullscreenDom.wrapper.height("auto"),fullscreenDom.tippingElements.show(),fullscreenDom.chat.container.show()}Cam4Event.dispatch(Cam4Event.FULLSCREEN_STATE_CHANGED,fullscreenLogic.states),$(".newStreamControls").css({display:"inline-block"})}function addToggleButton(){fullscreenDom.video.container.prepend('<div id="toggleVideo" class="glyphicon glyphicon-arrow-right"></div>'),$("#toggleVideo").on("click",function(){toggleFullscreen(fullscreenLogic.currentState)})}function editElementsInRealFullscreen(){setActive(fullscreenLogic.states.fullscreen),fullscreenLogic.settings.video.height=fullscreenDom.video.container.height(),fullscreenLogic.settings.video.width=fullscreenDom.video.container.width(),fullscreenDom.tippingElements.hide(),fullscreenDom.chat.container.hide(),fullscreenDom.wrapper.height("100%"),fullscreenDom.video.container.height("100%"),fullscreenDom.mainContainer.addClass("fullscreen"),fullscreenDom.wrapper.addClass("desktopFullscreenTheater"),fullscreenDom.mainContainer.removeClass("theaterMode")}function checkForToolTip(){$("#videoControlsUpdateContainer").length&&$(".closeToolTip").click()}function goDirectlyFullscreen(aspectRatio){var totalHeight=screen.height,totalWidth=totalHeight*aspectRatio;totalWidth>screen.width&&(totalHeight=(totalWidth=screen.width)/aspectRatio),editElementsInRealFullscreen(),fullscreenDom.video.container.css({width:screen.width,height:screen.height}),fullscreenDom.video.container.find("object").css({width:totalWidth,height:totalHeight}),fullscreenDom.video.vrWrapper.css({width:"100%",height:"100%"})}function chatlessGoFullscreen(){if(initChatlessWidth=$(".chatlessPlayer").outerWidth(),initChatlessHeight=$(".chatlessPlayer").outerHeight(),Cam4User.langIsRTL())return $("#chat_main").hide(),void $(".chatlessPlayer").width("100%").height("100%");var aspectRatio=ChatlessPlayer.resolution.getAspectRatio(),offset=fullscreenDom.chat.containerHeader.outerHeight(),userListOffsets=offset+$(".userBar").outerHeight(),chatOffsets=offset+$(".fakechatbutton").outerHeight()+$("#tabsBar").outerHeight();fullscreenLogic.settings.video.styleReset.width=fullscreenDom.video.container.width(),fullscreenLogic.settings.video.styleReset.height=fullscreenDom.video.container.height(),fullscreenDom.video.container.removeAttr("style"),$(".chatlessPlayer > .ui-resizable-handle").hide(),$("#chat_main").css("padding-left",0);var newHeight;newHeight=useBroadcasterFirebaseChat?fullscreenDom.wrapper.height()-fullscreenDom.video.broadcasterOffset:Cam4User.cameraData.useHlsVideoOnMobile?fullscreenDom.wrapper.height():fullscreenDom.wrapper.height()-fullscreenDom.video.offset;var newHeightForObject,newWidth=Math.round(newHeight*aspectRatio);if(fullscreenLogic.states.directFullscreen)fullscreenDom.video.container.height(newHeight).width(newWidth);else{var maxWidth=screen.width*maxWidthTehater;if(newWidth>maxWidth&&(newWidth=maxWidth),newHeightForObject=Math.round(newWidth/aspectRatio),"undefined"==typeof VidyoConnector||!VidyoConnector||!VidyoConnector.isInitialized()){var topValue=(fullscreenDom.wrapper.height()-newHeightForObject-fullscreenDom.video.offset)/2;fullscreenDom.video.container.find("object").height(newHeightForObject).width(newWidth).css("top",topValue)}Cam4User.isBroadcastingWindow&&fullscreenDom.video.container.find("object").css("position","relative"),fullscreenDom.video.container.height(newHeight).width(maxWidth)}if(fullscreenDom.chat.container.css({"padding-left":maxWidth}),fullscreenDom.chat.chatMain.height("100%"),fullscreenDom.chat.fakechatDiv.find(".container").height(fullscreenDom.wrapper.height()-userListOffsets),fullscreenDom.chat.fakechatDiv.find("#tab1C").height(fullscreenDom.wrapper.height()-chatOffsets),fullscreenDom.chat.lists.height($("#tab2C").height()-$(".userBar").outerHeight()),fullscreenDom.chat.userList.height("100%"),fullscreenDom.chat.fakechatDiv.find(".chatPanel").css({"max-height":fullscreenDom.chat.fakechatDiv.find(".container").height()}),ControlledFeatures.USE_JS_BROADCAST_SETTINGS&&"undefined"!=typeof BroadcastSettings&&BroadcastSettings.resizeVideoClient(newHeight),ControlledFeatures.USE_NEW_VIDEO_CONTROLS_DESIGN){if(fullscreenLogic.states.directFullscreen){if(fullscreenLogic.currentState!=fullscreenLogic.states.fullscreen)return void goDirectlyFullscreen(aspectRatio);toggleFullscreen(fullscreenLogic.currentState)}}else addToggleButton();setActive(fullscreenLogic.states.theater)}function chatlessExitFullscreen(){if(fullscreenLogic.states.directFullscreen=!1,"none"!==fullscreenDom.video.container.find("object").css("display")&&fullscreenDom.video.container.find("object").removeAttr("style"),$("#tipBottomContainer").show(),Cam4User.langIsRTL())return $("#chat_main").show(),void $(".chatlessPlayer").width(initChatlessWidth).height(initChatlessHeight);$("#camPaneBig").removeClass("fullscreen"),fullscreenDom.mainContainer.removeClass("theaterMode"),UserAgent.phone||fullscreenDom.tippingElements.show(),fullscreenDom.chat.container.show(),fullscreenDom.video.container.css({height:fullscreenLogic.settings.video.styleReset.height,width:fullscreenLogic.settings.video.styleReset.width}),fullscreenDom.chat.container.css({"padding-left":fullscreenLogic.settings.video.styleReset.width,height:""}),fullscreenDom.wrapper.removeClass("desktopFullscreenTheater"),fullscreenDom.chat.fakechatDiv.find(".container, .chatPanel").css("height",""),fullscreenDom.chat.lists.removeAttr("style"),fullscreenDom.chat.userList.removeAttr("style"),fullscreenDom.chat.fakechatDiv.height(""),setActive(fullscreenLogic.states.regular),$("#toggleVideo").remove(),$(".chatlessPlayer > .ui-resizable-handle").show(),ControlledFeatures&&ControlledFeatures.USE_JS_BROADCAST_SETTINGS&&!Cam4User.isViewer()||$("#chat_main").css("padding-left","10px"),fullscreenDom.chat.fakechatDiv.find(".chatPanel").removeAttr("style"),$("#tab1").click(),ChatlessPlayer.resize.updateChat(),ControlledFeatures&&ControlledFeatures.USE_JS_BROADCAST_SETTINGS&&"undefined"!=typeof BroadcastSettings&&BroadcastSettings.resizeVideoClient()}function playerStyleReset(){$(".chatlessPlayer").length>0&&JsReceiver.playerInFs&&chatlessExitFullscreen(),$j("#broadcastingApp").height("auto")}function playerExitFullScreen(){($(".chatlessPlayer").length>0||JsReceiver.playerInFs)&&exitFullScreen(),playerStyleReset()}function fullScreenStateChangedHandler(args){!(isInFullScreen=!isInFullScreen)&&JsReceiver.playerInFs&&!$(".chatlessPlayer").length>0&&playerStyleReset(),args.isInFullScreen=isInFullScreen,Cam4Event.dispatch(Cam4Event.FULL_SCREEN_CHANGED,args)}var REQUEST_FULLSCREEN_FUNCS={requestFullscreen:{change:"onfullscreenchange",request:"requestFullscreen",error:"onfullscreenerror",enabled:"fullscreenEnabled",cancel:"exitFullscreen",fullScreenElement:"fullscreenElement"},mozRequestFullScreen:{change:"onmozfullscreenchange",request:"mozRequestFullScreen",error:"onmozfullscreenerror",cancel:"mozCancelFullScreen",enabled:"mozFullScreenEnabled",fullScreenElement:"mozFullScreenElement"},webkitRequestFullScreen:{change:"onwebkitfullscreenchange",request:"webkitRequestFullScreen",cancel:"webkitCancelFullScreen",error:"onwebkitfullscreenerror",fullScreenElement:"webkitCurrentFullScreenElement"},MSRequestFullScreen:{change:"MSFullscreenChange",request:"MSRequestFullScreen",cancel:"MSCancelFullScreen",error:"MSFullscreenError",fullScreenElement:"MSCurrentFullScreenElement"},msRequestFullScreen:{change:"msFullscreenChange",request:"msRequestFullscreen",cancel:"msExitFullscreen",error:"msFullscreenError",fullScreenElement:"msCurrentFullScreenElement"}},TEST_NODE=document.createElement("div"),fullScreenMethods=!1;for(var prop in REQUEST_FULLSCREEN_FUNCS){var currentTest=REQUEST_FULLSCREEN_FUNCS[prop];for(var item in currentTest){var name=currentTest[item];document[name]&&(fullScreenMethods||(fullScreenMethods={}),fullScreenMethods[item]=name),TEST_NODE[name]&&(fullScreenMethods||(fullScreenMethods={}),fullScreenMethods[item]=name),name in TEST_NODE&&(fullScreenMethods||(fullScreenMethods={}),fullScreenMethods[item]=name),name in document&&(fullScreenMethods||(fullScreenMethods={}),fullScreenMethods[item]=name)}}var fullscreenLogic={currentState:"regular",states:{regular:"regular",theater:"theater",fullscreen:"fullscreen",directFullscreen:!1},settings:{video:{height:$(".chatlessPlayer").height(),width:$(".chatlessPlayer").width(),styleReset:{width:"",height:""}}}},fullscreenDom={wrapper:$("#broadcastingApp"),mainContainer:$("#camPaneBig"),video:{container:$(".chatlessPlayer"),offset:$(".player-header").outerHeight(),broadcasterOffset:$("#brStatBar").outerHeight(),vrWrapper:$("#vr-wrapper")},chat:{container:$("#containerFirebase"),chatMain:$("#chat_main"),fakechatDiv:$("#fakechatDiv"),containerHeader:$(".containerHeader"),lists:$("#lists"),userList:$(".infoUsersBar")},tippingElements:$("#privateShowContainer, #tDiv, #newTippingViewer")},maxWidthTehater=.65;$(".completeFullscreen").on("click",function(){Cam4User.isLoggedIn&&(Cam4User.isPayingMember()||void 0!==Cam4User.userFeatures.C4BND_FULL_SCREEN)||ControlledFeatures.GOLD_FREE_FEATURES?fullscreenLogic.currentState==fullscreenLogic.states.theater?$(".newStreamControls").hide("fast",function(){toggleFullscreen(fullscreenLogic.currentState)}):fullscreenLogic.currentState==fullscreenLogic.states.fullscreen?playerExitFullScreen():(fullscreenLogic.states.directFullscreen=!0,checkForToolTip(),playerGoFullScreen()):Registration.showGoldUpgradeOverlay("theater-mode")}),$(".theatre").on("click",function(){Cam4User.isLoggedIn&&(Cam4User.isPayingMember()||Cam4User.isBroadcastingWindow||void 0!==Cam4User.userFeatures.C4BND_FULL_SCREEN)||ControlledFeatures.GOLD_FREE_FEATURES?fullscreenLogic.currentState==fullscreenLogic.states.theater?playerExitFullScreen():fullscreenLogic.currentState==fullscreenLogic.states.fullscreen?$(".newStreamControls").hide("fast",function(){toggleFullscreen(fullscreenLogic.currentState)}):(fullscreenDom.mainContainer.addClass("theaterMode"),checkForToolTip(),playerGoFullScreen()):Registration.showGoldUpgradeOverlay("theater-mode")});var initChatlessWidth=$(".chatlessPlayer").width(),initChatlessHeight=$(".chatlessPlayer").height(),isInFullScreen=!1;return fullScreenMethods&&(document[fullScreenMethods.change]=fullScreenStateChangedHandler,void 0===fullScreenMethods.change&&"Explorer"==BrowserDetect.browser&&document.addEventListener("MSFullscreenChange",function(){fullScreenStateChangedHandler()},!1)),{init:function(domElement){return domElement.requestFullscreen?($(".chatlessPlayer").length&&$("#tipBottomContainer").hide(),domElement.requestFullscreen(),!0):domElement.msRequestFullscreen?(domElement.msRequestFullscreen(),fullScreenMethods||(fullScreenMethods={request:"msRequestFullscreen"}),!0):domElement.mozRequestFullScreen?(domElement.mozRequestFullScreen(),!0):!!domElement.webkitRequestFullscreen&&(domElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT),!0)},exitFullScreen:exitFullScreen,methods:fullScreenMethods,playerGoFullScreen:playerGoFullScreen,playerExitFullScreen:playerExitFullScreen,playerStyleReset:playerStyleReset,updateUIinFullScreen:function(aspectRatio,widthWhenExitFS){var newWidth=Math.round(fullscreenDom.video.container.height()*aspectRatio);fullscreenDom.video.container.width(newWidth),fullscreenDom.chat.container.css({"padding-left":newWidth,height:"100%"}),fullscreenLogic.settings.video.styleReset.width=widthWhenExitFS},chatlessExitFullscreen:chatlessExitFullscreen,getState:function(){return fullscreenLogic.currentState}}}(),mobileFullScreenAPI=function(){var Orientation,isPhone;return{init:function(){function getHeights(){winH=$j(window).innerHeight(),videoH=$j("#video").outerHeight(),containerHeaderH=$j(".containerHeader").outerHeight(),fakechatbuttonH=$j(".fakechatbutton").outerHeight(),tabsBarH=$j("#tabsBar").height(),privateShowContainerH=$j("#privateShowContainer").outerHeight(),innerTubeViewerH=$j("#innerTubeViewer").outerHeight(),broadcastingApp=$j("#broadcastingApp").height(),newTippingViewer=$j("#newTippingViewer").height()}function setLandscape(){setTimeout(function(){if(getHeights(),isPhone){var video=$j("#video");video.css("padding-bottom",winH),video.width(1.4*video.outerHeight()).css("margin","0 auto"),$j("body").css("overflow-y","hidden"),$j("#fakechatDiv .container").height("")}else{$j("#fakechatDiv .container").height(videoH-containerHeaderH-fakechatbuttonH-tabsBarH),getHeights();var diffH=broadcastingApp+privateShowContainerH+newTippingViewer;$j("#broadcastingApp").css("margin-top",(winH-diffH)/2)}},100)}function setPortrait(){$j("body").css("overflow-y","hidden"),Window.scrollTop(0),setTimeout(function(){getHeights(),isPhone?($j("#video").css({padding:"",width:""}),Utils.verticalAlign($(window),$("#video")),getHeights(),"block"==$j("#dropDownPrivateMessage").css("display")?$j("#fakechatDiv .container").height(winH-videoH-fakechatbuttonH-innerTubeViewerH-$j("#dropDownPrivateMessage").outerHeight(!0)):$j("#fakechatDiv .container").height(winH-videoH-fakechatbuttonH-innerTubeViewerH)):($j("#tippingButtonsMd").show().insertAfter($j("#sendTipAreaMd")),$j("#broadcastingApp").css("margin-top","0"),$j("#fakechatDiv .container").height(winH-videoH-fakechatbuttonH-tabsBarH-privateShowContainerH))},100)}Orientation=window.matchMedia("(orientation: portrait)");var Device=window.matchMedia("(max-width: 727px)"),Window=$j(window);isPhone=Device.matches?1:0,Orientation.matches?setPortrait():setLandscape(),0!=$j("#btn-fs-mobile").length?$j("#btn-fs-mobile").show():0==isPhone&&$j("#video").append('<a id="btn-fs-mobile" class="nopop fullscreen" onclick="mobileFullScreenAPI.toggleFullScreen();"></a>'),Window.scrollTop(0);var videoH,winH,fakechatbuttonH,tabsBarH,containerHeaderH,privateShowContainerH,innerTubeViewerH,broadcastingApp,newTippingViewer;return Orientation.addListener(function(m){1==mobileFullScreenAPI.inFullScreen&&(m.matches?setPortrait():setLandscape())}),!0},goFullScreen:function(){return!!$j("#camPaneBig")&&(Utils.verticalAlign($(window),$("#video")),$j("#camPaneBig").addClass("mobileFullScreen"),$j("#content").css("position","static"),$j("body").css("overflow-y","hidden"),$j("#firebasePrivateShow, #firebaseGroupShow, #firebaseReturningIn, #errorBanned#errorKicked, .errorMessage").css("position","absolute"),!0)},inFullScreen:!1,toggleFullScreen:function(){mobileFullScreenAPI.inFullScreen?mobileFullScreenAPI.exitFullScreen():"block"==$j("#video").css("display")&&(mobileFullScreenAPI.inFullScreen=!0,mobileFullScreenAPI.goFullScreen(),mobileFullScreenAPI.init())},exitFullScreen:function(){void 0!==mobileFullScreenAPI.inFullScreen&&!0===mobileFullScreenAPI.inFullScreen&&(mobileFullScreenAPI.resetStyle(),mobileFullScreenAPI.inFullScreen=!1)},resetStyle:function(){setTimeout(function(){if($j("#btn-fs-mobile").hide(),$j("#video").css({padding:"",margin:"",width:""}),$j("#content").css("position","relative"),$j("body").css("overflow-y","auto"),$j("#broadcastingApp").css("margin","0"),$j("#fakechatDiv .container").css("height",""),$j("#camPaneBig").removeClass("mobileFullScreen"),!isPhone){var tipping=$j("#tippingButtonsMd");tipping.insertBefore($j("#liveHelpButton")),tipping.css({"line-height":"20px"})}},100)}}}();$j(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",function(){JsReceiver.playerInFs?(FullScreenApi.playerExitFullScreen(),mobileFullScreenAPI.exitFullScreen(),JsReceiver.playerInFs=!1):JsReceiver.playerInFs=!0}),Cam4Event.addEventListener(Cam4Event.MODAL_OPENED,function(){FullScreenApi.playerExitFullScreen(),mobileFullScreenAPI.exitFullScreen(),console.log("modal opened, exiting fullscreen")});
var ImageGallery=function(){function checkImageSize(inputName,maxSize){maxSize||(maxSize=Cam4User.maxImageSize?Cam4User.maxImageSize:52e4);var input,sizeOK=!0;try{if(window.FileReader)return input=document.getElementById(inputName),input.files[0].size>maxSize&&(sizeOK=!1),sizeOK}catch(err){console.warn("Error checking image size : ",err)}}return{goToFanclub:function(){window.location="/"+Cam4User.profileName+"/edit/images?imageType=fanclub"},goToProfile:function(){window.location="/"+Cam4User.profileName+"/edit/images?imageType=profile"},setupImage:function(item,imageId){$j("#imageSetupForm #imageId").val(imageId),$j("#imageListManage .img-wrap").css("background","none");$j(item).css("background","#D9D9D9");var imgSrc=$j(item).find("img").attr("src");$j("#imgPreview").css({background:"url("+imgSrc+") no-repeat scroll center center transparent","background-size":"contain"})},checkForm:function(){return checkImageSize("fileInput")},checkImageSize:checkImageSize}}();$j(function(){function fanclubPage(){$j("#setMainProfileImg, #hasNudityProfileImg, #nudityComment").hide(),$j("#hashTag").selectpicker("hide"),$j("#imageSelectionType").val("fanclub").selectpicker("refresh")}function profilePage(){$j("#setMainProfileImg, #hasNudityProfileImg, #nudityComment").show(),$j("#hashTag").selectpicker("show")}$j("#hashTag").on("change",function(){""!==$j("#hashTag").val()&&$j("#label").val($j("#label").val()+" "+$j("#hashTag").val()+" ")}),!Cam4User.hasProfileImages&&(Cam4User.htmlStates.indexOf("image_ftl_profile")>-1||Cam4User.htmlStates.indexOf("image_ftl")>-1)&&$j("#imageSetupForm .btn").attr("disabled","true"),Cam4User.htmlStates.indexOf("image_ftl_fanclub")>-1&&(fanclubPage(),Cam4User.hasFanClubImages||$j("#imageSetupForm .btn").attr("disabled","true")),$("#imageSelectionType").on("change",function(){var selection=$(this).val();console.log(selection),"fanclub"===selection?fanclubPage():profilePage()})});
function trim1(str){return str.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}var Kicksend={mailcheck:{threshold:3,defaultDomains:["yahoo.com","google.com","gmail.com","me.com","aol.com","mac.com","comcast.net","googlemail.com","msn.com","hotmail.co.uk","yahoo.co.uk","facebook.com","verizon.net","sbcglobal.net","att.net","gmx.com","mail.com","hotmail.co.il","hotmail.co.jp","hotmail.com","hotmail.com.ar","hotmail.com.br","hotmail.com.tr","hotmail.co.th","hotmail.co.uk","hotmail.de","hotmail.es","hotmail.it","hotmail.jp","hotmail.se","live.at","live.be","live.ca","live.cl","live.cn","live.co.kr","live.com","live.com.ar","live.com.au","live.com.mx","live.com.my","live.com.sg","live.co.za","live.de","live.dk","live.fr","live.hk","live.ie","live.in","live.it","live.jp","live.nl","live.no","live.ru","live.se","msnhotmail.com","yahoo.com.ar","yahoo.com.au","yahoo.at","yahoo.be","yahoo.com.br","yahoo.ca","yahoo.ca","yahoo.com.cn","yahoo.cz","yahoo.dk","yahoo.fi","yahoo.fr","yahoo.de","yahoo.gr","yahoo.com.hk","yahoo.co.in","yahoo.com","yahoo.ie","yahoo.co.il","yahoo.it","yahoo.co.jp","yahoo.co.kr","yahoo.com.my","yahoo.com.mx","yahoo.ae","yahoo.nl","yahoo.co.nz","yahoo.no","yahoo.com.ph","yahoo.pl","yahoo.pt","yahoo.ro","yahoo.ru","yahoo.com.sg","yahoo.co.za","yahoo.es","yahoo.se","yahoo.ch","yahoo.ch","yahoo.com.tw","yahoo.co.th","yahoo.com.tr","yahoo.co.uk","yahoo.com","yahoo.com.vn"],defaultTopLevelDomains:["co.uk","com","net","org","info","de"],run:function(opts){opts.domains=opts.domains||Kicksend.mailcheck.defaultDomains,opts.topLevelDomains=opts.topLevelDomains||Kicksend.mailcheck.defaultTopLevelDomains,opts.distanceFunction=opts.distanceFunction||Kicksend.sift3Distance;var result=Kicksend.mailcheck.suggest(encodeURI(opts.email),opts.domains,opts.topLevelDomains,opts.distanceFunction);result?opts.suggested&&opts.suggested(result):opts.empty&&opts.empty()},suggest:function(email,domains,topLevelDomains,distanceFunction){email=email.toLowerCase();var emailParts=this.splitEmail(email),closestDomain=this.findClosestDomain(emailParts.domain,domains,distanceFunction);if(closestDomain){if(closestDomain!=emailParts.domain)return{address:emailParts.address,domain:closestDomain,full:emailParts.address+"@"+closestDomain}}else{var closestTopLevelDomain=this.findClosestDomain(emailParts.topLevelDomain,topLevelDomains);if(emailParts.domain&&closestTopLevelDomain&&closestTopLevelDomain!=emailParts.topLevelDomain){var domain=emailParts.domain;return closestDomain=domain.substring(0,domain.lastIndexOf(emailParts.topLevelDomain))+closestTopLevelDomain,{address:emailParts.address,domain:closestDomain,full:emailParts.address+"@"+closestDomain}}}return!1},findClosestDomain:function(domain,domains,distanceFunction){var dist,minDist=99,closestDomain=null;if(!domain||!domains)return!1;distanceFunction||(distanceFunction=this.sift3Distance);for(var i=0;i<domains.length;i++){if(domain===domains[i])return domain;(dist=distanceFunction(domain,domains[i]))<minDist&&(minDist=dist,closestDomain=domains[i])}return minDist<=this.threshold&&null!==closestDomain&&closestDomain},sift3Distance:function(s1,s2){if(null==s1||0===s1.length)return null==s2||0===s2.length?0:s2.length;if(null==s2||0===s2.length)return s1.length;for(var c=0,offset1=0,offset2=0,lcs=0;c+offset1<s1.length&&c+offset2<s2.length;){if(s1.charAt(c+offset1)==s2.charAt(c+offset2))lcs++;else{offset1=0,offset2=0;for(var i=0;i<5;i++){if(c+i<s1.length&&s1.charAt(c+i)==s2.charAt(c)){offset1=i;break}if(c+i<s2.length&&s1.charAt(c)==s2.charAt(c+i)){offset2=i;break}}}c++}return(s1.length+s2.length)/2-lcs},splitEmail:function(email){var parts=email.split("@");if(parts.length<2)return!1;for(i=0;i<parts.length;i++)if(""===parts[i])return!1;var domain=parts.pop(),domainParts=domain.split("."),tld="";if(0==domainParts.length)return!1;if(1==domainParts.length)tld=domainParts[0];else{for(var i=1;i<domainParts.length;i++)tld+=domainParts[i]+".";domainParts.length>=2&&(tld=tld.substring(0,tld.length-1))}return{topLevelDomain:tld,domain:domain,address:parts.join("@")}}}};window.jQuery&&(jQuery.fn.mailcheck=function(opts){var self=this;if(opts.suggested){var oldSuggested=opts.suggested;opts.suggested=function(result){oldSuggested(self,result)}}if(opts.empty){var oldEmpty=opts.empty;opts.empty=function(){oldEmpty.call(null,self)}}opts.email=trim1(this.val()),Kicksend.mailcheck.run(opts)});
var NetVerify={callbackCheckRate:1e4,initiationDelay:3e4,cbCheckTimeout:null,cbCheckInitiated:!1,popUpStyles:{position:"fixed",left:"0px",top:"0px",background:"#FFFFFF",width:"100%",height:"100%",border:"0px","z-index":"1000",display:"block !important",visibility:"visible !important"},netVerifyUrl:"/netverifyNotification",notificationId:"#netVerifyNotification",viewerNotification:"",toggleAgeCheckNotification:function(showNotification){if(1==showNotification)$j.ajax({url:NetVerify.netVerifyUrl,type:"GET",success:function(data){try{$j("#innerTube").hide(),$j("#newTippingBroadcaster").hide()}catch(ex){console.log(ex)}$j(NetVerify.notificationId).html(data),$j(NetVerify.notificationId).show(),$j(NetVerify.notificationId+" input[name=scanStatus]").length>0&&"PENDING"==$j(NetVerify.notificationId+" input[name=scanStatus]").val()&&NetVerify.initiatePendingState()},error:function(err){console.log(err)}});else try{$j(NetVerify.notificationId).hide(),$j("#innerTube").show(),$j("#newTippingBroadcaster").show()}catch(ex){console.log(ex)}},showViewerNotification:function(toggle){if(!$j(".profileCamWrap").hasClass("player-chat")){var notifId="#"+$j(NetVerify.viewerNotification).attr("id");toggle?(0==$j(notifId).length?$j(".profileCamWrap").hasClass("firebase-chat")&&($j("#broadcastingApp .chatlessPlayer").prepend(NetVerify.viewerNotification),$j(notifId).show()):$j(notifId).show(),$j(notifId).show()):$j(notifId).hide()}},callbackCheck:function(){var url=NetVerify.netVerifyUrl+"?scanStatus="+$j(NetVerify.notificationId+" input[name=scanStatus]").val();$j.ajax({type:"GET",url:url,success:function(res){if("PENDING"!=res.trim())switch($j(NetVerify.notificationId).html(res),$j(NetVerify.notificationId+" input[name=scanStatus]").val()){case"PENDING":setTimeout(function(){NetVerify.callbackCheck()},NetVerify.callbackCheckRate);break;case"SUCCESS":case"DUPLICATE":case"ERROR":NetVerify.cbCheckInitiated=!1}else setTimeout(function(){NetVerify.callbackCheck()},NetVerify.callbackCheckRate)},error:function(err){console.log(err)}})},initiatePendingState:function(){NetVerify.cbCheckInitiated=!1,NetVerify.cbCheckTimeout=setTimeout(function(){NetVerify.callbackCheck(),NetVerify.cbCheckInitiated=!0},NetVerify.initiationDelay)},initiateAgeVerification:function(){Utils.popWithAjaxContent("/netverify",NetVerify.popUpStyles,!0,function(){try{$j("#Cam4DialogContainer iframe").hide(),$j("#Cam4DialogContainer iframe").show()}catch(ex){console.error(ex)}}),NetVerify.cbCheckInitiated||NetVerify.initiatePendingState()}};
var $j=jQuery,TwitterOverlay={init:function(){TwitterOverlay.inputArea.currentText=TwitterOverlay.data.defaultTxt.prefix+TwitterOverlay.data.defaultTxt.suffix[0]+"http://"+window.location.host+"/"+TwitterOverlay.data.userName,$j("#options .innerTube ul li a").click(function(){$j(this).hasClass("tweet")||($j(".twitter-overlay").is(":visible")&&$j(".twitter-overlay").hide(),$j("#options .innerTube ul li a.tweet").removeClass("active"))}),$j("#twitterMedia").on("change",function(){TwitterOverlay.displayFileName()}),$j("#triggerFileUpload").on("click",function(){$("#twitterMedia").trigger("click")})},data:{defaultTxt:{prefix:"#CAM4",suffix:["I'm live on "]}},triggerTwitter:function(userId){$j(".overlayWrap").hide();var menuItems=$j("#options .innerTube ul li a");$("#twitterMedia").val(""),$("#twitterFileSelected").text(""),menuItems.not("#liveHelp, #contactSupport").removeAttr("style"),Overlays.closeAll();var twitterButton=menuItems.filter(".tweet");twitterButton.hasClass("active")?(twitterButton.removeClass("active"),TwitterOverlay.closeTwitterWindow()):(twitterButton.addClass("active"),TwitterOverlay.openTwitterWindow(userId))},displayFileName:function(){var fileName=document.getElementById("twitterMedia").files[0].name;$("#twitterFileSelected").text(fileName)},closeTwitterWindow:function(){$j(".overlayWrap").hide(),TwitterOverlay.inputArea.click(),$j("#options .innerTube ul li a.tweet").removeClass("active")},openTwitterWindow:function(userId){$j.ajax({url:TwitterOpts.urlHandler+"?act=opentweet",dataType:"json",cache:!1,success:function(result,status,xhr){var defaultTweetTxt=TwitterOverlay.inputArea.currentText;"true"==result.connected?(result.defaultTweetTxt&&(TwitterOverlay.inputArea.currentText=result.defaultTweetTxt,defaultTweetTxt=result.defaultTweetTxt),$j("#twitterMessage").val(defaultTweetTxt),$j("#fakeTweetText").html(""),$j("#twitterOverlayConnected .overlay .overlay-footer .error").html(""),$j("#twitterOverlayConnected .overlay .overlay-header em").html(140-defaultTweetTxt.length),$j("#btnSendTweet").removeClass("disabled").addClass("blue").html("").html("Send Tweet").removeAttr("disabled"),$j("#twitterMessage").removeAttr("disabled"),$j("#twitterOverlayConnected").show(),$j("#twitterOverlayConnected .overlay").show()):($j("#twitterOverlayUnconnected").show(),$j("#twitterOverlayUnconnected .overlay").show())},error:function(err,status,xhr){alert("There was error while connecting to the server.")}})},connectToTwitter:function(userId){var connectURL=TwitterOpts.urlHandler+"?act=connect";window.open(connectURL,"_blank","height=200,width=400",!1)},sendTwitterMessage:function(userId){var m=$j("#twitterMessage").val(),twitterData=new FormData,filesElement=document.getElementById("twitterMedia");filesElement&&$j.each(filesElement.files,function(i,file){twitterData.append("file-"+i,file)}),twitterData.append("act","sendtweet"),twitterData.append("message",m),$j.ajax({url:TwitterOpts.urlHandler+"?act=sendtweet",data:twitterData,cache:!1,contentType:!1,processData:!1,dataType:"json",type:"POST",success:function(result){if($("#twitterMedia").val(""),$("#twitterFileSelected").text(""),"success"==result.statusTweet)$j("#btnSendTweet").attr("disabled","disabled").removeClass("blue").addClass("disabled").html("Tweet Sent!"),$j("#twitterMessage").val("").attr("disabled","disabled"),setTimeout(function(){$j("#btnSendTweet").removeClass("disabled").addClass("blue").html("Send Tweet").removeAttr("disabled"),$j("#twitterMessage").removeAttr("disabled")},1e4);else{var censoredWords=[];if(void 0!==result.censoredWords[0]&&result.censoredWords[0].length>0){var markedTxt=TwitterOverlay.inputArea.currentText;for(var i in result.censoredWords[0])if(result.censoredWords[0].hasOwnProperty(i)){censoredWords.push('"'+result.censoredWords[0][i]+'"');var regex=new RegExp(result.censoredWords[0][i].toString().escapeRegEx(),"g");markedTxt=markedTxt.replace(regex,"<em>"+result.censoredWords[0][i]+"</em>")}$j("#fakeTweetText").html(markedTxt),$j("#twitterMessage").addClass("transparent")}"CENSORED_WORDS_FOUND"==result.error[0]&&$j("#twitterOverlayConnected .overlay .overlay-footer .error").html(TwitterOverlay.data.wordsNotAllowed+" "+censoredWords.join(","))}}})},inputArea:{currentText:"",click:function(event){return""!==$j("#fakeTweetText").html()&&$j("#fakeTweetText").html(""),""!==$j("#twitterOverlayConnected .overlay .overlay-footer .error").html()&&$j("#twitterOverlayConnected .overlay .overlay-footer .error").html(""),$j("#twitterMessage").hasClass("transparent")&&$j("#twitterMessage").removeClass("transparent"),TwitterOverlay.inputArea.preventCam4(),0},keyUp:function(event){return TwitterOverlay.inputArea.preventCam4(),1},keyDown:function(event){if(TwitterOverlay.inputArea.currentText=$j("#twitterMessage").val(),1===TwitterOverlay.inputArea.preventCam4()){event.preventDefault&&event.preventDefault();try{event.returnValue=!1}catch(ex){}}},change:function(event){TwitterOverlay.inputArea.preventCam4()},preventCam4:function(){var pre=TwitterOverlay.data.defaultTxt.prefix,wordLength=$j("#twitterMessage").val().length;return 140-wordLength>=0?$j("#twitterOverlayConnected .overlay .overlay-header em").html(140-wordLength):$j("#twitterOverlayConnected .overlay .overlay-header em").html("0"),0!==$j("#twitterMessage").val().indexOf(pre)&&($j("#twitterMessage").val()<pre?TwitterOverlay.inputArea.currentText=pre:TwitterOverlay.inputArea.currentText=pre+TwitterOverlay.inputArea.currentText,$j("#twitterMessage").val(TwitterOverlay.inputArea.currentText)),$j("#twitterMessage").val().length>140?($j("#twitterMessage").val($j("#twitterMessage").val().substring(0,140)),TwitterOverlay.inputArea.currentText=$j("#twitterMessage").val(),1):0}}},TwitterOpts={urlHandler:"/social/twitterHandler"},TwitterResponse={handler:function(){return 0}},TwitterConnect={userName:Cam4User.userName,twitterHandlerUrl:"/social/twitterHandler",limitTextCount:function(limitField_id,limitCount_id,limitNum){var limitField=document.getElementById(limitField_id),limitCount=document.getElementById(limitCount_id),fieldLEN=limitField?limitField.value.length:106;fieldLEN>limitNum?limitField&&(" "==limitField.value.substr(limitField.value.length-1)&&(limitField.value=limitField.value.substring(0,limitField.value.length-1)),limitField.value=limitField.value.substring(0,limitNum),fieldLEN=limitField.value.length,limitCount.innerHTML=fieldLEN+"/"+limitNum):limitCount&&(limitCount.innerHTML=fieldLEN+"/"+limitNum)},checkBoxInputClick:function(itemId){var item=document.getElementById(itemId);item.checked?item.setAttribute("value","checked"):item.setAttribute("value","unchecked")},checkBoxCustomMessage:function(itemId){var item=document.getElementById(itemId);item.checked?(item.setAttribute("value","checked"),$("#tweetCustomText").attr("readonly",!1)):(item.setAttribute("value","unchecked"),$("#tweetCustomText").attr("readonly",!0))},disconnectFromTwitter:function(userId){$j.ajax({url:TwitterConnect.twitterHandlerUrl+"?act=disconnect",cache:!1,success:function(){window.location.href=window.location.href.split("?")[0]+"?reload="+Math.random()+"&"+$j("#affiliateReferer").val()}})},connectToTwitter:function(userId){var connectURL=TwitterConnect.twitterHandlerUrl+"?act=connect";window.open(connectURL,"_blank","height=200,width=400",!1)}};$j(document).ready(TwitterConnect.limitTextCount("tweetCustomText","twCharLeft",106));
var Disclaimer=function(){function hideGenderSelection(){$(".mb-15, #whattowatch").hide()}function setActiveMenuTabCallback(){1===filterValues.length&&(-1!==filterValues.indexOf("shemale")?$("#headerMenuMainUL a#shemale-tab").addClass("active"):-1!==filterValues.indexOf("male")?$("#headerMenuMainUL a#male-tab").addClass("active"):-1!==filterValues.indexOf("female")&&$("#headerMenuMainUL a#female-tab").addClass("active"))}var filterValues,disclaimerBeingShown=!1,disclaimerModalContainer=document.getElementById("disclaimerModal");return void 0!==disclaimerModalContainer&&null!=disclaimerModalContainer&&(!function(state){disclaimerModalContainer.style.display=state}("block"),disclaimerBeingShown=!0),("undefined"!=typeof landingLink&&""!==landingLink||PageStatus.isProfile)&&hideGenderSelection(),$("#newDisclaimerWrap").find(".func").on("click",function(){$(this).toggleClass("active")}),$("#startWatching").on("click",function(e){e.stopPropagation();var filters=$("#newDisclaimerWrap").find("button.active");if(filterValues=[],0!==filters.length&&0===$("#allcams.active").length){for(var i=0;i<filters.length;i++)$('input[data-id="'+filters[i].value+'"]').parent().trigger("click"),$('li[data-id="'+filters[i].value+'"]').trigger("click"),filterValues.push(filters[i].value);BrowserDetect.isDesktop()?"undefined"!=typeof Directory?Directory.applyFilters(setActiveMenuTabCallback):$("#show-cams-btn").trigger("click"):0!==filterValues.length&&3!==filterValues.length&&(window.location.href=filterValues.join("/"))}Disclaimer.disclaimerPopAccept()}),$("#acceptAndLogin").on("click",function(event){PageStatus.showLoginModal=!0,Disclaimer.disclaimerPopAccept(!0),event.preventDefault()}),"undefined"==typeof PageStatus||disclaimerBeingShown||$(document).ready(function(){PageStatus.isCheckoutTokensModalActive?WaitFor.dependencies(["epay"],function(){epay.config.pluginCDN?TipFactory.popTokens():(epay.tool.setConfig({pluginCDN:EPAY_PLUGIN_LOCATION}),TipFactory.popTokens())}):PageStatus.showLoginModal&&LoginModals.activateLoginModal()}),{disclaimerBeingShown:disclaimerBeingShown,disclaimerPopAccept:function(skipSfw){Cam4Cookies.setCookie("disclaimerMobile18","adult"),Cam4Cookies.setCookie("disclaimer18","Accepted"),disclaimerModalContainer.parentNode&&disclaimerModalContainer.parentNode.removeChild(disclaimerModalContainer),PageStatus.isCheckoutTokensModalActive?TipFactory.popTokens():PageStatus.showLoginModal&&LoginModals.activateLoginModal(),disclaimerBeingShown=!1,skipSfw&&$.get("/toggleSFW?sfw=false")}}}();
var loginConsent=function(){function getConsents(){$j.ajax({type:"GET",url:"/rest/v1.0/user/"+Cam4User.userName+"/consent/user-status/UNCONFIRMED?login_user_name="+Cam4User.userName+"&accessHash="+Cam4User.kN,success:function(result){for(var jsonTranslates=[{bundleName:"privacypolicy",bundleEntries:{}}],consents=[],i=0;i<result.length;i++)jsonTranslates[0].bundleEntries[result[i].consent.headerKey]="",jsonTranslates[0].bundleEntries[result[i].consent.bodyKey]="",consents[i]={},consents[i].headerKey=result[i].consent.headerKey,consents[i].bodyKey=result[i].consent.bodyKey,consents[i].consentType=result[i].consent.consentType;0!==consents.length&&getTranslations(consents,jsonTranslates)},error:function(err){console.log("AJAX error in request: "+JSON.stringify(err,null,2))}})}function getTranslations(consents,jsonTranslates){$j.ajax({type:"POST",url:"/rest/v1.0/translation",dataType:"json",contentType:"application/x-www-form-urlencoded; charset=utf-8",data:{translations:encodeURIComponent(JSON.stringify(jsonTranslates))},success:function(result){populateModal(consents,result)},error:function(err){console.log("AJAX error in request: "+JSON.stringify(err,null,2))}})}function populateModal(consents,translations){if(loginConsentModalContainer.find(".modal-header").empty(),loginConsentModalContainer.find(".modal-body").empty(),loginConsentModalContainer.find(".modal-header").append(js_i18n.consentHeader),ControlledFeatures.GDPR_WITH_STEPS){loginConsentModalContainer.find(".modal-header").append('<p class="stepsCounter">'+js_i18n.step+' <span class="current-step">1</span> / '+(parseInt(consents.length)+2)+"</p>"),loginConsentModalContainer.find(".modal-body").append('<div class="step step1 activeStep">'+js_i18n.consentBody+"</div>");for(i=0;i<consents.length;i++){var headertranslate=translations[0].bundleEntries[consents[i].headerKey],bodytranslate=translations[0].bundleEntries[consents[i].bodyKey];consents[i].bodyKey.indexOf("privacy.promotions.body")>-1&&(bodytranslate=bodytranslate.replace("{0}",Cam4User.userName)),loginConsentModalContainer.find(".modal-body").append('<div class="step step'+(parseInt(i)+2)+'"><div class="consent">'+headertranslate+bodytranslate+'</div><div class="clearfix"><div class="pull-left"><input type="radio" class="loginConsentInput" name="'+consents[i].consentType+'" id="loginConsentYes'+i+'" value="yes"><label for="loginConsentYes'+i+'">'+js_i18n.yes+'</label></div><div class="pull-right"><input type="radio" class="loginConsentInput" name="'+consents[i].consentType+'" id="loginConsentNo'+i+'" value="no"><label for="loginConsentNo'+i+'">'+js_i18n.no+"</label></div></div></div>")}loginConsentModalContainer.find(".modal-body").append('<div class="step step'+(parseInt(consents.length)+2)+'"><div class="consent">'+js_i18n.allDoneHeader+js_i18n.allDoneBody+"</div></div>")}else{loginConsentModalContainer.find(".btn-save").addClass("disabled"),loginConsentModalContainer.find(".modal-body").append(js_i18n.consentBody);for(var i=0;i<consents.length;i++){var headertranslate=translations[0].bundleEntries[consents[i].headerKey],bodytranslate=translations[0].bundleEntries[consents[i].bodyKey];consents[i].bodyKey.indexOf("privacy.promotions.body")>-1&&(bodytranslate=bodytranslate.replace("{0}",Cam4User.userName)),loginConsentModalContainer.find(".modal-body").append(headertranslate),loginConsentModalContainer.find(".modal-body").append(bodytranslate),loginConsentModalContainer.find(".modal-body").append('<div class="clearfix"><div class="pull-left"><input type="radio" class="loginConsentInput" name="'+consents[i].consentType+'" id="loginConsentYes'+i+'" value="yes"><label for="loginConsentYes'+i+'">'+js_i18n.yes+'</label></div><div class="pull-right"><input type="radio" class="loginConsentInput" name="'+consents[i].consentType+'" id="loginConsentNo'+i+'" value="no"><label for="loginConsentNo'+i+'">'+js_i18n.no+"</label></div></div><hr />")}loginConsentModalContainer.find(".modal-body").append(js_i18n.consentFooter)}showModal()}function showModal(){var currentPathname=window.location.pathname;void 0!==loginConsentModalContainer&&null!==loginConsentModalContainer&&"/privacy"!==currentPathname&&"/cookies"!==currentPathname&&currentPathname!=="/"+Cam4User.userName+"/edit/email"&&loginConsentModalContainer.show()}function hideModal(){void 0!==loginConsentModalContainer&&null!==loginConsentModalContainer&&loginConsentModalContainer.hide()}function showWithdrawalModal(){void 0!==withdrawalConsentModalContainer&&null!==withdrawalConsentModalContainer&&withdrawalConsentModalContainer.show()}function hideWithdrawalModal(){void 0!==withdrawalConsentModalContainer&&null!==withdrawalConsentModalContainer&&withdrawalConsentModalContainer.hide()}function checkConsentsStatus(){var flag=!0;return $(".loginConsentInput").each(function(){var name=$(this).attr("name");flag&&!$(':radio[name="'+name+'"]:checked').length&&(flag=!1)}),flag}function saveUserConsents(){var userConsents=[];$(".loginConsentInput:checked").each(function(i){var name=$(this).attr("name"),status="yes"===$(this).val()?"APPROVED":"DENIED";userConsents[i]={consentType:name,userConsentStatus:status}}),$j.ajax({type:"POST",url:"/rest/v1.0/user/"+Cam4User.userName+"/consent?login_user_name="+Cam4User.userName+"&accessHash="+Cam4User.kN,data:JSON.stringify(userConsents),dataType:"json",contentType:"application/json; charset=utf-8",success:function(result){},error:function(err){console.log("AJAX error in request: "+JSON.stringify(err,null,2))}})}var loginConsentModalContainer=$("#loginConsentModal"),withdrawalConsentModalContainer=$("#loginWithdrawalConsentModal");return loginConsentModalContainer.on("change",".loginConsentInput",function(){checkConsentsStatus()&&loginConsentModalContainer.find(".btn-save").removeClass("disabled"),ControlledFeatures.GDPR_WITH_STEPS&&loginConsentModalContainer.find(".btn-next").removeClass("disabled")}),loginConsentModalContainer.on("click",".btn-save",function(e){e.preventDefault(),e.stopPropagation();var flag=!0;hideModal(),$(".loginConsentInput:checked").each(function(i){"yes"!==$(this).val()&&(flag=!1)}),!0===flag?saveUserConsents():showWithdrawalModal()}),withdrawalConsentModalContainer.on("click",".btn-yes",function(e){e.preventDefault(),e.stopPropagation(),saveUserConsents(),hideWithdrawalModal()}),withdrawalConsentModalContainer.on("click",".btn-cancel",function(e){e.preventDefault(),e.stopPropagation(),showModal(),hideWithdrawalModal()}),ControlledFeatures.GDPR_WITH_STEPS&&(loginConsentModalContainer.on("click",".btn-next",function(e){e.preventDefault(),e.stopPropagation();var activeStep=$(".activeStep").index();if($(".current-step").html(activeStep+2),activeStep+2!==$(".step").length&&loginConsentModalContainer.find(".btn-next").addClass("disabled"),$(".activeStep").next().find("input:checked").length>0&&loginConsentModalContainer.find(".btn-next").removeClass("disabled"),loginConsentModalContainer.find(".btn-back").removeClass("disabled"),$(".activeStep").is(":last-child"))hideModal(),saveUserConsents();else{var nextStep=$(".activeStep").next();$(".activeStep").removeClass("activeStep"),nextStep.addClass("activeStep")}}),loginConsentModalContainer.on("click",".btn-back",function(e){e.preventDefault(),e.stopPropagation(),loginConsentModalContainer.find(".btn-next").removeClass("disabled");activeStep=$(".activeStep").index();$(".current-step").html(activeStep);var prevStep=$(".activeStep").prev();$(".activeStep").removeClass("activeStep"),prevStep.addClass("activeStep");var activeStep=$(".activeStep").index();$(".activeStep").is(":first-child")?loginConsentModalContainer.find(".btn-back").addClass("disabled"):loginConsentModalContainer.find(".btn-back").removeClass("disabled")})),Cam4User.isLoggedIn&&showConsents&&consentsEnabled&&getConsents(),{showModal:showModal,hideModal:hideModal,getConsents:getConsents}}();
var broadcasterConsent=function(){function getConsents(){$j.ajax({type:"GET",async:!1,url:"/rest/v1.0/user/"+Cam4User.userName+"/consent/PERFORMER?login_user_name="+Cam4User.userName+"&accessHash="+Cam4User.kN,success:function(result){var jsonTranslates=[{bundleName:"privacypolicy",bundleEntries:{}}],consent=[];"APPROVED"!==result.userConsentStatus?(jsonTranslates[0].bundleEntries[result.consent.headerKey]="",jsonTranslates[0].bundleEntries[result.consent.bodyKey]="",consent.headerKey=result.consent.headerKey,consent.bodyKey=result.consent.bodyKey,getTranslations(consent,jsonTranslates)):$("#mobileBroadcastBtn").length>0?window.location.href=$("#mobileBroadcastBtn").attr("href"):Cam4User.broadcastStart()},error:function(err){console.log("AJAX error in request: "+JSON.stringify(err,null,2))}})}function getTranslations(consent,jsonTranslates){$j.ajax({type:"POST",url:"/rest/v1.0/translation",dataType:"json",contentType:"application/x-www-form-urlencoded; charset=utf-8",data:{translations:encodeURIComponent(JSON.stringify(jsonTranslates))},success:function(result){populateModal(consent,result)},error:function(err){console.log("AJAX error in request: "+JSON.stringify(err,null,2))}})}function populateModal(consent,translations){broadcasterConsentModalContainer.find(".modal-header").html(js_i18n.consentHeader),broadcasterConsentModalContainer.find(".modal-body").empty(),broadcasterConsentModalContainer.find(".btn-save").addClass("disabled"),broadcasterConsentModalContainer.find(".modal-body").append(js_i18n.consentBody),broadcasterConsentModalContainer.find(".modal-body").append(translations[0].bundleEntries[consent.headerKey]),broadcasterConsentModalContainer.find(".modal-body").append(translations[0].bundleEntries[consent.bodyKey]),broadcasterConsentModalContainer.find(".modal-body").append('<div class="clearfix"><div class="pull-left"><input type="radio" class="broadcasterConsentInput" name="PERFORMER" id="broadcasterConsentYes" value="yes"><label for="broadcasterConsentYes">'+js_i18n.yes+'</label></div><div class="pull-left"><input type="radio" class="broadcasterConsentInput" name="PERFORMER" id="broadcasterConsentNo" value="no"><label for="broadcasterConsentNo">'+js_i18n.no+"</label></div></div><hr />"),broadcasterConsentModalContainer.find(".modal-body").append(js_i18n.consentFooter),showModal()}function showModal(){void 0!==broadcasterConsentModalContainer&&null!==broadcasterConsentModalContainer&&broadcasterConsentModalContainer.show()}function hideModal(){void 0!==broadcasterConsentModalContainer&&null!==broadcasterConsentModalContainer&&broadcasterConsentModalContainer.hide()}function showWithdrawalModal(){void 0!==withdrawalConsentModalContainer&&null!==withdrawalConsentModalContainer&&withdrawalConsentModalContainer.show()}function hideWithdrawalModal(){void 0!==withdrawalConsentModalContainer&&null!==withdrawalConsentModalContainer&&withdrawalConsentModalContainer.hide()}function checkConsentsStatus(){var flag=!0;return $(".broadcasterConsentInput").each(function(){flag&&!$(':radio[name="PERFORMER"]:checked').length&&(flag=!1)}),flag}function saveUserConsents(){var userConsents=[],status="yes"===$(".broadcasterConsentInput:checked").eq(0).val()?"APPROVED":"DENIED";userConsents[0]={consentType:"PERFORMER",userConsentStatus:status},$j.ajax({type:"POST",url:"/rest/v1.0/user/"+Cam4User.userName+"/consent?login_user_name="+Cam4User.userName+"&accessHash="+Cam4User.kN,data:JSON.stringify(userConsents),dataType:"json",contentType:"application/json; charset=utf-8",success:function(result){"APPROVED"===status&&($("#mobileBroadcastBtn").length>0?window.location.href=$("#mobileBroadcastBtn").attr("href"):Cam4User.broadcastStart())},error:function(err){console.log("AJAX error in request: "+JSON.stringify(err,null,2))}})}var broadcasterConsentModalContainer=$("#broadcasterConsentModal"),withdrawalConsentModalContainer=$("#broadcasterWithdrawalConsentModal");return broadcasterConsentModalContainer.on("change",".broadcasterConsentInput",function(){checkConsentsStatus()&&broadcasterConsentModalContainer.find(".btn-save").removeClass("disabled")}),broadcasterConsentModalContainer.on("click",".btn-save",function(e){e.preventDefault(),e.stopPropagation(),hideModal(),"yes"===$(".broadcasterConsentInput:checked").eq(0).val()?saveUserConsents():showWithdrawalModal()}),withdrawalConsentModalContainer.on("click",".btn-yes",function(e){e.preventDefault(),e.stopPropagation(),saveUserConsents(),hideWithdrawalModal()}),withdrawalConsentModalContainer.on("click",".btn-cancel",function(e){e.preventDefault(),e.stopPropagation(),showModal(),hideWithdrawalModal()}),Cam4User.isLoggedIn&&$j(document).on("click",".broadcasting-button a, #p_1, #p_2, #p_3, #p_4, #p_5, .becomeAWebCamModel a, #mobileBroadcastBtn",function(event){event.preventDefault(),consentsEnabled&&!ControlledFeatures.GDPR_NEW_DESIGN?getConsents():"mobileBroadcastBtn"===$j(this).attr("id")?window.location.href=$("#mobileBroadcastBtn").attr("href"):Cam4User.broadcastStart()}),{showModal:showModal,hideModal:hideModal,getConsents:getConsents}}();
var promotionsConsent=function(){function showModal(){promotionsConsentModalContainer.show()}function hideModal(){promotionsConsentModalContainer.hide()}function hideModal(){promotionsConsentModalContainer.hide()}var promotionsConsentModalContainer=$("#promotionsConsentModal"),promotionsConsentCheckbox=$("#promotionsConsent"),promotionsConsentModalLink=$("#promotionsConsentModalLink");return $("body").on("change","#promotionsConsent",function(){promotionsConsentCheckbox.is(":checked")?promotionsConsentModalLink.html(js_i18n.subscribe+"!"):promotionsConsentModalLink.html(js_i18n.noThanks+"!")}),$("body").on("click","#promotionsConsentModalLink",function(e){e.preventDefault();var userConsentStatus="DENIED";if($j("#promotionsConsent").is(":checked")){userConsentStatus="APPROVED";var params={emailOptions:1,billing:1,weeklyUpdate:1,mailDiscounts:1,acctUpdate:1,d:(new Date).getTime(),emailPerformerOnline:1,username:Cam4User.profileName};$j.ajax({type:"POST",url:"/forms/save_options",data:params})}$j.ajax({type:"POST",url:"/rest/v1.0/user/"+Cam4User.userName+"/consent?login_user_name="+Cam4User.userName+"&accessHash="+Cam4User.kN,data:JSON.stringify([{consentType:"PROMOTIONS",userConsentStatus:userConsentStatus}]),dataType:"json",contentType:"application/json; charset=utf-8",error:function(err){console.warn("AJAX error in request: "+JSON.stringify(err,null,2))}}),hideModal()}),Cam4User.isLoggedIn&&ControlledFeatures.GDPR&&ControlledFeatures.GDPR_NEW_DESIGN&&showModal(),{showModal:showModal,hideModal:hideModal}}();
var MobileAdsManager=function(){return{init:function(){$j(".profileDataBox a").live("click",function(e){var target=$j(this).attr("target");if(target&&"_blank"==target.toLowerCase())return!0;if(!$j(this).hasClass("nopop"))try{var popUpMobileLimitator=Cam4Storage.getLocal("popUpMobileLimitator");if(popUpMobileLimitator&&(new Date).getTime()-new Date(popUpMobileLimitator).getTime()<36e5)return;Cam4Storage.setLocal("popUpMobileLimitator",new Date),doPopUnder(e)}catch(e){console.log(e)}})},getAdsState:function(){return UserAgent.phone||UserAgent.tablet},exoMapper:function(){switch(window.adsKey){case"straight":return"2931840";case"gay":return"2931838";case"shemale":return"3461247";default:return"2931840"}},getPopUnderLink:function(){var sUrl="";switch(window.adsKey){case"shemale":sUrl=ControlledFeatures.LOAD_LSM_ADS?"//a.libertystmedia.com/loader?a=57&t=8&s=5&p=4":"http://8e89-ede2-c1be-9cdf.reporo.net/red?id=rz9hMJyxCGL5BGD";break;case"gay":sUrl=ControlledFeatures.LOAD_LSM_ADS?"//a.libertystmedia.com/loader?a=40&t=8&s=5&p=4":"http://8e89-ede2-c1be-9cdf.reporo.net/red?id=rz9hMJyxCGR5BQNl";break;default:sUrl=ControlledFeatures.LOAD_LSM_ADS?"//a.libertystmedia.com/loader?a=19&t=8&s=5&p=4":"http://8e89-ede2-c1be-9cdf.reporo.net/red?id=rz9hMJyxCGL5BGD"}return sUrl}}}();PageStatus.enablePopUnder&&!isTabooCams&&$j(function(){if(!Cam4User.isPayingMember()&&Cam4User.htmlStates.indexOf("landing_page")<0)if(MobileAdsManager.getAdsState())MobileAdsManager.init();else try{initObserve()}catch(ex){}});
Cam4User.broadcastWindow="unset",Cam4User.broadcastWindowHeight=675,Cam4User.broadcastWindowWidth=1200,Cam4User.broadcastStart=function(userId){function openAndFocus(){Cam4User.broadcastWindow=window.open(url,"cam4Brd","resizable=yes,height="+Cam4User.broadcastWindowHeight+",width="+Cam4User.broadcastWindowWidth);{if(Cam4User.broadcastWindow)return Cam4User.broadcastWindow.__parentWindow=window,Cam4User.broadcastWindow.focus();window.location.href=url}}function hasLocationAndHref(){if(BrowserDetect.isFirefox())try{return typeof Cam4User.broadcastWindow.location==typeof{}&&""!==Cam4User.broadcastWindow.location.href}catch(ex){return!1}return typeof Cam4User.broadcastWindow.location==typeof{}&&void 0!==Cam4User.broadcastWindow.location.href}{if(!Cam4User.isLoggedInAsGuest){EverCookie.getInt("preferredBroadcastWidth")>0&&(Cam4User.broadcastWindowWidth=EverCookie.getInt("preferredBroadcastWidth")),EverCookie.getInt("preferredBroadcastHeight")>0&&(Cam4User.broadcastWindowHeight=EverCookie.getInt("preferredBroadcastHeight"));var url="/broadcast/broadcast.jsp?rnd="+(new Date).getTime()+"&responsiveMode=true";if("unset"===Cam4User.broadcastWindow)return openAndFocus();if(!hasLocationAndHref())return openAndFocus();if(hasLocationAndHref())try{if("about:blank"===Cam4User.broadcastWindow.location.href)return Cam4User.broadcastWindow.location=url,Cam4User.broadcastWindow.focus()}catch(ex){return openAndFocus()}return Cam4User.broadcastWindow.focus()}Registration.activateGuestRegisterModal()}};
/*
 * USE THIS IF YOU WANT TO REMOVE FLASH PLAYER LOGIC
 */


var WebChatResponses = {
    SEND_TOKENS_FOR_GROUP_SHOW_OK: 'SENDTOKENSFORGROUPSHOW_OK'
};

var stopSpyFailedRetryCounter = 0,
    stopSpyFailedRetryTimeoutId = null,
    stopSpyFailedMaxRetries = 5,
    stopSpyFailedDelay = 1000;

var LogicObj = (function () {

    Cam4Event.addEventListener(TipEvent.ON_TIP_SENT, function (args) {
        switch (args) {
            case WebChatResponses.SEND_TOKENS_FOR_GROUP_SHOW_OK:
                ncTip.enableSendTipInput();
                break;
        }
    });

    return {
        //viewer
        timeout: '',
        callWebchat: function(path, data, callback, doCallbackAfter, doCallbackOnError) {
            localStorage.setItem('activeGameName', GameCenter.getActiveGame() ? JSON.stringify(GameCenter.getActiveGame().name) : '');
            localStorage.setItem('activeGameOptions', GameCenter.getActiveGame() ? JSON.stringify(GameCenter.getActiveGame().details.o) : '');
            if (ControlledFeatures.SILENCE_FEATURE) {
                if (data.type == 'unSilenceAll') {
                    ChatUIController.unsilenceAllUsersFromList();
                }

                if (data.type == 'unsilence') {
                    ChatUIController.unsilenceUserFromList(data.recipient)
                }
            }

            var url = cam4WebChatHost + path,
                showType = '',
                doCallbackAfterSuccessLogic = (typeof doCallbackAfter !== 'undefined') ? doCallbackAfter : false,
                doCallbackOnErrorOrFailure = (typeof doCallbackOnError !== 'undefined') ? doCallbackOnError : false,
                streamSource = Chat.getStreamSource();

            data.accessHash = Cam4User.kN;
            data.username = Cam4User.userName;
            data.roomname = roomName;
            data.userIp = Cam4User.currentIp;

            if (typeof data.showType != 'undefined') {
                showType = data.showType.toUpperCase();
            }

            let params = {
                url: url,
                context: document.body,
                type: 'post',
                error: function () {
                    Chat.setRunning(false);
                    if (doCallbackOnErrorOrFailure && typeof callback === "function") {
                        callback();
                    }
                },
                fail: function () {
                    Chat.setRunning(false);
                    if (doCallbackOnErrorOrFailure && typeof callback === "function") {
                        callback();
                    }
                },
                data: data
            };
            if (ControlledFeatures.DISTRIBUTED_TRACING && (typeof Chat !== 'undefined')) {
                var shouldTrace = ["privateShowAction", "groupShowAction", "clientUnauthenticated", "notifyDisconnect"].indexOf(path) >= 0;
                if (shouldTrace) {
                    params.headers = {
                        "X-B3-TraceId": Chat.getTraceId(),
                        "X-B3-SpanId": Chat.generateSpanId(),
                        "X-B3-Sampled": 1
                    };
                }
            }
            $j.ajax(params).success( function(receivedData) {
                Chat.setRunning(false);
                if (!doCallbackAfterSuccessLogic && typeof callback != 'undefined' && callback != '') {
                    callback(receivedData, showType);
                    return;
                }
                if (typeof receivedData.status != 'undefined') {
                    var receivedStatus = receivedData.status.toUpperCase();
                    switch (receivedStatus) {
                        case 'CANNOT_TIP_IN_BONUS':
                            Chat.newShowsConfirmation(Cam4Chat.noTippingTitle,
                                Cam4Chat.noTipping, 'cannot_tip_in_bonus');
                            break;
                        case 'SENDTOKENSFORGROUPSHOW_OK':
                            ServiceTipViewer.tipSent(receivedStatus);
                            break;
                        case 'SENDTOKENSFORGROUPSHOW_OK_INSUFFICIENT':
                            Chat.newShowsConfirmation('Cam4', nstiplang.serverMessages.InsufficientWarning, 'insufficientWarning', '', receivedData.diff);
                            break;
                        case 'VIEWERDOESNOTHAVESUFFICIENTTOKENS':
                            Chat.newShowsConfirmation('Cam4', nstiplang.serverMessages.InsufficientFunds, 'insufficientFunds');
                            break;
                        case 'PRIVATE_SHOW_INSUFFICIENT_FUNDS':
                            TipFactory.popTokens();
                            break;
                        case 'FAILED':
                            if (typeof receivedData.message != 'undefined') {
                                switch (receivedData.message) {
                                    case 'PRIVATE_SHOW_TIMEOUT_PENALTY':
                                        Chat.newShowsConfirmation('Cam4', Cam4Chat.timeoutPenalty, 'timeoutPenalty');
                                        return;
                                    case 'PRIVATE_SHOW_NO_TOKENS_MESSAGE':
                                        Chat.newShowsConfirmation('Cam4', nstiplang.serverMessages.InsufficientFunds, 'insufficientFunds');
                                        return;
                                    default:
                                        break;
                                }
                                break;
                            }

                            if (data.action === 'stopSpy') {
                                if (typeof receivedData.details != 'undefined' && (receivedData.details.toLowerCase() === "null_ps_data" || receivedData.details.toLowerCase().indexOf('exception') !== -1)) {
                                    LogicObj.clearStopSpyRetryTimeout();
                                    if (stopSpyFailedRetryCounter < stopSpyFailedMaxRetries) {
                                        ++stopSpyFailedRetryCounter;
                                        stopSpyFailedRetryTimeoutId = setTimeout(function () {
                                            var data = {
                                                action: 'stopSpy'
                                            };
                                            LogicObj.callWebchat('privateShowAction', data, callback, doCallbackAfterSuccessLogic);
                                        }, stopSpyFailedDelay);
                                    } else {
                                        stopSpyFailedRetryCounter = 0;
                                        if (doCallbackAfterSuccessLogic && typeof callback === "function") {
                                            callback();
                                        }
                                    }
                                    return;
                                }
                            }
                        case 'SUCCESS':
                            Chat.viewerAllowedInPrivateStream = true;
                            streamSource.setToken(receivedData);
                            switch (data.action) {
                                case 'request':
                                    clearTimeout(LogicObj.timeout);
                                    if (!data.extend) {
                                        if (UserAgent.phone) {
                                            mobileNewShows.sendPrivateRequest();
                                            LogicObj.timeout = setTimeout(function () {
                                                mobileNewShows.requestPrivate();
                                            }, 120000);
                                        }
                                        NewShowReceiver.onNewShowStateChanged(NewShowState.requestingPrivateShow);
                                        LogicObj.timeout = setTimeout(function () {
                                            NewShowReceiver.onNewShowStateChanged(NewShowState.requestExpired);
                                        }, 120000);
                                    }
                                    return;
                                case 'cancelRequest':
                                    if (UserAgent.phone) {
                                        mobileNewShows.requestPrivate();
                                    } else {
                                        NewShowReceiver
                                            .onNewShowStateChanged(NewShowState.notRequestingPrivateShow);
                                    }
                                    return;
                                case 'startSpy':
                                    Cam4User.isSpy = true;
                                    streamSource.setState('disconnected');
                                    ChatUtils.countExactSeconds.start(ChatUIController.privateShowTimer);
                                    if (Cam4User.cameraData.useHlsVideoOnMobile && !UserAgent.desktop) {
                                        mobileNewShows.container.show();
                                        mobileNewShows.SPY.cancel.show();
                                    }
                                    NewShowReceiver.onNewShowStateChanged(NewShowState.inSpy);
                                    ChatUI.overlay.privateShow.hide();

                                    if (!ControlledFeatures.USE_CDN_FOR_HLS_VIEWERS || !Cam4User.cameraData.useHlsVideoOnMobile) {
                                        streamSource.reconnect();
                                    }
                                    ChatUI.showVideoContainer();
                                    if (doCallbackAfterSuccessLogic && typeof callback === "function") {
                                         callback();
                                     }

                                    ChatUI.muteAudio(streamSource);

                                    return;
                                case 'stopSpy':
                                    $j('#requestPrivateShow').removeClass('disabledLink');
                                    ChatUtils.countExactSeconds.stop();
                                    Cam4User.isSpy = false;
                                    NewShowReceiver
                                        .onNewShowStateChanged(NewShowState.accesDenied);
                                    ChatUI.overlay.privateShow.show();
                                    ChatUI.hideVideoContainer();
                                    streamSource.clearToken();
                                    if (!Cam4User.cameraData.useFlashPlayer) {
                                        streamSource.stop();
                                    }

                                    if (UserAgent.phone) {
                                        mobileNewShows.SPY.cancel.hide();
                                    }

                                    LogicObj.requestReceipt('ss');
                                    TipBalance.updateBalanceFields();

                                    ChatUI.unmuteAudio(streamSource);

                                    break;
                                case 'requestPlayToken':
                                    // streamSource.reconnect();
                                    break;
                            }
                            break;
                        case 'IDVERIFICATIONREQUIRED':
                            $j('#genericAlertModalContent').html(Cam4ChatErrors.cam2camIdVerificationRequired);
                            $j('#genericAlertModal').show();
                            break;
                        default:
                            break;
                    }
                }
            });
        },
        requestReceipt: function (showType) {
            var data = {
                'showType': showType
            };

            if (Cam4User.useVrPlayer && Utils.isViewerInVR()) {
                return;
            }

            LogicObj.callWebchat('receipt', data, LogicObj.showReceipt);
        },
        showReceipt: function (data, showType) {
            var receiptData = '';
            if (data.status == 'success') {
                switch (showType) {
                    case 'GS':
                        if (data.details == 'group_show_ended_with_success') {
                            //Webchat sends show length in minutes (display is in seconds)
                            data.showLength *= 60;

                            //TODO: Verify for broadcaster
                            if (Cam4User.performerName == Cam4User.userName) {
                                receiptData = {
                                    showLength: data.showLength,
                                    costOfTicket: data.ticketPrice,
                                    ticketSales: data.totalReserved,
                                    tipsReceived: data.totalTipped,
                                    totalEarned: data.totalEarn
                                };
                                receiptData = JSON.stringify(receiptData);
                            } else {
                                receiptData = {
                                    duration: data.showLength,
                                    ticketCost: data.ticketPrice,
                                    tipsSent: data.totalTipped
                                };
                            }
                        } else if (data.details == 'group_show_canceled') {
                            if (Cam4User.isViewer()) {
                                Chat.newShowsConfirmation(Cam4Chat.refundViewerTitle,
                                    Cam4Chat.refundViewer, 'tickets_refunded');
                            }
                            return;
                        }
                        break;
                    case 'PS':
                    case 'SS':
                        receiptData = {
                            duration: data.showLength,
                            cost: '',
                            broadcasterName: Cam4User.performerName,
                            timeinCam2Cam: ''
                        };
                        break;
                    default:
                        break;
                }
                NewShowReceiver.showReceipt(receiptData, 'r' + showType, true);
            }
        },
        requestPrivateShowCam2Cam: function () {
            Chat.newShowsConfirmation(Cam4Chat.c2cShowRequestTitle,
                Cam4Chat.c2cShowRequestMessage + Cam4Chat.c2cShowRequestDetails,
                'request_C2C');
        },
        cancelCam2CamRequest: function () {

        },
        requestPrivateShow: function () {
            if (!Cam4User.isLoggedIn) {
                if (!Cam4User.isLoggedInAsGuest) {
                    Utils.decideOffer();
                } else {
                    Registration.activateGuestRegisterModal();
                }
                return;
            }
            Chat.newShowsConfirmation(js_i18n.psRequest,
                Cam4Chat.privateShowRequestMessage, 'request_PS');
        },
        requestPlayToken: function () {
            var data = {
                action: 'requestPlayToken'
            };
            LogicObj.callWebchat('privateShowAction', data);
        },
        cancelPrivateShowRequest: function () {
            var data = {
                action: 'cancelRequest'
            };
            LogicObj.callWebchat('privateShowAction', data);
        },
        requestSpyMode: function () {
            //Fanclub subscribers get free spy
            if (Chat.globalUsers[Cam4User.userName.toLowerCase()].isFanclubSubscribed == 1) {
                Chat.newShowsConfirmation('', '', 'request_SPY_FREE');
                return;
            }
            Chat.newShowsConfirmation(Cam4Chat.spyRequestTitle,
                Cam4Chat.spyRequestMessage, 'request_SPY');
        },
        cancelSpyRequest: function () {

        },
        stopSpyMode: function () {
            Chat.newShowsConfirmation('', '', 'stopSpy');
        },
        clearStopSpyRetryTimeout: function () {
            if (stopSpyFailedRetryTimeoutId !== null) {
                clearTimeout(stopSpyFailedRetryTimeoutId);
                stopSpyFailedRetryTimeoutId = null;
            }
        },
        groupShowSendTip: function (tipAmount) {
            var data = {
                'tokens': tipAmount,
                'action': 'sendTokensForGroupShow'
            };

            LogicObj.callWebchat('groupShowAction', data);
        },
        groupShowBuyTicket: function () {
            if (!Cam4User.isLoggedIn) {
                Utils.decideOffer();
                return;
            }
            Chat.newShowsConfirmation(Cam4Chat.buyTicketTitle, Cam4Chat.buyTicket, 'buy_ticket');
        },
        //performer:
        setPrivateShowSettings: function (jsonString) {
            var obj = JSON.parse(jsonString);
            var data = {
                'acceptPS': obj.acceptPS,
                'allowSpy': obj.allowSpy,
                'allowCam2Cam': obj.allowCam2Cam,
                'viewerPPM': obj.viewerPPM,
                'spyPPM': obj.spyPPM,
                'c2cPPM': obj.c2cPPM,
                'blocksOfTimeActive': obj.blocksOfTimeActive,
                'blocksOfTime': JSON.stringify(obj.blocksOfTime),
                'action': 'updatePSSettings'
            };

            LogicObj.callWebchat('privateShowAction', data);
        },
        disablePrivateShowInvites: function () {

        },
        enablePrivateShowInvites: function () {

        },
        disableSpyMode: function () {

        },
        enableSpyMode: function () {

        },
        startPrivateShow: function(userId, cam2cam, callback, external) {
            var data = {
                billedUsername: userId,
                cam2cam: (typeof cam2cam !== 'undefined'),
                cam2camExternal: (typeof external !== 'undefined' && external),
                action: 'startPS'
            };
            LogicObj.callWebchat('privateShowAction', data, callback);
        },
        startPrivateShowCam2Cam: function (userId, callback, external) {
            var data = {
                action: 'startCam2Cam',
                cam2camExternal: (typeof external !== 'undefined' && external)
            };
            LogicObj.callWebchat('privateShowAction', data, callback);
        },
        rejectPrivateShowRequest: function (userId) {
        },
        startGroupShow: function () {
            var data = {
                action: 'startGS'
            };
            LogicObj.callWebchat('groupShowAction', data);
        },
        endGroupShow: function () {

            Chat.newShowsConfirmation(Cam4Chat.endGSTitle,
                Cam4Chat.endGSDescription + Cam4Chat.endGSContinue, 'endGS');

        },

        updateTippingData: function (object) {
            var minutes = parseInt(object.gsTime / 60000);
            ncTip.updateGoalBarData(object.gsTippedTokens + object.gsReservedTokens, object.goal);
            ncTip.confirmViewerStatusMessage(object.showDescription);
            ncTip.confirmFirstInfo(parseInt(object.ticketPrice));
            ncTip.confirmSecondInfo(parseInt(minutes));
            $j('#infoPre1').html(nstiplang.costPerTicket + ':');
            $j('#infoPre2').html(nstiplang.showLength + ':');
        },
        getGroupShowSettings: function (showDescription, costOfTicket,
                                        ticketGoal, showLength, timeLimit) {
            var data = {
                description: showDescription,
                ticketGoal: ticketGoal,
                showLength: showLength,
                ticketSaleTime: timeLimit,
                ticketValue: costOfTicket,
                action: 'sellGSTickets'
            };
            LogicObj.callWebchat('groupShowSettingsServlet', data);
        },
        enableCam2Cam: function (varboolean) {

        },
        setPrivateShowPrice: function(tokens_min, tokens_spy, tokens_c2c, use_timeblocks, tokens_timeblocks) {

        },
        //common for viewer and perfomer:
        stopPrivateShow: function () {
            var data = {
                action: 'stopPS'
            };
            LogicObj.callWebchat('privateShowAction', data);
        },
        stopCam2Cam: function () {
            var data = {
                action: 'stopCam2Cam'
            };
            LogicObj.callWebchat('privateShowAction', data);
        },
        updateGroupShowInfo: function (ticketGoal, showLength, timeLimit) {
            var data = {
                ticketGoal: ticketGoal,
                showLength: showLength,
                ticketSaleTime: timeLimit,
                action: 'updateGSTickets'
            };
            LogicObj.callWebchat('groupShowSettingsServlet', data);
        },
        updateBroadcastStatus: function (newStatus) {
            Cam4User.streamingData.broadcastSettings.statusMessage = newStatus;
            LogicObj.callWebchat('updateBroadcastStatus', {status: newStatus});
        }
    };
})();



var BeatTipLeader={useAppsEngineGoalBar:ControlledFeatures&&ControlledFeatures.TIPPING_BAR_APPS_ENGINE_VIEWER,beatTipDiff:1,crushTipDiff:100,getViewerTipBalance:function(){if(this.useAppsEngineGoalBar){var state=TipBarAppsEngine.getTippingBarState();if(void 0!==state&&void 0!==state.yt)return state.yt}else if("undefined"!=typeof TipViewerSessionAnswer&&void 0!==TipViewerSessionAnswer.crtbalance)return parseInt(TipViewerSessionAnswer.crtbalance)},getCurrentTipLeaderName:function(){if(this.useAppsEngineGoalBar){var state=TipBarAppsEngine.getTippingBarState();if(void 0!==state&&void 0!==state.tl&&void 0!==state.tl.u){var tipLeader=state.tl.u;if(Cam4User.userName.toLowerCase()!==tipLeader.toLowerCase())return tipLeader}return!1}return"undefined"!=typeof TipViewerSessionAnswer&&void 0!==TipViewerSessionAnswer.topTipper&&((void 0===TipViewerSessionAnswer.topTipperSelf||"1"!==TipViewerSessionAnswer.topTipperSelf)&&TipViewerSessionAnswer.topTipper)},getCurrentTipLeaderAmount:function(){if(this.useAppsEngineGoalBar){var state=TipBarAppsEngine.getTippingBarState();if(void 0!==state&&void 0!==state.tl&&void 0!==state.tl.a)return state.tl.a}else if("undefined"!=typeof TipViewerSessionAnswer&&void 0!==TipViewerSessionAnswer.tlamount)return parseInt(TipViewerSessionAnswer.tlamount)},toggleBeatTipLeaderStyles:function(flag){var selector="#info1, #infoNum1, #info2, #info2 span";flag?$j(selector).addClass("beat-tip-leader"):$j(selector).removeClass("beat-tip-leader")},toggleBeatBtn:function(){if($j("#beatTipLeaderBtn").length>0){var tipLeader=BeatTipLeader.getCurrentTipLeaderName();!Cam4User.isBroadcastingWindow&&tipLeader&&tipLeader.toLowerCase()!=Cam4User.userName.toLowerCase()?$j("#beatTipLeaderBtn").show():$j("#beatTipLeaderBtn").hide()}},openBeatTipLeaderOverlay:function(){var softBeatVal=BeatTipLeader.getCurrentTipLeaderAmount()-BeatTipLeader.getViewerTipBalance()+BeatTipLeader.beatTipDiff,crushBeatVal=softBeatVal+BeatTipLeader.crushTipDiff,tipLeaderName=BeatTipLeader.getCurrentTipLeaderName();$j("#beatTipValueLight").html(softBeatVal),this.useAppsEngineGoalBar?$j("#beatTipLeaderSoftBtn").attr("onclick","Utils.closeModalPops(); ServiceTipViewer.beatTheLeader()"):$j("#beatTipLeaderSoftBtn").attr("onclick","Utils.closeModalPops(); TipExt.sendTip("+softBeatVal+")"),tipLeaderName&&"."!=tipLeaderName?$j("#beatTipLeaderName").html(tipLeaderName):$j("#beatTipLeaderName").html(nstiplang.anonymous),$j("#beatTipValueCrush").html(softBeatVal),this.useAppsEngineGoalBar?$j("#beatTipLeaderCrushHimBtn").attr("onclick","Utils.closeModalPops(); ServiceTipViewer.crushTheLeader()"):$j("#beatTipLeaderCrushHimBtn").attr("onclick","Utils.closeModalPops(); TipExt.sendTip("+crushBeatVal+")"),$j("#beatTipValueCrushDiff").html(BeatTipLeader.crushTipDiff),Utils.popPreloadedContent($j("#beatTipLeaderOverlay").html(),function(){$j("#Cam4DialogContainer .modal-dialog").addClass("modal-sm")})}};$j(document).ready(function(){"undefined"!=typeof TipWatcher&&Cam4User.useBeatTipLeader&&(BeatTipLeader.toggleBeatTipLeaderStyles(!0),BeatTipLeader.toggleBeatBtn())});
function executeForPopUnderTrick(){null!==readCookie()&&-1!=readCookie().indexOf("under")||!needsDelayedPopup()||(shouldOpenPopUnderTrick=!0)}function attachPopUpToSelector(selector){var popUpLimitator=Cam4Storage.getLocal("popUpLimitator"),popUpLinkFirstTimeClicked=Cam4Storage.getLocal("popUpLinkFirstTimeClicked");popUpLimitator&&(new Date).getTime()-new Date(popUpLimitator).getTime()<36e5||(popUpLinkFirstTimeClicked&&Cam4Storage.setLocal("popUpLimitator",new Date),$j(document).on("click",selector,function(e){window.open(getPopunderUrl(),"_blank","toolbar=no,scrollbars=yes,location=yes,statusbar=yes,menubar=no,resizable=1,width=1000,height=750"),Cam4Storage.setLocal("popUpLinkFirstTimeClicked",!0)}))}function attachPopUnderToSelector(selector){console.log("attach popunder to : ",selector),$j(selector).filter(function(){return!$(this).hasClass("nopop")}).on("click",function(e){isExit=!1;var target=$j(this).attr("target");if(target&&"_blank"==target.toLowerCase())return!0;if(needsDelayedPopup()){var cookieData=readCookie();null!==cookieData&&-1!=cookieData.indexOf("under")||($j(this).attr("target","_blank"),setTimeout(function(){window.location=getPopunderUrl()},100))}doPopUnder(e)})}function initObserve(){!Cam4User.isBroadcastingWindow&&PageStatus.contextAllowPopunder&&attachPopUpToSelector(".profileBox a")}function setCountry(c){countryName=c}function needsDelayedPopup(){return!1}function jsPopunder(sUrl,sConfig,e){function isCapped(){return!1}function postponePopunder(){var now=new Date,next=new Date(now.setTime(now.getTime()+sWait));document.cookie=cookie+"=1;expires="+next.toGMTString()+";path=/";var tomorrow=new Date;tomorrow.setHours(24,0,0,0),document.cookie=cookie+"Cap="+(popsToday+1)+";expires="+tomorrow.toGMTString()+";path=/"}function pop2under(){try{if(popunder.blur(),popunder.opener.window.focus(),window.self.window.focus(),window.focus(),browser.android||browser.firefox)return void openCloseWindow();if(browser.webkit)return void openCloseTab();if(browser.msie)return void setTimeout(function(){popunder.blur(),popunder.opener.window.focus(),window.self.window.focus(),window.focus()},1e3);if(browser.chrome&&parseInt(browser.version.split(".")[0])>=33){var flashObject=document.createElement("object");flashObject.setAttribute("type","application/x-shockwave-flash"),document.body.appendChild(flashObject),flashObject.focus(),document.body.removeChild(flashObject);try{window.open("","mock"+Math.floor(99999999*Math.random()).toString()).close()}catch(ac){}}}catch(e){}}function openCloseWindow(){var ghost=window.open("about:blank");ghost.focus(),ghost.close()}function openCloseTab(){var ghost=document.createElement("a");ghost.href="data:text/html,<script>window.close();<\/script>",document.getElementsByTagName("body")[0].appendChild(ghost);var clk=document.createEvent("MouseEvents");clk.initMouseEvent("click",!1,!0,window,0,0,0,0,0,!0,!1,!1,!0,0,null),ghost.dispatchEvent(clk),ghost.parentNode.removeChild(ghost)}var _parent=top!=self&&"string"==typeof top.document.location.toString()?top:self,popunder=null,sName=(sConfig=sConfig||{}).name||Math.floor(1e3*Math.random()+1),sWidth=sConfig.width||window.outerWidth||window.innerWidth,sHeight=sConfig.height||window.outerHeight-100||window.innerHeight,sPosX=void 0!==sConfig.left?sConfig.left.toString():window.screenX,sPosY=void 0!==sConfig.top?sConfig.top.toString():window.screenY,sWait=sConfig.wait||3600;sWait*=1e3;sConfig.cap;var popsToday=0,cookie=sConfig.cookie||"__.popunder",browser=function(){var n=navigator.userAgent.toLowerCase(),b={webkit:/webkit/.test(n),mozilla:/mozilla/.test(n)&&!/(compatible|webkit)/.test(n),chrome:/chrome/.test(n),msie:/msie/.test(n)&&!/opera/.test(n),firefox:/firefox/.test(n),safari:/safari/.test(n)&&!/chrome/.test(n),opera:/opera/.test(n),android:/android/.test(n)};return b.version=b.safari?(n.match(/.+(?:ri)[\/: ]([\d.]+)/)||[])[1]:(n.match(/.+(?:ox|me|ra|ie)[\/: ]([\d.]+)/)||[])[1],b}();isCapped()||function(sUrl,sName,sWidth,sHeight,sPosX,sPosY,e){if(!isCapped()){var sOptions="toolbar=no,scrollbars=yes,location=yes,statusbar=yes,menubar=no,resizable=1,width="+sWidth.toString()+",height="+sHeight.toString()+",screenX="+sPosX+",screenY="+sPosY;if(needsDelayedPopup())postponePopunder();else if(browser.safari||browser.chrome||browser.firefox&&parseInt(browser.version)>=65)e&&e.currentTarget&&e.currentTarget.href&&window.open(e.currentTarget.href,"_blank")&&(e.preventDefault(),window.location.href=sUrl,postponePopunder());else if(browser.chrome&&parseInt(browser.version)>=34){var simulateLink=$j("<a/>",{href:sUrl,class:"nopop"}).appendTo(document.body),simulateEvent=document.createEvent("MouseEvents");simulateEvent.initMouseEvent("click",!0,!0,window,0,0,0,0,0,sUrl,!1,!sUrl,sUrl,0,null),simulateLink[0].dispatchEvent(simulateEvent),simulateLink[0].parentNode.removeChild(simulateLink[0]),postponePopunder()}else(popunder=_parent.window.open(sUrl,sName,sOptions))&&(postponePopunder(),pop2under())}}(sUrl,sName,sWidth,sHeight,sPosX,sPosY,e)}function getPopunderUrl(){return"undefined"==typeof adsKey||""===adsKey&&null===adsKey?"/ppu/ppu.jsp":"gay"==adsKey?"/ppu/ppugay.jsp":"shemale"==adsKey?"/ppu/ppushemale.jsp":"/ppu/ppu.jsp"}function doPopUnder(e){isExit=!1,jsPopunder(MobileAdsManager.getPopUnderLink(),{name:"PopUnder",top:0,left:0,wait:2},e)}function doPopExit(e){var doExit=!1,exitCookieData=readCookie();null!==exitCookieData&&-1!=exitCookieData.indexOf("exit")||(doExit=!0);try{if(isExit&&doExit&&"undefined"!=typeof exitCities&&null!==myCity&&""!==myCity&&-1!=exitCities.indexOf(myCity.toLowerCase())){writeCookie("exit");var exit_url="/ads/adserver.jsp?zone=exit.us."+myCity.toLowerCase()+"&isPopup=1";if(BrowserDetect.isXPSP2()||document.all)!BrowserDetect.isXPSP2()&&document.all?showModalDialog(exit_url,"exit","dialogTop:0px;dialogLeft:0px;dialogWidth:980px;dialogHeight:800px;status:no;scroll:auto:resizable:yes"):(document.body.innerHTML+="<object id=iie width=0 height=0 classid='CLSID:"+u+"'></object>",iie.launchURL(exit_url));else{var exitconsole=window.open(exit_url,"pm_indexexit","width=980,height=800,menubar=no,toolbar=no,location=no,status=no,scrollbars=yes,resizable=yes");null!==exitconsole?exitconsole.blur():Cam4Cookies.setCookie(cookieName,""),parent.focus()}}}catch(ex){}}function amt(){var count=GetCookie("dirPageCount");if(null===count)return Cam4Cookies.setCookie("dirPageCount","1"),1;var newcount=parseInt(count)+1;return Cam4Cookies.setCookie("dirPageCount",newcount,exp),count}function isInViewport(coords){return coords.bottom>0&&coords.right>0&&coords.left<(window.innerWidth||document.documentElement.clientWidth)&&coords.top<(window.innerHeight||document.documentElement.clientHeight)}function reloadIframes(){var _iframes=$j("#subfoot iframe, .sponsorAd iframe, #headerBanner iframe"),iframes=[];switch(refreshType){case 0:location.reload();break;case 1:_iframes.each(function(){isInViewport($j(this)[0].getBoundingClientRect())&&iframes.push(this)});break;default:iframes=_iframes}for(var i=0;i<iframes.length;i++)$j(iframes[i]).attr("src",$j(iframes[i]).attr("src"));0!==refreshType&&setTimeout(reloadIframes,refreshTimeout)}var refreshType=2,refreshTimeout=12e4;if(void 0!==Cam4User.xtra&&Cam4User.xtra.enabled){var countryName=null,isExit=!0,cookieName="bannerPops",isRefreshing=!1,clickedLink=!1;if(-1!=window.location.toString().indexOf("act="))for(var links=document.getElementsByTagName("a"),i=0;i<links.length;i++)void 0!==links[i].addEventListener?links[i].addEventListener("click",function(){clickedLink=!0}):links[i].attachEvent("click",function(){clickedLink=!0});var selectorNotFirePopUnder="#profileStatus_questionnaire a, #profileStatus .buttonLink, #addFriendFavoriteDiv a, #openMailBoxButton, .calListShowMore, #openAbuseBtn, #commentsDiv .deletelink, #sendGiftBtn, .galleryWrap .galleryRow a, #blueimp-gallery a, #tDiv a, #profileHeaderShare #share a, #col2ChatWall .viewAll, #moreGalleryLink, #giftShelfWrap #moreLink, .noPopUnderTrick, #commentsPageWrapper .calListShowMore, #commentForm .btn-orange, .gllry a, #scheduler a, #emoticonBtn, #fakechatDiv .chatbutton, .ui-state-default",popUnderFile=getPopunderUrl(),expDays=1,exp=new Date;exp.setTime(exp.getTime()+24*expDays*60*60*1e3)}
function validate(field,span,property){var cardNumberDOM=document.getElementById("cardNumber"),usrparams={};if(usrparams[property]=field.value,field==cardNumberDOM&&(0==field.value||0==field.value.length||field.value.length>6))updateMessage(span,!1,"Please enter a valid Card Number");else if((field.value!=field.lastValue||""==field.value)&&(field.timer&&clearTimeout(field.timer),field.timer=setTimeout(function(){span.removeClass("error").html('<img src="'+WEB_CDN+'/images/ajax-loader.gif" height="16" width="16" /> checking ...'),(usrparams={})[property]=field.value;var requestUrl="/signup/"+property;$j("#pageLocale").length&&(requestUrl+="?pageLocale="+$j("#pageLocale").text()),$j.ajax({url:requestUrl,data:usrparams,dataType:"json",type:"POST",success:function(json){updateMessage(span,json.success,json.message)},error:function(){ajFailure(span)}})},400),field.lastValue=field.value,field==cardNumberDOM)){var accessCodeDOM=document.getElementById("accessCode");accessCodeDOM.value="",validate2Fields(accessCodeDOM,$j("#accessCodeSpan"),"accessCode","cardNumber",$j("#cardNumber").val())}}function verificationPageVerifyEmail(){var validateEmailSpan=$j("#emailSpan");$j("#email").bind("keyup blur",function(){validate(this,validateEmailSpan,"email")})}function showMessages(){$j("#userName").each(function(){validate(this,$j("#userNameSpan"),"username")}),$j("#email").each(function(){validate(this,$j("#emailSpan"),"email")}),$j("#cardNumber").each(function(){validate(this,$j("#cardNumberSpan"),"cardNumber")}),$j("#accessCode").each(function(){validate2Fields(this,$j("#accessCodeSpan"),"accessCode","cardNumber",$j("#cardNumber").val())})}function validate2Fields(field,span,property1,property2,property2Value){""!=field.value?field.value!=field.lastValue&&(field.timer&&clearTimeout(field.timer),field.timer=setTimeout(function(){span.html('<img src="'+WEB_CDN+'/images/ajax-loader.gif" height="16" width="16" /> checking ...'),$j.ajax({url:"/signup/"+property1,data:property1+"="+field.value+"&"+property2+"="+property2Value,dataType:"json",type:"post",success:function(json){updateMessage(span,json.success,json.message)},error:function(){ajFailure(span)}})},400),field.lastValue=field.value):updateMessage(span,!1,"Please enter a valid AccessCode")}function updateMessage(div,success,message){div.html(message),success?setTimeout(function(){div.removeClass("error"),suggestionEmailDomain()},500):div.addClass("error")}function ajFailure(div){updateMessage(div,!0,"")}function suggestionEmailDomain(){null==document.getElementById("paymentForm")&&null==document.getElementById("changeEmail")||$j("#email").mailcheck({suggested:function(element,suggestion){$j("#emailSuggested").text(suggestion.full),$j("#email_suggestion").css({display:"block"})}})}function suggestionEmailDomainClicked(){$j("#email").val($j("#emailSuggested").text()),$j("#emailSpan").css({display:"block"}),$j("#email").each(function(){validate(this,$j("#emailSpan"),"email")}),$j("#email_suggestion").css({display:"none"})}function popover(e){var dataToggle=e.getAttribute("data-toggle");$(document.getElementById(dataToggle)).toggleClass("show")}function focusInPassword(){$(document.getElementById("popoverPassword")).addClass("show")}function focusOutPassword(){$(document.getElementById("popoverPassword")).removeClass("show")}PageStatus.allowSignupValidation&&$j(document).ready(function(){var validateUserNameSpan=$j("#userNameSpan");$j("#userName").bind("keyup blur",function(){validate(this,validateUserNameSpan,"username")});var validateEmailSpan=$j("#emailSpan");$j("#email").bind("keyup blur",function(){validate(this,validateEmailSpan,"email")});var validateCardNumberSpan=$j("#cardNumberSpan");$j("#cardNumber").bind("keyup blur",function(){validate(this,validateCardNumberSpan,"cardNumber")});var validateAccessCodeSpan=$j("#accessCodeSpan");$j("#accessCode").bind("keyup blur",function(){validate2Fields(this,validateAccessCodeSpan,"accessCode","cardNumber",$j("#cardNumber").val())}),$j("#registerForm").submit(function(){return $j("#userName").unbind(),$j("#email").unbind(),$j("#cardNumber").unbind(),$j("#accessCode").unbind(),!0})}),$(document).on("click",function(e){var element=$(document.getElementById("popoverPassword"));$(e.target).hasClass("infoIconPassword")||($(e.target).hasClass("passwordInputHolder")?element.addClass("show"):element.hasClass("show")&&element.removeClass("show"))}),$("#popoverPassword").on("click",function(event){event.stopPropagation()});
if(ControlledFeatures.USE_CAM4RED&&$j("#homeRandomAd-2").length)var cam4UltimateLayout=$j("#homeRandomAd-2").clone();var randomHomepageAds={getGenderContent:function(){if(BrowserDetect.isDesktop())return(whitelistedGenders={0:"featured",1:"female",2:"male",3:"couple",4:"shemale"})[$j(".desktop-tabs li a.active").parent().attr("data-tab")?$j(".desktop-tabs li a.active").parent().attr("data-tab"):0];var whitelistedGenders=["/featured","/female","/male","/couple","/shemale"],selectedOption=$j("#mobileSavedSearches option:selected")[0];return selectedOption&&whitelistedGenders.indexOf(selectedOption.value)>=0?selectedOption.value.replace(/\//g,""):"featured"},cam4RedAdTemplate:function(){return'<div class="cam4RedTitle"><img src="'+WEB_CDN+'/images/cam4redlogo.png"><a onclick="Registration.showGoldUpgradeOverlay(\'remove-ads\');" class="removeAdsButton btn btn-xs btn-danger nopop"><span class="glyphicon glyphicon-remove-circle"></span> '+js_i18n.sponsoredContent+'</a></div><div id="cam4RedContainer"></div>'},getCam4RedToken:function(url,path){var wi=window.open("about:blank","_blank");$j(wi.document.body).html("<p>"+js_i18n.waitWhileRedirect+"</p>"),$j.ajax({type:"GET",url:window.location.protocol+"//"+SERVER_NAME+path,success:function(response){if(void 0!==response.result.token){var tokenParameter="&oneClickToken="+response.result.token;wi.location.href=url+tokenParameter,Cam4User.isCam4RedUser=!0}},error:function(jqXHR,textStatus,errorThrown){console.log(textStatus,errorThrown)}})},appendGoToCam4Red:function(){$j("#goToCam4Red").unbind().on("click",function(event){event.preventDefault();var url=$j(this).attr("href");$j("#cam4RedOptInOverlay").modal("hide"),randomHomepageAds.getCam4RedToken(url,"/partnerInfo/cam4red?acceptButton=true")})},appendRedirectHandler:function(){$j("#cam4RedContainer .box-inner").on("click",function(){var url=$j(this).data("url");Cam4User.isLoggedIn?Cam4User.isCam4RedUser?randomHomepageAds.getCam4RedToken(url,"/partnerInfo/cam4red"):($j("#cam4RedOptInOverlay").modal(),$j("#goToCam4Red").attr("href",url),randomHomepageAds.appendGoToCam4Red()):window.open(url,"_blank")})},getCam4RedAd:function(div){"gay"==window.adsKey?url="https://promo.awempire.com/xml/feed/index.php?siteId=231768&psId=Shaft1more&psTool=213_1&psProgram=cbrnd&campaignId=&category=gay&limit=10&imageSizes=320x240&imageType=glamour&showOffline=0&extendedDetails=0&responseFormat=json&performerId=&subAffId=%7BSUBAFFID%7D":"shemale"!=window.adsKey&&(url="https://promo.awempire.com/xml/feed/index.php?siteId=231768&psId=Shaft1more&psTool=213_1&psProgram=cbrnd&campaignId=&category=girl&limit=10&imageSizes=320x240&imageType=glamour&showOffline=0&extendedDetails=0&responseFormat=json&performerId=&subAffId=%7BSUBAFFID%7D"),$j.ajax({type:"GET",url:url,dataType:"json",success:function(response){if("OK"==response.status){for(var profiles="",length=UserAgent.phone&&response.data.models.length>2?2:response.data.models.length,i=0;i<length;i++){var modelName=response.data.models[i].performerId;profiles+='<div class="box" data-column="1"> <a class="box-inner" data-url="'+response.data.models[i].chatRoomUrl+'"> <img class="box-img" alt="'+modelName+'" src="'+response.data.models[i].profilePictureUrl.size320x240+'"> <div class="box-modelname">'+modelName+"</div> </a> </div>"}$j(div).empty().show().append(randomHomepageAds.cam4RedAdTemplate()).find("#cam4RedContainer").append(profiles),randomHomepageAds.appendRedirectHandler()}},error:function(jqXHR,textStatus,errorThrown){console.log(textStatus,errorThrown)}})},shuffledArray:function(array){for(var i=array.length-1;i>0;i--){var j=Math.floor(Math.random()*(i+1)),temp=array[i];array[i]=array[j],array[j]=temp}return array},shuffledDivContainers:function(){var divList=["#homeRandomAd-1","#homeRandomAd-2"];return randomHomepageAds.shuffledArray(divList)},setAds:function(ad,type){$j("#homeRandomAd-2").html(cam4UltimateLayout.html()).show(),"iframe"==type?$j("#iframeFooterAd").empty().append(ad).show():"xmlAds"==type&&$j(".xmlAdsWrapper .camads-content").html(ad)}};if(showStreammate&&!Cam4User.isFullyApproved()&&!UserAgent.phone){var Cam4AdsTool={maxTries:5,tryNo:0,isIframe:!1,providerWeights:{default:[100],de:[50,100],nl:[100],be:[100]},providerNamesMap:{default:[{name:"cam4ultimate",type:"feed"}],de:[{name:"cam4max",type:"iframe",url:"https://www.zononi.com/cam4max"},{name:"cam4dildocam",type:"iframe",url:"https://cam4dildocams.live/cam4frame"}]},providerNames:["cam4ultimate","cam4max","cam4dildocam"],showSubFooterAds:function(){console.log("showSubFooterAds"),$j("#subfoot .subfoot-section").show()},adjustAdsWidth:function(){var smAdsWidth=1*$j("#main-content").css("width").replace("px","")-1*$j("#main-content").css("padding-right").replace("px","")-20;$j(".xmlAdsTitle").css("width",smAdsWidth),UserAgent.phone&&$j(".partner-segment").addClass("mobile-partner-segment")},adjustProviderLogo:function(pName){if(-1==Cam4AdsTool.providerNames.indexOf(pName)||!$j(".xmlAdsTitle img").length)return!1;var arr=$j(".xmlAdsTitle img").attr("src").split("/");arr.pop(),arr.push(pName+"_logo.png");var newUrl=arr.join("/");$j(".xmlAdsTitle img").attr("src",newUrl)},getXmlAds:function(providerName,sexpref,gender,baseUrl,tabBased,callback){var flag=!1,page="";if(PageStatus.isProfile?page="profile":PageStatus.isDirectory&&(page="directory"),$j.browser.msie&&window.XMLHttpRequest){console.log("IE detected"),console.log("Trying with XMLHttpRequest");var xhr=new XMLHttpRequest;try{xhr.open("get",baseUrl+"?&providerName="+providerName+"&tab="+gender+"&sexpref="+sexpref+"&lang="+Cam4User.lang+"&flag="+(tabBased?"0":"1")+"&timestamp="+(new Date).getTime()),xhr.onreadystatechange=function(){console.log("get xml ads VVV"),4==xhr.readyState&&(200==xhr.status?(console.log("content loaded with length: "+xhr.responseText.length),ControlledFeatures.USE_CAM4RED?randomHomepageAds.setAds(xhr.responseText,"xmlAds"):$j(".xmlAdsWrapper .camads-content").html(xhr.responseText),$j(".xmlAdsWrapper").show(),$j(".xmlAdsTitle").show(),Cam4AdsTool.adjustAdsWidth(),$j(".xmlAdsWrapper .camads-content .profile-box").click(function(){var adzone=$j(this).parent().attr("data-adzone"),camUrl="/cam4ultimate?repage=cam&reargs="+encodeURIComponent($j(this).find(".profile-username:first-child").html())+"&adzone="+adzone+"&page="+page+"&gender="+gender+"&sexpref="+sexpref;window.open(camUrl,"_blank")})):console.log("Error while loading Cam4Ultimate ads: "+xhr.status),callback&&callback())},xhr.send()}catch(err){console.log(err),flag=!0}if(flag&&(console.log("Trying with XDomainRequest"),window.XDomainRequest)){console.log("XDomainRequest available");var xdr=new XDomainRequest;xdr.open("get",baseUrl+"?&providerName="+providerName+"&tab="+gender+"&sexpref="+sexpref+"&lang="+Cam4User.lang+"&flag="+(tabBased?"0":"1")+"&timestamp="+(new Date).getTime()),console.log("Loading: "+baseUrl+"?tab="+gender+"&sexpref="+sexpref+"&flag="+(tabBased?"0":"1")),xdr.onload=function(){console.log("content loaded with length: "+xdr.responseText.length),ControlledFeatures.USE_CAM4RED?randomHomepageAds.setAds(xdr.responseText,"xmlAds"):$j(".xmlAdsWrapper .camads-content").html(xdr.responseText),$j(".xmlAdsWrapper").show(),$j(".xmlAdsTitle").show(),Cam4AdsTool.adjustAdsWidth(),$j(".xmlAdsWrapper .camads-content .profile-box").click(function(){var camUrl=$j(this).find("input[name=camUrl]").val();window.open(camUrl,"_blank")}),callback&&callback()},xdr.onprogress=function(){},xdr.ontimeout=function(){},xdr.onerror=function(){console.log("XDR error")},xdr.send()}}else $j.ajax({type:"GET",dataType:"html",cache:!1,url:baseUrl+"?&providerName="+providerName+"&tab="+gender+"&sexpref="+sexpref+"&lang="+Cam4User.lang+"&flag="+(tabBased?"0":"1")+"&timestamp="+(new Date).getTime(),success:function(res){res&&(ControlledFeatures.USE_CAM4RED?randomHomepageAds.setAds(res,"xmlAds"):$j(".xmlAdsWrapper .camads-content").html(res),$j(".xmlAdsWrapper").show(),$j(".xmlAdsTitle").show(),Cam4AdsTool.adjustAdsWidth(),$j(".xmlAdsWrapper .camads-content .profile-box").click(function(){var adzone=$j(this).parent().attr("data-adzone"),camUrl=$j(this).find("input[name=camUrl]").val()+"&adzone="+adzone+"&sexpref="+sexpref+"&gender="+gender+"&page="+page;window.open(camUrl,"_blank")})),callback&&callback()},error:function(jqXHR,textStatus,errorThrown){console.log(textStatus,errorThrown),"timeout"==errorThrown&&console.log("streamate response was timed out!"),callback&&callback()}})},callXmlAds:function(providerName){Cam4AdsTool.isIframe=!1,Cam4AdsTool.hideIframeAds(),console.log("calling callXmlAds"),$j("#iframeFooterAd").hide(),$j("#cam4UltimateFooterAd").show();var currentUrl=window.location.pathname.split("/"),whitelistedSexualPreferences=["straight","gay","bisexual","bicurious"],options={providerName:providerName,sexpref:"",gender:randomHomepageAds.getGenderContent(),baseUrl:Cam4Ultimate.footerAdServer,tabBased:!0};if(2 in currentUrl){var tabSexualPreference=currentUrl[2];options.sexpref=-1!=whitelistedSexualPreferences.indexOf(tabSexualPreference)?tabSexualPreference:options.sexpref}var timeOutProvider="cam4max"==options.providerName?5e3:1e3;console.log("Provider Name: "+options.providerName+" - timeOutProvider: "+timeOutProvider),Cam4AdsTool.getXmlAds(options.providerName,options.sexpref,options.gender,options.baseUrl,options.tabBased,function resendCam4UltimateRequest(){console.log("trying "+Cam4AdsTool.tryNo),setTimeout(function(){0===$j(".xmlAdsWrapper .camads-content .profile-box").length&&Cam4AdsTool.tryNo<=Cam4AdsTool.maxTries?(console.log("calling again!"),Cam4AdsTool.tryNo++,$j(".xmlAdsWrapper .camads-content").html(""),Cam4AdsTool.getXmlAds(options.providerName,options.sexpref,options.gender,options.baseUrl,options.tabBased,resendCam4UltimateRequest)):(console.log("exiting timeout.."),Cam4AdsTool.showSubFooterAds())},timeOutProvider)})},createIframe:function(url){var iframeProvider=$j("<iframe>",{src:url,frameborder:0,scrolling:"no"});ControlledFeatures.USE_CAM4RED?randomHomepageAds.setAds(iframeProvider,"iframe"):$j("#iframeFooterAd").empty().append(iframeProvider).show()},setLabels:function(name){var iframeContainer=$j("#iframeFooterAd");switch(name){case"cam4max":iframeContainer.addClass("cam4max").removeClass("cam4dildocam");break;case"cam4dildocam":iframeContainer.addClass("cam4dildocam").removeClass("cam4max")}},callIframeAds:function(name,url){Cam4AdsTool.isIframe=!0,Cam4AdsTool.createIframe(url),$j("#cam4UltimateFooterAd").hide(),$j(".xmlAdsTitle").show(),Cam4AdsTool.showSubFooterAds(),Cam4AdsTool.adjustProviderLogo(name),Cam4AdsTool.setLabels(name)},hideIframeAds:function(){$j("#iframeFooterAd").hide()},getProviderBySplit:function(providers,weights,key){var split=100*Math.random();if(!providers.hasOwnProperty(key)||!weights.hasOwnProperty(key))return providers.default[0];for(var it=0;it<weights[key].length;it++)if(weights[key][it]>=split)return providers[key][it];return providers.default[0]},decideFooterAds:function(){var provider=Cam4AdsTool.getProviderBySplit(Cam4AdsTool.providerNamesMap,Cam4AdsTool.providerWeights,"default");switch(provider.type){case"iframe":Cam4AdsTool.callIframeAds(provider.name,provider.url);break;case"feed":Cam4AdsTool.callXmlAds(provider.name)}}};$j(document).ready(function(){Cam4AdsTool.decideFooterAds()}),$j(window).resize(function(){Cam4AdsTool.adjustAdsWidth()})}
var mapAdsIds = {
    _mobileFooter: {
        straight: 9,
        gay: 28,
        shemale: 54
    }
};

function setBigIMG(newSRC) {
    document.getElementById('displayPhoto').src = newSRC;
}

/*
 * Window location origin polyfill for IE10
 * */
if (!window.location.origin) {
    window.location.origin = window.location.protocol + '//' + window.location.hostname + (window.location.port ? ':' + window.location.port : '');
}

function showLoginBox() {
    if (document.getElementById('loginForm')) {
        document.getElementById('loginForm').style.display = 'block';
    }
    if (document.getElementById('loginStatus')) {
        document.getElementById('loginStatus').style.display = 'none';
    }
    $j('#usernameBox').focus();

    window['Cam4MiniLoginOpened'] = true;
}

function hideLoginBox() {
    document.getElementById('loginForm').style.display = 'none';
    document.getElementById('loginStatus').style.display = 'block';
    window['Cam4MiniLoginOpened'] = false;
}

function popTerm(URL) {
    window.open(URL, 'terms', 'width=790,scrollbars=YES');
}

function profileEmailSetup() {
    //do not run if page is not profile email
    if ($j('#pagename').text() != 'profile.email')
        return;

    $j('#add_email_edit').change(function () {
        $j('#add_email_verify').html('<img src="' + WEB_CDN + '/images/ajax-loader.gif" height="16" width="16" /> ...');
        var data = {'action': 'validateEmail', 'email': $j('#add_email_edit').val()};
        $j('#add_email_verify').load('index.jsp', data,
            function (response, status, xhr) {
                if (status == 'success') {
                    setTimeout(function () {
                        if ($j('#validEmail').text() == 'true') {
                            $j('#add_user_email').fadeIn('slow');
                            $j('#add_user_email').addClass('button');
                            $j('#add_email_verify').fadeOut(1000);
                        } else {
                            $j('#add_email_verify').fadeOut('slow');
                        }

                    }, 400);
                }
            }
        );
    });

    $j('#add_user_email').click(function () {
        var data = {'action': 'addNewEmail', 'email': $j('#add_email_edit').val()};
    });

    $j('#add_user_email').fadeOut(3000);

}

function cookiesEnabled() {
    var cookieEnabled = !!(navigator.cookieEnabled);

    if (typeof navigator.cookieEnabled == 'undefined' && !cookieEnabled) {
        document.cookie = 'testcookie';
        cookieEnabled = (document.cookie.indexOf('testcookie') != -1);
    }
    return (cookieEnabled);
}

function setupNoCookiesEnabledMessage() {
    if (cookiesEnabled())
        return;

    var message = '';

    //content of message may need escaped (We're) therefore we load it from an element
    if (document.getElementById('cookieDisabledMessage')) {
        message = document.getElementById('cookieDisabledMessage').innerHTML;
    } else {
        document.location = '/login';
    }

    $j('#innerLoginForm, #loginPageForm').html(message);
}

function setupExclusiveCheck(none, other) {
    none.change(function () {
        if (none.attr('checked')) {
            other.attr('checked', false);
        }
    });

    other.change(function () {
        other.each(function (idx, elem) {
            if (other[idx].checked) {
                none.attr('checked', false);
            }
        });
    });
}

function setupExclusiveProfileEditCheckboxes() {
    //do not run if page is not contacts page
    if ($j('#pagename').text() != 'profile.edit.options')
        return;

    var bodyDecorationNoneCheckbox = $j("#profileBodyDecorationsDiv input[value='none']");
    var bodyDecorationOtherCheckbox = $j("#profileBodyDecorationsDiv input[value!='none']");
    setupExclusiveCheck(bodyDecorationNoneCheckbox, bodyDecorationOtherCheckbox);

    var bodyFacialHairNoneCheckbox = $j("#profileFacialHairDiv input[value='none']");
    var bodyFacialHairOtherCheckbox = $j("#profileFacialHairDiv input[value!='none']");
    setupExclusiveCheck(bodyFacialHairNoneCheckbox, bodyFacialHairOtherCheckbox);

}

function contactsSetup() {

    //do not run if page is not contacts page
    if ($j('#pagename').text() != 'contact.request') {
        return;
    }

    var sendContactRequest = $j('#sendContactRequest'),
        contactForm = $j('#contactForm'),
        email = $j('#email'),
        emailSpan = $j('#emailSpanContact'),
        emailSpan2 = $j('#emailSpan'),
        emailValidation = $j('#contactEmailValidation'),
        loaderHtml = '<img src="' + WEB_CDN + '/images/ajax-loader.gif" height="16" width="16" />  ...';

    email.on('change', function () {
        emailSpan.html(loaderHtml);
        emailSpan2.html(loaderHtml);

        $j.ajax({
            type: 'POST',
            url: '/contact',
            headers: {'validate-only': 'true'},
            data: {'email': $j('#email').val()},
            beforeSend: function (xhr) {
                xhr.setRequestHeader('validate-only', 'true');
            },
            success: function (data) {
                var cotent = '<div class="hidden" id="sendresult">' + data.sendresult + '</div>' +
                    '<div class="hidden" id="alertMessage">' + data.alertMessage + '</div>' +
                    '<div class="hidden" id="validEmail">' + data.validEmail + '</div>';
                if (data.validEmail == true) {
                    emailValidation.removeClass('hidden glyphicon-remove alert-danger')
                        .addClass('alert-success glyphicon-ok');
                } else {
                    emailValidation.removeClass('hidden glyphicon-ok alert-success')
                        .addClass('alert-danger glyphicon-remove');
                    cotent += '<span class="invalid">' + data.error + '</span>';
                }
                emailSpan.html(cotent);
                emailSpan2.html(cotent);

                setTimeout(function () {
                    validateContactForm();
                }, 400);
            },
            error: function () {
                emailSpan.html('');
                emailSpan2.html('');
            }
        });
    });
    //message length validation
    $j('#message').keyup(function () {
        validateContactForm();
    });

    //setup submit contact
    sendContactRequest.on('click', function () {
        sendContactRequest.attr('disabled', 'disabled');
        emailSpan.html('');
        emailSpan2.html('');
        var data = {
            'email': $j('#email').val(),
            'body': $j('#message').val(),
            'recipient': $j('#recipient').val(),
            'language': $j('#language').val(),
            'mailType': $j('#mailType').val()
        };
        sendContactRequest
            .html(loaderHtml)
            .load('/contact', data,
                function (data, status, xhr) {
                    sendContactRequest.removeAttr('disabled');
                    if (status == 'success') {
                        var dataParam = JSON.parse(data);
                        setTimeout(function () {
                            var alertMessage = dataParam.alertMessage,
                                sendresult = dataParam.sendresult == true,
                                mainMessage = $j('#mainMessage'),
                                contactFormH3 = $j('#contactFormWrapper h3');

                            if (sendresult) {
                                contactForm.fadeOut('slow');

                                mainMessage.attr('class', 'errorMessage alert alert-success');
                                mainMessage.removeClass('hidden').html(alertMessage).fadeIn('fast');
                                contactFormH3.fadeOut('slow');
                            } else {
                                contactForm.hide();
                                contactFormH3.hide();

                                mainMessage.attr('class', 'errorMessage alert alert-danger')
                                    .removeClass('hidden')
                                    .html(alertMessage).show();
                            }
                        }, 400);
                    }
                }
            );
    });
}

function validateContactForm() {
    var validEmail,
        validMessage,
        textAreaMessage = $j('#textareaMessage'),
        sendContactRequest = $j('#sendContactRequest');

    validEmail = $j('#validEmail').text() == 'true';
    validMessage = ($j('#message').val().length >= 10);

    if (validMessage) {
        textAreaMessage.fadeOut('slow');
    } else {
        textAreaMessage.fadeIn('slow');
        sendContactRequest.attr('disabled', 'disabled').removeClass('button');
    }

    if (validEmail && validMessage) {
        sendContactRequest.removeAttr('disabled').addClass('button');
    } else {
        sendContactRequest.attr('disabled', 'disabled');
    }
}

function openFileLikeOverlay() {
    var $loading = $j('<div class="loadingOverlay"><img src="' + WEB_CDN + '/images/loader.gif" alt="loading" title="loading"></div>');
    var i = 0;
    $j('.activateOverlayJquery a').each(function () {
        i++;
        var $dialog = $j('<div id="' + i.toString() + '"></div>').append($loading.clone());
        var $link = $j(this).on('click', function () {
            $dialog
                .load($link.attr('href') + ' #overlayWrap')
                .dialog({
                    width: 625,
                    height: 600,
                    minHeight: 600,
                    modal: true,
                    open: function () {
                        if (document.getElementById('name_element')) {
                            limitText(document.getElementById('name_element'), document.getElementById('remaining'), 50);
                        }
                    }
                });
            $link.click(function () {
                var aLink = $j('#btnWrap a');
                aLink.show();
                $dialog.dialog('open');
                // element.appendTo("#regForm");
                return false;
            });
            $j('.ui-resizable-handle').css({display: 'none'});
            $j('.ui-dialog .ui-dialog-content').css({padding: 0});
            $j('.ui-dialog .ui-dialog-titlebar').css({display: 'none'});
            $j('.ui-widget-content').css({background: 'transparent'});
            $j('.ui-widget-content').css({border: 'none'});
            return false;
        });
        console.log('dumping $link href: ');
        console.log($link.attr('href'));
        $j('.closeOverlayJquery').live('click', function () {
            $dialog.dialog('close');
        });
    });
}

var fireAutoModal = false;
var fireAutoModalURL;

function activateOverlayItself(url, callback) {
    $j(document).ready(function () {
        fireAutoModal = true;
        fireAutoModalURL = url;
    });
}

function setupSignup() {

    var $link = $j('.initSignUp');
    var $dialog = $j('<div></div>');

    $j('.initSignUp').click(function () {

        $dialog.load($link.attr('href'))
            .dialog({
                autoOpen: false,
                width: 660,
                height: 700,
                modal: true
            });

        $dialog.dialog('open');

//cleanup the look of newly opened overly dialog
        $j('.ui-dialog').css('border', 'none');
        $j('.ui-dialog .ui-dialog-titlebar').css({display: 'none'});
        $j('.ui-widget-content').css({background: 'transparent'});
        $j('.ui-resizable-handle').css({display: 'none'});
// prevent the default action, e.g., following a link
        return false;
    });

    $j('.initSignUpClose').live('click', function () {
        $dialog.dialog('close');
    });

}

/**
 * Displays a splash screen with content from a url
 *
 * @method generalSplash
 * @param {String} url The page url. The content of the ulr will be inseted in the splash
 * @return {Boolean} Always return false (prevent the default action, e.g., following a link)
 */
function generalSplash(url) {

    var $dialog = $j('<div></div>');
    $dialog.load(url)
        .dialog({
            autoOpen: false,
            width: 660,
            height: 700,
            modal: true
        });

    $dialog.dialog('open');
    $j('.ui-dialog').css('background', 'none');
    $j('.ui-dialog .ui-dialog-titlebar').css({display: 'none'});
    $j('.ui-widget-content').css({background: 'transparent'});
    $j('.ui-resizable-handle').css({display: 'none'});

    $j('.initSignUpClose').live('click', function () {
        $dialog.dialog('close');
    });

    return false;
}

function refreshSecurityQuestion() {
    window.location = '/loginsecure?username=' + $j('form[action="/loginsecure"] input[name="username"]').val();
}

function setupSecurityQuestionRefresh() {
    if (1 != $j('#loginSecurePageForm').size())
        return;
    if (1 == $j('.error').size())
        return;
    var elem = $j('form[action="/loginsecure"] input[name="username"]');
    elem.blur(function (e) {
        refreshSecurityQuestion();
    });
}

function removeErrorsMessages() {
    $j('body').on('keyup', '#twoFACodeValidationInput', function (e) {
        var keycode = (e.keyCode ? e.keyCode : e.which);
        if (keycode === 13) {
            if ($j('#loginForm').is(':visible')) {
                loginTwoFA();
            } else {
                validateCode();
            }
        }

        $('#validationCodeSpan').html('').removeClass('greenColor');
    });

    $j('body').on('keyup', '#passwordModalDisable', function (e) {
        var keycode = (e.keyCode ? e.keyCode : e.which);
        if (keycode === 13) {
            disableTwoFa();
        }

        $('#validationCodeSpan').html('').removeClass('greenColor');
    });

    $j('body').on('change', '.countryCodeSelect', function () {
        $j('#countryCodeSpan').html('');
        if ($(this).val() !== 'null') {
            var numbersOfChars = $(this).val().length;
            $j('.countryPrefix').html('(+' + $(this).val() + ')');
            $j('#phoneNumber').css('padding-left', 31 + numbersOfChars * 8);
        } else {
            $j('.countryPrefix').html('');
            $j('#phoneNumber').css('padding-left', 12);
        }
    });

    $j('body').on('keypress', '#phoneNumber', function (e) {
        var keycode = (e.keyCode ? e.keyCode : e.which);
        if (keycode === 69 || keycode === 101 || keycode === 46 || keycode === 45 || keycode === 43) {
            e.preventDefault();
            return false;
        }
    });

    $j('body').on('keyup', '#phoneNumber', function (e) {
        $j('#phoneNumberSpan').html('');
    });

    $j('body').on('keyup', '#password', function (e) {
        var keycode = (e.keyCode ? e.keyCode : e.which);
        if (keycode === 13) {
            processPhoneNumber();
        }

        $j('#passwordSpan').html('');
    });
}

function populateCountryDropdown() {
    $j.ajax({
        url: '/rest/v1.0/options/countries?full=true',
        type: 'get',
        success: function (response) {
            $j('#countryCode').append('<option value="-1">' + js_i18n.pleaseSelect + '</option>');
            response.forEach(function (country) {
                if (country.phoneNumberPrefix != null) {
                    $j('#countryCode').append('<option value="' + country.phoneNumberPrefix + '">' + country.name + '</option>');
                }
            });
            $j('#countryCode').selectpicker();
            $j('button[data-id="countryCode"]').attr('id', 'countryCodeDropdown');

        },
        error: function (response) {
        }
    });
}

function setupPromotionsConsent() {
    if (ControlledFeatures.GDPR_NEW_DESIGN) {
        $j('body').on('change', '#promotionsConsent', function() {
            var checkboxChecked = $('#promotionsConsent:checked').length === 1;
            $('input[name="promotions"]').val(checkboxChecked);
        });
    }
}

$j(document).ready(function () {
    try {
        setupSignup();
        openFileLikeOverlay();
        contactsSetup();
        profileEmailSetup();
        setupNoCookiesEnabledMessage();
        setupExclusiveProfileEditCheckboxes();
        setupSecurityQuestionRefresh();
        removeErrorsMessages();
        populateCountryDropdown();
        setupPromotionsConsent();
        if (showSignupPopup === true) {
            Utils.decideOffer();
        }
    } catch (e) {
        console.log(e);
    }

    if ($j('#rateUserDiv').length) {
        $j('.initSignUp').unbind();
    }
});

//  -->
//broadcast.js begin

var deliminator = '[=]';
var expireTime = 43150000;

function updateProfileField(fieldName, controlsType) {
    var obj = '';
    var inputValue = '';
    var params = '';
    var d = new Date().getTime();
    if (controlsType == 'Select') {
        inputValue = jQuery('#' + fieldName + '  option:selected').val();

    } else if (controlsType = 'Radio') {
        inputValue = jQuery("input[name='" + fieldName + "']:checked").val();
    } else if (controlsType == 'Input') {
        inputValue = jQuery('#' + fieldName).val();
    }

    if (fieldName == 'city') {
        inputValue = jQuery('#city').val();
        if (inputValue == '') {
            alert('please input  one city to add');
            return;
        }
    } else if (fieldName == 'occupation') {
        inputValue = jQuery('#occupation').val();
        if (inputValue == '') {
            alert('please input  one occupation to add');
            return;
        }
    } else if (fieldName == 'height') {
        var feetObj = document.getElementById('heightFeet');
        var inchObj = document.getElementById('heightInches');
        var strFeet = feetObj.options[feetObj.selectedIndex].value;
        var strInch = inchObj.options[inchObj.selectedIndex].value;
        if (strFeet == null || strInch == null) {
            alert('please input  your height correctly');
            return;
        }
        params = 'obj=height&valFeet=' + strFeet + '&valInch=' + strInch + '&d=' + d;
    } else if (fieldName == 'birthday') {
        var monthObj = document.getElementById('monthSelect');
        var dayObj = document.getElementById('daySelect');
        var yearObj = document.getElementById('yearSelect');
        var strMonth = monthObj.options[monthObj.selectedIndex].value;
        var strDay = dayObj.options[dayObj.selectedIndex].value;
        var strYear = yearObj.options[yearObj.selectedIndex].value;

        if (strMonth == 'Month' || strDay == 'Day' || strYear == 'Year') {
            return;
        }

        params = 'obj=birthday&valMonth=' + strMonth + '&valDay=' + strDay + '&valYear=' + strYear + '&d=' + d;

    } else if (fieldName == 'bodyDecorations') {
        obj = document.getElementsByName('bodyDecorations');
        inputValue = '';
        for (var i = 0; i < obj.length; i++) {
            if (obj[i].checked)
                inputValue += obj[i].value + ',';
        }
        if (inputValue == '')
            alert('please select at least one bodyDecoration to update');

    }
    else if (fieldName == 'facialHair') {
        obj = document.getElementsByName('facialHair');
        inputValue = '';
        for (var i = 0; i < obj.length; i++) {
            if (obj[i].checked)
                inputValue += obj[i].value + ',';
        }
        if (inputValue == '')
            alert('please select at least one facial Hair to update');
    }

    if (fieldName != 'height' && fieldName != 'birthday') {
        params = 'obj=' + fieldName + '&val=' + inputValue + '&d=' + d;
    }

    var url = '/profiles/profileUpdate.jsp';

    var resultInfoDiv = 'profileStatus';

    var jqxhr = $j.get(url + '?' + params, null, function (data) {
        document.getElementById(resultInfoDiv).innerHTML = data;
        showStatsResult(fieldName, 'default', 'afterSave', false);
    }, 'html');

}

function ajxUpdateFailure(resp) {
    alert('Ajax error: ' + resp);
}

function update_questionnaire(question_id, updateProfile) {
    var strQuestionResp = jQuery('#questionnaireResponses_' + question_id).val();

    var d = new Date().getTime();
    if (updateProfile == 'true') {
        if (strQuestionResp == '' || strQuestionResp == null) {
            alert('strQuestionResp is null');
            return;
        }
    }

    $j.ajax({
        type: 'GET',
        url: '/profiles/profileUpdate.jsp?',
        data: 'target=questionnaire&questionId=' + question_id + '&questionResp=' + strQuestionResp + '&update=' + updateProfile + '&d=' + d,
        success: function (data) {
            $j('#profileStatus_questionnaire').html(data);
            if (updateProfile == true)
                showStatsResult('questionnaire', question_id, 'afterSave', false);
        },
        onFailure: ajxUpdateFailure
    });

}

function showStatsResult(fieldName, key, direction, save2Buffer) {
    var d = new Date().getTime();
    var resultInfoDiv = 'profileStatus_' + fieldName;
    var params = 'target=' + resultInfoDiv + '&key=' + key + '&direction=' + direction + '&d=' + d;

    var url = '/profiles/profileUpdate.jsp';
    var resultDiv = 'profileStatus';
    if (fieldName == 'questionnaire')
        resultDiv = 'profileStatus_questionnaire';

    $j.ajax({
        type: 'GET',
        url: '/profiles/profileUpdate.jsp?',
        data: params,
        success: function (data) {

            if (data.indexOf('Invalid') == -1) {
                if (fieldName == 'questionnaire') {
                    if (save2Buffer == true)
                        copyDivHtmlContent('profileStatus_questionnaire', 'QuestionnaireDivBuffer');
                }
                else {
                    copyDivHtmlContent('profileStatus', 'profileStatusBuffer'); //backup original div contents

                }
                $j('#' + resultDiv).html(data);
                $j('#profileStatus .plainLink1').after($('#profileStatus').find('.goalBar2'));
            }
        },
        onFailure: ajxUpdateFailure
    });
}

function copyDivHtmlContent(srcDiv, dstDiv) {
    var container = document.getElementById(dstDiv);
    container.innerHTML = document.getElementById(srcDiv).innerHTML;
}

//update.profile.js  end

function toggleBgImage(elem) {
    var style2 = elem.style;
    style2.backgroundImage = style2.backgroundImage ? '' : 'url(/images/checkout/information-balloon24green.png)';
}

function extractCDATA(element) {
    if (element) {
        for (var i = 0; i < element.childNodes.length; i++) {
            var nodeType = element.childNodes[i].nodeType;
            // fix for IE
            // 4 CDATA nodeType
            // 8 COMMENT nodeType
            if (nodeType == 4 || nodeType == 8) {
                return element.childNodes[i].data.replace(/\s*\[CDATA\[/, '').replace(/\]\]\s*/, '');
            }
        }
    }
    return '';
}

function copyCDATAToElement(src, dst) {
    if (dst) {
        dst.innerHTML = extractCDATA(src);

        //Check if the taboocams URLs respond with a 404 error
        if ($j('body').hasClass('taboocamscom') && !Cam4User.isPayingMember()) {
            Cam4Xtra.checkTaboocamsAdsStatusCode(dst);
        }
    }
}


function changeSexGameURL(isDesktop, isGay, isShemale) {
    var elements = document.querySelectorAll('.sexgames'),
        sexGameURL = '';

    var isStraight = false;
    if ((!isGay) && (!isShemale)) {
        isStraight = true;
    }
    if (isDesktop) {
        if (isGay) {
            sexGameURL = Cam4User.desktopGaySexGamesUrl;
        }
        if (isShemale) {
            sexGameURL = Cam4User.desktopShemaleSexGamesUrl;
        }
        if (isStraight) {
            sexGameURL = Cam4User.desktopStraightSexGamesUrl;
        }
    } else {
        if (UserAgent.tablet) {
            if (isGay) {
                sexGameURL = Cam4User.tabletGaySexGamesUrl;
            }
            if (isShemale) {
                sexGameURL = Cam4User.tabletShemaleSexGamesUrl;
                ;
            }
            if (isStraight) {
                sexGameURL = Cam4User.tabletStraightSexGamesUrl;
            }
        } else {
            if (isGay) {
                sexGameURL = Cam4User.mobileGaySexGamesUrl;
            }
            if (isShemale) {
                sexGameURL = Cam4User.mobileShemaleSexGamesUrl;
            }
            if (isStraight) {
                sexGameURL = Cam4User.mobileStraightSexGamesUrl;
            }
        }
    }

    if (typeof elements != null && sexGameURL !== '') {
        for (var i = 0; i < elements.length; i++) {
            elements[i].setAttribute('href', sexGameURL);
        }
    }
}

function formatAdsUrl(textContent, id) {
    var filters = getFilters();
    var adsNewUrl = [];
    adsNewUrl.push('gender=' + filters.gender);
    adsNewUrl.push('category=' + filters.sexualPreference);
    var adId = 9;
    if (mapAdsIds[id][filters.sexualPreference] !== undefined) {
        adId = mapAdsIds[id][filters.sexualPreference];
    }
    adsNewUrl.push('id=' + adId);
    adsNewUrl = adsNewUrl.join('&');
    return textContent.replace(/(\?)(.*)"/, '?' + adsNewUrl + '"');
}

function decideAdsGender() {
    var adsContainer = $j('#loading_ads #_mobileFooter');
    for (var i = 0; i < adsContainer.length; i++) {
        if ($j('body').hasClass('taboocamscom')) {
            $j(adsContainer[i]).attr('src', $j(adsContainer[i]).attr('src'));
        }
    }

    /* Cam4Ultimate */
    function updateCam4Ads() {
        if (typeof Cam4AdsTool !== 'undefined') {
            Cam4AdsTool.decideFooterAds();
            if ($j('#cam4UltimateFooterAd .profile-box').length === 0 && !Cam4AdsTool.isIframe && Cam4AdsTool.tryNo <= Cam4AdsTool.maxTries) {
                setTimeout(updateCam4Ads, 1000);
            }
        }
    }

    updateCam4Ads();
}

function getFilters() {
    var gender, category;
    if (Cam4User && Cam4User.userGender && Cam4User.userSexPref) {
        gender = Cam4User.userGender;
        category = Cam4User.userSexPref;
    } else {
        switch (randomHomepageAds.getGenderContent()) {
            case "male":
                gender = 'male';
                category = 'gay';
                break;
            case "shemale":
                gender = 'shemale';
                category = 'shemale';
                break;
            default:
                gender = 'female';
                category = 'straight';
        }
    }
    return {gender: gender, sexualPreference: category};
}

function changeDatingURL(isDesktop, isGay, isShemale) {

    var elements = document.querySelectorAll('.meetandfuck'),
        datingTabUrl = '';

    var isStraight = false;
    if (!isGay && !isShemale) {
        isStraight = true;
    }
    if (isDesktop) {
        if (isGay) {
            datingTabUrl = Cam4User.desktopGayDatingUrl;
        }
        if (isShemale) {
            datingTabUrl = Cam4User.desktopShemaleDatingUrl;
        }
        if (isStraight) {
            datingTabUrl = Cam4User.desktopStraightDatingUrl;
        }
    } else {
        if (UserAgent.tablet) {
            if (isGay) {
                datingTabUrl = Cam4User.tabletGayDatingUrl;
            }
            if (isShemale) {
                datingTabUrl = Cam4User.tabletShemaleDatingUrl;
            }
            if (isStraight) {
                datingTabUrl = Cam4User.tabletStraightDatingUrl;
            }
        } else {
            if (isGay) {
                datingTabUrl = Cam4User.mobileGayDatingUrl;
            }
            if (isShemale) {
                datingTabUrl = Cam4User.mobileShemaleDatingUrl;
            }
            if (isStraight) {
                datingTabUrl = Cam4User.mobileStraightDatingUrl;
            }
        }
    }

    if (typeof elements != null && datingTabUrl !== '') {
        for (var i = 0; i < elements.length; i++) {
            elements[i].setAttribute('href', datingTabUrl);
        }
    }
}

function updateAds(data) {
    if (!document.getElementById('loading_ads')) {
        return;
    }

    document.getElementById('loading_ads').innerHTML = data;
    decideAdsGender();
    copyCDATAToElement(document.getElementById('_headerBanner'), document.getElementById('headerBanner'));
    copyCDATAToElement(document.getElementById('_besideBroadcasting'), document.getElementById('besideBroadcasting'));

    copyCDATAToElement(document.getElementById('_mobileFooter'), document.getElementById('mobileFooter'));

    copyCDATAToElement(document.getElementById('_sidebarTop'), document.getElementById('sidebarTop'));
    // copyCDATAToElement(document.getElementById('_sidebarBottom'), document.getElementById('sidebarBottom'));
    // copyCDATAToElement(document.getElementById('_sidebarThird'), document.getElementById('sidebarThird'));
    copyCDATAToElement(document.getElementById('_footerFirst'), document.getElementById('footerFirst'));
    copyCDATAToElement(document.getElementById('_footerSecond'), document.getElementById('footerSecond'));
    copyCDATAToElement(document.getElementById('_footerThird'), document.getElementById('footerThird'));
    copyCDATAToElement(document.getElementById('_footerNative'), document.getElementById('footerNative'));

    copyCDATAToElement(document.getElementById('_profilePostrollAd'), document.getElementById('profilePostrollAd'));
    copyCDATAToElement(document.getElementById('_videoBannerMidrollAd'), document.getElementById('videoBannerMidrollAd'));
    copyCDATAToElement(document.getElementById('_profileLeaderboardFirst'), document.getElementById('profileLeaderboardFirst'));
    copyCDATAToElement(document.getElementById('_profile-ad'), document.getElementById('profile-ad'));
    copyCDATAToElement(document.getElementById('_skyscraper-ad-1'), document.getElementById('skyscraper-ad-1'));
    copyCDATAToElement(document.getElementById('_skyscraper-ad-2'), document.getElementById('skyscraper-ad-2'));

    // If not on directory, do not wait for xmlAds
    //
    if (typeof Directory === 'undefined') {
        $j('#subfoot .subfoot-section').show();
    }

}

// This is to clean up the JS code for the menuTabs.js where print a different class for IE6

function submitForm() {
    if ($j('#emailSpanContact').hasClass('error') || $j('#emailSpan').hasClass('error') || $j('#userNameSpan').hasClass('error')) {
        showMessages();
        return;
    }
    document.paymentForm.submit();
}

function submitFormWithNewEmail() {
    if (Cam4User.isLoggedInAsGuest || Cam4User.isLoggedIn || !Cam4User.useGuestBilling) {
        return;
    }

    var submitNewEmail = $j.ajax({
        type: 'POST',
        url: '/signup',
        data: $j('#provideNewEmailForm').serialize() + '&isGuestSignup=true',
        dataType: 'text'
    });

    submitNewEmail.done(function (data) {
        switch (data) {
            case 'SUCCESS':
                window.location.reload();
                break;
            default:
                break;
        }
    });

    submitNewEmail.fail(function () {
        console.log('submitNewEmail failed!');
    });

}

function submitFormWithPassword(event) {
    if (event) {
        try {
            event.preventDefault();
        } catch (ex) {
            console.log(ex);
        }
    }

    if (okToSubmitFormWithPassword()) {

        dataLayer.push({
            'event': 'SidebarRegistration',
            'login': document.getElementById('userName').value,
            'email': document.getElementById('email').value
        });

        var formProductId = $j('#paymentForm input[name=productId][type=radio]:checked').val();
        if (typeof(formProductId) == 'undefined') {
            formProductId = $j('#paymentForm input[name=productId]').val();
        }
        var isGoldSignup = ($j('#Cam4DialogContainer .registration-modal form')
            .find('input[name=isGoldSignup]').val() == 'true');

        var paymentForm = $j('#paymentForm');
        var paymentFormInput = paymentForm.find('input');

        if (Cam4User.isLoggedInAsGuest) {
            // For upselling guest accounts
            //
            var dataString = $j('#Cam4DialogContainer .registration-modal form').serialize();
            var goldCheckoutURL = Utils.getCheckoutMembershipURL('default');

            // For basic upsell this function
            // will be called in the original window.
            //
            // However for GOLD upsell, this function is injected
            // and executed within a new window, in order
            // for the checkout popup to bypass
            // browser AdBlocker plugins; it is called from
            // an asynchronous request.
            //
            // NOTE: jQuery is also included in the new window
            // in order to execute the $j.ajax POST call.
            //
            function _asyncSignupSubmit(dString, isGold, goldURL, useEpayFlow) {
                var refreshTarget,
                    isNewWindow = false;
                if (typeof(goldURL) !== 'undefined') {
                    refreshTarget = window.opener;
                    isNewWindow = true;
                } else {
                    refreshTarget = window;
                }

                if (typeof($j) === 'undefined') {
                    $j = jQuery;
                }

                function __closeOnError() {
                    if (isNewWindow) {
                        window.close();
                    } else {
                        try {
                            Utils.closeModalPops();
                        } catch (ex) {
                            //
                        }
                    }
                }

                if (isGold && useEpayFlow) {
                    var winSpecs = epay.tool.determineCheckoutWindowSpecs(
                        paymentForm.find('input[name=processorId]').val(), 'CC');
                    epay.DomMan.submissionWindow =
                        epay.DomMan.preOpenCheckoutWindow(winSpecs);
                }

                $j.ajax({
                    url: '/signup',
                    type: 'POST',
                    data: dString,
                    dataType: 'text',
                    success: function (res) {
                        // treat res
                        //
                        if (typeof res == 'string') {
                            res = JSON.parse(res);
                        }

                        var status = (typeof res == 'object' && res.status)
                            ? res.status : res;

                        switch (status) {
                            case 'SUCCESS':
                                if (isGold && useEpayFlow) {
                                    var obj = Utils.convertUriToJson(dString);

                                    var data = {
                                        userName: res.userName,
                                        accessHash: res.accessHash,
                                        email: Cam4User.email,
                                        processorId: paymentForm.find('input[name=processorId]').val()
                                    };
                                    EpayPlugin.submitGuestToGold(data, function () {
                                        window.location.reload();
                                    });
                                } else {
                                    if (isGold && isNewWindow) {
                                        window.location.href = goldURL;
                                    }
                                    refreshTarget.location.reload();
                                }
                                break;
                            default:
                                __closeOnError();
                                break;
                        }
                    },
                    error: function (err) {
                        __closeOnError();
                    }
                });
            }

            if (isGoldSignup) {
                _asyncSignupSubmit(dataString, isGoldSignup, '', true);
            } else {
                _asyncSignupSubmit(dataString);
            }

        } else if (!Cam4User.isLoggedIn && isGoldSignup) {

            var userName = document.getElementById('userName').value;
            var password = document.getElementById('newPassword').value;
            var email = document.getElementById('email').value;

            if (window.location.origin) {
                var locationOrigin = window.location.origin;
            } else {
                var locationOrigin = window.location.protocol + '//' + SERVER_NAME;
            }

            var signupData = {};

            for (var i = 0; i < paymentFormInput.length; i++) {
                signupData[paymentFormInput[i].name] = paymentFormInput[i].value;
            }

            EpayPlugin.createUserBeforeGold(signupData, function (res) {
                var data = {
                    userName: userName,
                    accessHash: res.accessHash,
                    email: email,
                    processorId: paymentForm.find('input[name=processorId]').val()
                };
                EpayPlugin.settings.args.passThrough.membershipOperation = res.membershipOperation;
                EpayPlugin.submitGuestToGold(data);
            });

            var calls = 0;

            function startCheck() {
                $j.ajax({
                    url: '/verify/status?username=' + userName + '&_=' + (new Date()).getTime(),
                    type: 'GET',
                    error: function (err, status, errThrown) {

                        calls++;
                        if (calls < 500) {
                            setTimeout(startCheck, 500);
                        }
                    },
                    success: function (result) {
                        if (result.success) {
                            window.location = '/verify?manual_verification=true' +
                                getAvailableRegistrationOptions();
                        } else {
                            calls++;
                            if (calls < 500) {
                                setTimeout(startCheck, 500);
                            }

                        }
                    }
                });
            }

            setTimeout(startCheck, 1000);

        } else {
            /*
             http://documentcloud.github.io/underscore/#isElement
             This will happen when the registration form is in the sidebar and also in the modal.
             */
            if (document.querySelector('form button[type=submit]')) {
                document.querySelector('form button[type=submit]').setAttribute('disabled', 'disabled');
            }
            if (typeof _ === typeof Function && !_.isElement(document.paymentForm)) {
                document.paymentForm[0].submit();
            } else {
                document.paymentForm.submit();
            }
        }

    } else {
        document.querySelector('form button[type=submit]').removeAttribute('disabled');
        showMessages();
    }
}

function okToSubmitFormWithPassword() {
    processPasswordWithUsername();
    if (!Cam4User.isLoggedInAsGuest &&
        ($j('#emailSpan').hasClass('error') ||
        $j('#emailSpanContact').hasClass('error') ||
        $j('#userNameSpan').hasClass('error') || !fPassOk)) {
        return false;
    } else if ($j('#userNameSpan').hasClass('error') || !fPassOk) {
        return false;
    }
    return true;
}

// Code from password.jsp

function isFormComplete() {
    return (fPassOk && fPassConfirmOk);
}

function setAppropriateSpanClass(objId, success) {
    if (typeof mainPasswordStyle != 'undefined') {
        if (success)
            document.getElementById(objId).className = 'helperInfoField';
        else
            document.getElementById(objId).className = 'helperInfoField error';
        return;
    }

    if (success) {
        document.getElementById(objId).className = 'helperInfoFieldOk';
    } else {
        document.getElementById(objId).className = 'helperInfoFieldError';
    }
}

function processJsonField(spanId, json) {
    document.getElementById(spanId).innerHTML = json.message;
    setAppropriateSpanClass(spanId, json.success);
}

// This will simulate change in all of the fields thus allowing each field to validate automagically
function recheckForm() {
    if (!fPassOk) {
        processPassword();
    }
    if (!fPassConfirmOk) {
        processPasswordConfirm();
    }
}

function checkPassword(userName, pwTxt) {

    // Make sure userName and password are not the same
    if (pwTxt == '') {
        return {
            'message': document.getElementById('passCantBeBlank').innerHTML,
            'success': false
        };
    }

    if (userName.toLowerCase() == pwTxt.toLowerCase()) {
        return {
            'message': document.getElementById('passUserIdCantBeSame').innerHTML,
            'success': false
        };
    }

    var upperCase= new RegExp('[A-Z]');
    var lowerCase= new RegExp('[a-z]');
    if(pwTxt.match(upperCase) == null || pwTxt.match(lowerCase) == null)
    {
        return {'message': js_i18n.mustContainLowercaseUppercase, 'success': false};
    }

    // Make sure password has the right length
    if (pwTxt.length < passwordMinLength || pwTxt.length > passwordMaxLength) {
        return {
            'message': document.getElementById('profilePassLenghtMsg').innerHTML,
            'success': false
        };
    }

    var passStrength = (strengthIncreased == 'true');

    if (passStrength) {
        // Make sure password contains at least one lowercase character
        if (!(/(?=.*[a-z])/.test(pwTxt))) {
            return {
                'message': document.getElementById('passLowercase').innerHTML,
                'success': false
            };
        }

        // Make sure password contains at least one uppercase character
        if (!(/(?=.*[A-Z])/.test(pwTxt))) {
            return {
                'message': document.getElementById('passUppercase').innerHTML,
                'success': false
            };
        }

        var specialC = specialChars;
        specialC = specialC.replace("[", "\\[");
        specialC = specialC.replace("]", "\\]");
        var passRegex = "(?=.*[" + specialC + "])"
        var regex = RegExp(passRegex);

        // Make sure password contains at least one special character
        if (!(regex.test(pwTxt))) {
            return {
                'message': document.getElementById('passSpecialCharacter').innerHTML,
                'success': false
            };
        }

        if (!(/^[a-zA-Z0-9!#$%&()*+,./:;<>=?@^_{|}\]\[]*$/.test(pwTxt))) {
            return {
                'message': document.getElementById('passIllegalChar').innerHTML,
                'success': false
            };
        }
    } else {
        if (/[^0-9a-z]/i.test(pwTxt)) {
            return {
                'message': document.getElementById('passCanBeNumAlpha').innerHTML,
                'success': false
            };
        }
    }

    // check basic password strength

    var score = 0;

    var toadd = {
        'letters': 1,
        'digits': 1,
        'specials': 1
    };

    if (pwTxt.match(/[a-zA-Z]/)) {    // letters
        score += 1;
        toadd.letters = 0;
    }

    if (pwTxt.match(/\d+/)) {      // digits
        score += 1;
        toadd.digits = 0;
    }

    if (pwTxt.match(/[!,@#$%^&*?_~]/)) {  // specials
        score += 1;
        toadd.specials = 0;
    }

    return {'message': document.getElementById('passOkMsg').innerHTML, 'success': true};
}

function processPassword() {
    var pwTxt = $j('#newPassword').val();

    json = checkPassword(userNameEditPassword, pwTxt);
    if (json.success == false) {
        jQuery('#validation').val(document.getElementById('passFailed').innerHTML);
    }
    fPassOk = json.success;
    processJsonField('passwordSpan', json);
}

function registerUser(event) {
    if (ControlledFeatures.AVOID_WEAK_PASSWORD && !fPassOk) {
        return;
    }
    registerOptionsGA();
    submitFormWithPassword(event);

}

function registerOptionsGA() {
    if (okToSubmitFormWithPassword()) {
        var ProductId = $j('#paymentForm input[name=productId][type=radio]:checked').val();
        if (ProductId == 14) {
            dataLayer.push({'event': 'Register Trial Account'});
        }
        if (ProductId == 1) {
            dataLayer.push({'event': 'Register Full Account'});
        }
    }
}

function validatePassword() {
    processPasswordWithUsername();
    if (ControlledFeatures.AVOID_WEAK_PASSWORD && fPassOk) {
        validateWeakPassword();
    }
}

var passwordCache = new Object();

function validateWeakPassword() {
    if (ControlledFeatures.AVOID_WEAK_PASSWORD) {
        var password = $j('#newPassword').val();
        var cachedStatus = passwordCache[password];
        if (cachedStatus !== undefined) {
            processWeakValidationResponse(cachedStatus);
            return;
        }

        var data = {
            'password': password
        };

        var request = $j.ajax({
            url: '/signup/validateWeakPassword',
            type: 'post',
            data: data,
            success: function (data) {
                var status = data.status;
                console.log("Weak password validation status: " + status);
                processWeakValidationResponse(status);
                passwordCache[password] = status;
            },
            failure: function (result) {
                var spanId = 'passwordSpan';
                processWeakValidation(spanId, true, 'passOkMsg');
                passwordCache[password] = 'GOOD_PASSWORD';
            }
        });
    }
}

function processWeakValidationResponse(status) {
    var spanId = 'passwordSpan';
    switch (status) {
        case 'ERR_WEAK_PASSWORD': {
            processWeakValidation(spanId, false, 'passWeakMsg');
            break;
        }
        case 'ERR_PASSWORD_TOO_SHORT': {
            processWeakValidation(spanId, false, 'passTooShortMsg');
            break;
        }
        case 'GOOD_PASSWORD':
        case 'FAILED': {
            processWeakValidation(spanId, true, 'passOkMsg');
            break;
        }
        default: {
            processWeakValidation(spanId, true, 'passOkMsg');
        }
    }
}

function processWeakValidation(objId, success, message) {
    document.getElementById(objId).innerText = document.getElementById(message).innerHTML;
    fPassOk = success;
    setAppropriateSpanClass(objId, success);
}

function processPasswordWithUsername() {
    var pwTxt = $j('#newPassword').val();
    userNameEditPassword = $j('#userName').val();
    json = checkPassword(userNameEditPassword, pwTxt);
    if (json.success == false) {
        jQuery('#validation').val(document.getElementById('passFailed').innerHTML);
    }
    fPassOk = json.success;
    processJsonField('passwordSpan', json);
}

function submitPasswordChange() {
    var currentPassword = $j('#currentPassword').val();
    var newPassword = $j('#newPassword').val();
    var passwordConfirm = $j('#newPasswordConfirm').val();
    if (newPassword != passwordConfirm)
        return;
    var data = {
        'newPassword': newPassword,
        'newPasswordConfirm': passwordConfirm,
        'currentPassword': currentPassword,
        'action': 'save'
    };
    var url = '?' + Math.random();

    if (ControlledFeatures.TWO_FA) {
        var request = $j.ajax({
            url: window.location,
            type: 'post',
            data: data,
            success: function (data) {
                switch (data.status) {
                    case "SUCCESS":
                        $j('#passwordChangeResult').fadeIn('0');
                        setTimeout(function () {
                            $j('#passwordChangeResult').fadeOut('0');
                            window.location = '/' + userNameEditPassword + '/edit/password?changed=true';
                        }, 1000);
                        break;
                    case "VALIDATION_REQUIRED":
                        openTwoFaModal(twoFAModalChangePassword, data.operationId, data.phoneNumber, data.countryCode);
                        break;
                    case "FAILED":
                        setTimeout(function () {
                            $j('#passwordChangeResult').fadeOut('0');
                            window.location = '/' + userNameEditPassword + '/edit/password?failed=true';
                        }, 1000);
                }
            },
            failure: function () {
                setTimeout(function () {
                    $j('#passwordChangeResult').fadeOut('0');
                    window.location = '/' + userNameEditPassword + '/edit/password?failed=true';
                }, 1000);
            }
        });
    } else {
        $j(window).load(url, data, function (response, success, xhr) {
            if ('success' == success) {
                $j('#passwordChangeResult').fadeIn('0');
                if ('Changed' == response) {
                    setTimeout(function () {
                        $j('#passwordChangeResult').fadeOut('0');
                        window.location = '/' + userNameEditPassword + '/edit/password?changed=true';
                    }, 1000);
                } else {
                    setTimeout(function () {
                        $j('#passwordChangeResult').fadeOut('0');
                        window.location = '/' + userNameEditPassword + '/edit/password?failed=true';
                    }, 1000);
                }
            }
        });
    }
}

function submitPasswordChangeByReset() {
    if (!useNewFlow || useNewFlow !== "true") {
        setButtonActive(false);
        document.resetPasswordForm.submit();
    }
    else {
        var newPassword = document.resetPasswordForm["newPassword"].value;
        var newPasswordConfirm = document.resetPasswordForm["newPasswordConfirm"].value;
        var action = "save";
        var origUrl = document.resetPasswordForm["origUrl"].value;

        var username = document.resetPasswordForm["username"].value;

        var request = {};
        request.newPassword = newPassword;
        request.newPasswordConfirm = newPasswordConfirm;
        request.action = action;
        request.origUrl = origUrl;
        request.username = username;
        $("#invalidPassSpan").hide();
        console.log(document.resetPasswordForm.action);
        $.ajax({
            url: document.resetPasswordForm.action,
            data: request,
            type: "POST"
        }).done(function (data) {
            switch (data.status) {
                case "SUCCESS":
                    setTimeout(function () {
                        window.location = '/password/reset/thankyou';
                    }, 1000);
                    break;
                case "VALIDATION_REQUIRED":
                    openTwoFaModalResetPassword(twoFAModalResetPassword, data.operationId, data.phoneNumber, data.countryCode);
                    break;
                case "FAILED":
                    switch (data.details) {
                        case "invalid_new_password":
                            $("#invalidPassSpan").show();
                            break;
                        default:
                            window.location = '/signup/passwordError?errorCode=' + data.details;
                    }
                    console.log(data);
            }

        })

        console.log("use new flow");
    }
}

function changePasswordSuccess() {
    window.location = '/' + userNameEditPassword + '/edit/password?changed=true';
}

function changeEmailSuccess() {
    window.location = '/' + Cam4User.profileName + '/edit/email?changed=true';
}

function resetPasswordSuccess() {
    window.location = '/password/reset/thankyou';
}

function processPasswordConfirm() {
    var pwTxt = $j('#newPassword').val();
    var pwConfirmTxt = $j('#newPasswordConfirm').val();
    var json = {'message': '', 'success': false};

    var isOk = checkPassword(userNameEditPassword, pwTxt);

    if (pwTxt != pwConfirmTxt) {
        json.message = document.getElementById('parseDontMatchText').innerHTML;
        //$j("#buttonBlock").fadeOut("slow");
        setButtonActive(false);

    } else {

        if (isOk.success) {

            json.message = document.getElementById('passMatchesCorrectly').innerHTML;

            json.success = true;
            //$j("#buttonBlock").fadeIn("slow");
            setButtonActive(true);
        }
    }

    fPassConfirmOk = json.success;

    processJsonField('passwordConfirmSpan', json);
}

var twoFAResponse;

/**
 * same as $j.ajax but ads tracing headers if needed
 */
function executeRequest(settings) {
    if (ControlledFeatures.DISTRIBUTED_TRACING && (typeof Chat !== 'undefined')) {
        settings.headers = {
            "X-B3-TraceId": Chat.getTraceId(),
            "X-B3-SpanId": Chat.generateSpanId(),
            "X-B3-Sampled": 1
        };
    }
    $j.ajax(settings);
}

function processPhoneNumber() {
    var validForm = true,
        isModal = $j('#passwordModalEnable').is(':visible'),
        countryCode,
        phoneNumber,
        password,
        passwordSpan;

    $j('#countryCodeSpan').html('');
    $j('#phoneNumberSpan').html('');
    $j('#passwordSpan').html('');
    $j('#passwordModalEnableSpan').html('');

    if (isModal) {
        countryCode = $j('#countryCode').attr('data-selected-value');
        phoneNumber = $j('#phoneNumber').attr('data-value');
        password = $j('#passwordModalEnable').val();
        passwordSpan = $j('#passwordModalEnableSpan');
    } else {
        countryCode = $j('#countryCode').val();
        phoneNumber = $j('#phoneNumber').val();
        password = $j('#password').val();
        passwordSpan = $j('#passwordSpan');

        if (!countryCode || countryCode === '-1') {
            $j('#countryCodeSpan').html(js_i18n.selectCountry);
            validForm = false;
        }

        if (!phoneNumber || phoneNumber === '') {
            $j('#phoneNumberSpan').html(js_i18n.phoneNumberCantBeBlank);
            validForm = false;
        }
    }

    if (!password || password === '') {
        passwordSpan.html(js_i18n.passCantBeBlank);
        validForm = false;
    }

    if (!validForm) {
        return;
    }

    let settings = {
        url: window.location,
        type: 'post',
        data: {
            phoneNumber: phoneNumber,
            countryCode: countryCode,
            password: password,
            action: 'changePhoneNumber'
        },
        success: function (response) {
            switch (response.status) {
                case "invalidPassword":
                case "authError":
                    passwordSpan.html(js_i18n.wrongPassword);
                    break;
                case "VALIDATION_REQUIRED":
                    twoFAResponse = response;
                    openTwoFaModal(twoFAModalHideNumber, response.operationId, response.phoneNumber, response.countryCode);
                    break;
                case "INVALID_PHONE_NUMBER":
                case "PHONE_NUMBER_NOT_ALLOCATED":
                case "PHONE_NUMBER_NOT_SUPPORTED":
                    $j('#phoneNumberSpan').html(js_i18n.invalidPhoneNumber);
                    break;
                case "LIMIT_REACHED":
                    passwordSpan.html(js_i18n.limitReach);
                    break;
                default:
                    passwordSpan.html(js_i18n.tryAgain);
            }
        },
        error: function (response) {
            console.log(response);
        }
    };
    executeRequest(settings);
}

function editPhoneNumber() {
    $('.twoFA .twoFAStatus').addClass('hidden');
    $('.twoFA .well').addClass('hidden');
    $('.twoFA .country-and-phone-number-container').removeClass('hidden');
    $('.twoFA .password-container').removeClass('hidden');
    $('.twoFA #savePhoneNumber').removeClass('hidden');
    $('.twoFA #editPhoneNumber').addClass('hidden');
    $('.twoFA #disablePhoneNumber').addClass('hidden');
    $('.twoFA #cancelPhoneNumber').removeClass('hidden');
}

function cancelTwoFA() {
    $('.twoFA .twoFAStatus').removeClass('hidden');
    $('.twoFA .well').removeClass('hidden');
    $('.twoFA .country-and-phone-number-container').addClass('hidden');
    $('.twoFA .password-container').addClass('hidden');
    $('.twoFA #savePhoneNumber').addClass('hidden');
    $('.twoFA #editPhoneNumber').removeClass('hidden');
    $('.twoFA #disablePhoneNumber').removeClass('hidden');
    $('.twoFA #cancelPhoneNumber').addClass('hidden');
}

function dismissTwoFA(value) {
    $j.ajax({
        url: window.location.origin + '/rest/v1.0/twoFaOptions/dismiss',
        type: 'post',
        contentType: 'application/x-www-form-urlencoded; charset=utf-8',
        data: {
            username: Cam4User.userName,
            dismissed: value
        }
    });

    $('#twoFAInformModal').modal('hide');
}

function twoFAModalHideNumber() {
    $j('#twoFAModal').attr( 'data-action', 'enableTwoFA' );
    $j('#twoFACodeValidationInput').focus();
}

function twoFASetPhone() {
    var countryCode = $j('select.countryCodeSelect').val(),
        phoneNumber = $j('#phoneNumber').val(),
        phoneNumberComplete;

    if ($('#enablePhoneNumber').is(':visible')) {
        countryCode = Cam4User.twoFaUserData.countryCode;
        phoneNumber = Cam4User.twoFaUserData.phoneNumber;
        phoneNumberComplete = '+' + countryCode + '****' + phoneNumber.substring(phoneNumber.length,phoneNumber.length-4);
    } else {
        countryCode = $j('select.countryCodeSelect').val();
        phoneNumber = $j('#phoneNumber').val();
        phoneNumberComplete = '+' + countryCode + '****' + phoneNumber.substring(phoneNumber.length,phoneNumber.length-4);
    }

    $j('#twoFAModal .code-sent').addClass('hidden');
    $j('#twoFAModal .actions-container').addClass('hidden');
    $j('#twoFAModal .correct-code.set-up-phone').removeClass('hidden');
    $j('.twoFA .twoFAStatus').removeClass('hidden');
    $j('.twoFA .featureEnabled').removeClass('hidden');
    $j('.twoFA .featureDisabled').addClass('hidden');
    $j('.twoFA .well').removeClass('disabled').removeClass('hidden');
    $j('.twoFA #password').val('');
    $j('.twoFA .country-and-phone-number-container').addClass('hidden');
    $j('.twoFA .password-container').addClass('hidden');
    $j('.twoFA .phoneNumberContainer').html(phoneNumberComplete);
    $j('.twoFA #savePhoneNumber').addClass('hidden');
    $j('.twoFA #enablePhoneNumber').addClass('hidden');
    $j('.twoFA #editPhoneNumber').removeClass('hidden');
    $j('.twoFA #disablePhoneNumber').removeClass('hidden');
    $j('.twoFA #cancelPhoneNumber').addClass('hidden');
}

function twoFAModalDisablePhone() {
    var currentTitle = $j('#twoFAModal .title').html(),
        currentPhoneNumberLabel = $j('#twoFAPhoneNumberLabel').html(),
        countryCode = Cam4User.twoFaUserData.countryCode;

    $j('#twoFAModal .title').html(js_i18n.disable + ' ' + currentTitle);
    $j('#twoFAModal').attr('data-action', 'disableTwoFA');
    $j('#twoFACodeValidationInput').focus();
}

function twoFADisabled() {
    var currentTitle = $j('#twoFAModal .title').html();

    $j('#twoFAModal .title').html(js_i18n.disable + ' ' + currentTitle);
    $j('#twoFAModal .code-sent').addClass('hidden');
    $j('#twoFAModal .actions-container').addClass('hidden');
    $j('#password').val('');
    $j('.featureEnabled').addClass('hidden');
    $j('.featureDisabled').removeClass('hidden');
    $j('.twoFA .well').addClass('disabled');
    $j('#twoFAModal .correct-code.delete-phone').removeClass('hidden');
    $j('#savePhoneNumber').addClass('hidden');
    $j('#enablePhoneNumber').removeClass('hidden');
    $j('#editPhoneNumber').addClass('hidden');
    $j('#disablePhoneNumber').addClass('hidden');
}

function twoFAModalChangePassword() {
    var action = 'changePassword';

    $j('#twoFAModal').attr('data-action', action);
}

function twoFAModalChangePrimaryEmail() {
    var action = 'changePrimaryEmail';

    $j('#twoFAModal').attr('data-action', action);
}

function twoFAModalResetPassword() {
    var action = 'resetPassword';

    $j('#twoFAModal').attr('data-action', action);
}

function openDisableTwoFaModal() {
    openTwoFaModal(function () {
        $('#twoFAModal').addClass('hidden');
        $('#twoFADisableModal').removeClass('hidden');
    }, '', '');
}

function openEnableTwoFaModal() {
    openTwoFaModal(function () {
        $('#twoFAModal').addClass('hidden');
        $('#twoFAEnableModal').removeClass('hidden');
    }, '', '');
}

function disableTwoFa() {
    $('#passwordModalDisableSpan').html('');

    var validForm = true;
    var password = $j('#passwordModalDisable').val();
    if (!password || password === '') {
        $j('#passwordModalDisableSpan').html(js_i18n.passCantBeBlank);
        validForm = false;
    }

    if (!validForm) {
        return;
    }

    let settings = {
        url: window.location,
        type: 'post',
        data: {
            password: password,
            action: 'disableTwoFa'
        },
        success: function (response) {
            switch (response.status) {
                case "invalidPassword":
                case "authError":
                    $j('#passwordModalDisableSpan').html(js_i18n.wrongPassword);
                    break;
                case "VALIDATION_REQUIRED":
                    twoFAResponse = response;
                    openTwoFaModal(twoFAModalDisablePhone, response.operationId, response.phoneNumber, response.countryCode);
                    break;
                case "LIMIT_REACHED":
                    $j('#passwordModalDisableSpan').html(js_i18n.limitReach);
                    break;
                default:
                    $j('#passwordModalDisableSpan').html(js_i18n.tryAgain);
            }

        },
        error: function (request, response) {
            console.log(response);
        }
    };
    executeRequest(settings);

}

function loginTwoFA() {
    var postUrl = "/login/twoFA";

    var validationCode = $j('#twoFACodeValidationInput').val();
    if (!validationCode || validationCode === '') {
        $j('#validationCodeSpan').html(js_i18n.validationCodeBlank);
        return;
    }

    var operationId = $j("#twoFAOperationId").val();
    var token = $j("#twoFAToken").val();
    var username = $j("#twoFAUsername").val();
    let settings = {
        url: postUrl,
        type: 'post',
        data: {
            validationCode: validationCode,
            operationId: operationId,
            action: 'validate',
            token: token,
            username: username
        },
        success: function (response) {
            switch (response.status) {
                case "SUCCESS":
                    window.location.reload();
                    break;
                case "FAILED":
                    $j('#validationCodeSpan').html(js_i18n.validationCodeWrong);
                    break;
                case "INVALID_CODE":
                    $j('#validationCodeSpan').html(js_i18n.validationCodeWrong);
                    break;
                default:
                    $j('#validationCodeSpan').html(js_i18n.tryAgain);
            }
        },
        error: function (request, response) {
            console.log(response);
        }
    };
    executeRequest(settings);

}

function loginResendTwoFaCode() {
    var operationId = $j("#twoFAOperationId").val();
    $j('#validationCodeSpan').removeClass('greenColor');

    let settings = {
        url: '/login/twoFA',
        type: 'post',
        data: {
            action: 'resend',
            operationId: operationId
        },
        success: function (response) {
            switch (response.status) {
                case "SUCCESS":
                    twoFAResponse = response;
                    $j('#validationCodeSpan').html(js_i18n.codeValidationSent);
                    $j('#validationCodeSpan').addClass('greenColor');
                    break;
                case "FAILED":
                    $j('#validationCodeSpan').html(js_i18n.codeValidationSentFailed);
                    break;
                default:
                    $j('#validationCodeSpan').html(js_i18n.tryAgain);
            }
        },
        error: function (request, response) {
            console.log(response);
        }
    };
    executeRequest(settings);
}

function validateCode() {
    var postUrl = window.location;
    if ($j("#twoFAUrlValidation").val() !== 'undefined') {
        postUrl = $j("#twoFAUrlValidation").val();
    }

    var validationCode = $j('#twoFACodeValidationInput').val();
    if (!validationCode || validationCode === '') {
        $j('#validationCodeSpan').html(js_i18n.validationCodeBlank);
        return;
    }

    var operationId = $j("#twoFAOperationId").val();

    let settings = {
        url: postUrl,
        type: 'post',
        data: {
            validationCode: validationCode,
            operationId: operationId,
            action: 'validate'
        },
        success: function (response) {
            switch (response.status) {
                case "SUCCESS":
                    var action = $j('#twoFAModal').attr('data-action');
                    Utils.closeModalPops(true);

                    switch (action) {
                        case "enableTwoFA":
                            openTwoFaModal(twoFASetPhone);
                            dismissTwoFA(true);
                            break;
                        case "disableTwoFA":
                            openTwoFaModal(twoFADisabled);
                            dismissTwoFA(true);
                            break;
                        case "changePassword":
                            changePasswordSuccess();
                            break;
                        case "resetPassword":
                            resetPasswordSuccess();
                            break;
                        case "changePrimaryEmail":
                            changeEmailSuccess();
                        default:
                            console.warn('do nothing');
                    }
                    break;
                case "VALIDATION_REQUIRED":
                    twoFAResponse = response;
                    openTwoFaModal(twoFAModalHideNumber, response.operationId, response.phoneNumber, response.countryCode);
                    break;
                case "INVALID_CODE":
                    $j('#validationCodeSpan').html(js_i18n.validationCodeWrong);
                    break;
                case "LIMIT_REACHED":
                    $j('#validationCodeSpan').html(js_i18n.limitReach);
                    break;
                default:
                    $j('#validationCodeSpan').html(js_i18n.tryAgain);
            }
        },
        error: function (request, response) {
            console.log(response);
        }
    };
    executeRequest(settings);
}


function closeTwoFAModal() {
    Utils.closeModalPops(true);
}

function openTwoFaModal(twoFAModalOpenedCallback, operationId, phoneNumber, countryCode) {
    var _url = '/' + Cam4User.performerName + '/modal/twoFACodeValidationServlet?operationId='
        + operationId + "&phoneNumber=" + phoneNumber + "&countryCode=" + countryCode;
    Utils.popWithAjaxContent(_url, {}, undefined, twoFAModalOpenedCallback, undefined, undefined, undefined, 'modal-md');
}

function openTwoFaModalResetPassword(twoFAModalOpenedCallback, operationId, phoneNumber, countryCode) {
    var _url = '/_profile/modal/twoFACodeValidationServlet?operationId='
        + operationId + "&phoneNumber=" + phoneNumber + "&countryCode=" + countryCode;
    Utils.popWithAjaxContent(_url, {}, undefined, twoFAModalOpenedCallback, undefined, undefined, undefined, 'modal-md');
}

function openTwoFaModalChangeEmail(twoFAModalOpenedCallback, operationId, phoneNumber, countryCode, codeValidationUrl) {
    var _url = '/_profile/modal/twoFACodeValidationServlet?operationId='
        + operationId + "&phoneNumber=" + phoneNumber + "&countryCode=" + countryCode + "&url=" + codeValidationUrl;
    Utils.popWithAjaxContent(_url, {}, undefined, twoFAModalOpenedCallback, undefined, undefined, undefined, 'modal-md');
}

function resendTwoFaCode() {
    var operationId = $j("#twoFAOperationId").val();
    $j('#validationCodeSpan').removeClass('greenColor');

    var baseUrl = "/_profile";
    if (Cam4User.performerName && Cam4User.performerName !== '')
        baseUrl = "/" + Cam4User.performerName;

    let settings = {
        url: baseUrl + '/modal/twoFACodeValidationServlet',
        type: 'post',
        data: {
            action: 'resendTwoFaCode',
            operationId: operationId
        },
        success: function (response) {
            switch (response.status) {
                case "SUCCESS":
                    twoFAResponse = response;
                    $j('#validationCodeSpan').html(js_i18n.codeValidationSent);
                    $j('#validationCodeSpan').addClass('greenColor');
                    break;
                case "FAILED":
                    $j('#validationCodeSpan').html(js_i18n.codeValidationSentFailed);
                    break;
                default:
                    $j('#validationCodeSpan').html(js_i18n.tryAgain);
            }
        },
        error: function (request, response) {
            console.warn(response);
        }
    };
    executeRequest(settings);
}

function setButtonActive(active) {
    var buttonBlock = $j('#buttonBlock');
    if (active) {
        buttonBlock.find('.saveButtonInactive').attr('class', 'saveButton');
        buttonBlock.find('#saveButtonInactive').attr('id', 'saveButton');
        buttonBlock.find('input[type="submit"], input[type="button"], .saveButton').removeAttr('disabled');
    } else {
        buttonBlock.find('input[type="submit"], input[type="button"], .saveButton').attr('disabled', 'disabled');
        buttonBlock.find('.saveButton').attr('class', 'saveButtonInactive');
        buttonBlock.find('#saveButton').attr('id', 'saveButtonInactive');
    }
}

$j('#changePassword').submit(function () {
    if (!isFormComplete()) {
        recheckForm();
        alert(document.getElementById('passFormErrorMsg').innerHTML, document.getElementById('passSignupErrorMsg').innerHTML);
    }
});

// The function below check/set the message when the user wrote in the confirm pass and try to change the new pass again
function recheckNewPassConfirm() {
    var newPassConfirm = $j('#newPasswordConfirm');
    if (newPassConfirm.val().length > 0) {
        $j('#newPassword').keyup(function () {
            processPasswordConfirm();
        });
    }
}

function cleanTextInput(text, type) {
    var inputType = document.getElementById(type);
    if (inputType.value == text) {
        inputType.value = '';
    }
}

function cleanTextInputEmpty(text, type) {
    var inputType = document.getElementById(type);
    if (inputType.value == '') {
        inputType.value = text;
    }
}

// Used when form is loaded with existing username and email entries (eg. when user creation failed for whatever reason)
// triggers client side validation of initial form values

function showMessages() {
    $j('#userName').each(function () {
        validate(this, $j('#userNameSpan'), 'username');
    });
    $j('#email').each(function () {
        validate(this, $j('#emailSpanContact'), 'email');
        validate(this, $j('#emailSpan'), 'email');
    });
}

var element;

function detachRightSignupForm() {
    element = $j('#rightSignupFormElements').detach();
}

// FINISH code migrated from the initSignup overlay

// START code to show the pitches of the signup benefits in the right side

var goldFeatures = ['ec', 'fs', 'mc', 'pm', 'ad', 'ss', 'srch'];
var selectedFeature = Math.floor(Math.random() * 7);
var randomFeature = goldFeatures[selectedFeature];

var randomPitchesDiv = document.getElementById('randomPitches');
if (randomPitchesDiv != null) {
    $j(document).ready(function () {
        $j.get('/signupFeatures/pitches_' + randomFeature + '.jsp',
            function (data) {
                showPitch(data);
            }, 'html');
    });
}

function showPitch(data) {
    document.getElementById('randomPitches').innerHTML = data;
}

// FINISH code to show the pitches of the signup benefits in the right side

function validateWishlist() {
    var s = document.profileForm.wishListAmazon.value;
    if (s != '') {
        if ((s.indexOf('www.amazon.') == -1)) {
            if ((s.indexOf('http://amzn.com') == -1)) {
                alert('Invalid amazon wishlist, please try again');
                document.profileForm.wishListAmazon.focus();
                return false;
            }
        }
    }

    var sr = document.profileForm.wishListStockroom.value;
    if (sr != '') {
        if (sr.indexOf('stockroom.com') == -1) {
            alert('Invalid Stockroom wishlist, please try again');
            document.profileForm.wishListStockroom.focus();
            return false;
        }
    }

    var eden = document.profileForm.wishListEden.value;
    if (eden != '') {
        if (eden.indexOf('edenfantasys.com') == -1 &&
            eden.indexOf('eden-fantasys.ca') == -1) {
            alert('Invalid EdenFantasys wishlist, please try again');
            document.profileForm.wishListEden.focus();
            return false;
        }
    }
}

function initOverlayFromProfile(string) {
    if (document.getElementById('initSignupTitle') != null) {
        $j('#initSignupTitle').text(string);
    }
}

function checkIfPriceMustBeEnabled(giftId) {
    if (!giftId) {
        giftId = 0;
    }
    if ($j('#gift_form_' + giftId + ' select[name=category] option:selected').hasClass('gold-exclusive') ||
        $j('#gift_form_' + giftId + ' select[name=category] option:selected').hasClass('admin-only')) {
        $j('#gift_form_' + giftId).each(function () {
            this['price'].setAttribute('disabled', 'disabled');
            this['price'].value = '0';
        });
    } else {
        $j('#gift_form_' + giftId).each(function () {
            this['price'].removeAttribute('disabled');
        });
    }
}

/* START: MOVING the following code from popAds.js May 08, 2013 */

/* Code to create/read cookies */

var cookieName = 'bannerPops';

function writeCookie(value) {
    var oldValue = readCookie();
    if (oldValue != null) {
        value = value + deliminator + oldValue;
    }
    var date = new Date();
    date.setTime(date.getTime() + (expireTime));
    var expires = '; expires = ' + date.toGMTString();
    document.cookie = cookieName + '=' + escape(value) + expires + ';path=/';
}

function readCookie() {
    var dc = document.cookie;
    var prefix = cookieName + '=';
    var begin = dc.indexOf('; ' + prefix);
    if (begin == -1) {
        begin = dc.indexOf(prefix);
        if (begin != 0)
            return null;
    } else {
        begin += 2;
    }
    var end = document.cookie.indexOf(';', begin);
    if (end == -1) {
        end = dc.length;
    }
    return unescape(dc.substring(begin + prefix.length, end));
}

function GetCookie(name) {
    var arg = name + '=';
    var alen = arg.length;
    var clen = document.cookie.length;
    var i = 0;
    while (i < clen) {
        var j = i + alen;
        if (document.cookie.substring(i, j) == arg)
            return getCookieVal(j);
        i = document.cookie.indexOf(' ', i) + 1;
        if (i == 0)
            break;
    }
    return null;
}

function getCookieVal(offset) {
    var endstr = document.cookie.indexOf(';', offset);
    if (endstr == -1) {
        endstr = document.cookie.length;
    }
    return unescape(document.cookie.substring(offset, endstr));
}

function openCheckoutMembership(unlockFeature, reportFeatureId) {

    if (typeof(unlockFeature) === 'undefined') {
        unlockFeature = 'default';
    }

    var wName = 'tipWindow';

    Utils.closeOpenedPopupWindows();

    var win = window.open('/checkout/goldUpgrade?unlockFeature=' + unlockFeature,
        wName,
        'width=' + processorPopUpPageWidth +
        ',height=' + processorPopUpPageHeight + ',scrollbars=1,toolbars=0,status=0,resizable=1,left=' +
        ((screen.width / 2) - (processorPopUpPageWidth / 2)));
    win.focus();

    Utils.openedPopupWindows[wName] = win;

    // If an overlay was displayed when the checkout membership form was opened
    if ($j('.modal-dialog').css('display') != 'none') {
        var checkIfWindowClosed = setInterval(function () {
            if (win.closed) {
                Utils.closeModalPops();
                clearInterval(checkIfWindowClosed);
            }
        }, 500);
    }

    if (typeof reportFeatureId !== 'undefined') {
        try {
            FeatureReporting.sendUsageAttempt(reportFeatureId, 'BUY');
        } catch (ex) {
            console.warn(ex);
        }
    }
}

function updateUnreadCounters() {
    if (!Cam4User.isLoggedIn || Cam4User.isLoggedInAsGuest) {
        return 0;
    }
    $j.get('/mail/unreadThreads', function (response) {
        if (typeof response.unreadThreads != 'undefined') {
            response = response.unreadThreads.length;
        }
        var counter = $j('#miniInbox, .inbox-icon .counter');
        counter.text(response);
        counter.parent('span').removeClass('inboxCount0').addClass('inboxCount' + response);
    });
}

updateUnreadCounters();

function setPrice() {
    var trialGoldPlan = $j('#TrialGoldPlan'),
        fullGoldPlan = $j('#FullGoldPlan'),
        activeGoldPlan = $j('#activeGoldPlan');

    if (trialGoldPlan.is(':checked')) {
        activeGoldPlan.val(activeGoldPlan.attr('data-trial'));
    } else if (fullGoldPlan.is(':checked')) {
        activeGoldPlan.val(activeGoldPlan.attr('data-full'));
    } else {
        activeGoldPlan.val(0);
    }
}

function getAvailableRegistrationOptions() {
    var opts = '';
    if ($j('#FullGoldPlan').length) {
        opts = opts + '&showGold=true';
    }
    if ($j('#TrialGoldPlan').length) {
        opts = opts + '&showTrial=true';
    }
    if ($j('#BasicPlan').length) {
        opts = opts + '&showBasic=true';
    }

    return opts;
}

function subscribeWeeklyUpdates() {
    // fire off the request to /form.php
    var request = $j.ajax({
        url: '/subscribe',
        type: 'post',
        data: {
            subscriptionType: 'weekly'
        },
        success: function (response) {
            if (response == 'success') {
                $j('#subscription-controls').hide();
                $j('#subscription-result-success').show();
            } else {
                console.log(response);
            }
        },
        error: function (request, response) {
            console.log(response);
        }
    });
}


$j(document).ready(function () {

    if (!ControlledFeatures.USE_HLS_WHEN_FLASH_DISABLED) {
        return;
    }

    var hasFlash = false;
    try {
        var flashObject = new ActiveXObject('ShockwaveFlash.ShockwaveFlash');
        if (flashObject) {
            hasFlash = true;
        }
    } catch (e) {
        if (navigator.mimeTypes
            && navigator.mimeTypes['application/x-shockwave-flash'] != undefined
            && navigator.mimeTypes['application/x-shockwave-flash'].enabledPlugin) {
            hasFlash = true;
        }
    }

    document.cookie = "flash_enable=" + hasFlash;

    if (UserAgent.desktop &&
        !hasFlash &&
        Cam4User.cameraData.useHlsVideoOnMobile &&
        !ControlledFeatures.STREAMING_HLS_VIEWER
    ) {
        $j('#enableFlash').show();
    }
});
var Conversations;Conversations=function(){function setLoaderDisplay(_state,_selector){document.querySelector(_selector).style.display=_state}function getLastMessagesAjax(threadsLimit,filter){var url="loadConversations?mode=getThreads&limit="+threadsLimit+"&filter="+(searchFilter=filter||"");setLoaderDisplay("block",".thread-previews-container .ajax-loader"),$j.getJSON(url,function(data){setLoaderDisplay("none",".thread-previews-container .ajax-loader"),0==data.conversations.length&&""==searchFilter&&$("#noConversations").show(),$j.each(data.conversations,function(key,value){threads[value.threadId]=value}),$j("#thread-previews").empty(),data.conversations.length>=threadsLimit?$j("#loadMoreThreads").css("display","block"):$j("#loadMoreThreads").hide(),"conversations"in data&&!data.conversations.length>0?document.getElementById("thread-noresults").style.display="block":document.getElementById("thread-noresults").style.display="none",getLastMessages(data),selectThreadByIndex(0)}).fail(function(){setLoaderDisplay("none",".thread-previews-container .ajax-loader")})}function selectThreadByIndex(index){var threads=$j(".msg-row"),threadsLength=threads.length;threadsLength&&index<threadsLength&&threads[index].click()}function getThreadMessagesAjax(threadId,newThread,threadData,offset){var autoscroll=!0;offset?autoscroll=!1:offset=0;var url="loadConversations?mode=loadConversation&threadId="+threadId+"&offset="+offset+"&limit="+MESSAGES_LIMIT;setLoaderDisplay("block","#thread-loader"),$j.getJSON(url,function(data){if(setLoaderDisplay("none","#thread-loader"),newThread){if(!$j("#thread"+threadId).length){addConversationTab(data.thread,!0);var thread=$j("#thread"+threadId);Conversations.threads[threadId]=data.thread,Conversations.threads[threadId].unreadCount=1,Conversations.threads[threadId].offset=0,Conversations.threads[threadId].loadedFromWeb=!1,thread.find(".ur-count").text(Conversations.threads[threadId].unreadCount).addClass("unread").show(),thread.click()}}else putThreadMessagesInDom(data.thread,!1,autoscroll);void 0!==threads[threadId]&&(0!=data.thread.messages.length&&(data.thread.messages.length<MESSAGES_LIMIT?$j("#loadMoreMessages").hide():$j("#loadMoreMessages").css("display","block"),void 0===threads[threadId].messages&&(threads[threadId].messages=data.thread.messages)),threads[threadId].usersProperties=data.thread.usersProperties,threads[threadId].fanClubBadge=data.thread.fanClubBadge,threads[threadId].offset=offset,threads[threadId].loadedFromWeb=!0),data.thread.messages.length<MESSAGES_LIMIT&&$j("#loadMoreMessages").hide()})}function getLastMessages(data){$j.each(data.conversations,function(key,value){addConversationTab(value,!1)})}function clearRelations(){$j("#iconFriend, #iconFavorite, #iconFanClub").hide()}function showRelations(relations,fanClubBadge){$j("#iconFriend").toggle(relations.isFriend),$j("#iconFavorite").toggle(relations.isFavorite);var banUserText,defaulFanBadge=WEB_CDN+"/images/fanclub/badges/icon_fanclub_default.png";if(relations.isFan){var targetUser=$j("#headerUsername").text(),defaultImage=ControlledFeatures&&ControlledFeatures.FAN_CLUB_IN_PERFORMER_DASHBOARD?defaulFanBadge:fanClubBadge;banUserText=Cam4Chat.banFanClubMember.replace("{0}",targetUser).replace("{1}",targetUser),$j("#iconFanClub").css({display:"inline-block","background-image":"url("+defaultImage+")","background-size":"cover","vertical-align":"middle"})}else banUserText=Cam4Chat.banOrdinaryUser;$j("#ban-user").find("p").text(banUserText)}function putThreadMessagesInDom(data,cached,autoscroll){var usersProperties,fanClubBadge,info,massMessage,defaulFanBadge=WEB_CDN+"/images/fanclub/badges/icon_fanclub_default.png";info=data.messages,usersProperties=data.usersProperties,fanClubBadge=ControlledFeatures&&ControlledFeatures.FAN_CLUB_IN_PERFORMER_DASHBOARD?defaulFanBadge:data.fanClubBadge,massMessage=data.isMassAdminThread,usersProperties&&1==usersProperties.length&&showRelations(usersProperties[0],fanClubBadge),$j.each(info,function(key,value){addMessage(value,cached,autoscroll,massMessage)})}function excerpt(message){return message.length>excerptLimit&&(message=message.substr(0,excerptLimit)+" ..."),processMessage(message)}function updateMessageContainer(displayName,thread_id){$j("#headerUsername").text(displayName),$j("#headerUsername, #headerAvatar").on("click",function(){"My Fans"!=displayName?-1==admins.indexOf(displayName)&&(window.location="/"+displayName.toLowerCase()):window.location="/"+Cam4User.userName+"/edit/editMyFanClub"});var imageUrl;imageUrl=-1!=admins.indexOf(displayName)?WEB_CDN+"/images/avatar_cam4admin.gif":ImageServer.GET_CHAT_AVATAR(displayName),"My Fans"==displayName?($j("#dropdownMenu1").hide(),imageUrl=ImageServer.GET_CHAT_AVATAR(Cam4User.userName)):$j("#dropdownMenu1").show(),$j("#headerUsername").text(displayName),"Cam4 Team"==displayName||"myshop"==displayName?($j("#msg-body-wrap").addClass("massAdmin"),$j("#messageField, #goToProfile").hide(),$j(".msg-head").addClass("massAdminPointer")):($j("#msg-body-wrap").removeClass("massAdmin"),$j("#messageField, #goToProfile").show(),$j(".msg-head").removeClass("massAdminPointer")),$j("#messagesContainer").empty().data("thread_id",thread_id),$j("#headerAvatar").css("background-image","url("+imageUrl+")"),$j("#goToProfile").attr("href","/"+displayName.toLowerCase())}function giftPreview(imageUrl,excerptMessage){return'<img class="gift-preview" src="'+imageUrl+'" />'+excerptMessage}function addConversationTab(data,newThread){var conversationName,imageUrl,info=data.preview;newThread&&(void 0!==(info=data).messages&&info.messages.length>0?(info.message=info.messages[0].message,info.sendDate=info.messages[0].sendDate):info.message="",data.unreadMsgCount=0,info.users.length>2&&(conversationName=excerpt(conversationName=info.users.join(",")))),$j("#noConversations").hide(),data.unreadCount=data.unreadMsgCount;var newRow=$j("#msgRowTemplate").clone(),unreadMsgCount=data.unreadMsgCount;conversationName=getConversationName(void 0!==data.users?data.users:data.thread.users),-1!=admins.indexOf(conversationName)?(imageUrl="My Fans"===conversationName?ImageServer.GET_CHAT_AVATAR(Cam4User.userName):WEB_CDN+"/images/avatar_cam4admin.gif","myshop"===conversationName&&(conversationName=marketLocales.myShop)):imageUrl=ImageServer.GET_CHAT_AVATAR(conversationName),newRow.data("threadId",info.threadId),newRow.data("displayName",conversationName),newRow.find(".date").text(info.sendDate);var displayName;if(""!==searchFilter){var exp=new RegExp("("+searchFilter+")","gi");displayName=conversationName.replace(exp,"<strong>$1</strong>")}else displayName=conversationName;newRow.find(".un").html(displayName);var excerptMessage=excerpt(info.message);if((info.messages&&~marketplaceTypes.indexOf(info.messages[0].mType)||~marketplaceTypes.indexOf(info.mType))&&(excerptMessage=JSON.parse(info.message).title),"gift"==info.mType)newRow.find(".excerpt").html(giftPreview(info.giftUrl,excerptMessage));else if("studio_invite"==info.mType){excerptMsg=excerpt(js_i18n.studioInviteNotification);newRow.find(".excerpt").text(excerptMsg)}else if("studio_release"==info.mType){var excerptMsg=excerpt(js_i18n.studioReleaseNotification.replace("{0}",JSON.parse(info.message).studioName));newRow.find(".excerpt").text(excerptMsg)}else newRow.find(".excerpt").text(excerptMessage);Cam4User.id==info.senderId&&newRow.find(".sender").css("display","inline"),unreadMsgCount>0&&(newRow.find("#unreadMsgCount").text(data.unreadMsgCount).show(),newRow.addClass("unread")),newRow.data("thread_id",info.threadId),newRow.attr("id","thread"+info.threadId),newRow.find(".usr-img").css("background-image","url("+imageUrl+")"),data.read&&newRow.addClass("unread"),newRow.on("click",function(newThread){$j("#loadMoreMessages").hide(),clearRelations();var thread_id=newRow.data("thread_id"),displayName=newRow.data("displayName");$j(".msg-row").removeClass("active-tab"),newRow.addClass("active-tab"),Conversations.activeTab=newRow.data("thread_id"),updateMessageContainer(displayName,thread_id),newRow.find("#unreadMsgCount").hide(),void 0!==threads[thread_id]&&newThread&&void 0!==threads[thread_id].messages&&threads[thread_id].loadedFromWeb?putThreadMessagesInDom(threads[thread_id],!1,!0):getThreadMessagesAjax(thread_id),UserAgent.desktop&&document.getElementById("message").focus(),markThreadAsRead(thread_id)}),newThread?$("#thread-previews").prepend(newRow):$("#thread-previews").append(newRow),newRow.show()}function markThreadAsRead(threadId){var threadSelector=$("#thread"+threadId);Conversations.threads[threadId].unreadCount=0,threadSelector.find(".ur-count").hide(),threadSelector.removeClass("unread");$.get("/mail/unreadThreads",function(response){if(void 0!==response&&void 0!==response.unreadThreads&&(Conversations.unreadThreadsIds=response.unreadThreads,void 0!==Conversations.unreadThreadsIds&&~Conversations.unreadThreadsIds.indexOf(threadId))){$.post("/mail/unreadThreads",{threadId:threadId},function(data,textStatus){var tags;tags="undefined"!=typeof Cam4Analytics?Cam4Analytics.getCurrentTags():"NA",dataLayer.push({event:"socialEvents",eventCategory:"privateMessage",eventAction:"openMessage",eventLabel:tags})},"json"),Conversations.unreadThreadsIds.shift(threadId);var inboxIcon=$("#miniInbox, .inbox-icon .counter"),unreadCount=Conversations.unreadThreadsIds.length;inboxIcon.text(unreadCount).parent().removeClass(function(index,css){return(css.match(/(^|\s)inboxCount\S+/g)||[]).join(" ")}).addClass("inboxCount"+unreadCount)}})}function getConversationName(users){var user="";return $.each(users,function(key,value){key!=Cam4User.id&&(2==Object.keys(users).length?user=value:""===user?user=value:user+=", "+value)}),user}function replaceTag(tag){return tagsToReplace[tag]||tag}function safe_tags_replace(str){return str.replace(/[&<>]/g,replaceTag)}function processMessage(message,massMessage){return message=massMessage?message.replace(/(?:\r\n|\r|\n)/g,"<br/>"):safe_tags_replace(message),(message=message.replace(/(((https?:\/\/)|(www\.))[\w\-]+\.[\w\.,;:_\/\%\$\=\-\?]+)/gi,'<a href="$1" class="link-message" target="_blank">$1</a>')).replace(/(a href="www\.)/gi,'a href="http://www.')}function addRegularMessage(newRow,data){newRow.find(".full-msg").html(processMessage(data.message,data.massMessage))}function addMarketplaceMessage(newRow,data){var info=JSON.parse(data.message),username=info.username,title=info.title,reason=info.reason,messageHTML='<div class="notice">';switch(data.mType){case"marketplace":reason?(messageHTML+=marketLocales.rejectedMessage1.replace("{0}",username).replace("{1}",title),messageHTML+=marketLocales.rejectedMessage2,messageHTML+="</br></br>"+processMessage(reason)+"</br></br>",messageHTML+=marketLocales.rejectedMessage3+"</br>"+marketLocales.rejectedMessage4):messageHTML+=marketLocales.approvedMessage.replace("{0}",username).replace("{1}",title);break;case"marketplace_p":messageHTML+=marketLocales.purchaseNotification.replace("{0}",info.buyer).replace("{1}","'"+info.title+"'").replace("{2}",info.amount);break;case"marketplace_b_p":messageHTML+=marketLocales.purchaseNotification.replace("{0}",info.buyer).replace("{1}",info.count+" "+marketLocales.videos).replace("{2}",info.amount);break;case"marketplace_d":messageHTML+=marketLocales.videoDeletedMessage.replace("{0}","'"+title+"'").replace("{1}",username);break;case"marketplace_p_c":messageHTML+=marketLocales.videoPriceChangeMessage.replace("{0}","'"+title+"'").replace("{1}",username);break;case"marketplace_p_f":messageHTML+=marketLocales.videoPriceChangeFanclubMessage.replace("{0}","'"+title+"'").replace("{1}",username)}messageHTML+="</div>",newRow.find(".full-msg").html(messageHTML)}function addGiftMessage(newRow,data){var giftHtml='<div class="notice">'+js_i18n.sentGift+"</div>";giftHtml+='<img class="gft" src="'+data.giftUrl+'" />'+data.giftName,giftHtml+=" ("+data.tokens+" "+js_i18n.tokens+")",giftHtml+='<div class="gft-msg">'+processMessage(data.message,data.massMessage)+"</div>",newRow.find(".full-msg").html(giftHtml)}function addTipMessage(newRow,data){var tipHtml='<div class="notice">'+js_i18n.sentTip.replace("{0}",data.tokens)+"!</div>";tipHtml+='<span class="gft-msg">'+processMessage(data.message)+"</span>",newRow.find(".full-msg").html(tipHtml)}function addImageMessage(newRow,data){var escapedMessage=_.escape(data.message),img='<a data-gallery="gallery" href="'+escapedMessage+'"><img data-original="'+escapedMessage+'" class="img-attch" src="'+escapedMessage+'"></a>';newRow.find(".full-msg").html(img)}function buildVideoPreview(data){var video='<div class="vid-preview"><a download target="_blank" href="'+_.escape(data.message)+'">';return video+='<span class="glyphicon glyphicon-play-circle play"></span>',video+='<span class="glyphicon glyphicon-arrow-down dwnld"></span>',video+="</a></div>"}function addVideoMessage(newRow,data){newRow.find(".full-msg").html(buildVideoPreview(data))}function addStudioInviteMessage(newRow,data){var messageForm=JSON.parse(data.message),BASE_URL="/studio/studio-invitation?studioOwnerName="+messageForm.studioOwnerName,message="<span>"+js_i18n.studioInviteNotification+' </span><a class="nopop " href="'+BASE_URL+'">'+messageForm.studioName+"</a>";newRow.find(".full-msg").html(message)}function addStudioReleaseMessage(newRow,data){var messageForm=JSON.parse(data.message),message="<span>"+js_i18n.studioReleaseNotification.replace("{0}",messageForm.studioName)+"</span>";newRow.find(".full-msg").html(message)}function addMessage(data,threadLoad,autoscroll,massMessage){var imageUrl,container=$("#messagesContainer"),messageLine=$("#msg-body-template").clone();switch(data.massMessage=massMessage,-1!=admins.indexOf(data.displayName)||data.senderId==Cam4User.id&&Cam4User.accessLevel>=48?(imageUrl="My Fans"==data.displayName?ImageServer.GET_CHAT_AVATAR(Cam4User.userName):WEB_CDN+"/images/avatar_cam4admin.gif",data.massMessage=!0):imageUrl=ImageServer.GET_CHAT_AVATAR(data.displayName),data.senderId==Cam4User.id&&messageLine.find(".msg-body-entry").addClass("self"),void 0===data.msgId||""==data.msgId?messageLine.find(".messageDiv").attr("id",data.id):messageLine.find(".messageDiv").attr("id",data.msgId),messageLine.find(".msgDate").text(data.sendDate),messageLine.find(".userProfile").css("background-image","url("+imageUrl+")"),messageLine.removeAttr("id"),data.mType){case"text":addRegularMessage(messageLine,data);break;case"gift":addGiftMessage(messageLine,data);break;case"tip":messageLine.addClass("tipTest"),addTipMessage(messageLine,data);break;case"image":addImageMessage(messageLine,data);break;case"video":addVideoMessage(messageLine,data);break;case"marketplace":case"marketplace_p":case"marketplace_b_p":case"marketplace_d":case"marketplace_p_c":case"marketplace_p_f":addMarketplaceMessage(messageLine,data);break;case"studio_invite":addStudioInviteMessage(messageLine,data);break;case"studio_release":addStudioReleaseMessage(messageLine,data)}messageLine.css("display","inline-block");var scrollTopHeight=$("#msg-body-wrap").scrollTop();if(threadLoad?container.append(messageLine):container.prepend(messageLine),autoscroll)Conversations.scrollToBottom("msg-body-wrap");else{var messageDivHeight=messageLine.outerHeight();$("#msg-body-wrap").scrollTop(scrollTopHeight+messageDivHeight)}"tip"===data.mType&&$j(".tipTest .msg-body-entry").prepend('<div class="tipNotification"></div>')}function populateMediaMessage(threadData,id){$("#"+id).find("a").attr("href",threadData.message).find("img").attr("src",threadData.message),Conversations.scrollToBottom("msg-body-wrap")}function removeConversationAndResetView(thread_id){delete Conversations.threads[thread_id],$j("#thread"+thread_id).remove(),selectThreadByIndex(0),0==$j("#thread-previews").find(".msg-row").length&&($j("#messagesContainer, #headerUsername").empty(),$j("#headerAvatar").css("background-image",""),Conversations.activeTab=null,$j("#noConversations").show())}function getThreadByRecipients(recipients){var exists=!1;if(void 0!==threads){var recipientsToLower=recipients.map(function(recipient){return recipient.toLowerCase()});$.each(threads,function(key,value){if(void 0===value.users&&(value.users=value.thread.users),recipients.length==_.size(value.users)){var threadExists=!0;for(key in value.users)if(value.users.hasOwnProperty(key)&&recipientsToLower.indexOf(value.users[key].toLowerCase())<0){threadExists=!1;break}return threadExists?(exists=!0,$("#msg-thread").modal("hide"),$("#thread"+value.threadId).click(),Conversations.activeTab=value.threadId,!0):void 0}})}return exists}function sanitizeThreadParticipants(participants){var aux=participants.split(/,|\s|;| /),recipients=[];if("my fans"!=participants)for(var i=0;i<aux.length;i++)aux[i]=aux[i].trim(),""!=aux[i]&&recipients.push(aux[i]);else recipients.push("my fans");return recipients.push(Cam4User.userName.toLowerCase()),recipients}function isInvalidUsername(recipients){return recipients.length<2?($j("#errEnterUserName").show(),!0):($j("#errEnterUserName").hide(),!1)}function isEmptyMessage(){return""==$j("#messageToSend").val()&&""==newMessage.getFileUrl()?($j("#errEnterMessage").show(),!0):($j("#errEnterMessage").hide(),!1)}function handleThread(selector){var recipients=$(selector).val(),invalidUsername=isInvalidUsername(recipients=sanitizeThreadParticipants(recipients)),emptyMessage=isEmptyMessage();if(!invalidUsername&&!emptyMessage){var threadExists=getThreadByRecipients(recipients);if(""==recipients||threadExists)newMessage.startSendMessages(Conversations.activeTab);else if("my fans"==recipients[0]){var thread_id=-1*Cam4User.id;Conversations.threads[thread_id]=Conversations.threads[thread_id]||{},Conversations.threads[thread_id].users=recipients,updateMessageContainer(Cam4User.userName,thread_id),Conversations.activeTab=thread_id,newMessage.startSendMessages(Conversations.activeTab,!0)}else Conversations.startThread(recipients);$(selector).val("")}}function bindMessageModalEvents(){$("#startThread").on("click",function(){$j(".threadError").hide(),newMessage.sendNewMessage("#messageToSend")}),$(document).on("keyup",function(e){27==e.which&&Conversations.newMessage.hide()}),$("#searchUser, #openMailBoxButton, #startConversation").on("click",function(){$(".threadError, .videoPreview").hide(),$("#newUploadPreview").attr("src","").hide()}),$("#errorMessageOK").on("click",function(){$("#conversationsErrorMessage").modal("hide")}),$("#msg-thread, #startConversation").on("shown.bs.modal",function(){newMessage.show()})}var threadsLoaded,automaticSearchTimeout,messageRedirectLink,excerptLimit=20,threads={},unconfirmedMessages={},unreadThreadsIds=[],admins=["Cam4 Admin","Cam4 Moderator","Cam4 Coach","Cam4 Team","myshop","My Fans"],marketplaceTypes=["marketplace","marketplace_p","marketplace_d","marketplace_p_c","marketplace_p_f","marketplace_b_p"],MESSAGES_LIMIT=25,THREADS_LIMIT=25,oldSearchFilter="",searchFilter="",automaticSearchInterval=2e3,loading=!1,newMessage=function(){var fileType,fileUrl="",message="";return{updateFileUrl:function(newFileUrl,mType){fileUrl=newFileUrl,"image"==(fileType=mType)&&($j("#newUploadPreview").attr("src",fileUrl).css("display","inline-block"),$j(".videoPreview").hide()),"video"==fileType&&($j(".videoPreview").css("display","inline-block"),$j("#newUploadPreview").attr("src","").hide())},show:function(){var username=$("#searchUsername");fileUrl="",message="",~Cam4User.htmlStates.indexOf("profilePageHeaderInfo_jsp")?username.val(Cam4Performer.name).attr("disabled",!0):username.val("").focus(),$("#messageToSend").val("")},hide:function(){$("#msg-thread").modal("hide")},showError:function(){$("#threadError").show()},sendNewMessage:function(selector){message=$(selector).val(),"placeholder"!=$j("#massUsername").val()&&ControlledFeatures.WRITE_MASS_PERFORMER_MESSAGES?Conversations.handleThread("#massUsername"):Conversations.handleThread("#searchUsername")},startSendMessages:function(thread_id,isNewThread){""!=message&&(Conversations.sendMessage(thread_id,message,"text","",isNewThread),message=""),""!=fileUrl&&(Conversations.sendMessage(thread_id,fileUrl,fileType,"",isNewThread),fileUrl="")},getFileUrl:function(){return fileUrl}}}(),tagsToReplace=(function(){function prepareUpload(event){files=event.target.files}function uploadFilesNew(event,mType,isNewMessage,extension){event.stopPropagation(),event.preventDefault();var id,element,file=files[0],data={size:file.size,contentType:file.type,extension:extension,username:Cam4User.userName,accessHash:Cam4User.kN},thread_id=Conversations.activeTab,tmpMessage="/images/spinner.gif?id="+(new Date).getTime();id=isNewMessage?"newUploadPreview":(new Date).getTime();var dummyData={msgId:"",mType:mType,sendDate:"",message:tmpMessage,displayName:Cam4User.userName,senderId:Cam4User.id,id:id};isNewMessage||addMessage(dummyData,!0,!0),$.ajax({url:"testCommunicatorFileUpload",type:"POST",data:data,beforeSend:function(){setLoaderDisplay("block",".modal .ajax-loader"),element=$("#"+id).find(".msgDate")},success:function(data,textStatus,jqXHR){var tmpUploadUrl=data.tmpUploadUrl,accessUrl=data.accessUrl;$.ajax({xhr:function(){var xhr=new window.XMLHttpRequest;return xhr.upload.addEventListener("progress",function(e){if(e.lengthComputable){var percentComplete=parseInt(e.loaded/e.total*100);element.html(percentComplete+"%")}},!1),xhr},url:tmpUploadUrl,type:"PUT",data:file,cache:!1,dataType:"json",processData:!1,contentType:!1,success:function(data,textStatus,jqXHR){setLoaderDisplay("none",".modal .ajax-loader"),$("#"+id).find("a").attr("href",accessUrl),isNewMessage?newMessage.updateFileUrl(accessUrl,mType):Conversations.sendMessage(thread_id,accessUrl,mType,dummyData.id)},error:function(jqXHR,textStatus,errorThrown){console.log("ERRORS: "+textStatus),setLoaderDisplay("none",".modal .ajax-loader")}})},error:function(jqXHR,textStatus,errorThrown){console.log("ERRORS: "+textStatus),setLoaderDisplay("none",".modal .ajax-loader")}})}function getFileType(extension){return-1!=acceptedImageFileType.indexOf(extension.toLowerCase())?"image":-1!=acceptedVideoFileType.indexOf(extension.toLowerCase())?"video":""}function getExtension(filename){var result=filename.match(/[^\.]*$/),extension="";return result.length>0&&(extension=result[0]),extension}function getFileName(filePath){var result=filePath.match(/([^\\\/]+)$/),filename="";return result.length>0&&(filename=result[0]),filename}var files,acceptedImageFileType=["jpg","jpeg","tiff","gif","png"],acceptedVideoFileType=["mkv","mp4","avi","flv","mov","wmv","3gp","ts","m3u8"];$j("#uploadFile").on("click",function(){$j("#imageFile").click()}),$j("#uploadImageFileNewMessage, #uploadVideoFileNewMessage").on("click",function(){$j("#imageFileNewMessage").click()}),$j("#imageFile, #imageFileNewMessage").on("change",function(event){var extension=getExtension(getFileName($j(this).val())),type=getFileType(extension);""!==type&&(prepareUpload(event),uploadFilesNew(event,type,"imageFileNewMessage"==this.id,extension))})}(),{"&":"&amp;","<":"&lt;",">":"&gt;"});return{getLastMessagesAjax:getLastMessagesAjax,getThreadMessagesAjax:getThreadMessagesAjax,giftPreview:giftPreview,startThread:function(recipients,oldThreadID){loading=!0,$.ajax({url:"/loadConversations?username="+recipients,type:"PUT",dataType:"json",success:function(result){switch(result.status.toLowerCase()){case"success":var thread_id=result.thread_id;oldThreadID<0&&$("#thread"+oldThreadID).attr("id","thread"+thread_id),~thread_id?(Conversations.threads[thread_id]=Conversations.threads[thread_id]||{},Conversations.threads[thread_id].users=result.users,updateMessageContainer(Cam4User.userName,thread_id),Conversations.activeTab=thread_id,newMessage.startSendMessages(thread_id,!0),newMessage.hide()):newMessage.showError();break;case"failed":if(void 0!==result.details)switch(result.details){case"ERROR_MESSAGE_LIMIT":Registration.showGoldUpgradeOverlay("newinbox-throttle"),newMessage.hide();break;case"ERROR_INVALID_RECIPIENT":$j("#invalidUsername").show()}}loading=!1}})},sendMessage:function(threadId,message,mType,id,isNewThread){loading=!0;var noID=!1;id&&""!==id||(id=(new Date).getTime(),noID=!0);var sendThisData={message:message,threadId:threadId,mType:mType,id:id},messageData={senderId:Cam4User.id,displayName:Cam4User.userName,message:message,mType:mType,id:id};("text"==mType||threadId==-1*Cam4User.id&&"video"==mType&&noID)&&addMessage(messageData,!0,!0),"image"==mType&&(threadId==-1*Cam4User.id&&noID?addMessage(messageData,!0,!0):populateMediaMessage(sendThisData,id)),unconfirmedMessages[id]=messageData.message;if(threadId==-1*Cam4User.id)postMessage=$.post("/performerMassMessage",sendThisData),newMessage.hide();else var postMessage=$.post("/loadConversations",sendThisData);postMessage.success(function(data){switch(data.status.toLowerCase()){case"success":markThreadAsRead(threadId),isNewThread&&getThreadMessagesAjax(threadId,!0),threadId<0&&threadId!=-1*Cam4User.id&&-100!=threadId&&$("#thread"+threadId).remove();var tags;tags="undefined"!=typeof Cam4Analytics?Cam4Analytics.getCurrentTags():"NA",dataLayer.push({event:"socialEvents",eventCategory:"privateMessage",eventAction:"sendMessage",eventLabel:tags});break;case"failed":if(void 0!==data.details)switch(data.details){case"ERROR_SENDER_BANNED_BY_RECIPIENT":$(".self .full-msg").filter(function(){return $(this).text()===messageData.message}).text(mailboxI18n.bannedFromConversation),delete unconfirmedMessages[id];break;case"ERROR_MESSAGE_LIMIT":Registration.showGoldUpgradeOverlay("newinbox-throttle"),delete unconfirmedMessages[id];break;case"ERROR_FRESH_BASIC_USER":$("#conversationsErrorMessage").modal("show")}}loading=!1})},addMessage:addMessage,deleteThread:function(thread_id){$.ajax({url:"/loadConversations?threadId="+thread_id,type:"DELETE",success:function(result){"success"==result.status.toLowerCase()&&removeConversationAndResetView(thread_id)}}),$("#delete-thread").modal("hide")},banUser:function(userToBan,thread_id){$.ajax({url:Cam4User.profileName+"/edit/ban_list?changed=true",type:"POST",data:jQuery.param({userNameToBan:userToBan,simpleresult:!0}),success:function(result){removeConversationAndResetView(thread_id)},error:function(jqXHR){409==jqXHR.status?($("#ban-error-msg").text(js_i18n.userAlreadyBanned),$("#ban-user-error").modal("show")):($("#ban-error-msg").text(js_i18n.tryAgain),$("#ban-user-error").modal("show"))}}),$("#ban-user").modal("hide")},activeTab:void 0,unconfirmedMessages:unconfirmedMessages,scrollToBottom:function(id){var scroll=document.getElementById(id);void 0!==scroll&&null!==scroll&&(scroll.scrollTop=scroll.scrollHeight)},threads:threads,getThreadByRecipients:getThreadByRecipients,excerpt:excerpt,init:function(){function getSearchResults(for_search){for_search!==oldSearchFilter&&(getLastMessagesAjax(THREADS_LIMIT,for_search),oldSearchFilter=for_search)}function isExternalLink(url){var domain=function(url){return url.replace("http://","").replace("https://","").split("/")[0].split("?")[0]},urlDomain=domain(url);return!endsWith(urlDomain,".cam4.com")&&"cam4.com"!==urlDomain&&domain(location.href)!==domain(url)}function endsWith(str,suffix){return-1!==str.indexOf(suffix,str.length-suffix.length)}var container=$j("#messagesContainer");threadsLoaded=THREADS_LIMIT,bindMessageModalEvents(),$("#confirm-delete").on("click",function(event){var thread_id=container.data("thread_id");markThreadAsRead(thread_id),Conversations.deleteThread(thread_id)}),$("#cancel-delete").on("click",function(event){$("#delete-thread").modal("hide")}),$("#confirm-ban").on("click",function(event){Conversations.banUser(Conversations.threads[Conversations.activeTab].usersProperties[0].name,container.data("thread_id"))}),$("#cancel-ban").on("click",function(event){$("#ban-user").modal("hide")}),$("#confirm-ban-error").on("click",function(event){$("#ban-user-error").modal("hide")}),$("#msg-body-wrap").on("click","a.link-message",function(event){isExternalLink(messageRedirectLink=event.target.href)&&(event.preventDefault(),event.stopImmediatePropagation(),$("#redirect-modal").modal("show"))}),$("#cancel-redirect").on("click",function(){$("#redirect-modal").modal("hide"),messageRedirectLink=null}),$("#confirm-redirect").on("click",function(){$("#redirect-modal").modal("hide"),window.open(messageRedirectLink,"_blank"),messageRedirectLink=null}),$(document).on("keydown",function(e){var activeConversation=$("#thread-previews").find(".active-tab");if(activeConversation.length)switch(e.keyCode){case 38:activeConversation.prev(".msg-row").length&&activeConversation.prev(".msg-row").click();break;case 40:activeConversation.next(".msg-row").length&&activeConversation.next(".msg-row").click()}}),$("#searchInput").on("keydown",function(e){var for_search="";clearTimeout(automaticSearchTimeout),for_search=e.target.value||document.getElementById("searchInput").value,13==e.which?getSearchResults(for_search):automaticSearchTimeout=setTimeout(function(){getSearchResults(for_search=document.getElementById("searchInput").value)},automaticSearchInterval)}),$("#searchUsername").keypress(function(e){13==e.which&&handleThread("#"+this.id)}),$("#searchUsername").focus(function(){$('#massUsername option[value="placeholder"]').attr("selected","selected")}),$("#sendMessage").on("click",function(){if(!loading){var message=$j("#message").val();if(""!=message){var thread_id=container.data("thread_id");Conversations.sendMessage(thread_id,message,"text"),$j("#message").val("")}}}),$j("#loadMoreMessages").on("click",function(){var thread_id=container.data("thread_id");getThreadMessagesAjax(thread_id,!1,"",Conversations.threads[thread_id].offset+MESSAGES_LIMIT)}),$j("#loadMoreThreads").on("click",function(){getLastMessagesAjax(threadsLoaded+=THREADS_LIMIT)}),$("#message").keypress(function(e){if(13==e.which&&!loading){e.preventDefault();var message=$j("#message").val();if(""!=message){var thread_id=container.data("thread_id");Conversations.sendMessage(thread_id,message,"text"),$j("#message").val("")}}}).on("click",function(){Conversations.activeTab&&markThreadAsRead(Conversations.activeTab)}),$j("#complaintsAboutUser").on("click",function(){Complaints.openAbuseForm()}),Conversations.getLastMessagesAjax(THREADS_LIMIT)},bindMessageModalEvents:bindMessageModalEvents,newMessage:newMessage,handleThread:handleThread,unreadThreadsIds:unreadThreadsIds}}();
var SoundPlayer=function(){function getTipTierSound(tipValue){for(var i=tipTierLimits.length;i>0;){if(parseInt(tipValue)>=parseInt(tipTierLimits[i-1]))return i+1;i--}return 1}function stopAudioInstance(sound){sound.volume=0,sound.pause(),sound=!1}function stopAudioElement(domAudioElementId){if(document.getElementById(domAudioElementId)){var audio=document.getElementById(domAudioElementId);audio.pause(),audio.volume=0,document.body.removeChild(audio)}}function createAudioElement(audioId,soundSource,onEndedCall){stopAudioElement(audioId);var audio=document.createElement("audio");audio.id=audioId,audio.style.display="none",ChatlessPlayer&&ChatlessPlayer.volume&&ChatlessPlayer.volume.get()&&(audio.volume=ChatlessPlayer.volume.get()/100),audio.setAttribute("autoplay",!0);var audioSourceMp3=document.createElement("source");audioSourceMp3.src=soundSource+".mp3";var audioSourceOgg=document.createElement("source");return audioSourceOgg.src=soundSource+".ogg","string"==typeof onEndedCall&&audio.setAttribute("onended",onEndedCall),audio.appendChild(audioSourceMp3),audio.appendChild(audioSourceOgg),document.body.appendChild(audio),audio}function playAttached(source,channel){var audioId="audio_",audio=createAudioElement(audioId+=channel||source,directory+source);soundList[audioId]=audio,audio.volume=1,audio.play()}function flushBuffer(){audioElementsBuffer.length<1?bufferBeingFlushed=!1:(bufferBeingFlushed=!0,createAudioElement("tipSound",audioElementsBuffer.shift(),"SoundPlayer.flushBuffer();"))}var directory=WEB_CDN+"/js/sounds/",soundList={},tipTierLimits=tippingSoundThresholds.split("|"),soundFileBasePath={chat_polls_vote:directory+"chat_polls_vote",chat_polls_win:directory+"chat_polls_win",clock_ticking:directory+"clock_ticking",completeGoal:directory+"complete_goal",dice:directory+"dice_roll",lucky_draw_buy_ticket:directory+"lucky_draw_buy_ticket",lucky_draw_selection:directory+"lucky_draw_selection",lucky_draw_win:directory+"lucky_draw_win",tip:directory+"tip_tier_",tipping_game_start:directory+"tipping_game_start",token_keno_action:directory+"token_keno_action",token_keno_end:directory+"token_keno_end",spin_the_wheel:directory+"spin_the_wheel",spin_the_wheel_win:directory+"spin_the_wheel_win"},standardTierLevel=2,audioElementsBuffer=[],bufferBeingFlushed=!1;return{privateMessageReceived:function(){},createAudioElement:createAudioElement,playAudioInstance:function(source,channel){var audio=new Audio(directory+source+".mp3");soundList[channel]&&stopAudioInstance(soundList[source]),soundList[source]&&stopAudioInstance(soundList[source]),channel?soundList[channel]=audio:soundList[source]=audio,audio.play()},playAttached:playAttached,stopAudioElement:stopAudioElement,privateShowRequest:function(){ChatSettings.getSettings().privateShowSound&&playAttached("private_show_request")},privateShowEnd:function(){ChatSettings.getSettings().privateShowSound&&playAttached("private_show_end")},playTippingSound:function(tipValue,eventType){if(!ChatlessPlayer.tippingSound.isMuted())if(!1!==Chat.getFbStatus()){var soundPath="";soundPath=soundFileBasePath[eventType]&&"tip"!==eventType?soundFileBasePath[eventType]:soundFileBasePath.tip+getTipTierSound(tipValue),audioElementsBuffer.push(soundPath),bufferBeingFlushed||flushBuffer()}else createAudioElement("tipSound",soundFileBasePath.tip+standardTierLevel)},flushBuffer:flushBuffer,getTipTierSound:getTipTierSound,getSounds:function(){return soundList}}}();
function loadSnapshots(){$j(".profile-thumb").each(function(){var _this=$j(this),useShapshotsAPI=ControlledFeatures.USE_SNAPSHOTS_API&&!SFW,link=$j(this).parent("a"),snapshots=useShapshotsAPI?"":String(_this.data("thumbs")),profile=useShapshotsAPI?THUMBNAILS_CDN+"/"+_this.data("username")+"?s="+encodeURIComponent(_this.data("thumbnail-sig")):_this.data("profile"),initial=_this.data("src"),gender=_this.data("gender");useShapshotsAPI&&ControlledFeatures.FACIAL_DETECTION_SNAPSHOTS&&(profile+="&fd=true"),snapshots=""!=snapshots?snapshots.split(","):[];new DirectorySnapshot(this,link,snapshots,initial,profile,"default_Unknown",_this.data("thumbnail-sig"),_this.data("username"),gender,function(image){image.addEventListener("load",function(){image.naturalWidth>image.naturalHeight?$j(image).parent().parent().addClass("wide-thumbnails"):$j(image).parent().parent().addClass("portrait-thumbnails")}),SearchDirectory.cycleImage($j(image))})})}var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}(),ImageSource;!function(ImageSource){ImageSource[ImageSource.profile=0]="profile",ImageSource[ImageSource.gender=1]="gender",ImageSource[ImageSource.snapshot=2]="snapshot"}(ImageSource||(ImageSource={}));var Snapshots;!function(Snapshots){var Snapshot=function(){function Snapshot(snapshots,snapshotImageLink,profileImageLink,defaultImageLink,thumbnailId,username){this.snapshots=snapshots;var snapshotLink=snapshotImageLink;ControlledFeatures.USE_SNAPSHOTS_API&&!SFW&&(snapshotLink=THUMBNAILS_CDN+"/"+username+"?s="+encodeURIComponent(thumbnailId),ControlledFeatures.FACIAL_DETECTION_SNAPSHOTS&&(snapshotLink+="&fd=true")),this.snapshotImageLink=snapshotLink,this.profileImageLink=profileImageLink,this.defaultImageLink=defaultImageLink,this.thumbnailId=thumbnailId,this.username=username}return Snapshot.prototype.getSnapshotBaseUrl=function(url){return url.substring(0,url.lastIndexOf("/")+1)},Snapshot.prototype.getSnapshotExtension=function(url){return url.substring(url.lastIndexOf("."),url.length)},Snapshot.prototype.getProfileImage=function(){return this.snapshots.length>0?(this.imageSource=ImageSource.snapshot,this.snapshots[0]):this.profileImageLink?(this.imageSource=ImageSource.profile,this.profileImageLink):(this.imageSource=ImageSource.gender,this.defaultImageLink)},Snapshot.prototype.getProfileImageUrl=function(){this.getProfileImage();var url=this.defaultImageLink;return this.imageSource==ImageSource.snapshot&&(url=this.snapshotImageLink),this.imageSource==ImageSource.profile&&(url=this.profileImageLink),url},Snapshot.prototype.getLastImageSource=function(){return this.imageSource},Snapshot.prototype.removeProfileImage=function(){this.profileImageLink=""},Snapshot.prototype.removeFirstSnapshot=function(){this.snapshots.length>0&&this.snapshots.shift()},Snapshot}();Snapshots.Snapshot=Snapshot}(Snapshots||(Snapshots={}));var Gender;!function(Gender){Gender[Gender.male=0]="male",Gender[Gender.female=1]="female",Gender[Gender.shemale=2]="shemale",Gender[Gender.unknown=3]="unknown"}(Gender||(Gender={}));var ImageServer=function(){function ImageServer(){}return Object.defineProperty(ImageServer,"IMAGE_EXTENSION",{get:function(){return".jpg"},enumerable:!0,configurable:!0}),Object.defineProperty(ImageServer,"SNAPSHOT_IMAGE_SERVERS",{get:function(){return imageServers.map(function(imageServer){return imageServer+"/avatar/400x300/"})},enumerable:!0,configurable:!0}),Object.defineProperty(ImageServer,"GENDER_URL",{get:function(){return WEB_CDN+"/images/defaults/"},enumerable:!0,configurable:!0}),ImageServer.GET_CHAT_AVATAR=function(username){return"/avatar/user/60x60/"+username+this.IMAGE_EXTENSION},ImageServer}(),DirectorySnapshot=function(_super){function DirectorySnapshot(image,link,snapshots,snapshotsLink,profileLink,defaultLink,thumbnailId,username,gender,onLoad){var _this=_super.call(this,snapshots,snapshotsLink,profileLink,defaultLink,thumbnailId,username)||this;return _this.show=function(){_this.inViewport()&&($j(window).unbind("scroll",_this.scrollHandler),_this.validate())},_this.getProfileId=function(){return _this.profileImageLink.replace(_this.getSnapshotBaseUrl(_this.profileImageLink),"")},_this.getShard=function(snapshotId){return ImageServer.SNAPSHOT_IMAGE_SERVERS[snapshotId%ImageServer.SNAPSHOT_IMAGE_SERVERS.length]},_this.removeProfileImg=function(){_this.profileImageLink=null},_this.removeFirstSnapshotFromDom=function(){_this.removeFirstSnapshot(),typeof _this.snapshots==typeof[]&&$j(_this.image).data("thumbs",_this.snapshots.join(","))},_this.replace=function(){_this.removeFirstSnapshotFromDom(),_this.getLastImageSource()==ImageSource.profile&&_this.removeProfileImg(),_this.validate(_this.getUrl())},_this.validate=function(src){src||(src=_this.getUrl());var temporary=new Image,startTime=(new Date).getTime();temporary.onerror=function(){SnapshotsLogger.logSnapshotFail((new Date).getTime()-startTime),console.log("replacing ",src),_this.replace()},temporary.onload=function(event){SnapshotsLogger.logSnapshotSuccess((new Date).getTime()-startTime),_this.isValid(temporary)?(_this.onLoad(_this.image),_this.link.removeClass("loading"),_this.image.src=src):(console.log("replacing ",src),_this.replace())},temporary.src=src},_this.isValid=function(img){return img.complete&&!(void 0!==img.naturalWidth&&0===img.naturalWidth)},_this.getUrl=function(){var imageId=_this.getProfileImage();return _this.imageSource==ImageSource.snapshot?ControlledFeatures.USE_SNAPSHOTS_API&&!SFW?_this.snapshotImageLink:[_this.getShard(imageId),imageId,ImageServer.IMAGE_EXTENSION].join(""):_this.imageSource==ImageSource.profile?imageId:[ImageServer.GENDER_URL,imageId,ImageServer.IMAGE_EXTENSION].join("")},_this.inViewport=function(){var rect=_this.image.getBoundingClientRect(),offset=window.innerHeight||600;return rect.top>=-offset&&rect.left>=0&&rect.bottom<=(window.innerHeight||document.documentElement.clientHeight)+offset&&rect.right<=(window.innerWidth||document.documentElement.clientWidth)},_this.throttle=function(func,wait,options){var context,args,result,timeout=null,previous=0;options||(options={});var later=function(){previous=!1===options.leading?0:Date.now(),timeout=null,result=func.apply(context,args),context=args=null};return function(){var now=Date.now();previous||!1!==options.leading||(previous=now);var remaining=wait-(now-previous);return context=this,args=arguments,remaining<=0?(clearTimeout(timeout),timeout=null,previous=now,result=func.apply(context,args),context=args=null):timeout||!1===options.trailing||(timeout=setTimeout(later,remaining)),result}},link instanceof $j?_this.link=link:_this.link=$j(image).parent("a"),_this.image=image,_this.gender=gender,_this.defaultImageLink=_this.getGenderProfileImage(),_this.onLoad=onLoad||$j.noop,_this.scrollHandler=_this.throttle(function(){_this.show()},300,{}),_this.inViewport()?_this.show():$j(window).on("scroll",_this.scrollHandler),_this}return __extends(DirectorySnapshot,_super),DirectorySnapshot.prototype.getUserAgent=function(UserAgent){return UserAgent.phone?"phone":UserAgent.tablet?"tablet":"desktop"},DirectorySnapshot.prototype.getGenderProfileImage=function(){var genderImages={f:"default_Female",female:"default_Female",t:"default_Shemale",shemale:"default_Shemale",transgender:"default_Shemale",m:"default_Male",male:"default_Male",u:"default_Unknown",unknown:"default_Unknown",c:"default_Unknown"},genderImagesSizes={phone:"400x300",tablet:"400x300",desktop:"400x300"};return void 0===this.gender&&(this.gender="u"),genderImages[this.gender]+"."+genderImagesSizes[this.getUserAgent(UserAgent)]},DirectorySnapshot}(Snapshots.Snapshot),SexualPreference;!function(SexualPreference){SexualPreference[SexualPreference.straight=0]="straight",SexualPreference[SexualPreference.gay=1]="gay",SexualPreference[SexualPreference.bisexual=2]="bisexual",SexualPreference[SexualPreference.bicurious=3]="bicurious",SexualPreference[SexualPreference.unknown=4]="unknown"}(SexualPreference||(SexualPreference={}));var ShowType;!function(ShowType){ShowType[ShowType.free=0]="free",ShowType[ShowType.privateShow=1]="privateShow",ShowType[ShowType.groupShow=2]="groupShow"}(ShowType||(ShowType={}));var BroadcastType;!function(BroadcastType){BroadcastType[BroadcastType.solo=0]="solo",BroadcastType[BroadcastType.couple=1]="couple",BroadcastType[BroadcastType.male_female_group=2]="male_female_group",BroadcastType[BroadcastType.male_group=3]="male_group",BroadcastType[BroadcastType.female_group=4]="female_group",BroadcastType[BroadcastType.party=5]="party"}(BroadcastType||(BroadcastType={}));var CamType;!function(CamType){CamType[CamType.standard=0]="standard",CamType[CamType.valentinesDay=1]="valentinesDay",CamType[CamType.standardAd=2]="standardAd",CamType[CamType.summerSale=3]="summerSale",CamType[CamType.olympicGold=4]="olympicGold",CamType[CamType.goldBonusTokens=5]="goldBonusTokens"}(CamType||(CamType={}));var CampaignsForAll;!function(CampaignsForAll){CampaignsForAll[CampaignsForAll.SUMMER_TOKENS=0]="SUMMER_TOKENS",CampaignsForAll[CampaignsForAll.BONUS_TOKENS=1]="BONUS_TOKENS"}(CampaignsForAll||(CampaignsForAll={}));var NewShowType;!function(NewShowType){NewShowType[NewShowType.NORMAL=0]="NORMAL",NewShowType[NewShowType.PRIVATE_SHOW=1]="PRIVATE_SHOW",NewShowType[NewShowType.GROUP_SHOW=2]="GROUP_SHOW",NewShowType[NewShowType.GROUP_SHOW_SELLING_TICKETS=3]="GROUP_SHOW_SELLING_TICKETS"}(NewShowType||(NewShowType={}));var CamsListing;!function(CamsListing){var Cam=function(){return function(cam){for(var key in cam)cam.hasOwnProperty(key)&&(this[key]=m.prop(cam[key]));this.hasOwnProperty("type")||(this.type=m.prop(CamType.standard)),this.hasOwnProperty("profileThumbnailId")||(this.profileThumbnailId=m.prop(0)),this.hasOwnProperty("broadcastType")?this.broadcastType=m.prop(BroadcastType[this.broadcastType()]):this.broadcastType=m.prop(BroadcastType.solo),this.hasOwnProperty("sexPreference")||(this.sexPreference=m.prop(SexualPreference.unknown)),this.hasOwnProperty("newPerformer")||(this.newPerformer=m.prop(!1)),this.hasOwnProperty("kiiroo")||(this.kiiroo=m.prop(!1)),this.hasOwnProperty("resolution")||(this.resolution=m.prop("")),this.hasOwnProperty("mbaVersion")||(this.mbaVersion=m.prop("")),this.hasOwnProperty("hlsPreviewUrl")||(this.hlsPreviewUrl=m.prop("")),this.hasOwnProperty("rec")||(this.rec=m.prop(!1)),this.showType(NewShowType[this.showType()])}}();CamsListing.Cam=Cam;var Model=function(){function Model(){var _this=this;this.list=new Array,this.add=function(_cam){_this.list.push(new Cam(_cam))},this.length=function(){return _this.list.length},this.splice=function(a,b){return _this.list.splice(a,b)}}return Model.prototype.getAll=function(){return this.list},Model}(),Controller=function(){return function(args){var _this=this;this.args=args,this.cams=new Model,this.onunload=function(){console.log("unloading cams component")},this.getAll=function(){return _this.cams.getAll()},this.add=function(cam){_this.cams.add(cam)},this.genderOneLetter=function(gender,broadcastType){var genders={female:"f",male:"m",shemale:"t",unknown:"u"};return broadcastType!=BroadcastType.solo?"c":genders.hasOwnProperty(gender)?genders[gender]:"u"},this.broadcastTime=function(broadcastDuration){return new Date((new Date).getTime()-broadcastDuration).getMinutes()},args.cams.map(function(cam){_this.add(cam)})}}();CamsListing.controller=function(args){return new Controller(args)},CamsListing.view=function(ctrl,args){function generateHashtags(status){return status.replace(/[#]+[A-Za-z0-9-_]+/g,function(tag){return['<a class="show-tags" href="/tags/',tag.replace("#",""),'">',tag,"</a>"].join("")})}function countryFlagView(country){return m("span",{class:"country"},[m("img",{src:BLANK_IMG,class:"flag flag-"+country,alt:country,title:country})])}function sexualOrientationView(gender,orientation,broadcastType){var genderShort=ctrl.genderOneLetter(gender,broadcastType);return m("div",{class:"sexnorientation"},[m("img",{src:BLANK_IMG,class:"align-top gender gender-"+genderShort,alt:gender,title:gender}),m("span",{class:"orientation"},orientation)])}function broadcastStatsView(cam){return m("div",{class:"broadcastTime"},[m("span",{class:"timeContainer"},[m("img",{src:BLANK_IMG,class:"align-top stats time",alt:"Broadcast time",title:"Broadcast time"}),m("span",{},[]," "+ctrl.broadcastTime(cam.broadcastTime())+"m ")]),m("span",{class:"viewers"},cam.viewers())])}function profileStatus(cam){var status=cam.statusMessage();return status.length?m("div",{class:"statusMsg2"},[m.trust(generateHashtags(status))]):[]}function profileDetailsView(cam){return m("div",{class:"profileDetailBox clearfix"},[m("div",{class:"profileBoxTitle"},[m("a",{href:"/"+cam.username().toLowerCase()},cam.username())]),m("div",{class:"profileDetailArea"},[countryFlagView(cam.countryCode()),sexualOrientationView(cam.gender(),cam.sexPreference(),cam.broadcastType()),broadcastStatsView(cam)])])}function showTypeView(showType){return~[NewShowType.GROUP_SHOW_SELLING_TICKETS,NewShowType.GROUP_SHOW].indexOf(showType)?m("span",{class:"inPrivateKey groupShow"}):[]}function privateShowView(cam){return cam.goldPartyWinner()?m("div",{class:"sticker-icon show_sticker"},[m("div",{class:"gold_party_winner"},directoryInt.goldExclusive)]):cam.showType()===NewShowType.PRIVATE_SHOW?m("div",{class:"banner private-show"},directoryInt.inPrivateShow):[]}function camTypeView(cam){return cam.vrStream()?m("div",{class:"vrStreamIcon"}):cam.hdStream()?m("div",{class:"cameraStat cameraStatHD"}):[]}function awardView(dailyAward,monthlyAward){return dailyAward||monthlyAward?m("div",{class:"sticker-icon award_sticker"},m("div",{class:"award_gold",title:"award winner"})):[]}function newTagView(newPerformer){if(newPerformer)return m("span",{class:"new-tag"},[m("span",{class:"glyphicon glyphicon-asterisk"}),"New!"])}function sourceView(source){return"mobile"===source?m("div",{class:"sticker-icon mobile-broadcast"},m("div",{class:"mobile-icon",title:"Mobile broadcast"})):[]}function kiirooView(kiiroo){return kiiroo?m("div",{class:"kiirooIcon"}):[]}function adCam(cam){return[m("div",{class:["profileBox","promo-ad",cam.ad().classes,Cam4User.lang].join(" "),onclick:function(){var callback,onClick=cam.ad().onClick;switch(onClick){case"popTokens":callback=TipFactory[onClick];break;default:callback=Registration[onClick]}"function"==typeof callback&&callback(),ctrl.pushGTMEvent()}},[m("div",{class:"profileDataBox"},[m("a",[m("img",{src:BLANK_IMG,width:120,height:90})]),m("div",{class:"profileDetailBox"})])])]}function camType(cam){switch(cam.type()){case CamType.valentinesDay:case CamType.standardAd:case CamType.summerSale:case CamType.olympicGold:case CamType.goldBonusTokens:return adCam(cam);case CamType.standard:default:return standardCam(cam)}}function getAspectRatioClass(cam){var resolution=cam.resolution().split(":"),width=resolution[0],height=resolution[1];return cam.vrStream()&&(height>width?height/=2:width/=2),width/height>=1?"wide-thumbnails":"portrait-thumbnails"}function standardCam(cam){return[m("div",{class:"profileBox"},[m("div",{class:"profileDataBox "+(cam.rec()?"recEng ":"")+getAspectRatioClass(cam),opacity:0,config:function(element,isInitialized,ctx){isInitialized||"undefined"!=typeof DirectoryPreviewHLS&&DirectoryPreviewHLS.load(element)}},[newTagView(cam.newPerformer()),m("a",{href:"/"+cam.username(),class:"profile-preview","data-profile-preview":"true",style:"display:none","data-hls-preview-url":cam.hlsPreviewUrl()},[m("video",{id:"inlinepreview_segment_"+(new Date).getTime()+"_"+cam.username(),muted:"",loop:"","data-setup":"{}",class:"video-js profile-preview "+(cam.vrStream()?"vrPreview ":"")+("mobile"===cam.source()?"mobilePreview ":""),autoplay:""})]),m("a",{href:"/"+cam.username(),class:"loading clearfix"},[m("img",{src:BLANK_IMG,class:"profile-thumb",width:"120",height:"90","data-thumbs":cam.snapshotThumbnailIds(),key:cam.userId(),config:function(element,isInitialized,ctx){if(!isInitialized){var snapshots=~[NewShowType.GROUP_SHOW,NewShowType.PRIVATE_SHOW].indexOf(cam.showType())||cam.privateRoom()?[]:cam.snapshotThumbnailIds();SFW?ctx.snapshot=new DirectorySnapshot(element,null,[],cam.snapshotImageLink(),cam.profileImageLinkSFW(),cam.defaultImageLink(),cam.thumbnailId(),cam.username(),cam.gender(),function(){"undefined"!=typeof SearchDirectory&&SearchDirectory.cycleImage($j(element))}):ctx.snapshot=new DirectorySnapshot(element,null,snapshots,cam.snapshotImageLink(),cam.profileImageLink(),cam.defaultImageLink(),cam.thumbnailId(),cam.username(),cam.gender(),function(){"undefined"!=typeof SearchDirectory&&SearchDirectory.cycleImage($j(element))})}}}),UserAgent.desktop?m("div",{class:"fade"}):""]),privateShowView(cam),profileStatus(cam),m("div",{class:"icon-wrp"},kiirooView(cam.kiiroo()),awardView(cam.dailyAward(),cam.monthlyAward()),showTypeView(cam.showType()),sourceView(cam.source()),camTypeView(cam)),profileDetailsView(cam)])])]}var BLANK_IMG=WEB_CDN+"/images/blank.gif";return ctrl.getAll().length<args.minimumCamsToDisplay?[]:["headerView"in args?args.headerView(ctrl):[],m("div",{class:"cams-wrapper clearfix",config:function(element,isInitialized){isInitialized||Cam4Event.dispatch("segmentLoaded",args.key)}},[ctrl.getAll().slice(0,args.numberOfCams).map(function(cam){return camType(cam)})])]}}(CamsListing||(CamsListing={}));var VR;if(function(VR){var Cams=function(){function Cams(){var _this=this;Cams.getCams().then(function(cams){_this.cams=cams,_this.mount()})}return Object.defineProperty(Cams,"REQUEST_URL",{get:function(){return"/directoryCams"},enumerable:!0,configurable:!0}),Object.defineProperty(Cams,"params",{get:function(){return"?vrStream=true&directoryJson=true"},enumerable:!0,configurable:!0}),Cams.getCams=function(){return m.request({url:this.REQUEST_URL+this.params})},Cams.prototype.mount=function(){var container=document.getElementById("vrCams");container&&(this.camsComponent=m.component(CamsListing,{cams:this.cams,headerView:function(){return[m("h2",{class:"category-title"},m("span",{class:"glyphicon glyphicon-record green"}),js_i18n.liveVRShows)]},numberOfCams:20,minimumCamsToDisplay:1}),this.camsModule=m.module(container,this.camsComponent))},Cams}();VR.Cams=Cams}(VR||(VR={})),document.getElementById("vrCams")){var VRComponent=new VR.Cams;$(".device").on("click",".dev-type",function(e){e.preventDefault();var modalLayout=$("#modalLayout"),content=$("#modal"+this.id).html();modalLayout.html(content).modal("show")})}
var NotificationContainer=function($){function removeRequest(username){var element=$("#"+prefix+username.toLowerCase());element.length&&(element.fadeOut(fadeTime,function(){element.remove()}),requestCounter--),updateCounter()}function addFriendItem(username){var lowerCaseUsername=username.toLowerCase(),element=UI.template.clone(),id=prefix+lowerCaseUsername;return element.attr({id:id,"data-user":lowerCaseUsername}),element.find("a").attr("href","/"+lowerCaseUsername),element.find(".name").text(username),element.find("img.ff-avatar").attr("src",ImageServer.GET_CHAT_AVATAR(lowerCaseUsername)),friendList.appendChild(element[0]),element}function renderList(friendList){UI.containerList.append(friendList)}function animateAction(element,type){element.find("."+type+" .glyphicon").removeClass("glyphicon-ok glyphicon-remove").addClass("glyphicon-refresh glyphicon-refresh-animate")}function animateActionStop(element,type){var retClass="";switch(type){case"accept":retClass="glyphicon-ok";break;case"ignore":retClass="glyphicon-remove"}element.find("."+type+" .glyphicon").removeClass("glyphicon-refresh glyphicon-refresh-animate").addClass(retClass)}function getRequestByUsername(username){return $("#"+prefix+username.toLowerCase())}function updateCounter(){requestCounter>0?(startNotificationBlinking(),UI.count.find("p").text(requestCounter).end().show(),UI.noRequests.hide(),UI.buttonsContainer.show()):(stopNotificationBlinking(),UI.count.hide(),UI.noRequests.show(),UI.buttonsContainer.hide())}function updateNotifications(response){receivedList=response.received,requestCounter=response.totalCount,friendList=document.createDocumentFragment();for(var i=0;i<receivedList.length;i++)addFriendItem(receivedList[i]);updateCounter(),renderList(friendList)}function renderNewRequest(friendRequest){UI.containerList.prepend(friendRequest)}function getFriendRequests(){$.ajax({url:requestURL,context:document.body,dataType:"json",data:{limit:requestLimit,offset:requestOffset},success:function(data){updateNotifications(data.response),data.response.received.length||UI.containerList.off("scroll")}})}function startNotificationBlinking(){UI.bell.find("span").addClass("blinkFavCSS3")}function stopNotificationBlinking(){UI.bell.find("span").removeClass("blinkFavCSS3")}function sendNewRequestResponse(type,friendUsername){var url="",method="",info="",element="";switch(type){case"ACCEPT_ALL":case"IGNORE_ALL":url="/rest/v1.0/friends/"+UI.loggedInUsername+"?action="+type,method="POST";break;case"accept":url="/rest/v1.0/friends/"+UI.loggedInUsername+"/"+friendUsername,method="POST";break;case"ignore":url="/friendRequests",method="POST",info={operation:"ignore",friendUsername:friendUsername};break;default:return void console.error("Invalid friend request type : ",type)}friendUsername&&animateAction(element=getRequestByUsername(friendUsername),type),element&&element.hasClass("pending")||UI.containerList.hasClass("pending")||(UI.friendLimitNotification.hide(),$.ajax({url:url,type:method,data:info,beforeSend:function(){element?element.addClass("pending"):UI.containerList.addClass("pending")},success:function(data){element?element.removeClass("pending"):UI.containerList.removeClass("pending")},error:function(jqXHR){403===jqXHR.status&&""!==jqXHR.responseText&&"FRIEND_LIMIT_REACHED"===JSON.parse(jqXHR.responseText).status&&(UI.friendLimitNotification.show(),""!==element&&(animateActionStop(element,type),element.removeClass("pending"))),UI.containerList.removeClass("pending")}}))}var friendList,prefix="ff_",requestCounter=0,isListOpen=!1,receivedList=[],UI={container:$("#notificationContainer"),containerList:$("#notificationContainerList"),bell:$("#notificationContainerBell"),template:$("#notificationContainerTemplate"),count:$("#notificationCount"),noRequests:$("#notificationContainer").find(".noRequests"),acceptAll:$("#acceptAllFriends"),ignoreAll:$("#ignoreAllFriends"),buttonsContainer:$("#notificationContainer").find(".buttonsContainer"),friendLimitNotification:$("#notificationContainer").find(".friend-limit-notification-container"),loggedInUsername:$("#tempUsername").html()};UI.friendLimitNotification.hide();var requestLimit=20,requestOffset=0,requestURL="/friendRequests",actions=["accept","ignore"],fadeTime=3e3;return{init:function(){actions.map(function(action){var target="."+action;UI.containerList.on("click",target,function(event){event.stopPropagation();var username=$(this).parents(".ff-req").attr("data-user");sendNewRequestResponse(action,username)})}),UI.bell.on("click",function(event){event.stopPropagation(),Cam4User.isBroadcastingWindow||UsersOnline.closeWidget(),NotificationContainer.toggleList(),UI.friendLimitNotification.hide()}),getFriendRequests(),UI.containerList.on("scroll",Utils.throttle(function(){$(this).scrollTop()+$(this).innerHeight()+100>=$(this).prop("scrollHeight")&&(requestOffset+=20,getFriendRequests())},500)),UI.acceptAll.on("click",function(event){event.stopPropagation(),sendNewRequestResponse("ACCEPT_ALL","")}),UI.ignoreAll.on("click",function(event){event.stopPropagation(),sendNewRequestResponse("IGNORE_ALL","")}),$(window).on("click",function(event){UI.container.is(":visible")&&!$(event.target).parents().hasClass("dropdown-menu")&&(NotificationContainer.toggleList(),UI.friendLimitNotification.hide())})},newFriendRequest:function(initiator){Cam4User.userName.toLowerCase()!=initiator.toLowerCase()&&(requestCounter++,renderNewRequest(addFriendItem(initiator))),updateCounter()},removeFriendRequest:function(username,initiator){Cam4User.userName.toLowerCase()!=initiator.toLowerCase()&&(username=initiator),removeRequest(username)},toggleList:function(){isListOpen?(isListOpen=!1,$j("#notificationContainerBell").removeClass("active"),UI.container.hide()):(NotificationContainer.stopNotificationBlinking(),$j("#notificationContainerBell").addClass("active"),isListOpen=!0,UI.container.show())},stopNotificationBlinking:stopNotificationBlinking,startNotificationBlinking:startNotificationBlinking,acceptRequest:function(username){$("#"+prefix+username.toLowerCase()).addClass("accepted").html("<span>"+Cam4NotificationsBundles.friendAccepted.replace("%0",username)+"</span>")}}}(jQuery);Cam4User.isLoggedIn&&$("#notificationContainerList").length&&NotificationContainer.init();
$(function(){$.fn.emojiPicker.emojis=[{name:"grinning",unicode:{apple:"1F600",google:"1F600",twitter:"1F600"},shortcode:"grinning",description:"GRINNING FACE",category:"people"},{name:"grin",unicode:{apple:"1F601",google:"1F601",twitter:"1F601"},shortcode:"grin",description:"GRINNING FACE WITH SMILING EYES",category:"people"},{name:"grimacing",unicode:{apple:"1F62C",google:"1F62C",twitter:"1F62C"},shortcode:"grimacing",description:"GRIMACING FACE",category:"people"},{name:"joy",unicode:{apple:"1F602",google:"1F602",twitter:"1F602"},shortcode:"joy",description:"FACE WITH TEARS OF JOY",category:"people"},{name:"smiley",unicode:{apple:"1F603",google:"1F603",twitter:"1F603"},shortcode:"smiley",description:"SMILING FACE WITH OPEN MOUTH",category:"people"},{name:"smile",unicode:{apple:"1F604",google:"1F604",twitter:"1F604"},shortcode:"smile",description:"SMILING FACE WITH OPEN MOUTH AND SMILING EYES",category:"people"},{name:"sweat_smile",unicode:{apple:"1F605",google:"1F605",twitter:"1F605"},shortcode:"sweat_smile",description:"SMILING FACE WITH OPEN MOUTH AND COLD SWEAT",category:"people"},{name:"laughing",unicode:{apple:"1F606",google:"1F606",twitter:"1F606"},shortcode:"laughing",description:"SMILING FACE WITH OPEN MOUTH AND TIGHTLY-CLOSED EYES",category:"people"},{name:"innocent",unicode:{apple:"1F607",google:"1F607",twitter:"1F607"},shortcode:"innocent",description:"SMILING FACE WITH HALO",category:"people"},{name:"wink",unicode:{apple:"1F609",google:"1F609",twitter:"1F609"},shortcode:"wink",description:"WINKING FACE",category:"people"},{name:"blush",unicode:{apple:"1F60A",google:"1F60A",twitter:"1F60A"},shortcode:"blush",description:"SMILING FACE WITH SMILING EYES",category:"people"},{name:"slightly_smiling_face",unicode:{apple:"1F642",google:"1F642",twitter:"1F642"},shortcode:"slightly_smiling_face",description:"slightly smiling face",category:"people"},{name:"upside_down_face",unicode:{apple:"1F643",google:"1F643",twitter:"1F643"},shortcode:"upside_down_face",description:"upside-down face",category:"people"},{name:"yum",unicode:{apple:"1F60B",google:"1F60B",twitter:"1F60B"},shortcode:"yum",description:"FACE SAVOURING DELICIOUS FOOD",category:"people"},{name:"relieved",unicode:{apple:"1F60C",google:"1F60C",twitter:"1F60C"},shortcode:"relieved",description:"RELIEVED FACE",category:"people"},{name:"heart_eyes",unicode:{apple:"1F60D",google:"1F60D",twitter:"1F60D"},shortcode:"heart_eyes",description:"SMILING FACE WITH HEART-SHAPED EYES",category:"people"},{name:"kissing_heart",unicode:{apple:"1F618",google:"1F618",twitter:"1F618"},shortcode:"kissing_heart",description:"FACE THROWING A KISS",category:"people"},{name:"kissing",unicode:{apple:"1F617",google:"1F617",twitter:"1F617"},shortcode:"kissing",description:"KISSING FACE",category:"people"},{name:"kissing_smiling_eyes",unicode:{apple:"1F619",google:"1F619",twitter:"1F619"},shortcode:"kissing_smiling_eyes",description:"KISSING FACE WITH SMILING EYES",category:"people"},{name:"kissing_closed_eyes",unicode:{apple:"1F61A",google:"1F61A",twitter:"1F61A"},shortcode:"kissing_closed_eyes",description:"KISSING FACE WITH CLOSED EYES",category:"people"},{name:"stuck_out_tongue_winking_eye",unicode:{apple:"1F61C",google:"1F61C",twitter:"1F61C"},shortcode:"stuck_out_tongue_winking_eye",description:"FACE WITH STUCK-OUT TONGUE AND WINKING EYE",category:"people"},{name:"stuck_out_tongue_closed_eyes",unicode:{apple:"1F61D",google:"1F61D",twitter:"1F61D"},shortcode:"stuck_out_tongue_closed_eyes",description:"FACE WITH STUCK-OUT TONGUE AND TIGHTLY-CLOSED EYES",category:"people"},{name:"stuck_out_tongue",unicode:{apple:"1F61B",google:"1F61B",twitter:"1F61B"},shortcode:"stuck_out_tongue",description:"FACE WITH STUCK-OUT TONGUE",category:"people"},{name:"money_mouth_face",unicode:{apple:"1F911",google:"1F911",twitter:"1F911"},shortcode:"money_mouth_face",description:"Money-Mouth Face",category:"people"},{name:"nerd_face",unicode:{apple:"1F913",google:"1F913",twitter:"1F913"},shortcode:"nerd_face",description:"Nerd Face",category:"people"},{name:"sunglasses",unicode:{apple:"1F60E",google:"1F60E",twitter:"1F60E"},shortcode:"sunglasses",description:"SMILING FACE WITH SUNGLASSES",category:"people"},{name:"hugging_face",unicode:{apple:"1F917",google:"1F917",twitter:"1F917"},shortcode:"hugging_face",description:"Hugging Face",category:"people"},{name:"smirk",unicode:{apple:"1F60F",google:"1F60F",twitter:"1F60F"},shortcode:"smirk",description:"SMIRKING FACE",category:"people"},{name:"no_mouth",unicode:{apple:"1F636",google:"1F636",twitter:"1F636"},shortcode:"no_mouth",description:"FACE WITHOUT MOUTH",category:"people"},{name:"neutral_face",unicode:{apple:"1F610",google:"1F610",twitter:"1F610"},shortcode:"neutral_face",description:"NEUTRAL FACE",category:"people"},{name:"expressionless",unicode:{apple:"1F611",google:"1F611",twitter:"1F611"},shortcode:"expressionless",description:"EXPRESSIONLESS FACE",category:"people"},{name:"unamused",unicode:{apple:"1F612",google:"1F612",twitter:"1F612"},shortcode:"unamused",description:"UNAMUSED FACE",category:"people"},{name:"face_with_rolling_eyes",unicode:{apple:"1F644",google:"1F644",twitter:"1F644"},shortcode:"face_with_rolling_eyes",description:"Face With Rolling Eyes",category:"people"},{name:"thinking_face",unicode:{apple:"1F914",google:"1F914",twitter:"1F914"},shortcode:"thinking_face",description:"Thinking Face",category:"people"},{name:"flushed",unicode:{apple:"1F633",google:"1F633",twitter:"1F633"},shortcode:"flushed",description:"FLUSHED FACE",category:"people"},{name:"disappointed",unicode:{apple:"1F61E",google:"1F61E",twitter:"1F61E"},shortcode:"disappointed",description:"DISAPPOINTED FACE",category:"people"},{name:"worried",unicode:{apple:"1F61F",google:"1F61F",twitter:"1F61F"},shortcode:"worried",description:"WORRIED FACE",category:"people"},{name:"angry",unicode:{apple:"1F620",google:"1F620",twitter:"1F620"},shortcode:"angry",description:"ANGRY FACE",category:"people"},{name:"rage",unicode:{apple:"1F621",google:"1F621",twitter:"1F621"},shortcode:"rage",description:"POUTING FACE",category:"people"},{name:"pensive",unicode:{apple:"1F614",google:"1F614",twitter:"1F614"},shortcode:"pensive",description:"PENSIVE FACE",category:"people"},{name:"confused",unicode:{apple:"1F615",google:"1F615",twitter:"1F615"},shortcode:"confused",description:"CONFUSED FACE",category:"people"},{name:"slightly_frowning_face",unicode:{apple:"1F641",google:"1F641",twitter:"1F641"},shortcode:"slightly_frowning_face",description:"slightly frowning face",category:"people"},{name:"white_frowning_face",unicode:{apple:"2639",google:"2639",twitter:"2639"},shortcode:"white_frowning_face",description:"white frowning face",category:"people"},{name:"persevere",unicode:{apple:"1F623",google:"1F623",twitter:"1F623"},shortcode:"persevere",description:"PERSEVERING FACE",category:"people"},{name:"confounded",unicode:{apple:"1F616",google:"1F616",twitter:"1F616"},shortcode:"confounded",description:"CONFOUNDED FACE",category:"people"},{name:"tired_face",unicode:{apple:"1F62B",google:"1F62B",twitter:"1F62B"},shortcode:"tired_face",description:"TIRED FACE",category:"people"},{name:"weary",unicode:{apple:"1F629",google:"1F629",twitter:"1F629"},shortcode:"weary",description:"WEARY FACE",category:"people"},{name:"triumph",unicode:{apple:"1F624",google:"1F624",twitter:"1F624"},shortcode:"triumph",description:"FACE WITH LOOK OF TRIUMPH",category:"people"},{name:"open_mouth",unicode:{apple:"1F62E",google:"1F62E",twitter:"1F62E"},shortcode:"open_mouth",description:"FACE WITH OPEN MOUTH",category:"people"},{name:"scream",unicode:{apple:"1F631",google:"1F631",twitter:"1F631"},shortcode:"scream",description:"FACE SCREAMING IN FEAR",category:"people"},{name:"fearful",unicode:{apple:"1F628",google:"1F628",twitter:"1F628"},shortcode:"fearful",description:"FEARFUL FACE",category:"people"},{name:"cold_sweat",unicode:{apple:"1F630",google:"1F630",twitter:"1F630"},shortcode:"cold_sweat",description:"FACE WITH OPEN MOUTH AND COLD SWEAT",category:"people"},{name:"hushed",unicode:{apple:"1F62F",google:"1F62F",twitter:"1F62F"},shortcode:"hushed",description:"HUSHED FACE",category:"people"},{name:"frowning",unicode:{apple:"1F626",google:"1F626",twitter:"1F626"},shortcode:"frowning",description:"FROWNING FACE WITH OPEN MOUTH",category:"people"},{name:"anguished",unicode:{apple:"1F627",google:"1F627",twitter:"1F627"},shortcode:"anguished",description:"ANGUISHED FACE",category:"people"},{name:"cry",unicode:{apple:"1F622",google:"1F622",twitter:"1F622"},shortcode:"cry",description:"CRYING FACE",category:"people"},{name:"disappointed_relieved",unicode:{apple:"1F625",google:"1F625",twitter:"1F625"},shortcode:"disappointed_relieved",description:"DISAPPOINTED BUT RELIEVED FACE",category:"people"},{name:"sleepy",unicode:{apple:"1F62A",google:"1F62A",twitter:"1F62A"},shortcode:"sleepy",description:"SLEEPY FACE",category:"people"},{name:"sweat",unicode:{apple:"1F613",google:"1F613",twitter:"1F613"},shortcode:"sweat",description:"FACE WITH COLD SWEAT",category:"people"},{name:"sob",unicode:{apple:"1F62D",google:"1F62D",twitter:"1F62D"},shortcode:"sob",description:"LOUDLY CRYING FACE",category:"people"},{name:"dizzy_face",unicode:{apple:"1F635",google:"1F635",twitter:"1F635"},shortcode:"dizzy_face",description:"DIZZY FACE",category:"people"},{name:"astonished",unicode:{apple:"1F632",google:"1F632",twitter:"1F632"},shortcode:"astonished",description:"ASTONISHED FACE",category:"people"},{name:"zipper_mouth_face",unicode:{apple:"1F910",google:"1F910",twitter:"1F910"},shortcode:"zipper_mouth_face",description:"Zipper-Mouth Face",category:"people"},{name:"mask",unicode:{apple:"1F637",google:"1F637",twitter:"1F637"},shortcode:"mask",description:"FACE WITH MEDICAL MASK",category:"people"},{name:"face_with_thermometer",unicode:{apple:"1F912",google:"1F912",twitter:"1F912"},shortcode:"face_with_thermometer",description:"Face With Thermometer",category:"people"},{name:"face_with_head_bandage",unicode:{apple:"1F915",google:"1F915",twitter:"1F915"},shortcode:"face_with_head_bandage",description:"Face With Head-Bandage",category:"people"},{name:"sleeping",unicode:{apple:"1F634",google:"1F634",twitter:"1F634"},shortcode:"sleeping",description:"SLEEPING FACE",category:"people"},{name:"zzz",unicode:{apple:"1F4A4",google:"1F4A4",twitter:"1F4A4"},shortcode:"zzz",description:"SLEEPING SYMBOL",category:"people"},{name:"hankey",keywords:["poop","poo"],unicode:{apple:"1F4A9",google:"1F4A9",twitter:"1F4A9"},shortcode:"hankey",description:"PILE OF POO",category:"people"},{name:"smiling_imp",unicode:{apple:"1F608",google:"1F608",twitter:"1F608"},shortcode:"smiling_imp",description:"SMILING FACE WITH HORNS",category:"people"},{name:"imp",unicode:{apple:"1F47F",google:"1F47F",twitter:"1F47F"},shortcode:"imp",description:"IMP",category:"people"},{name:"japanese_ogre",unicode:{apple:"1F479",google:"1F479",twitter:"1F479"},shortcode:"japanese_ogre",description:"JAPANESE OGRE",category:"people"},{name:"japanese_goblin",unicode:{apple:"1F47A",google:"1F47A",twitter:"1F47A"},shortcode:"japanese_goblin",description:"JAPANESE GOBLIN",category:"people"},{name:"skull",unicode:{apple:"1F480",google:"1F480",twitter:"1F480"},shortcode:"skull",description:"SKULL",category:"people"},{name:"ghost",unicode:{apple:"1F47B",google:"1F47B",twitter:"1F47B"},shortcode:"ghost",description:"GHOST",category:"people"},{name:"alien",unicode:{apple:"1F47D",google:"1F47D",twitter:"1F47D"},shortcode:"alien",description:"EXTRATERRESTRIAL ALIEN",category:"people"},{name:"robot_face",unicode:{apple:"1F916",google:"1F916",twitter:"1F916"},shortcode:"robot_face",description:"Robot Face",category:"people"},{name:"smiley_cat",unicode:{apple:"1F63A",google:"1F63A",twitter:"1F63A"},shortcode:"smiley_cat",description:"SMILING CAT FACE WITH OPEN MOUTH",category:"people"},{name:"smile_cat",unicode:{apple:"1F638",google:"1F638",twitter:"1F638"},shortcode:"smile_cat",description:"GRINNING CAT FACE WITH SMILING EYES",category:"people"},{name:"joy_cat",unicode:{apple:"1F639",google:"1F639",twitter:"1F639"},shortcode:"joy_cat",description:"CAT FACE WITH TEARS OF JOY",category:"people"},{name:"heart_eyes_cat",unicode:{apple:"1F63B",google:"1F63B",twitter:"1F63B"},shortcode:"heart_eyes_cat",description:"SMILING CAT FACE WITH HEART-SHAPED EYES",category:"people"},{name:"smirk_cat",unicode:{apple:"1F63C",google:"1F63C",twitter:"1F63C"},shortcode:"smirk_cat",description:"CAT FACE WITH WRY SMILE",category:"people"},{name:"kissing_cat",unicode:{apple:"1F63D",google:"1F63D",twitter:"1F63D"},shortcode:"kissing_cat",description:"KISSING CAT FACE WITH CLOSED EYES",category:"people"},{name:"scream_cat",unicode:{apple:"1F640",google:"1F640",twitter:"1F640"},shortcode:"scream_cat",description:"WEARY CAT FACE",category:"people"},{name:"crying_cat_face",unicode:{apple:"1F63F",google:"1F63F",twitter:"1F63F"},shortcode:"crying_cat_face",description:"CRYING CAT FACE",category:"people"},{name:"pouting_cat",unicode:{apple:"1F63E",google:"1F63E",twitter:"1F63E"},shortcode:"pouting_cat",description:"POUTING CAT FACE",category:"people"},{name:"raised_hands",unicode:{apple:"1F64C",google:"1F64C",twitter:"1F64C"},shortcode:"raised_hands",description:"PERSON RAISING BOTH HANDS IN CELEBRATION",category:"people"},{name:"clap",unicode:{apple:"1F44F",google:"1F44F",twitter:"1F44F"},shortcode:"clap",description:"CLAPPING HANDS SIGN",category:"people"},{name:"wave",unicode:{apple:"1F44B",google:"1F44B",twitter:"1F44B"},shortcode:"wave",description:"WAVING HAND SIGN",category:"people"},{name:"+1",keywords:["thumbsup"],unicode:{apple:"1F44D",google:"1F44D",twitter:"1F44D"},shortcode:"plus1",description:"THUMBS UP SIGN",category:"people"},{name:"-1",keywords:["thumbsdown"],unicode:{apple:"1F44E",google:"1F44E",twitter:"1F44E"},shortcode:"-1",description:"THUMBS DOWN SIGN",category:"people"},{name:"facepunch",unicode:{apple:"1F44A",google:"1F44A",twitter:"1F44A"},shortcode:"facepunch",description:"FISTED HAND SIGN",category:"people"},{name:"fist",unicode:{apple:"270A",google:"270A",twitter:"270A"},shortcode:"fist",description:"RAISED FIST",category:"people"},{name:"v",unicode:{apple:"270C",google:"270C",twitter:"270C"},shortcode:"v",description:"VICTORY HAND",category:"people"},{name:"ok_hand",unicode:{apple:"1F44C",google:"1F44C",twitter:"1F44C"},shortcode:"ok_hand",description:"OK HAND SIGN",category:"people"},{name:"hand",unicode:{apple:"270B",google:"270B",twitter:"270B"},shortcode:"hand",description:"RAISED HAND",category:"people"},{name:"open_hands",unicode:{apple:"1F450",google:"1F450",twitter:"1F450"},shortcode:"open_hands",description:"OPEN HANDS SIGN",category:"people"},{name:"muscle",unicode:{apple:"1F4AA",google:"1F4AA",twitter:"1F4AA"},shortcode:"muscle",description:"FLEXED BICEPS",category:"people"},{name:"pray",unicode:{apple:"1F64F",google:"1F64F",twitter:"1F64F"},shortcode:"pray",description:"PERSON WITH FOLDED HANDS",category:"people"},{name:"point_up",unicode:{apple:"261D",google:"261D",twitter:"261D"},shortcode:"point_up",description:"WHITE UP POINTING INDEX",category:"people"},{name:"point_up_2",unicode:{apple:"1F446",google:"1F446",twitter:"1F446"},shortcode:"point_up_2",description:"WHITE UP POINTING BACKHAND INDEX",category:"people"},{name:"point_down",unicode:{apple:"1F447",google:"1F447",twitter:"1F447"},shortcode:"point_down",description:"WHITE DOWN POINTING BACKHAND INDEX",category:"people"},{name:"point_left",unicode:{apple:"1F448",google:"1F448",twitter:"1F448"},shortcode:"point_left",description:"WHITE LEFT POINTING BACKHAND INDEX",category:"people"},{name:"point_right",unicode:{apple:"1F449",google:"1F449",twitter:"1F449"},shortcode:"point_right",description:"WHITE RIGHT POINTING BACKHAND INDEX",category:"people"},{name:"middle_finger",keywords:["reversed_hand_with_middle_finger_extended"],unicode:{apple:"1F595",google:"1F595",twitter:"1F595"},shortcode:"middle_finger",description:"Reversed Hand With Middle Finger Extended",category:"people"},{name:"raised_hand_with_fingers_splayed",unicode:{apple:"1F590",google:"1F590",twitter:"1F590"},shortcode:"raised_hand_with_fingers_splayed",description:"Raised Hand With Fingers Splayed",category:"people"},{name:"the_horns",keywords:["sign_of_the_horns"],unicode:{apple:"1F918",google:"1F918",twitter:"1F918"},shortcode:"the_horns",description:"Sign of the Horns",category:"people"},{name:"spock-hand",unicode:{apple:"1F596",google:"1F596",twitter:"1F596"},shortcode:"spock-hand",description:"Raised Hand With Part Between Middle and Ring Fingers",category:"people"},{name:"writing_hand",unicode:{apple:"270D",google:"270D",twitter:"270D"},shortcode:"writing_hand",description:"Writing Hand",category:"people"},{name:"nail_care",unicode:{apple:"1F485",google:"1F485",twitter:"1F485"},shortcode:"nail_care",description:"NAIL POLISH",category:"people"},{name:"lips",unicode:{apple:"1F444",google:"1F444",twitter:"1F444"},shortcode:"lips",description:"MOUTH",category:"people"},{name:"tongue",unicode:{apple:"1F445",google:"1F445",twitter:"1F445"},shortcode:"tongue",description:"TONGUE",category:"people"},{name:"ear",unicode:{apple:"1F442",google:"1F442",twitter:"1F442"},shortcode:"ear",description:"EAR",category:"people"},{name:"nose",unicode:{apple:"1F443",google:"1F443",twitter:"1F443"},shortcode:"nose",description:"NOSE",category:"people"},{name:"eye",unicode:{apple:"1F441",google:"1F441",twitter:"1F441"},shortcode:"eye",description:"EYE",category:"people"},{name:"eyes",unicode:{apple:"1F440",google:"1F440",twitter:"1F440"},shortcode:"eyes",description:"EYES",category:"people"},{name:"bust_in_silhouette",unicode:{apple:"1F464",google:"1F464",twitter:"1F464"},shortcode:"bust_in_silhouette",description:"BUST IN SILHOUETTE",category:"people"},{name:"busts_in_silhouette",unicode:{apple:"1F465",google:"1F465",twitter:"1F465"},shortcode:"busts_in_silhouette",description:"BUSTS IN SILHOUETTE",category:"people"},{name:"speaking_head_in_silhouette",unicode:{apple:"1F5E3",google:"1F5E3",twitter:"1F5E3"},shortcode:"speaking_head_in_silhouette",description:" Speaking Head in Silhouette",category:"people"},{name:"baby",unicode:{apple:"1F476",google:"1F476",twitter:"1F476"},shortcode:"baby",description:"BABY",category:"people"},{name:"boy",unicode:{apple:"1F466",google:"1F466",twitter:"1F466"},shortcode:"boy",description:"BOY",category:"people"},{name:"girl",unicode:{apple:"1F467",google:"1F467",twitter:"1F467"},shortcode:"girl",description:"GIRL",category:"people"},{name:"man",unicode:{apple:"1F468",google:"1F468",twitter:"1F468"},shortcode:"man",description:"MAN",category:"people"},{name:"woman",unicode:{apple:"1F469",google:"1F469",twitter:"1F469"},shortcode:"woman",description:"WOMAN",category:"people"},{name:"person_with_blond_hair",unicode:{apple:"1F471",google:"1F471",twitter:"1F471"},shortcode:"person_with_blond_hair",description:"PERSON WITH BLOND HAIR",category:"people"},{name:"older_man",unicode:{apple:"1F474",google:"1F474",twitter:"1F474"},shortcode:"older_man",description:"OLDER MAN",category:"people"},{name:"older_woman",unicode:{apple:"1F475",google:"1F475",twitter:"1F475"},shortcode:"older_woman",description:"OLDER WOMAN",category:"people"},{name:"man_with_gua_pi_mao",unicode:{apple:"1F472",google:"1F472",twitter:"1F472"},shortcode:"man_with_gua_pi_mao",description:"MAN WITH GUA PI MAO",category:"people"},{name:"man_with_turban",unicode:{apple:"1F473",google:"1F473",twitter:"1F473"},shortcode:"man_with_turban",description:"MAN WITH TURBAN",category:"people"},{name:"cop",unicode:{apple:"1F46E",google:"1F46E",twitter:"1F46E"},shortcode:"cop",description:"POLICE OFFICER",category:"people"},{name:"construction_worker",unicode:{apple:"1F477",google:"1F477",twitter:"1F477"},shortcode:"construction_worker",description:"CONSTRUCTION WORKER",category:"people"},{name:"guardsman",unicode:{apple:"1F482",google:"1F482",twitter:"1F482"},shortcode:"guardsman",description:"GUARDSMAN",category:"people"},{name:"sleuth_or_spy",unicode:{apple:"1F575",google:"1F575",twitter:"1F575"},shortcode:"sleuth_or_spy",description:"Sleuth Or Spy",category:"people"},{name:"santa",unicode:{apple:"1F385",google:"1F385",twitter:"1F385"},shortcode:"santa",description:"FATHER CHRISTMAS",category:"people"},{name:"angel",unicode:{apple:"1F47C",google:"1F47C",twitter:"1F47C"},shortcode:"angel",description:"BABY ANGEL",category:"people"},{name:"princess",unicode:{apple:"1F478",google:"1F478",twitter:"1F478"},shortcode:"princess",description:"PRINCESS",category:"people"},{name:"bride_with_veil",unicode:{apple:"1F470",google:"1F470",twitter:"1F470"},shortcode:"bride_with_veil",description:"BRIDE WITH VEIL",category:"people"},{name:"walking",unicode:{apple:"1F6B6",google:"1F6B6",twitter:"1F6B6"},shortcode:"walking",description:"PEDESTRIAN",category:"people"},{name:"runner",unicode:{apple:"1F3C3",google:"1F3C3",twitter:"1F3C3"},shortcode:"runner",description:"RUNNER",category:"people"},{name:"dancer",unicode:{apple:"1F483",google:"1F483",twitter:"1F483"},shortcode:"dancer",description:"DANCER",category:"people"},{name:"dancers",unicode:{apple:"1F46F",google:"1F46F",twitter:"1F46F"},shortcode:"dancers",description:"WOMAN WITH BUNNY EARS",category:"people"},{name:"couple",unicode:{apple:"1F46B",google:"1F46B",twitter:"1F46B"},shortcode:"couple",description:"MAN AND WOMAN HOLDING HANDS",category:"people"},{name:"two_men_holding_hands",unicode:{apple:"1F46C",google:"1F46C",twitter:"1F46C"},shortcode:"two_men_holding_hands",description:"TWO MEN HOLDING HANDS",category:"people"},{name:"two_women_holding_hands",unicode:{apple:"1F46D",google:"1F46D",twitter:"1F46D"},shortcode:"two_women_holding_hands",description:"TWO WOMEN HOLDING HANDS",category:"people"},{name:"bow",unicode:{apple:"1F647",google:"1F647",twitter:"1F647"},shortcode:"bow",description:"PERSON BOWING DEEPLY",category:"people"},{name:"information_desk_person",unicode:{apple:"1F481",google:"1F481",twitter:"1F481"},shortcode:"information_desk_person",description:"INFORMATION DESK PERSON",category:"people"},{name:"no_good",unicode:{apple:"1F645",google:"1F645",twitter:"1F645"},shortcode:"no_good",description:"FACE WITH NO GOOD GESTURE",category:"people"},{name:"ok_woman",unicode:{apple:"1F646",google:"1F646",twitter:"1F646"},shortcode:"ok_woman",description:"FACE WITH OK GESTURE",category:"people"},{name:"raising_hand",unicode:{apple:"1F64B",google:"1F64B",twitter:"1F64B"},shortcode:"raising_hand",description:"HAPPY PERSON RAISING ONE HAND",category:"people"},{name:"person_with_pouting_face",unicode:{apple:"1F64E",google:"1F64E",twitter:"1F64E"},shortcode:"person_with_pouting_face",description:"PERSON WITH POUTING FACE",category:"people"},{name:"person_frowning",unicode:{apple:"1F64D",google:"1F64D",twitter:"1F64D"},shortcode:"person_frowning",description:"PERSON FROWNING",category:"people"},{name:"haircut",unicode:{apple:"1F487",google:"1F487",twitter:"1F487"},shortcode:"haircut",description:"HAIRCUT",category:"people"},{name:"massage",unicode:{apple:"1F486",google:"1F486",twitter:"1F486"},shortcode:"massage",description:"FACE MASSAGE",category:"people"},{name:"couple_with_heart",unicode:{apple:"1F491",google:"1F491",twitter:"1F491"},shortcode:"couple_with_heart",description:"COUPLE WITH HEART",category:"people"},{name:"couplekiss",unicode:{apple:"1F48F",google:"1F48F",twitter:"1F48F"},shortcode:"couplekiss",description:"KISS",category:"people"},{name:"family",unicode:{apple:"1F46A",google:"1F46A",twitter:"1F46A"},shortcode:"family",description:"FAMILY",category:"people"},{name:"womans_clothes",unicode:{apple:"1F45A",google:"1F45A",twitter:"1F45A"},shortcode:"womans_clothes",description:"WOMANS CLOTHES",category:"people"},{name:"shirt",unicode:{apple:"1F455",google:"1F455",twitter:"1F455"},shortcode:"shirt",description:"T-SHIRT",category:"people"},{name:"jeans",unicode:{apple:"1F456",google:"1F456",twitter:"1F456"},shortcode:"jeans",description:"JEANS",category:"people"},{name:"necktie",unicode:{apple:"1F454",google:"1F454",twitter:"1F454"},shortcode:"necktie",description:"NECKTIE",category:"people"},{name:"dress",unicode:{apple:"1F457",google:"1F457",twitter:"1F457"},shortcode:"dress",description:"DRESS",category:"people"},{name:"bikini",unicode:{apple:"1F459",google:"1F459",twitter:"1F459"},shortcode:"bikini",description:"BIKINI",category:"people"},{name:"kimono",unicode:{apple:"1F458",google:"1F458",twitter:"1F458"},shortcode:"kimono",description:"KIMONO",category:"people"},{name:"lipstick",unicode:{apple:"1F484",google:"1F484",twitter:"1F484"},shortcode:"lipstick",description:"LIPSTICK",category:"people"},{name:"kiss",unicode:{apple:"1F48B",google:"1F48B",twitter:"1F48B"},shortcode:"kiss",description:"KISS MARK",category:"people"},{name:"footprints",unicode:{apple:"1F463",google:"1F463",twitter:"1F463"},shortcode:"footprints",description:"FOOTPRINTS",category:"people"},{name:"high_heel",unicode:{apple:"1F460",google:"1F460",twitter:"1F460"},shortcode:"high_heel",description:"HIGH-HEELED SHOE",category:"people"},{name:"sandal",unicode:{apple:"1F461",google:"1F461",twitter:"1F461"},shortcode:"sandal",description:"WOMANS SANDAL",category:"people"},{name:"boot",unicode:{apple:"1F462",google:"1F462",twitter:"1F462"},shortcode:"boot",description:"WOMANS BOOTS",category:"people"},{name:"mans_shoe",unicode:{apple:"1F45E",google:"1F45E",twitter:"1F45E"},shortcode:"mans_shoe",description:"MANS SHOE",category:"people"},{name:"athletic_shoe",unicode:{apple:"1F45F",google:"1F45F",twitter:"1F45F"},shortcode:"athletic_shoe",description:"ATHLETIC SHOE",category:"people"},{name:"womans_hat",unicode:{apple:"1F452",google:"1F452",twitter:"1F452"},shortcode:"womans_hat",description:"WOMANS HAT",category:"people"},{name:"tophat",unicode:{apple:"1F3A9",google:"1F3A9",twitter:"1F3A9"},shortcode:"tophat",description:"TOP HAT",category:"people"},{name:"helmet_with_white_cross",unicode:{apple:"26D1",google:"26D1",twitter:"26D1"},shortcode:"helmet_with_white_cross",description:"Helmet With White Cross",category:"people"},{name:"mortar_board",unicode:{apple:"1F393",google:"1F393",twitter:"1F393"},shortcode:"mortar_board",description:"GRADUATION CAP",category:"people"},{name:"crown",unicode:{apple:"1F451",google:"1F451",twitter:"1F451"},shortcode:"crown",description:"CROWN",category:"people"},{name:"school_satchel",unicode:{apple:"1F392",google:"1F392",twitter:"1F392"},shortcode:"school_satchel",description:"SCHOOL SATCHEL",category:"people"},{name:"pouch",unicode:{apple:"1F45D",google:"1F45D",twitter:"1F45D"},shortcode:"pouch",description:"POUCH",category:"people"},{name:"purse",unicode:{apple:"1F45B",google:"1F45B",twitter:"1F45B"},shortcode:"purse",description:"PURSE",category:"people"},{name:"handbag",unicode:{apple:"1F45C",google:"1F45C",twitter:"1F45C"},shortcode:"handbag",description:"HANDBAG",category:"people"},{name:"briefcase",unicode:{apple:"1F4BC",google:"1F4BC",twitter:"1F4BC"},shortcode:"briefcase",description:"BRIEFCASE",category:"people"},{name:"eyeglasses",unicode:{apple:"1F453",google:"1F453",twitter:"1F453"},shortcode:"eyeglasses",description:"EYEGLASSES",category:"people"},{name:"dark_sunglasses",unicode:{apple:"1F576",google:"1F576",twitter:"1F576"},shortcode:"dark_sunglasses",description:"Dark Sunglasses",category:"people"},{name:"ring",unicode:{apple:"1F48D",google:"1F48D",twitter:"1F48D"},shortcode:"ring",description:"RING",category:"people"},{name:"closed_umbrella",unicode:{apple:"1F302",google:"1F302",twitter:"1F302"},shortcode:"closed_umbrella",description:"CLOSED UMBRELLA",category:"people"},{name:"dog",unicode:{apple:"1F436",google:"1F436",twitter:"1F436"},shortcode:"dog",description:"DOG FACE",category:"animal"},{name:"cat",unicode:{apple:"1F431",google:"1F431",twitter:"1F431"},shortcode:"cat",description:"CAT FACE",category:"animal"},{name:"mouse",unicode:{apple:"1F42D",google:"1F42D",twitter:"1F42D"},shortcode:"mouse",description:"MOUSE FACE",category:"animal"},{name:"hamster",unicode:{apple:"1F439",google:"1F439",twitter:"1F439"},shortcode:"hamster",description:"HAMSTER FACE",category:"animal"},{name:"rabbit",unicode:{apple:"1F430",google:"1F430",twitter:"1F430"},shortcode:"rabbit",description:"RABBIT FACE",category:"animal"},{name:"bear",unicode:{apple:"1F43B",google:"1F43B",twitter:"1F43B"},shortcode:"bear",description:"BEAR FACE",category:"animal"},{name:"panda_face",unicode:{apple:"1F43C",google:"1F43C",twitter:"1F43C"},shortcode:"panda_face",description:"PANDA FACE",category:"animal"},{name:"koala",unicode:{apple:"1F428",google:"1F428",twitter:"1F428"},shortcode:"koala",description:"KOALA",category:"animal"},{name:"tiger",unicode:{apple:"1F42F",google:"1F42F",twitter:"1F42F"},shortcode:"tiger",description:"TIGER FACE",category:"animal"},{name:"lion",keywords:["lion_face"],unicode:{apple:"1F981",google:"1F981",twitter:"1F981"},shortcode:"lion",description:"Lion Face",category:"animal"},{name:"cow",unicode:{apple:"1F42E",google:"1F42E",twitter:"1F42E"},shortcode:"cow",description:"COW FACE",category:"animal"},{name:"pig",unicode:{apple:"1F437",google:"1F437",twitter:"1F437"},shortcode:"pig",description:"PIG FACE",category:"animal"},{name:"pig_nose",unicode:{apple:"1F43D",google:"1F43D",twitter:"1F43D"},shortcode:"pig_nose",description:"PIG NOSE",category:"animal"},{name:"frog",unicode:{apple:"1F438",google:"1F438",twitter:"1F438"},shortcode:"frog",description:"FROG FACE",category:"animal"},{name:"octopus",unicode:{apple:"1F419",google:"1F419",twitter:"1F419"},shortcode:"octopus",description:"OCTOPUS",category:"animal"},{name:"monkey_face",unicode:{apple:"1F435",google:"1F435",twitter:"1F435"},shortcode:"monkey_face",description:"MONKEY FACE",category:"animal"},{name:"see_no_evil",unicode:{apple:"1F648",google:"1F648",twitter:"1F648"},shortcode:"see_no_evil",description:"SEE-NO-EVIL MONKEY",category:"nature"},{name:"hear_no_evil",unicode:{apple:"1F649",google:"1F649",twitter:"1F649"},shortcode:"hear_no_evil",description:"HEAR-NO-EVIL MONKEY",category:"nature"},{name:"speak_no_evil",unicode:{apple:"1F64A",google:"1F64A",twitter:"1F64A"},shortcode:"speak_no_evil",description:"SPEAK-NO-EVIL MONKEY",category:"nature"},{name:"monkey",unicode:{apple:"1F412",google:"1F412",twitter:"1F412"},shortcode:"monkey",description:"MONKEY",category:"animal"},{name:"chicken",unicode:{apple:"1F414",google:"1F414",twitter:"1F414"},shortcode:"chicken",description:"CHICKEN",category:"animal"},{name:"penguin",unicode:{apple:"1F427",google:"1F427",twitter:"1F427"},shortcode:"penguin",description:"PENGUIN",category:"animal"},{name:"bird",unicode:{apple:"1F426",google:"1F426",twitter:"1F426"},shortcode:"bird",description:"BIRD",category:"animal"},{name:"baby_chick",unicode:{apple:"1F424",google:"1F424",twitter:"1F424"},shortcode:"baby_chick",description:"BABY CHICK",category:"animal"},{name:"hatching_chick",unicode:{apple:"1F423",google:"1F423",twitter:"1F423"},shortcode:"hatching_chick",description:"HATCHING CHICK",category:"animal"},{name:"hatched_chick",unicode:{apple:"1F425",google:"1F425",twitter:"1F425"},shortcode:"hatched_chick",description:"FRONT-FACING BABY CHICK",category:"animal"},{name:"wolf",unicode:{apple:"1F43A",google:"1F43A",twitter:"1F43A"},shortcode:"wolf",description:"WOLF FACE",category:"animal"},{name:"boar",unicode:{apple:"1F417",google:"1F417",twitter:"1F417"},shortcode:"boar",description:"BOAR",category:"animal"},{name:"horse",unicode:{apple:"1F434",google:"1F434",twitter:"1F434"},shortcode:"horse",description:"HORSE FACE",category:"animal"},{name:"unicorn",unicode:{apple:"1F984",google:"1F984",twitter:"1F984"},shortcode:"unicorn",description:"Unicorn Face",category:"animal"},{name:"bee",unicode:{apple:"1F41D",google:"1F41D",twitter:"1F41D"},shortcode:"bee",description:"HONEYBEE",category:"animal"},{name:"bug",unicode:{apple:"1F41B",google:"1F41B",twitter:"1F41B"},shortcode:"bug",description:"BUG",category:"animal"},{name:"snail",unicode:{apple:"1F40C",google:"1F40C",twitter:"1F40C"},shortcode:"snail",description:"SNAIL",category:"animal"},{name:"beetle",unicode:{apple:"1F41E",google:"1F41E",twitter:"1F41E"},shortcode:"beetle",description:"LADY BEETLE",category:"animal"},{name:"ant",unicode:{apple:"1F41C",google:"1F41C",twitter:"1F41C"},shortcode:"ant",description:"ANT",category:"animal"},{name:"spider",unicode:{apple:"1F577",google:"1F577",twitter:"1F577"},shortcode:"spider",description:"Spider",category:"animal"},{name:"scorpion",unicode:{apple:"1F982",google:"1F982",twitter:"1F982"},shortcode:"scorpion",description:"Scorpion",category:"animal"},{name:"crab",unicode:{apple:"1F980",google:"1F980",twitter:"1F980"},shortcode:"crab",description:"Crab",category:"animal"},{name:"snake",unicode:{apple:"1F40D",google:"1F40D",twitter:"1F40D"},shortcode:"snake",description:"SNAKE",category:"animal"},{name:"turtle",unicode:{apple:"1F422",google:"1F422",twitter:"1F422"},shortcode:"turtle",description:"TURTLE",category:"animal"},{name:"tropical_fish",unicode:{apple:"1F420",google:"1F420",twitter:"1F420"},shortcode:"tropical_fish",description:"TROPICAL FISH",category:"animal"},{name:"fish",unicode:{apple:"1F41F",google:"1F41F",twitter:"1F41F"},shortcode:"fish",description:"FISH",category:"animal"},{name:"blowfish",unicode:{apple:"1F421",google:"1F421",twitter:"1F421"},shortcode:"blowfish",description:"BLOWFISH",category:"animal"},{name:"dolphin",unicode:{apple:"1F42C",google:"1F42C",twitter:"1F42C"},shortcode:"dolphin",description:"DOLPHIN",category:"animal"},{name:"whale",unicode:{apple:"1F433",google:"1F433",twitter:"1F433"},shortcode:"whale",description:"SPOUTING WHALE",category:"animal"},{name:"whale2",unicode:{apple:"1F40B",google:"1F40B",twitter:"1F40B"},shortcode:"whale2",description:"WHALE",category:"animal"},{name:"crocodile",unicode:{apple:"1F40A",google:"1F40A",twitter:"1F40A"},shortcode:"crocodile",description:"CROCODILE",category:"animal"},{name:"leopard",unicode:{apple:"1F406",google:"1F406",twitter:"1F406"},shortcode:"leopard",description:"LEOPARD",category:"animal"},{name:"tiger2",unicode:{apple:"1F405",google:"1F405",twitter:"1F405"},shortcode:"tiger2",description:"TIGER",category:"animal"},{name:"water_buffalo",unicode:{apple:"1F403",google:"1F403",twitter:"1F403"},shortcode:"water_buffalo",description:"WATER BUFFALO",category:"animal"},{name:"ox",unicode:{apple:"1F402",google:"1F402",twitter:"1F402"},shortcode:"ox",description:"OX",category:"animal"},{name:"cow2",unicode:{apple:"1F404",google:"1F404",twitter:"1F404"},shortcode:"cow2",description:"COW",category:"animal"},{name:"dromedary_camel",unicode:{apple:"1F42A",google:"1F42A",twitter:"1F42A"},shortcode:"dromedary_camel",description:"DROMEDARY CAMEL",category:"animal"},{name:"camel",unicode:{apple:"1F42B",google:"1F42B",twitter:"1F42B"},shortcode:"camel",description:"BACTRIAN CAMEL",category:"animal"},{name:"elephant",unicode:{apple:"1F418",google:"1F418",twitter:"1F418"},shortcode:"elephant",description:"ELEPHANT",category:"animal"},{name:"goat",unicode:{apple:"1F410",google:"1F410",twitter:"1F410"},shortcode:"goat",description:"GOAT",category:"animal"},{name:"ram",unicode:{apple:"1F40F",google:"1F40F",twitter:"1F40F"},shortcode:"ram",description:"RAM",category:"animal"},{name:"sheep",unicode:{apple:"1F411",google:"1F411",twitter:"1F411"},shortcode:"sheep",description:"SHEEP",category:"animal"},{name:"racehorse",unicode:{apple:"1F40E",google:"1F40E",twitter:"1F40E"},shortcode:"racehorse",description:"HORSE",category:"animal"},{name:"pig2",unicode:{apple:"1F416",google:"1F416",twitter:"1F416"},shortcode:"pig2",description:"PIG",category:"animal"},{name:"rat",unicode:{apple:"1F400",google:"1F400",twitter:"1F400"},shortcode:"rat",description:"RAT",category:"animal"},{name:"mouse2",unicode:{apple:"1F401",google:"1F401",twitter:"1F401"},shortcode:"mouse2",description:"MOUSE",category:"animal"},{name:"rooster",unicode:{apple:"1F413",google:"1F413",twitter:"1F413"},shortcode:"rooster",description:"ROOSTER",category:"animal"},{name:"turkey",unicode:{apple:"1F983",google:"1F983",twitter:"1F983"},shortcode:"turkey",description:"Turkey",category:"animal"},{name:"dove_of_peace",unicode:{apple:"1F54A",google:"1F54A",twitter:"1F54A"},shortcode:"dove_of_peace",description:"Dove Of Peace",category:"animal"},{name:"dog2",unicode:{apple:"1F415",google:"1F415",twitter:"1F415"},shortcode:"dog2",description:"DOG",category:"animal"},{name:"poodle",unicode:{apple:"1F429",google:"1F429",twitter:"1F429"},shortcode:"poodle",description:"POODLE",category:"animal"},{name:"cat2",unicode:{apple:"1F408",google:"1F408",twitter:"1F408"},shortcode:"cat2",description:"CAT",category:"animal"},{name:"rabbit2",unicode:{apple:"1F407",google:"1F407",twitter:"1F407"},shortcode:"rabbit2",description:"RABBIT",category:"animal"},{name:"chipmunk",unicode:{apple:"1F43F",google:"1F43F",twitter:"1F43F"},shortcode:"chipmunk",description:"Chipmunk",category:"animal"},{name:"feet",unicode:{apple:"1F43E",google:"1F43E",twitter:"1F43E"},shortcode:"feet",description:"PAW PRINTS",category:"animal"},{name:"dragon",unicode:{apple:"1F409",google:"1F409",twitter:"1F409"},shortcode:"dragon",description:"DRAGON",category:"animal"},{name:"dragon_face",unicode:{apple:"1F432",google:"1F432",twitter:"1F432"},shortcode:"dragon_face",description:"DRAGON FACE",category:"animal"},{name:"cactus",unicode:{apple:"1F335",google:"1F335",twitter:"1F335"},shortcode:"cactus",description:"CACTUS",category:"animal"},{name:"christmas_tree",unicode:{apple:"1F384",google:"1F384",twitter:"1F384"},shortcode:"christmas_tree",description:"CHRISTMAS TREE",category:"nature"},{name:"evergreen_tree",unicode:{apple:"1F332",google:"1F332",twitter:"1F332"},shortcode:"evergreen_tree",description:"EVERGREEN TREE",category:"nature"},{name:"deciduous_tree",unicode:{apple:"1F333",google:"1F333",twitter:"1F333"},shortcode:"deciduous_tree",description:"DECIDUOUS TREE",category:"nature"},{name:"palm_tree",unicode:{apple:"1F334",google:"1F334",twitter:"1F334"},shortcode:"palm_tree",description:"PALM TREE",category:"nature"},{name:"seedling",unicode:{apple:"1F331",google:"1F331",twitter:"1F331"},shortcode:"seedling",description:"SEEDLING",category:"nature"},{name:"herb",unicode:{apple:"1F33F",google:"1F33F",twitter:"1F33F"},shortcode:"herb",description:"HERB",category:"nature"},{name:"shamrock",unicode:{apple:"2618",google:"2618",twitter:"2618"},shortcode:"shamrock",description:"Shamrock",category:"nature"},{name:"four_leaf_clover",unicode:{apple:"1F340",google:"1F340",twitter:"1F340"},shortcode:"four_leaf_clover",description:"FOUR LEAF CLOVER",category:"nature"},{name:"bamboo",unicode:{apple:"1F38D",google:"1F38D",twitter:"1F38D"},shortcode:"bamboo",description:"PINE DECORATION",category:"nature"},{name:"tanabata_tree",unicode:{apple:"1F38B",google:"1F38B",twitter:"1F38B"},shortcode:"tanabata_tree",description:"TANABATA TREE",category:"nature"},{name:"leaves",unicode:{apple:"1F343",google:"1F343",twitter:"1F343"},shortcode:"leaves",description:"LEAF FLUTTERING IN WIND",category:"nature"},{name:"fallen_leaf",unicode:{apple:"1F342",google:"1F342",twitter:"1F342"},shortcode:"fallen_leaf",description:"FALLEN LEAF",category:"nature"},{name:"maple_leaf",unicode:{apple:"1F341",google:"1F341",twitter:"1F341"},shortcode:"maple_leaf",description:"MAPLE LEAF",category:"nature"},{name:"ear_of_rice",unicode:{apple:"1F33E",google:"1F33E",twitter:"1F33E"},shortcode:"ear_of_rice",description:"EAR OF RICE",category:"nature"},{name:"hibiscus",unicode:{apple:"1F33A",google:"1F33A",twitter:"1F33A"},shortcode:"hibiscus",description:"HIBISCUS",category:"nature"},{name:"sunflower",unicode:{apple:"1F33B",google:"1F33B",twitter:"1F33B"},shortcode:"sunflower",description:"SUNFLOWER",category:"nature"},{name:"rose",unicode:{apple:"1F339",google:"1F339",twitter:"1F339"},shortcode:"rose",description:"ROSE",category:"nature"},{name:"tulip",unicode:{apple:"1F337",google:"1F337",twitter:"1F337"},shortcode:"tulip",description:"TULIP",category:"nature"},{name:"blossom",unicode:{apple:"1F33C",google:"1F33C",twitter:"1F33C"},shortcode:"blossom",description:"BLOSSOM",category:"nature"},{name:"cherry_blossom",unicode:{apple:"1F338",google:"1F338",twitter:"1F338"},shortcode:"cherry_blossom",description:"CHERRY BLOSSOM",category:"nature"},{name:"bouquet",unicode:{apple:"1F490",google:"1F490",twitter:"1F490"},shortcode:"bouquet",description:"BOUQUET",category:"nature"},{name:"mushroom",unicode:{apple:"1F344",google:"1F344",twitter:"1F344"},shortcode:"mushroom",description:"MUSHROOM",category:"nature"},{name:"chestnut",unicode:{apple:"1F330",google:"1F330",twitter:"1F330"},shortcode:"chestnut",description:"CHESTNUT",category:"nature"},{name:"jack_o_lantern",unicode:{apple:"1F383",google:"1F383",twitter:"1F383"},shortcode:"jack_o_lantern",description:"JACK-O-LANTERN",category:"nature"},{name:"shell",unicode:{apple:"1F41A",google:"1F41A",twitter:"1F41A"},shortcode:"shell",description:"SPIRAL SHELL",category:"nature"},{name:"spider_web",unicode:{apple:"1F578",google:"1F578",twitter:"1F578"},shortcode:"spider_web",description:"Spider Web",category:"nature"},{name:"earth_americas",unicode:{apple:"1F30E",google:"1F30E",twitter:"1F30E"},shortcode:"earth_americas",description:"EARTH GLOBE AMERICAS",category:"nature"},{name:"earth_africa",unicode:{apple:"1F30D",google:"1F30D",twitter:"1F30D"},shortcode:"earth_africa",description:"EARTH GLOBE EUROPE-AFRICA",category:"nature"},{name:"earth_asia",unicode:{apple:"1F30F",google:"1F30F",twitter:"1F30F"},shortcode:"earth_asia",description:"EARTH GLOBE ASIA-AUSTRALIA",category:"nature"},{name:"full_moon",unicode:{apple:"1F315",google:"1F315",twitter:"1F315"},shortcode:"full_moon",description:"FULL MOON SYMBOL",category:"nature"},{name:"waning_gibbous_moon",unicode:{apple:"1F316",google:"1F316",twitter:"1F316"},shortcode:"waning_gibbous_moon",description:"WANING GIBBOUS MOON SYMBOL",category:"nature"},{name:"last_quarter_moon",unicode:{apple:"1F317",google:"1F317",twitter:"1F317"},shortcode:"last_quarter_moon",description:"LAST QUARTER MOON SYMBOL",category:"nature"},{name:"waning_crescent_moon",unicode:{apple:"1F318",google:"1F318",twitter:"1F318"},shortcode:"waning_crescent_moon",description:"WANING CRESCENT MOON SYMBOL",category:"nature"},{name:"new_moon",unicode:{apple:"1F311",google:"1F311",twitter:"1F311"},shortcode:"new_moon",description:"NEW MOON SYMBOL",category:"nature"},{name:"waxing_crescent_moon",unicode:{apple:"1F312",google:"1F312",twitter:"1F312"},shortcode:"waxing_crescent_moon",description:"WAXING CRESCENT MOON SYMBOL",category:"nature"},{name:"first_quarter_moon",unicode:{apple:"1F313",google:"1F313",twitter:"1F313"},shortcode:"first_quarter_moon",description:"FIRST QUARTER MOON SYMBOL",category:"nature"},{name:"moon",unicode:{apple:"1F314",google:"1F314",twitter:"1F314"},shortcode:"moon",description:"WAXING GIBBOUS MOON SYMBOL",category:"nature"},{name:"new_moon_with_face",unicode:{apple:"1F31A",google:"1F31A",twitter:"1F31A"},shortcode:"new_moon_with_face",description:"NEW MOON WITH FACE",category:"nature"},{name:"first_quarter_moon_with_face",unicode:{apple:"1F31B",google:"1F31B",twitter:"1F31B"},shortcode:"first_quarter_moon_with_face",description:"FIRST QUARTER MOON WITH FACE",category:"nature"},{name:"last_quarter_moon_with_face",unicode:{apple:"1F31C",google:"1F31C",twitter:"1F31C"},shortcode:"last_quarter_moon_with_face",description:"LAST QUARTER MOON WITH FACE",category:"nature"},{name:"full_moon_with_face",unicode:{apple:"1F31D",google:"1F31D",twitter:"1F31D"},shortcode:"full_moon_with_face",description:"FULL MOON WITH FACE",category:"nature"},{name:"crescent_moon",unicode:{apple:"1F319",google:"1F319",twitter:"1F319"},shortcode:"crescent_moon",description:"CRESCENT MOON",category:"nature"},{name:"sun_with_face",unicode:{apple:"1F31E",google:"1F31E",twitter:"1F31E"},shortcode:"sun_with_face",description:"SUN WITH FACE",category:"nature"},{name:"star",unicode:{apple:"2B50",google:"2B50",twitter:"2B50"},shortcode:"star",description:"WHITE MEDIUM STAR",category:"nature"},{name:"star2",unicode:{apple:"1F31F",google:"1F31F",twitter:"1F31F"},shortcode:"star2",description:"GLOWING STAR",category:"nature"},{name:"dizzy",unicode:{apple:"1F4AB",google:"1F4AB",twitter:"1F4AB"},shortcode:"dizzy",description:"DIZZY SYMBOL",category:"nature"},{name:"sparkles",unicode:{apple:"2728",google:"2728",twitter:"2728"},shortcode:"sparkles",description:"SPARKLES",category:"nature"},{name:"comet",unicode:{apple:"2604",google:"2604",twitter:"2604"},shortcode:"comet",description:"Comet",category:"nature"},{name:"sunny",unicode:{apple:"2600",google:"2600",twitter:"2600"},shortcode:"sunny",description:"BLACK SUN WITH RAYS",category:"nature"},{name:"mostly_sunny",unicode:{apple:"1F324",google:"1F324",twitter:"1F324"},shortcode:"mostly_sunny",description:"White Sun With Small Cloud",category:"nature"},{name:"partly_sunny",unicode:{apple:"26C5",google:"26C5",twitter:"26C5"},shortcode:"partly_sunny",description:"SUN BEHIND CLOUD",category:"nature"},{name:"barely_sunny",unicode:{apple:"1F325",google:"1F325",twitter:"1F325"},shortcode:"barely_sunny",description:"White Sun Behind Cloud",category:"nature"},{name:"partly_sunny_rain",unicode:{apple:"1F326",google:"1F326",twitter:"1F326"},shortcode:"partly_sunny_rain",description:"White Sun Behind Cloud With Rain",category:"nature"},{name:"cloud",unicode:{apple:"2601",google:"2601",twitter:"2601"},shortcode:"cloud",description:"CLOUD",category:"nature"},{name:"rain_cloud",unicode:{apple:"1F327",google:"1F327",twitter:"1F327"},shortcode:"rain_cloud",description:"Cloud With Rain",category:"nature"},{name:"thunder_cloud_and_rain",unicode:{apple:"26C8",google:"26C8",twitter:"26C8"},shortcode:"thunder_cloud_and_rain",description:"Thunder Cloud and Rain",category:"nature"},{name:"lightning",unicode:{apple:"1F329",google:"1F329",twitter:"1F329"},shortcode:"lightning",description:"Cloud With Lightning",category:"nature"},{name:"zap",unicode:{apple:"26A1",google:"26A1",twitter:"26A1"},shortcode:"zap",description:"HIGH VOLTAGE SIGN",category:"nature"},{name:"fire",unicode:{apple:"1F525",google:"1F525",twitter:"1F525"},shortcode:"fire",description:"FIRE",category:"nature"},{name:"boom",unicode:{apple:"1F4A5",google:"1F4A5",twitter:"1F4A5"},shortcode:"boom",description:"COLLISION SYMBOL",category:"nature"},{name:"snowflake",unicode:{apple:"2744",google:"2744",twitter:"2744"},shortcode:"snowflake",description:"SNOWFLAKE",category:"nature"},{name:"snow_cloud",unicode:{apple:"1F328",google:"1F328",twitter:"1F328"},shortcode:"snow_cloud",description:"Cloud With Snow",category:"nature"},{name:"snowman",unicode:{apple:"26C4",google:"26C4",twitter:"26C4"},shortcode:"snowman",description:"SNOWMAN WITHOUT SNOW",category:"nature"},{name:"wind_blowing_face",unicode:{apple:"1F32C",google:"1F32C",twitter:"1F32C"},shortcode:"wind_blowing_face",description:"Wind Blowing Face",category:"nature"},{name:"dash",unicode:{apple:"1F4A8",google:"1F4A8",twitter:"1F4A8"},shortcode:"dash",description:"DASH SYMBOL",category:"nature"},{name:"tornado",unicode:{apple:"1F32A",google:"1F32A",twitter:"1F32A"},shortcode:"tornado",description:"Cloud With Tornado",category:"nature"},{name:"fog",unicode:{apple:"1F32B",google:"1F32B",twitter:"1F32B"},shortcode:"fog",description:"Fog",category:"nature"},{name:"umbrella",unicode:{apple:"2614",google:"2614",twitter:"2614"},shortcode:"umbrella",description:"UMBRELLA WITH RAIN DROPS",category:"nature"},{name:"droplet",unicode:{apple:"1F4A7",google:"1F4A7",twitter:"1F4A7"},shortcode:"droplet",description:"DROPLET",category:"nature"},{name:"sweat_drops",unicode:{apple:"1F4A6",google:"1F4A6",twitter:"1F4A6"},shortcode:"sweat_drops",description:"SPLASHING SWEAT SYMBOL",category:"nature"},{name:"ocean",unicode:{apple:"1F30A",google:"1F30A",twitter:"1F30A"},shortcode:"ocean",description:"WATER WAVE",category:"nature"},{name:"green_apple",unicode:{apple:"1F34F",google:"1F34F",twitter:"1F34F"},shortcode:"green_apple",description:"GREEN APPLE",category:"food"},{name:"apple",unicode:{apple:"1F34E",google:"1F34E",twitter:"1F34E"},shortcode:"apple",description:"RED APPLE",category:"food"},{name:"pear",unicode:{apple:"1F350",google:"1F350",twitter:"1F350"},shortcode:"pear",description:"PEAR",category:"food"},{name:"tangerine",unicode:{apple:"1F34A",google:"1F34A",twitter:"1F34A"},shortcode:"tangerine",description:"TANGERINE",category:"food"},{name:"lemon",unicode:{apple:"1F34B",google:"1F34B",twitter:"1F34B"},shortcode:"lemon",description:"LEMON",category:"food"},{name:"banana",unicode:{apple:"1F34C",google:"1F34C",twitter:"1F34C"},shortcode:"banana",description:"BANANA",category:"food"},{name:"watermelon",unicode:{apple:"1F349",google:"1F349",twitter:"1F349"},shortcode:"watermelon",description:"WATERMELON",category:"food"},{name:"grapes",unicode:{apple:"1F347",google:"1F347",twitter:"1F347"},shortcode:"grapes",description:"GRAPES",category:"food"},{name:"strawberry",unicode:{apple:"1F353",google:"1F353",twitter:"1F353"},shortcode:"strawberry",description:"STRAWBERRY",category:"food"},{name:"melon",unicode:{apple:"1F348",google:"1F348",twitter:"1F348"},shortcode:"melon",description:"MELON",category:"food"},{name:"cherries",unicode:{apple:"1F352",google:"1F352",twitter:"1F352"},shortcode:"cherries",description:"CHERRIES",category:"food"},{name:"peach",unicode:{apple:"1F351",google:"1F351",twitter:"1F351"},shortcode:"peach",description:"PEACH",category:"food"},{name:"pineapple",unicode:{apple:"1F34D",google:"1F34D",twitter:"1F34D"},shortcode:"pineapple",description:"PINEAPPLE",category:"food"},{name:"tomato",unicode:{apple:"1F345",google:"1F345",twitter:"1F345"},shortcode:"tomato",description:"TOMATO",category:"food"},{name:"eggplant",unicode:{apple:"1F346",google:"1F346",twitter:"1F346"},shortcode:"eggplant",description:"AUBERGINE",category:"food"},{name:"hot_pepper",unicode:{apple:"1F336",google:"1F336",twitter:"1F336"},shortcode:"hot_pepper",description:"Hot Pepper",category:"food"},{name:"corn",unicode:{apple:"1F33D",google:"1F33D",twitter:"1F33D"},shortcode:"corn",description:"EAR OF MAIZE",category:"thing"},{name:"sweet_potato",unicode:{apple:"1F360",google:"1F360",twitter:"1F360"},shortcode:"sweet_potato",description:"ROASTED SWEET POTATO",category:"food"},{name:"honey_pot",unicode:{apple:"1F36F",google:"1F36F",twitter:"1F36F"},shortcode:"honey_pot",description:"HONEY POT",category:"food"},{name:"bread",unicode:{apple:"1F35E",google:"1F35E",twitter:"1F35E"},shortcode:"bread",description:"BREAD",category:"food"},{name:"cheese_wedge",unicode:{apple:"1F9C0",google:"1F9C0",twitter:"1F9C0"},shortcode:"cheese_wedge",description:"Cheese Wedge",category:"food"},{name:"poultry_leg",unicode:{apple:"1F357",google:"1F357",twitter:"1F357"},shortcode:"poultry_leg",description:"POULTRY LEG",category:"food"},{name:"meat_on_bone",unicode:{apple:"1F356",google:"1F356",twitter:"1F356"},shortcode:"meat_on_bone",description:"MEAT ON BONE",category:"food"},{name:"fried_shrimp",unicode:{apple:"1F364",google:"1F364",twitter:"1F364"},shortcode:"fried_shrimp",description:"FRIED SHRIMP",category:"food"},{name:"egg",unicode:{apple:"1F373",google:"1F373",twitter:"1F373"},shortcode:"egg",description:"COOKING",category:"food"},{name:"hamburger",unicode:{apple:"1F354",google:"1F354",twitter:"1F354"},shortcode:"hamburger",description:"HAMBURGER",category:"food"},{name:"fries",unicode:{apple:"1F35F",google:"1F35F",twitter:"1F35F"},shortcode:"fries",description:"FRENCH FRIES",category:"food"},{name:"hotdog",unicode:{apple:"1F32D",google:"1F32D",twitter:"1F32D"},shortcode:"hotdog",description:"Hot Dog",category:"food"},{name:"pizza",unicode:{apple:"1F355",google:"1F355",twitter:"1F355"},shortcode:"pizza",description:"SLICE OF PIZZA",category:"food"},{name:"spaghetti",unicode:{apple:"1F35D",google:"1F35D",twitter:"1F35D"},shortcode:"spaghetti",description:"SPAGHETTI",category:"food"},{name:"taco",unicode:{apple:"1F32E",google:"1F32E",twitter:"1F32E"},shortcode:"taco",description:"Taco",category:"food"},{name:"burrito",unicode:{apple:"1F32F",google:"1F32F",twitter:"1F32F"},shortcode:"burrito",description:"Burrito",category:"food"},{name:"ramen",unicode:{apple:"1F35C",google:"1F35C",twitter:"1F35C"},shortcode:"ramen",description:"STEAMING BOWL",category:"food"},{name:"stew",unicode:{apple:"1F372",google:"1F372",twitter:"1F372"},shortcode:"stew",description:"POT OF FOOD",category:"food"},{name:"fish_cake",unicode:{apple:"1F365",google:"1F365",twitter:"1F365"},shortcode:"fish_cake",description:"FISH CAKE WITH SWIRL DESIGN",category:"food"},{name:"sushi",unicode:{apple:"1F363",google:"1F363",twitter:"1F363"},shortcode:"sushi",description:"SUSHI",category:"food"},{name:"bento",unicode:{apple:"1F371",google:"1F371",twitter:"1F371"},shortcode:"bento",description:"BENTO BOX",category:"food"},{name:"curry",unicode:{apple:"1F35B",google:"1F35B",twitter:"1F35B"},shortcode:"curry",description:"CURRY AND RICE",category:"food"},{name:"rice_ball",unicode:{apple:"1F359",google:"1F359",twitter:"1F359"},shortcode:"rice_ball",description:"RICE BALL",category:"food"},{name:"rice",unicode:{apple:"1F35A",google:"1F35A",twitter:"1F35A"},shortcode:"rice",description:"COOKED RICE",category:"food"},{name:"rice_cracker",unicode:{apple:"1F358",google:"1F358",twitter:"1F358"},shortcode:"rice_cracker",description:"RICE CRACKER",category:"food"},{name:"oden",unicode:{apple:"1F362",google:"1F362",twitter:"1F362"},shortcode:"oden",description:"ODEN",category:"food"},{name:"dango",unicode:{apple:"1F361",google:"1F361",twitter:"1F361"},shortcode:"dango",description:"DANGO",category:"food"},{name:"shaved_ice",unicode:{apple:"1F367",google:"1F367",twitter:"1F367"},shortcode:"shaved_ice",description:"SHAVED ICE",category:"food"},{name:"ice_cream",unicode:{apple:"1F368",google:"1F368",twitter:"1F368"},shortcode:"ice_cream",description:"ICE CREAM",category:"food"},{name:"icecream",unicode:{apple:"1F366",google:"1F366",twitter:"1F366"},shortcode:"icecream",description:"SOFT ICE CREAM",category:"food"},{name:"cake",unicode:{apple:"1F370",google:"1F370",twitter:"1F370"},shortcode:"cake",description:"SHORTCAKE",category:"food"},{name:"birthday",unicode:{apple:"1F382",google:"1F382",twitter:"1F382"},shortcode:"birthday",description:"BIRTHDAY CAKE",category:"food"},{name:"custard",unicode:{apple:"1F36E",google:"1F36E",twitter:"1F36E"},shortcode:"custard",description:"CUSTARD",category:"food"},{name:"candy",unicode:{apple:"1F36C",google:"1F36C",twitter:"1F36C"},shortcode:"candy",description:"CANDY",category:"food"},{name:"lollipop",unicode:{apple:"1F36D",google:"1F36D",twitter:"1F36D"},shortcode:"lollipop",description:"LOLLIPOP",category:"food"},{name:"chocolate_bar",unicode:{apple:"1F36B",google:"1F36B",twitter:"1F36B"},shortcode:"chocolate_bar",description:"CHOCOLATE BAR",category:"food"},{name:"popcorn",unicode:{apple:"1F37F",google:"1F37F",twitter:"1F37F"},shortcode:"popcorn",description:"Popcorn",category:"food"},{name:"cookie",unicode:{apple:"1F36A",google:"1F36A",twitter:"1F36A"},shortcode:"cookie",description:"COOKIE",category:"food"},{name:"doughnut",unicode:{apple:"1F369",google:"1F369",twitter:"1F369"},shortcode:"doughnut",description:"DOUGHNUT",category:"food"},{name:"beer",unicode:{apple:"1F37A",google:"1F37A",twitter:"1F37A"},shortcode:"beer",description:"BEER MUG",category:"food"},{name:"beers",unicode:{apple:"1F37B",google:"1F37B",twitter:"1F37B"},shortcode:"beers",description:"CLINKING BEER MUGS",category:"food"},{name:"wine_glass",unicode:{apple:"1F377",google:"1F377",twitter:"1F377"},shortcode:"wine_glass",description:"WINE GLASS",category:"food"},{name:"cocktail",unicode:{apple:"1F378",google:"1F378",twitter:"1F378"},shortcode:"cocktail",description:"COCKTAIL GLASS",category:"food"},{name:"champagne",unicode:{apple:"1F379",google:"1F379",twitter:"1F379"},shortcode:"tropical_drink",description:"TROPICAL DRINK",category:"food"},{name:"champagne",unicode:{apple:"1F37E",google:"1F37E",twitter:"1F37E"},shortcode:"champagne",description:"Bottle With Popping Cork",category:"food"},{name:"sake",unicode:{apple:"1F376",google:"1F376",twitter:"1F376"},shortcode:"sake",description:"SAKE BOTTLE AND CUP",category:"food"},{name:"tea",unicode:{apple:"1F375",google:"1F375",twitter:"1F375"},shortcode:"tea",description:"TEACUP WITHOUT HANDLE",category:"food"},{name:"coffee",unicode:{apple:"2615",google:"2615",twitter:"2615"},shortcode:"coffee",description:"HOT BEVERAGE",category:"food"},{name:"baby_bottle",unicode:{apple:"1F37C",google:"1F37C",twitter:"1F37C"},shortcode:"baby_bottle",description:"BABY BOTTLE",category:"food"},{name:"fork_and_knife",unicode:{apple:"1F374",google:"1F374",twitter:"1F374"},shortcode:"fork_and_knife",description:"FORK AND KNIFE",category:"food"},{name:"knife_fork_plate",unicode:{apple:"1F37D",google:"1F37D",twitter:"1F37D"},shortcode:"knife_fork_plate",description:"Fork and Knife With Plate",category:"food"},{name:"soccer",unicode:{apple:"26BD",google:"26BD",twitter:"26BD"},shortcode:"soccer",description:"SOCCER BALL",category:"activity"},{name:"basketball",unicode:{apple:"1F3C0",google:"1F3C0",twitter:"1F3C0"},shortcode:"basketball",description:"BASKETBALL AND HOOP",category:"activity"},{name:"football",unicode:{apple:"1F3C8",google:"1F3C8",twitter:"1F3C8"},shortcode:"football",description:"AMERICAN FOOTBALL",category:"activity"},{name:"baseball",unicode:{apple:"26BE",google:"26BE",twitter:"26BE"},shortcode:"baseball",description:"BASEBALL",category:"activity"},{name:"tennis",unicode:{apple:"1F3BE",google:"1F3BE",twitter:"1F3BE"},shortcode:"tennis",description:"TENNIS RACQUET AND BALL",category:"activity"},{name:"volleyball",unicode:{apple:"1F3D0",google:"1F3D0",twitter:"1F3D0"},shortcode:"volleyball",description:"Volleyball",category:"activity"},{name:"rugby_football",unicode:{apple:"1F3C9",google:"1F3C9",twitter:"1F3C9"},shortcode:"rugby_football",description:"RUGBY FOOTBALL",category:"activity"},{name:"8ball",unicode:{apple:"1F3B1",google:"1F3B1",twitter:"1F3B1"},shortcode:"8ball",description:"BILLIARDS",category:"activity"},{name:"golf",unicode:{apple:"26F3",google:"26F3",twitter:"26F3"},shortcode:"golf",description:"FLAG IN HOLE",category:"activity"},{name:"golfer",unicode:{apple:"1F3CC",google:"1F3CC",twitter:"1F3CC"},shortcode:"golfer",description:"Golfer",category:"activity"},{name:"table_tennis_paddle_and_ball",unicode:{apple:"1F3D3",google:"1F3D3",twitter:"1F3D3"},shortcode:"table_tennis_paddle_and_ball",description:"Table Tennis Paddle and Ball",category:"activity"},{name:"badminton_racquet_and_shuttlecock",unicode:{apple:"1F3F8",google:"1F3F8",twitter:"1F3F8"},shortcode:"badminton_racquet_and_shuttlecock",description:"Badminton Racquet and Shuttlecock",category:"activity"},{name:"ice_hockey_stick_and_puck",unicode:{apple:"1F3D2",google:"1F3D2",twitter:"1F3D2"},shortcode:"ice_hockey_stick_and_puck",description:"Ice Hockey Stick and Puck",category:"activity"},{name:"field_hockey_stick_and_ball",unicode:{apple:"1F3D1",google:"1F3D1",twitter:"1F3D1"},shortcode:"field_hockey_stick_and_ball",description:"Field Hockey Stick and Ball",category:"activity"},{name:"cricket_bat_and_ball",unicode:{apple:"1F3CF",google:"1F3CF",twitter:"1F3CF"},shortcode:"cricket_bat_and_ball",description:"Cricket Bat and Ball",category:"activity"},{name:"ski",unicode:{apple:"1F3BF",google:"1F3BF",twitter:"1F3BF"},shortcode:"ski",description:"SKI AND SKI BOOT",category:"activity"},{name:"skier",unicode:{apple:"26F7",google:"26F7",twitter:"26F7"},shortcode:"skier",description:"Skier",category:"activity"},{name:"snowboarder",unicode:{apple:"1F3C2",google:"1F3C2",twitter:"1F3C2"},shortcode:"snowboarder",description:"SNOWBOARDER",category:"activity"},{name:"ice_skate",unicode:{apple:"26F8",google:"26F8",twitter:"26F8"},shortcode:"ice_skate",description:"Ice Skate",category:"activity"},{name:"bow_and_arrow",unicode:{apple:"1F3F9",google:"1F3F9",twitter:"1F3F9"},shortcode:"bow_and_arrow",description:"Bow and Arrow",category:"activity"},{name:"fishing_pole_and_fish",unicode:{apple:"1F3A3",google:"1F3A3",twitter:"1F3A3"},shortcode:"fishing_pole_and_fish",description:"FISHING POLE AND FISH",category:"activity"},{name:"rowboat",unicode:{apple:"1F6A3",google:"1F6A3",twitter:"1F6A3"},shortcode:"rowboat",description:"ROWBOAT",category:"activity"},{name:"swimmer",unicode:{apple:"1F3CA",google:"1F3CA",twitter:"1F3CA"},shortcode:"swimmer",description:"SWIMMER",category:"activity"},{name:"surfer",unicode:{apple:"1F3C4",google:"1F3C4",twitter:"1F3C4"},shortcode:"surfer",description:"SURFER",category:"activity"},{name:"bath",unicode:{apple:"1F6C0",google:"1F6C0",twitter:"1F6C0"},shortcode:"bath",description:"BATH",category:"activity"},{name:"person_with_ball",unicode:{apple:"26F9",google:"26F9",twitter:"26F9"},shortcode:"person_with_ball",description:"Person With Ball",category:"activity"},{name:"weight_lifter",unicode:{apple:"1F3CB",google:"1F3CB",twitter:"1F3CB"},shortcode:"weight_lifter",description:"Weight Lifter",category:"activity"},{name:"bicyclist",unicode:{apple:"1F6B4",google:"1F6B4",twitter:"1F6B4"},shortcode:"bicyclist",description:"BICYCLIST",category:"activity"},{name:"mountain_bicyclist",unicode:{apple:"1F6B5",google:"1F6B5",twitter:"1F6B5"},shortcode:"mountain_bicyclist",description:"MOUNTAIN BICYCLIST",category:"activity"},{name:"horse_racing",unicode:{apple:"1F3C7",google:"1F3C7",twitter:"1F3C7"},shortcode:"horse_racing",description:"HORSE RACING",category:"activity"},{name:"man_in_business_suit_levitating",unicode:{apple:"1F574",google:"1F574",twitter:"1F574"},shortcode:"man_in_business_suit_levitating",description:"Man in Business Suit Levitating",category:"activity"},{name:"trophy",unicode:{apple:"1F3C6",google:"1F3C6",twitter:"1F3C6"},shortcode:"trophy",description:"TROPHY",category:"activity"},{name:"running_shirt_with_sash",unicode:{apple:"1F3BD",google:"1F3BD",twitter:"1F3BD"},shortcode:"running_shirt_with_sash",description:"RUNNING SHIRT WITH SASH",category:"activity"},{name:"sports_medal",unicode:{apple:"1F3C5",google:"1F3C5",twitter:"1F3C5"},shortcode:"sports_medal",description:"Sports Medal",category:"activity"},{name:"medal",unicode:{apple:"1F396",google:"1F396",twitter:"1F396"},shortcode:"medal",description:"Military Medal",category:"activity"},{name:"reminder_ribbon",unicode:{apple:"1F397",google:"1F397",twitter:"1F397"},shortcode:"reminder_ribbon",description:"Reminder Ribbon",category:"activity"},{name:"rosette",unicode:{apple:"1F3F5",google:"1F3F5",twitter:"1F3F5"},shortcode:"rosette",description:"Rosette",category:"activity"},{name:"ticket",unicode:{apple:"1F3AB",google:"1F3AB",twitter:"1F3AB"},shortcode:"ticket",description:"TICKET",category:"activity"},{name:"admission_tickets",unicode:{apple:"1F39F",google:"1F39F",twitter:"1F39F"},shortcode:"admission_tickets",description:"Admission Tickets",category:"activity"},{name:"performing_arts",unicode:{apple:"1F3AD",google:"1F3AD",twitter:"1F3AD"},shortcode:"performing_arts",description:"PERFORMING ARTS",category:"activity"},{name:"art",unicode:{apple:"1F3A8",google:"1F3A8",twitter:"1F3A8"},shortcode:"art",description:"ARTIST PALETTE",category:"activity"},{name:"circus_tent",unicode:{apple:"1F3AA",google:"1F3AA",twitter:"1F3AA"},shortcode:"circus_tent",description:"CIRCUS TENT",category:"activity"},{name:"microphone",unicode:{apple:"1F3A4",google:"1F3A4",twitter:"1F3A4"},shortcode:"microphone",description:"MICROPHONE",category:"activity"},{name:"headphones",unicode:{apple:"1F3A7",google:"1F3A7",twitter:"1F3A7"},shortcode:"headphones",description:"HEADPHONE",category:"activity"},{name:"musical_score",unicode:{apple:"1F3BC",google:"1F3BC",twitter:"1F3BC"},shortcode:"musical_score",description:"MUSICAL SCORE",category:"activity"},{name:"musical_keyboard",unicode:{apple:"1F3B9",google:"1F3B9",twitter:"1F3B9"},shortcode:"musical_keyboard",description:"MUSICAL KEYBOARD",category:"activity"},{name:"saxophone",unicode:{apple:"1F3B7",google:"1F3B7",twitter:"1F3B7"},shortcode:"saxophone",description:"SAXOPHONE",category:"activity"},{name:"trumpet",unicode:{apple:"1F3BA",google:"1F3BA",twitter:"1F3BA"},shortcode:"trumpet",description:"TRUMPET",category:"activity"},{name:"guitar",unicode:{apple:"1F3B8",google:"1F3B8",twitter:"1F3B8"},shortcode:"guitar",description:"GUITAR",category:"activity"},{name:"violin",unicode:{apple:"1F3BB",google:"1F3BB",twitter:"1F3BB"},shortcode:"violin",description:"VIOLIN",category:"activity"},{name:"clapper",unicode:{apple:"1F3AC",google:"1F3AC",twitter:"1F3AC"},shortcode:"clapper",description:"CLAPPER BOARD",category:"activity"},{name:"video_game",unicode:{apple:"1F3AE",google:"1F3AE",twitter:"1F3AE"},shortcode:"video_game",description:"VIDEO GAME",category:"activity"},{name:"space_invader",unicode:{apple:"1F47E",google:"1F47E",twitter:"1F47E"},shortcode:"space_invader",description:"ALIEN MONSTER",category:"activity"},{name:"dart",unicode:{apple:"1F3AF",google:"1F3AF",twitter:"1F3AF"},shortcode:"dart",description:"DIRECT HIT",category:"activity"},{name:"game_die",unicode:{apple:"1F3B2",google:"1F3B2",twitter:"1F3B2"},shortcode:"game_die",description:"GAME DIE",category:"activity"},{name:"slot_machine",unicode:{apple:"1F3B0",google:"1F3B0",twitter:"1F3B0"},shortcode:"slot_machine",description:"SLOT MACHINE",category:"activity"},{name:"bowling",unicode:{apple:"1F3B3",google:"1F3B3",twitter:"1F3B3"},shortcode:"bowling",description:"BOWLING",category:"activity"},{name:"car",unicode:{apple:"1F697",google:"1F697",twitter:"1F697"},shortcode:"car",description:"AUTOMOBILE",category:"travel"},{name:"taxi",unicode:{apple:"1F695",google:"1F695",twitter:"1F695"},shortcode:"taxi",description:"TAXI",category:"travel"},{name:"blue_car",unicode:{apple:"1F699",google:"1F699",twitter:"1F699"},shortcode:"blue_car",description:"RECREATIONAL VEHICLE",category:"travel"},{name:"bus",unicode:{apple:"1F68C",google:"1F68C",twitter:"1F68C"},shortcode:"bus",description:"BUS",category:"travel"},{name:"trolleybus",unicode:{apple:"1F68E",google:"1F68E",twitter:"1F68E"},shortcode:"trolleybus",description:"TROLLEYBUS",category:"travel"},{name:"racing_car",unicode:{apple:"1F3CE",google:"1F3CE",twitter:"1F3CE"},shortcode:"racing_car",description:"Racing Car",category:"travel"},{name:"police_car",unicode:{apple:"1F693",google:"1F693",twitter:"1F693"},shortcode:"police_car",description:"POLICE CAR",category:"travel"},{name:"ambulance",unicode:{apple:"1F691",google:"1F691",twitter:"1F691"},shortcode:"ambulance",description:"AMBULANCE",category:"travel"},{name:"fire_engine",unicode:{apple:"1F692",google:"1F692",twitter:"1F692"},shortcode:"fire_engine",description:"FIRE ENGINE",category:"travel"},{name:"minibus",unicode:{apple:"1F690",google:"1F690",twitter:"1F690"},shortcode:"minibus",description:"MINIBUS",category:"travel"},{name:"truck",unicode:{apple:"1F69A",google:"1F69A",twitter:"1F69A"},shortcode:"truck",description:"DELIVERY TRUCK",category:"travel"},{name:"articulated_lorry",unicode:{apple:"1F69B",google:"1F69B",twitter:"1F69B"},shortcode:"articulated_lorry",description:"ARTICULATED LORRY",category:"travel"},{name:"tractor",unicode:{apple:"1F69C",google:"1F69C",twitter:"1F69C"},shortcode:"tractor",description:"TRACTOR",category:"travel"},{name:"racing_motorcycle",unicode:{apple:"1F3CD",google:"1F3CD",twitter:"1F3CD"},shortcode:"racing_motorcycle",description:"Racing Motorcycle",category:"travel"},{name:"bike",unicode:{apple:"1F6B2",google:"1F6B2",twitter:"1F6B2"},shortcode:"bike",description:"BICYCLE",category:"travel"},{name:"rotating_light",unicode:{apple:"1F6A8",google:"1F6A8",twitter:"1F6A8"},shortcode:"rotating_light",description:"POLICE CARS REVOLVING LIGHT",category:"travel"},{name:"oncoming_police_car",unicode:{apple:"1F694",google:"1F694",twitter:"1F694"},shortcode:"oncoming_police_car",description:"ONCOMING POLICE CAR",category:"travel"},{name:"oncoming_bus",unicode:{apple:"1F68D",google:"1F68D",twitter:"1F68D"},shortcode:"oncoming_bus",description:"ONCOMING BUS",category:"travel"},{name:"oncoming_automobile",unicode:{apple:"1F698",google:"1F698",twitter:"1F698"},shortcode:"oncoming_automobile",description:"ONCOMING AUTOMOBILE",category:"travel"},{name:"oncoming_taxi",unicode:{apple:"1F696",google:"1F696",twitter:"1F696"},shortcode:"oncoming_taxi",description:"ONCOMING TAXI",category:"travel"},{name:"aerial_tramway",unicode:{apple:"1F6A1",google:"1F6A1",twitter:"1F6A1"},shortcode:"aerial_tramway",description:"AERIAL TRAMWAY",category:"travel"},{name:"mountain_cableway",unicode:{apple:"1F6A0",google:"1F6A0",twitter:"1F6A0"},shortcode:"mountain_cableway",description:"MOUNTAIN CABLEWAY",category:"travel"},{name:"suspension_railway",unicode:{apple:"1F69F",google:"1F69F",twitter:"1F69F"},shortcode:"suspension_railway",description:"SUSPENSION RAILWAY",category:"travel"},{name:"railway_car",unicode:{apple:"1F683",google:"1F683",twitter:"1F683"},shortcode:"railway_car",description:"RAILWAY CAR",category:"travel"},{name:"train",unicode:{apple:"1F68B",google:"1F68B",twitter:"1F68B"},shortcode:"train",description:"TRAM CAR",category:"travel"},{name:"monorail",unicode:{apple:"1F69D",google:"1F69D",twitter:"1F69D"},shortcode:"monorail",description:"MONORAIL",category:"travel"},{name:"bullettrain_side",unicode:{apple:"1F684",google:"1F684",twitter:"1F684"},shortcode:"bullettrain_side",description:"HIGH-SPEED TRAIN",category:"travel"},{name:"bullettrain_front",unicode:{apple:"1F685",google:"1F685",twitter:"1F685"},shortcode:"bullettrain_front",description:"HIGH-SPEED TRAIN WITH BULLET NOSE",category:"travel"},{name:"light_rail",unicode:{apple:"1F688",google:"1F688",twitter:"1F688"},shortcode:"light_rail",description:"LIGHT RAIL",category:"travel"},{name:"mountain_railway",unicode:{apple:"1F69E",google:"1F69E",twitter:"1F69E"},shortcode:"mountain_railway",description:"MOUNTAIN RAILWAY",category:"travel"},{name:"steam_locomotive",unicode:{apple:"1F682",google:"1F682",twitter:"1F682"},shortcode:"steam_locomotive",description:"STEAM LOCOMOTIVE",category:"travel"},{name:"train2",unicode:{apple:"1F686",google:"1F686",twitter:"1F686"},shortcode:"train2",description:"TRAIN",category:"travel"},{name:"metro",unicode:{apple:"1F687",google:"1F687",twitter:"1F687"},shortcode:"metro",description:"METRO",category:"travel"},{name:"tram",unicode:{apple:"1F68A",google:"1F68A",twitter:"1F68A"},shortcode:"tram",description:"TRAM",category:"travel"},{name:"station",unicode:{apple:"1F689",google:"1F689",twitter:"1F689"},shortcode:"station",description:"STATION",category:"travel"},{name:"helicopter",unicode:{apple:"1F681",google:"1F681",twitter:"1F681"},shortcode:"helicopter",description:"HELICOPTER",category:"travel"},{name:"small_airplane",unicode:{apple:"1F6E9",google:"1F6E9",twitter:"1F6E9"},shortcode:"small_airplane",description:"Small Airplane",category:"travel"},{name:"airplane",unicode:{apple:"2708",google:"2708",twitter:"2708"},shortcode:"airplane",description:"AIRPLANE",category:"travel"},{name:"airplane_departure",unicode:{apple:"1F6EB",google:"1F6EB",twitter:"1F6EB"},shortcode:"airplane_departure",description:"Airplane Departure",category:"travel"},{name:"airplane_arriving",unicode:{apple:"1F6EC",google:"1F6EC",twitter:"1F6EC"},shortcode:"airplane_arriving",description:"Airplane Arriving",category:"travel"},{name:"boat",unicode:{apple:"26F5",google:"26F5",twitter:"26F5"},shortcode:"boat",description:"SAILBOAT",category:"travel"},{name:"motor_boat",unicode:{apple:"1F6E5",google:"1F6E5",twitter:"1F6E5"},shortcode:"motor_boat",description:"Motor Boat",category:"travel"},{name:"speedboat",unicode:{apple:"1F6A4",google:"1F6A4",twitter:"1F6A4"},shortcode:"speedboat",description:"SPEEDBOAT",category:"travel"},{name:"ferry",unicode:{apple:"26F4",google:"26F4",twitter:"26F4"},shortcode:"ferry",description:"Ferry",category:"travel"},{name:"passenger_ship",unicode:{apple:"1F6F3",google:"1F6F3",twitter:"1F6F3"},shortcode:"passenger_ship",description:"Passenger Ship",category:"travel"},{name:"rocket",unicode:{apple:"1F680",google:"1F680",twitter:"1F680"},shortcode:"rocket",description:"ROCKET",category:"travel"},{name:"satellite",unicode:{apple:"1F4E1",google:"1F4E1",twitter:"1F4E1"},shortcode:"satellite",description:"SATELLITE ANTENNA",category:"travel"},{name:"seat",unicode:{apple:"1F4BA",google:"1F4BA",twitter:"1F4BA"},shortcode:"seat",description:"SEAT",category:"travel"},{name:"anchor",unicode:{apple:"2693",google:"2693",twitter:"2693"},shortcode:"anchor",description:"ANCHOR",category:"travel"},{name:"construction",unicode:{apple:"1F6A7",google:"1F6A7",twitter:"1F6A7"},shortcode:"construction",description:"CONSTRUCTION SIGN",category:"travel"},{name:"fuelpump",unicode:{apple:"26FD",google:"26FD",twitter:"26FD"},shortcode:"fuelpump",description:"FUEL PUMP",category:"travel"},{name:"busstop",unicode:{apple:"1F68F",google:"1F68F",twitter:"1F68F"},shortcode:"busstop",description:"BUS STOP",category:"travel"},{name:"vertical_traffic_light",unicode:{apple:"1F6A6",google:"1F6A6",twitter:"1F6A6"},shortcode:"vertical_traffic_light",description:"VERTICAL TRAFFIC LIGHT",category:"travel"},{name:"traffic_light",unicode:{apple:"1F6A5",google:"1F6A5",twitter:"1F6A5"},shortcode:"traffic_light",description:"HORIZONTAL TRAFFIC LIGHT",category:"travel"},{name:"checkered_flag",unicode:{apple:"1F3C1",google:"1F3C1",twitter:"1F3C1"},shortcode:"checkered_flag",description:"CHEQUERED FLAG",category:"travel"},{name:"ship",unicode:{apple:"1F6A2",google:"1F6A2",twitter:"1F6A2"},shortcode:"ship",description:"SHIP",category:"travel"},{name:"ferris_wheel",unicode:{apple:"1F3A1",google:"1F3A1",twitter:"1F3A1"},shortcode:"ferris_wheel",description:"FERRIS WHEEL",category:"travel"},{name:"roller_coaster",unicode:{apple:"1F3A2",google:"1F3A2",twitter:"1F3A2"},shortcode:"roller_coaster",description:"ROLLER COASTER",category:"travel"},{name:"carousel_horse",unicode:{apple:"1F3A0",google:"1F3A0",twitter:"1F3A0"},shortcode:"carousel_horse",description:"CAROUSEL HORSE",category:"travel"},{name:"building_construction",unicode:{apple:"1F3D7",google:"1F3D7",twitter:"1F3D7"},shortcode:"building_construction",description:"Building Construction",category:"travel"},{name:"foggy",unicode:{apple:"1F301",google:"1F301",twitter:"1F301"},shortcode:"foggy",description:"FOGGY",category:"travel"},{name:"tokyo_tower",unicode:{apple:"1F5FC",google:"1F5FC",twitter:"1F5FC"},shortcode:"tokyo_tower",description:"TOKYO TOWER",category:"travel"},{name:"factory",unicode:{apple:"1F3ED",google:"1F3ED",twitter:"1F3ED"},shortcode:"factory",description:"FACTORY",category:"travel"},{name:"fountain",unicode:{apple:"26F2",google:"26F2",twitter:"26F2"},shortcode:"fountain",description:"FOUNTAIN",category:"travel"},{name:"rice_scene",unicode:{apple:"1F391",google:"1F391",twitter:"1F391"},shortcode:"rice_scene",description:"MOON VIEWING CEREMONY",category:"travel"},{name:"mountain",unicode:{apple:"26F0",google:"26F0",twitter:"26F0"},shortcode:"mountain",description:"Mountain",category:"travel"},{name:"snow_capped_mountain",unicode:{apple:"1F3D4",google:"1F3D4",twitter:"1F3D4"},shortcode:"snow_capped_mountain",description:"Snow Capped Mountain",category:"travel"},{name:"mount_fuji",unicode:{apple:"1F5FB",google:"1F5FB",twitter:"1F5FB"},shortcode:"mount_fuji",description:"MOUNT FUJI",category:"travel"},{name:"volcano",unicode:{apple:"1F30B",google:"1F30B",twitter:"1F30B"},shortcode:"volcano",description:"VOLCANO",category:"travel"},{name:"japan",unicode:{apple:"1F5FE",google:"1F5FE",twitter:"1F5FE"},shortcode:"japan",description:"SILHOUETTE OF JAPAN",category:"travel"},{name:"camping",unicode:{apple:"1F3D5",google:"1F3D5",twitter:"1F3D5"},shortcode:"camping",description:"Camping",category:"travel"},{name:"tent",unicode:{apple:"26FA",google:"26FA",twitter:"26FA"},shortcode:"tent",description:"TENT",category:"travel"},{name:"national_park",unicode:{apple:"1F3DE",google:"1F3DE",twitter:"1F3DE"},shortcode:"national_park",description:"National Park",category:"travel"},{name:"motorway",unicode:{apple:"1F6E3",google:"1F6E3",twitter:"1F6E3"},shortcode:"motorway",description:"Motorway",category:"travel"},{name:"railway_track",unicode:{apple:"1F6E4",google:"1F6E4",twitter:"1F6E4"},shortcode:"railway_track",description:"Railway Track",category:"travel"},{name:"sunrise",unicode:{apple:"1F305",google:"1F305",twitter:"1F305"},shortcode:"sunrise",description:"SUNRISE",category:"travel"},{name:"sunrise_over_mountains",unicode:{apple:"1F304",google:"1F304",twitter:"1F304"},shortcode:"sunrise_over_mountains",description:"SUNRISE OVER MOUNTAINS",category:"travel"},{name:"desert",unicode:{apple:"1F3DC",google:"1F3DC",twitter:"1F3DC"},shortcode:"desert",description:"Desert",category:"travel"},{name:"beach_with_umbrella",unicode:{apple:"1F3D6",google:"1F3D6",twitter:"1F3D6"},shortcode:"beach_with_umbrella",description:"Beach With Umbrella",category:"travel"},{name:"desert_island",unicode:{apple:"1F3DD",google:"1F3DD",twitter:"1F3DD"},shortcode:"desert_island",description:"Desert Island",category:"travel"},{name:"city_sunrise",unicode:{apple:"1F307",google:"1F307",twitter:"1F307"},shortcode:"city_sunrise",description:"SUNSET OVER BUILDINGS",category:"travel"},{name:"city_sunset",unicode:{apple:"1F306",google:"1F306",twitter:"1F306"},shortcode:"city_sunset",description:"CITYSCAPE AT DUSK",category:"travel"},{name:"cityscape",unicode:{apple:"1F3D9",google:"1F3D9",twitter:"1F3D9"},shortcode:"cityscape",description:"CITYSCAPE",category:"travel"},{name:"night_with_stars",unicode:{apple:"1F303",google:"1F303",twitter:"1F303"},shortcode:"night_with_stars",description:"NIGHT WITH STARS",category:"travel"},{name:"bridge_at_night",unicode:{apple:"1F309",google:"1F309",twitter:"1F309"},shortcode:"bridge_at_night",description:"BRIDGE AT NIGHT",category:"travel"},{name:"milky_way",unicode:{apple:"1F30C",google:"1F30C",twitter:"1F30C"},shortcode:"milky_way",description:"MILKY WAY",category:"travel"},{name:"stars",unicode:{apple:"1F320",google:"1F320",twitter:"1F320"},shortcode:"stars",description:"SHOOTING STAR",category:"travel"},{name:"sparkler",unicode:{apple:"1F387",google:"1F387",twitter:"1F387"},shortcode:"sparkler",description:"FIREWORK SPARKLER",category:"travel"},{name:"fireworks",unicode:{apple:"1F386",google:"1F386",twitter:"1F386"},shortcode:"fireworks",description:"FIREWORKS",category:"travel"},{name:"rainbow",unicode:{apple:"1F308",google:"1F308",twitter:"1F308"},shortcode:"rainbow",description:"RAINBOW",category:"travel"},{name:"house_buildings",unicode:{apple:"1F3D8",google:"1F3D8",twitter:"1F3D8"},shortcode:"house_buildings",description:"EUROPEAN CASTLE",category:"travel"},{name:"european_castle",unicode:{apple:"1F3F0",google:"1F3F0",twitter:"1F3F0"},shortcode:"european_castle",description:"EUROPEAN CASTLE",category:"travel"},{name:"japanese_castle",unicode:{apple:"1F3EF",google:"1F3EF",twitter:"1F3EF"},shortcode:"japanese_castle",description:"JAPANESE CASTLE",category:"travel"},{name:"stadium",unicode:{apple:"1F3DF",google:"1F3DF",twitter:"1F3DF"},shortcode:"stadium",description:"Stadium",category:"travel"},{name:"statue_of_liberty",unicode:{apple:"1F5FD",google:"1F5FD",twitter:"1F5FD"},shortcode:"statue_of_liberty",description:"STATUE OF LIBERTY",category:"travel"},{name:"house",unicode:{apple:"1F3E0",google:"1F3E0",twitter:"1F3E0"},shortcode:"house",description:"HOUSE BUILDING",category:"travel"},{name:"house_with_garden",unicode:{apple:"1F3E1",google:"1F3E1",twitter:"1F3E1"},shortcode:"house_with_garden",description:"HOUSE WITH GARDEN",category:"travel"},{name:"derelict_house_building",unicode:{apple:"1F3DA",google:"1F3DA",twitter:"1F3DA"},shortcode:"derelict_house_building",description:"Derelict House Building",category:"travel"},{name:"office",unicode:{apple:"1F3E2",google:"1F3E2",twitter:"1F3E2"},shortcode:"office",description:"OFFICE BUILDING",category:"travel"},{name:"department_store",unicode:{apple:"1F3EC",google:"1F3EC",twitter:"1F3EC"},shortcode:"department_store",description:"DEPARTMENT STORE",category:"travel"},{name:"post_office",unicode:{apple:"1F3E3",google:"1F3E3",twitter:"1F3E3"},shortcode:"post_office",description:"JAPANESE POST OFFICE",category:"travel"},{name:"european_post_office",unicode:{apple:"1F3E4",google:"1F3E4",twitter:"1F3E4"},shortcode:"european_post_office",description:"EUROPEAN POST OFFICE",category:"travel"},{name:"hospital",unicode:{apple:"1F3E5",google:"1F3E5",twitter:"1F3E5"},shortcode:"hospital",description:"HOSPITAL",category:"travel"},{name:"bank",unicode:{apple:"1F3E6",google:"1F3E6",twitter:"1F3E6"},shortcode:"bank",description:"BANK",category:"travel"},{name:"hotel",unicode:{apple:"1F3E8",google:"1F3E8",twitter:"1F3E8"},shortcode:"hotel",description:"HOTEL",category:"travel"},{name:"convenience_store",unicode:{apple:"1F3EA",google:"1F3EA",twitter:"1F3EA"},shortcode:"convenience_store",description:"CONVENIENCE STORE",category:"travel"},{name:"school",unicode:{apple:"1F3EB",google:"1F3EB",twitter:"1F3EB"},shortcode:"school",description:"SCHOOL",category:"travel"},{name:"love_hotel",unicode:{apple:"1F3E9",google:"1F3E9",twitter:"1F3E9"},shortcode:"love_hotel",description:"LOVE HOTEL",category:"travel"},{name:"wedding",unicode:{apple:"1F492",google:"1F492",twitter:"1F492"},shortcode:"wedding",description:"WEDDING",category:"travel"},{name:"classical_building",unicode:{apple:"1F3DB",google:"1F3DB",twitter:"1F3DB"},shortcode:"classical_building",description:"Classical Building",category:"travel"},{name:"church",unicode:{apple:"26EA",google:"26EA",twitter:"26EA"},shortcode:"church",description:"CHURCH",category:"travel"},{name:"mosque",unicode:{apple:"1F54C",google:"1F54C",twitter:"1F54C"},shortcode:"mosque",description:"Mosque",category:"travel"},{name:"synagogue",unicode:{apple:"1F54D",google:"1F54D",twitter:"1F54D"},shortcode:"synagogue",description:"Synagogue",category:"travel"},{name:"kaaba",unicode:{apple:"1F54B",google:"1F54B",twitter:"1F54B"},shortcode:"kaaba",description:"Kaaba",category:"travel"},{name:"shinto_shrine",unicode:{apple:"26E9",google:"26E9",twitter:"26E9"},shortcode:"shinto_shrine",description:"Shinto Shrine",category:"travel"},{name:"watch",unicode:{apple:"231A",google:"231A",twitter:"231A"},shortcode:"watch",description:"WATCH",category:"object"},{name:"iphone",unicode:{apple:"1F4F1",google:"1F4F1",twitter:"1F4F1"},shortcode:"iphone",description:"MOBILE PHONE",category:"object"},{name:"calling",unicode:{apple:"1F4F2",google:"1F4F2",twitter:"1F4F2"},shortcode:"calling",description:"MOBILE PHONE WITH RIGHTWARDS ARROW AT LEFT",category:"object"},{name:"computer",unicode:{apple:"1F4BB",google:"1F4BB",twitter:"1F4BB"},shortcode:"computer",description:"PERSONAL COMPUTER",category:"object"},{name:"keyboard",unicode:{apple:"2328",google:"2328",twitter:"2328"},shortcode:"keyboard",description:"KEYBOARD",category:"object"},{name:"desktop_computer",unicode:{apple:"1F5A5",google:"1F5A5",twitter:"1F5A5"},shortcode:"desktop_computer",description:"DESKTOP COMPUTER",category:"object"},{name:"printer",unicode:{apple:"1F5A8",google:"1F5A8",twitter:"1F5A8"},shortcode:"printer",description:"PRINTER",category:"object"},{name:"three_button_mouse",unicode:{apple:"1F5B1",google:"1F5B1",twitter:"1F5B1"},shortcode:"three_button_mouse",description:"THREE BUTTON MOUSE",category:"object"},{name:"trackball",unicode:{apple:"1F5B2",google:"1F5B2",twitter:"1F5B2"},shortcode:"trackball",description:"TRACKBALL",category:"object"},{name:"joystick",unicode:{apple:"1F579",google:"1F579",twitter:"1F579"},shortcode:"joystick",description:"JOYSTICK",category:"object"},{name:"compression",unicode:{apple:"1F5DC",google:"1F5DC",twitter:"1F5DC"},shortcode:"compression",description:"COMPRESSION",category:"object"},{name:"minidisc",unicode:{apple:"1F4BD",google:"1F4BD",twitter:"1F4BD"},shortcode:"minidisc",description:"MINIDISC",category:"object"},{name:"floppy_disk",unicode:{apple:"1F4BE",google:"1F4BE",twitter:"1F4BE"},shortcode:"floppy_disk",description:"FLOPPY DISK",category:"object"},{name:"cd",unicode:{apple:"1F4BF",google:"1F4BF",twitter:"1F4BF"},shortcode:"cd",description:"OPTICAL DISC",category:"object"},{name:"dvd",unicode:{apple:"1F4C0",google:"1F4C0",twitter:"1F4C0"},shortcode:"dvd",description:"DVD",category:"object"},{name:"vhs",unicode:{apple:"1F4FC",google:"1F4FC",twitter:"1F4FC"},shortcode:"vhs",description:"VIDEOCASSETTE",category:"object"},{name:"camera",unicode:{apple:"1F4F7",google:"1F4F7",twitter:"1F4F7"},shortcode:"camera",description:"CAMERA",category:"object"},{name:"camera_with_flash",unicode:{apple:"1F4F8",google:"1F4F8",twitter:"1F4F8"},shortcode:"camera_with_flash",description:"CAMERA WITH FLASH",category:"object"},{name:"video_camera",unicode:{apple:"1F4F9",google:"1F4F9",twitter:"1F4F9"},shortcode:"video_camera",description:"VIDEO CAMERA",category:"object"},{name:"movie_camera",unicode:{apple:"1F3A5",google:"1F3A5",twitter:"1F3A5"},shortcode:"movie_camera",description:"MOVIE CAMERA",category:"object"},{name:"film_projector",unicode:{apple:"1F4FD",google:"1F4FD",twitter:"1F4FD"},shortcode:"film_projector",description:"FILM PROJECTOR",category:"object"},{name:"film_frames",unicode:{apple:"1F39E",google:"1F39E",twitter:"1F39E"},shortcode:"film_frames",description:"FILM FRAMES",category:"object"},{name:"telephone_receiver",unicode:{apple:"1F4DE",google:"1F4DE",twitter:"1F4DE"},shortcode:"telephone_receiver",description:"TELEPHONE RECEIVER",category:"object"},{name:"phone",unicode:{apple:"260E",google:"260E",twitter:"260E"},shortcode:"phone",description:"BLACK TELEPHONE",category:"object"},{name:"pager",unicode:{apple:"1F4DF",google:"1F4DF",twitter:"1F4DF"},shortcode:"pager",description:"PAGER",category:"object"},{name:"fax",unicode:{apple:"1F4E0",google:"1F4E0",twitter:"1F4E0"},shortcode:"fax",description:"FAX MACHINE",category:"object"},{name:"tv",unicode:{apple:"1F4FA",google:"1F4FA",twitter:"1F4FA"},shortcode:"tv",description:"TELEVISION",category:"object"},{name:"radio",unicode:{apple:"1F4FB",google:"1F4FB",twitter:"1F4FB"},shortcode:"radio",description:"RADIO",category:"object"},{name:"studio_microphone",unicode:{apple:"1F399",google:"1F399",twitter:"1F399"},shortcode:"studio_microphone",description:"STUDIO MICROPHONE",category:"object"},{name:"level_slider",unicode:{apple:"1F39A",google:"1F39A",twitter:"1F39A"},shortcode:"level_slider",description:"LEVEL SLIDER",category:"object"},{name:"control_knobs",unicode:{apple:"1F39B",google:"1F39B",twitter:"1F39B"},shortcode:"control_knobs",description:"CONTROL KNOBS",category:"object"},{name:"stopwatch",unicode:{apple:"23F1",google:"23F1",twitter:"23F1"},shortcode:"stopwatch",description:"STOPWATCH",category:"object"},{name:"timer_clock",unicode:{apple:"23F2",google:"23F2",twitter:"23F2"},shortcode:"timer_clock",description:"TIMER CLOCK",category:"object"},{name:"alarm_clock",unicode:{apple:"23F0",google:"23F0",twitter:"23F0"},shortcode:"alarm_clock",description:"ALARM CLOCK",category:"object"},{name:"mantelpiece_clock",unicode:{apple:"1F570",google:"1F570",twitter:"1F570"},shortcode:"mantelpiece_clock",description:"MANTELPIECE CLOCK",category:"object"},{name:"hourglass_flowing_sand",unicode:{apple:"23F3",google:"23F3",twitter:"23F3"},shortcode:"hourglass_flowing_sand",description:"HOURGLASS WITH FLOWING SAND",category:"object"},{name:"hourglass",unicode:{apple:"231B",google:"231B",twitter:"231B"},shortcode:"hourglass",description:"HOURGLASS",category:"object"},{name:"satellite",unicode:{apple:"1F6F0",google:"1F6F0",twitter:"1F6F0"},shortcode:"satellite",description:"SATELLITE",category:"object"},{name:"battery",unicode:{apple:"1F50B",google:"1F50B",twitter:"1F50B"},shortcode:"battery",description:"BATTERY",category:"object"},{name:"electric_plug",unicode:{apple:"1F50C",google:"1F50C",twitter:"1F50C"},shortcode:"electric_plug",description:"ELECTRIC PLUG",category:"object"},{name:"bulb",unicode:{apple:"1F4A1",google:"1F4A1",twitter:"1F4A1"},shortcode:"bulb",description:"ELECTRIC LIGHT BULB",category:"object"},{name:"flashlight",unicode:{apple:"1F526",google:"1F526",twitter:"1F526"},shortcode:"flashlight",description:"ELECTRIC TORCH",category:"object"},{name:"candle",unicode:{apple:"1F56F",google:"1F56F",twitter:"1F56F"},shortcode:"candle",description:"CANDLE",category:"object"},{name:"wastebasket",unicode:{apple:"1F5D1",google:"1F5D1",twitter:"1F5D1"},shortcode:"wastebasket",description:"WASTEBASKET",category:"object"},{name:"oil_drum",unicode:{apple:"1F6E2",google:"1F6E2",twitter:"1F6E2"},shortcode:"oil_drum",description:"OIL DRUM",category:"object"},{name:"money_with_wings",unicode:{apple:"1F4B8",google:"1F4B8",twitter:"1F4B8"},shortcode:"money_with_wings",description:"MONEY WITH WINGS",category:"object"},{name:"dollar",unicode:{apple:"1F4B5",google:"1F4B5",twitter:"1F4B5"},shortcode:"dollar",description:"BANKNOTE WITH DOLLAR SIGN",category:"object"},{name:"yen",unicode:{apple:"1F4B4",google:"1F4B4",twitter:"1F4B4"},shortcode:"yen",description:"BANKNOTE WITH YEN SIGN",category:"object"},{name:"euro",unicode:{apple:"1F4B6",google:"1F4B6",twitter:"1F4B6"},shortcode:"euro",description:"BANKNOTE WITH EURO SIGN",category:"object"},{name:"pound",unicode:{apple:"1F4B7",google:"1F4B7",twitter:"1F4B7"},shortcode:"pound",description:"BANKNOTE WITH POUND SIGN",category:"object"},{name:"moneybag",unicode:{apple:"1F4B0",google:"1F4B0",twitter:"1F4B0"},shortcode:"moneybag",description:"MONEY BAG",category:"object"},{name:"credit_card",unicode:{apple:"1F4B3",google:"1F4B3",twitter:"1F4B3"},shortcode:"credit_card",description:"CREDIT CARD",category:"object"},{name:"gem",unicode:{apple:"1F48E",google:"1F48E",twitter:"1F48E"},shortcode:"gem",description:"GEM STONE",category:"object"},{name:"scales",unicode:{apple:"2696",google:"2696",twitter:"2696"},shortcode:"scales",description:"SCALES",category:"object"},{name:"wrench",unicode:{apple:"1F527",google:"1F527",twitter:"1F527"},shortcode:"wrench",description:"WRENCH",category:"object"},{name:"hammer",unicode:{apple:"1F528",google:"1F528",twitter:"1F528"},shortcode:"hammer",description:"HAMMER",category:"object"},{name:"hammer_and_pick",unicode:{apple:"2692",google:"2692",twitter:"2692"},shortcode:"hammer_and_pick",description:"HAMMER AND PICK",category:"object"},{name:"hammer_and_wrench",unicode:{apple:"1F6E0",google:"1F6E0",twitter:"1F6E0"},shortcode:"hammer_and_wrench",description:"HAMMER AND WRENCH",category:"object"},{name:"pick",unicode:{apple:"26CF",google:"26CF",twitter:"26CF"},shortcode:"pick",description:"PICK",category:"object"},{name:"nut_and_bolt",unicode:{apple:"1F529",google:"1F529",twitter:"1F529"},shortcode:"nut_and_bolt",description:"NUT AND BOLT",category:"object"},{name:"gear",unicode:{apple:"2699",google:"2699",twitter:"2699"},shortcode:"gear",description:"GEAR",category:"object"},{name:"chains",unicode:{apple:"26D3",google:"26D3",twitter:"26D3"},shortcode:"chains",description:"CHAINS",category:"object"},{name:"gun",unicode:{apple:"1F52B",google:"1F52B",twitter:"1F52B"},shortcode:"gun",description:"PISTOL",category:"object"},{name:"bomb",unicode:{apple:"1F4A3",google:"1F4A3",twitter:"1F4A3"},shortcode:"bomb",description:"BOMB",category:"object"},{name:"hocho",unicode:{apple:"1F52A",google:"1F52A",twitter:"1F52A"},shortcode:"hocho",description:"HOCHO",category:"object"},{name:"dagger_knife",unicode:{apple:"1F5E1",google:"1F5E1",twitter:"1F5E1"},shortcode:"dagger_knife",description:"DAGGER KNIFE",category:"object"},{name:"crossed_swords",unicode:{apple:"2694",google:"2694",twitter:"2694"},shortcode:"crossed_swords",description:"CROSSED SWORDS",category:"object"},{name:"shield",unicode:{apple:"1F6E1",google:"1F6E1",twitter:"1F6E1"},shortcode:"shield",description:"SHIELD",category:"object"},{name:"smoking",unicode:{apple:"1F6AC",google:"1F6AC",twitter:"1F6AC"},shortcode:"smoking",description:"SMOKING SYMBOL",category:"object"},{name:"skull_and_crossbones",unicode:{apple:"2620",google:"2620",twitter:"2620"},shortcode:"skull_and_crossbones",description:"SKULL AND CROSSBONES",category:"object"},{name:"coffin",unicode:{apple:"26B0",google:"26B0",twitter:"26B0"},shortcode:"coffin",description:"COFFIN",category:"object"},{name:"funeral_urn",unicode:{apple:"26B1",google:"26B1",twitter:"26B1"},shortcode:"funeral_urn",description:"FUNERAL URN",category:"object"},{name:"amphora",unicode:{apple:"1F3FA",google:"1F3FA",twitter:"1F3FA"},shortcode:"amphora",description:"AMPHORA",category:"object"},{name:"crystal_ball",unicode:{apple:"1F52E",google:"1F52E",twitter:"1F52E"},shortcode:"crystal_ball",description:"CRYSTAL BALL",category:"object"},{name:"prayer_beads",unicode:{apple:"1F4FF",google:"1F4FF",twitter:"1F4FF"},shortcode:"prayer_beads",description:"PRAYER BEADS",category:"object"},{name:"barber",unicode:{apple:"1F488",google:"1F488",twitter:"1F488"},shortcode:"barber",description:"BARBER POLE",category:"object"},{name:"alembic",unicode:{apple:"2697",google:"2697",twitter:"2697"},shortcode:"alembic",description:"ALEMBIC",category:"object"},{name:"telescope",unicode:{apple:"1F52D",google:"1F52D",twitter:"1F52D"},shortcode:"telescope",description:"TELESCOPE",category:"object"},{name:"microscope",unicode:{apple:"1F52C",google:"1F52C",twitter:"1F52C"},shortcode:"microscope",description:"MICROSCOPE",category:"object"},{name:"hole",unicode:{apple:"1F573",google:"1F573",twitter:"1F573"},shortcode:"hole",description:"HOLE",category:"object"},{name:"pill",unicode:{apple:"1F48A",google:"1F48A",twitter:"1F48A"},shortcode:"pill",description:"PILL",category:"object"},{name:"syringe",unicode:{apple:"1F489",google:"1F489",twitter:"1F489"},shortcode:"syringe",description:"SYRINGE",category:"object"},{name:"thermometer",unicode:{apple:"1F321",google:"1F321",twitter:"1F321"},shortcode:"thermometer",description:"THERMOMETER",category:"object"},{name:"label",unicode:{apple:"1F3F7",google:"1F3F7",twitter:"1F3F7"},shortcode:"label",description:"LABEL",category:"object"},{name:"bookmark",unicode:{apple:"1F516",google:"1F516",twitter:"1F516"},shortcode:"bookmark",description:"BOOKMARK",category:"object"},{name:"toilet",unicode:{apple:"1F6BD",google:"1F6BD",twitter:"1F6BD"},shortcode:"toilet",description:"TOILET",category:"object"},{name:"shower",unicode:{apple:"1F6BF",google:"1F6BF",twitter:"1F6BF"},shortcode:"shower",description:"SHOWER",category:"object"},{name:"bathtub",unicode:{apple:"1F6C1",google:"1F6C1",twitter:"1F6C1"},shortcode:"bathtub",description:"BATHTUB",category:"object"},{name:"key",unicode:{apple:"1F511",google:"1F511",twitter:"1F511"},shortcode:"key",description:"KEY",category:"object"},{name:"old_key",unicode:{apple:"1F5DD",google:"1F5DD",twitter:"1F5DD"},shortcode:"old_key",description:"OLD KEY",category:"object"},{name:"couch_and_lamp",unicode:{apple:"1F6CB",google:"1F6CB",twitter:"1F6CB"},shortcode:"couch_and_lamp",description:"COUCH AND LAMP",category:"object"},{name:"sleeping_accommodation",unicode:{apple:"1F6CC",google:"1F6CC",twitter:"1F6CC"},shortcode:"sleeping_accommodation",description:"SLEEPING ACCOMMODATION",category:"object"},{name:"bed",unicode:{apple:"1F6CF",google:"1F6CF",twitter:"1F6CF"},shortcode:"bed",description:"BED",category:"object"},{name:"door",unicode:{apple:"1F6AA",google:"1F6AA",twitter:"1F6AA"},shortcode:"door",description:"DOOR",category:"object"},{name:"bellhop_bell",unicode:{apple:"1F6CE",google:"1F6CE",twitter:"1F6CE"},shortcode:"bellhop_bell",description:"BELLHOP BELL",category:"object"},{name:"frame_with_picture",unicode:{apple:"1F5BC",google:"1F5BC",twitter:"1F5BC"},shortcode:"frame_with_picture",description:"FRAME WITH PICTURE",category:"object"},{name:"world_map",unicode:{apple:"1F5FA",google:"1F5FA",twitter:"1F5FA"},shortcode:"world_map",description:"WORLD MAP",category:"object"},{name:"umbrella_on_ground",unicode:{apple:"26F1",google:"26F1",twitter:"26F1"},shortcode:"umbrella_on_ground",description:"UMBRELLA ON GROUND",category:"object"},{name:"moyai",unicode:{apple:"1F5FF",google:"1F5FF",twitter:"1F5FF"},shortcode:"moyai",description:"MOYAI",category:"object"},{name:"shopping_bags",unicode:{apple:"1F6CD",google:"1F6CD",twitter:"1F6CD"},shortcode:"shopping_bags",description:"SHOPPING BAGS",category:"object"},{name:"balloon",unicode:{apple:"1F388",google:"1F388",twitter:"1F388"},shortcode:"balloon",description:"BALLOON",category:"object"},{name:"flags",unicode:{apple:"1F38F",google:"1F38F",twitter:"1F38F"},shortcode:"flags",description:"CARP STREAMER",category:"object"},{name:"ribbon",unicode:{apple:"1F380",google:"1F380",twitter:"1F380"},shortcode:"ribbon",description:"RIBBON",category:"object"},{name:"gift",unicode:{apple:"1F381",google:"1F381",twitter:"1F381"},shortcode:"gift",description:"WRAPPED PRESENT",category:"object"},{name:"confetti_ball",unicode:{apple:"1F38A",google:"1F38A",twitter:"1F38A"},shortcode:"confetti_ball",description:"CONFETTI BALL",category:"object"},{name:"tada",unicode:{apple:"1F389",google:"1F389",twitter:"1F389"},shortcode:"tada",description:"PARTY POPPER",category:"object"},{name:"dolls",unicode:{apple:"1F38E",google:"1F38E",twitter:"1F38E"},shortcode:"dolls",description:"JAPANESE DOLLS",category:"object"},{name:"wind_chime",unicode:{apple:"1F390",google:"1F390",twitter:"1F390"},shortcode:"wind_chime",description:"WIND CHIME",category:"object"},{name:"crossed_flags",unicode:{apple:"1F38C",google:"1F38C",twitter:"1F38C"},shortcode:"crossed_flags",description:"CROSSED FLAGS",category:"object"},{name:"izakaya_lantern",unicode:{apple:"1F3EE",google:"1F3EE",twitter:"1F3EE"},shortcode:"izakaya_lantern",description:"IZAKAYA LANTERN",category:"object"},{name:"email",unicode:{apple:"2709",google:"2709",twitter:"2709"},shortcode:"email",description:"ENVELOPE",category:"object"},{name:"envelope_with_arrow",unicode:{apple:"1F4E9",google:"1F4E9",twitter:"1F4E9"},shortcode:"envelope_with_arrow",description:"ENVELOPE WITH DOWNWARDS ARROW ABOVE",category:"object"},{name:"incoming_envelope",unicode:{apple:"1F4E8",google:"1F4E8",twitter:"1F4E8"},shortcode:"incoming_envelope",description:"INCOMING ENVELOPE",category:"object"},{name:"e-mail",unicode:{apple:"1F4E7",google:"1F4E7",twitter:"1F4E7"},shortcode:"e-mail",description:"E-MAIL SYMBOL",category:"object"},{name:"love_letter",unicode:{apple:"1F48C",google:"1F48C",twitter:"1F48C"},shortcode:"love_letter",description:"LOVE LETTER",category:"object"},{name:"postbox",unicode:{apple:"1F4EE",google:"1F4EE",twitter:"1F4EE"},shortcode:"postbox",description:"POSTBOX",category:"object"},{name:"mailbox_closed",unicode:{apple:"1F4EA",google:"1F4EA",twitter:"1F4EA"},shortcode:"mailbox_closed",description:"CLOSED MAILBOX WITH LOWERED FLAG",category:"object"},{name:"mailbox",unicode:{apple:"1F4EB",google:"1F4EB",twitter:"1F4EB"},shortcode:"mailbox",description:"CLOSED MAILBOX WITH RAISED FLAG",category:"object"},{name:"mailbox_with_mail",unicode:{apple:"1F4EC",google:"1F4EC",twitter:"1F4EC"},shortcode:"mailbox_with_mail",description:"OPEN MAILBOX WITH RAISED FLAG",category:"object"},{name:"mailbox_with_no_mail",unicode:{apple:"1F4ED",google:"1F4ED",twitter:"1F4ED"},shortcode:"mailbox_with_no_mail",description:"OPEN MAILBOX WITH LOWERED FLAG",category:"object"},{name:"package",unicode:{apple:"1F4E6",google:"1F4E6",twitter:"1F4E6"},shortcode:"package",description:"PACKAGE",category:"object"},{name:"postal_horn",unicode:{apple:"1F4EF",google:"1F4EF",twitter:"1F4EF"},shortcode:"postal_horn",description:"POSTAL HORN",category:"object"},{name:"inbox_tray",unicode:{apple:"1F4E5",google:"1F4E5",twitter:"1F4E5"},shortcode:"inbox_tray",description:"INBOX TRAY",category:"object"},{name:"outbox_tray",unicode:{apple:"1F4E4",google:"1F4E4",twitter:"1F4E4"},shortcode:"outbox_tray",description:"OUTBOX TRAY",category:"object"},{name:"scroll",unicode:{apple:"1F4DC",google:"1F4DC",twitter:"1F4DC"},shortcode:"scroll",description:"SCROLL",category:"object"},{name:"page_with_curl",unicode:{apple:"1F4C3",google:"1F4C3",twitter:"1F4C3"},shortcode:"page_with_curl",description:"PAGE WITH CURL",category:"object"},{name:"bookmark_tabs",unicode:{apple:"1F4D1",google:"1F4D1",twitter:"1F4D1"},shortcode:"bookmark_tabs",description:"BOOKMARK TABS",category:"object"},{name:"bar_chart",unicode:{apple:"1F4CA",google:"1F4CA",twitter:"1F4CA"},shortcode:"bar_chart",description:"BAR CHART",category:"object"},{name:"chart_with_upwards_trend",unicode:{apple:"1F4C8",google:"1F4C8",twitter:"1F4C8"},shortcode:"chart_with_upwards_trend",description:"CHART WITH UPWARDS TREND",category:"object"},{name:"chart_with_downwards_trend",unicode:{apple:"1F4C9",google:"1F4C9",twitter:"1F4C9"},shortcode:"chart_with_downwards_trend",description:"CHART WITH DOWNWARDS TREND",category:"object"},{name:"page_facing_up",unicode:{apple:"1F4C4",google:"1F4C4",twitter:"1F4C4"},shortcode:"page_facing_up",description:"PAGE FACING UP",category:"object"},{name:"date",unicode:{apple:"1F4C5",google:"1F4C5",twitter:"1F4C5"},shortcode:"date",description:"CALENDAR",category:"object"},{name:"calendar",unicode:{apple:"1F4C6",google:"1F4C6",twitter:"1F4C6"},shortcode:"calendar",description:"TEAR-OFF CALENDAR",category:"object"},{name:"spiral_calendar_pad",unicode:{apple:"1F5D3",google:"1F5D3",twitter:"1F5D3"},shortcode:"spiral_calendar_pad",description:"SPIRAL CALENDAR PAD",category:"object"},{name:"card_index",unicode:{apple:"1F4C7",google:"1F4C7",twitter:"1F4C7"},shortcode:"card_index",description:"CARD INDEX",category:"object"},{name:"card_file_box",unicode:{apple:"1F5C3",google:"1F5C3",twitter:"1F5C3"},shortcode:"card_file_box",description:"CARD FILE BOX",category:"object"},{name:"ballot_box_with_check",unicode:{apple:"2611-FE0F",google:"2611-FE0F",twitter:"2611-FE0F"},shortcode:"ballot_box_with_check",description:"BALLOT BOX WITH CHECK",category:"object"},{name:"file_cabinet",unicode:{apple:"1F5C4",google:"1F5C4",twitter:"1F5C4"},shortcode:"file_cabinet",description:"FILE CABINET",category:"object"},{name:"clipboard",unicode:{apple:"1F4CB",google:"1F4CB",twitter:"1F4CB"},shortcode:"clipboard",description:"CLIPBOARD",category:"object"},{name:"spiral_note_pad",unicode:{apple:"1F5D2",google:"1F5D2",twitter:"1F5D2"},shortcode:"spiral_note_pad",description:"SPIRAL NOTE PAD",category:"object"},{name:"file_folder",unicode:{apple:"1F4C1",google:"1F4C1",twitter:"1F4C1"},shortcode:"file_folder",description:"FILE FOLDER",category:"object"},{name:"open_file_folder",unicode:{apple:"1F4C2",google:"1F4C2",twitter:"1F4C2"},shortcode:"open_file_folder",description:"OPEN FILE FOLDER",category:"object"},{name:"card_index_dividers",unicode:{apple:"1F5C2",google:"1F5C2",twitter:"1F5C2"},shortcode:"card_index_dividers",description:"CARD INDEX DIVIDERS",category:"object"},{name:"rolled_up_newspaper",unicode:{apple:"1F5DE",google:"1F5DE",twitter:"1F5DE"},shortcode:"rolled_up_newspaper",description:"ROLLED-UP NEWSPAPER",category:"object"},{name:"newspaper",unicode:{apple:"1F4F0",google:"1F4F0",twitter:"1F4F0"},shortcode:"newspaper",description:"NEWSPAPER",category:"object"},{name:"notebook",unicode:{apple:"1F4D3",google:"1F4D3",twitter:"1F4D3"},shortcode:"notebook",description:"NOTEBOOK",category:"object"},{name:"closed_book",unicode:{apple:"1F4D5",google:"1F4D5",twitter:"1F4D5"},shortcode:"closed_book",description:"CLOSED BOOK",category:"object"},{name:"green_book",unicode:{apple:"1F4D7",google:"1F4D7",twitter:"1F4D7"},shortcode:"green_book",description:"GREEN BOOK",category:"object"},{name:"blue_book",unicode:{apple:"1F4D8",google:"1F4D8",twitter:"1F4D8"},shortcode:"blue_book",description:"BLUE BOOK",category:"object"},{name:"orange_book",unicode:{apple:"1F4D9",google:"1F4D9",twitter:"1F4D9"},shortcode:"orange_book",description:"ORANGE BOOK",category:"object"},{name:"notebook_with_decorative_cover",unicode:{apple:"1F4D4",google:"1F4D4",twitter:"1F4D4"},shortcode:"notebook_with_decorative_cover",description:"NOTEBOOK WITH DECORATIVE COVER",category:"object"},{name:"ledger",unicode:{apple:"1F4D2",google:"1F4D2",twitter:"1F4D2"},shortcode:"ledger",description:"LEDGER",category:"object"},{name:"books",unicode:{apple:"1F4DA",google:"1F4DA",twitter:"1F4DA"},shortcode:"books",description:"BOOKS",category:"object"},{name:"book",unicode:{apple:"1F4D6",google:"1F4D6",twitter:"1F4D6"},shortcode:"book",description:"OPEN BOOK",category:"object"},{name:"link",unicode:{apple:"1F517",google:"1F517",twitter:"1F517"},shortcode:"link",description:"LINK SYMBOL",category:"object"},{name:"paperclip",unicode:{apple:"1F4CE",google:"1F4CE",twitter:"1F4CE"},shortcode:"paperclip",description:"PAPERCLIP",category:"object"},{name:"linked_paperclips",unicode:{apple:"1F587",google:"1F587",twitter:"1F587"},shortcode:"linked_paperclips",description:"LINKED PAPERCLIPS",category:"object"},{name:"scissors",unicode:{apple:"2702",google:"2702",twitter:"2702"},shortcode:"scissors",description:"BLACK SCISSORS",category:"object"},{name:"triangular_ruler",unicode:{apple:"1F4D0",google:"1F4D0",twitter:"1F4D0"},shortcode:"triangular_ruler",description:"TRIANGULAR RULER",category:"object"},{name:"straight_ruler",unicode:{apple:"1F4CF",google:"1F4CF",twitter:"1F4CF"},shortcode:"straight_ruler",description:"STRAIGHT RULER",category:"object"},{name:"pushpin",unicode:{apple:"1F4CC",google:"1F4CC",twitter:"1F4CC"},shortcode:"pushpin",description:"PUSHPIN",category:"object"},{name:"round_pushpin",unicode:{apple:"1F4CD",google:"1F4CD",twitter:"1F4CD"},shortcode:"round_pushpin",description:"ROUND PUSHPIN",category:"object"},{name:"triangular_flag_on_post",unicode:{apple:"1F6A9",google:"1F6A9",twitter:"1F6A9"},shortcode:"triangular_flag_on_post",description:"TRIANGULAR FLAG ON POST",category:"object"},{name:"waving_white_flag",unicode:{apple:"1F3F3",google:"1F3F3",twitter:"1F3F3"},shortcode:"waving_white_flag",description:"WAVING WHITE FLAG",category:"object"},{name:"waving_black_flag",unicode:{apple:"1F3F4",google:"1F3F4",twitter:"1F3F4"},shortcode:"waving_black_flag",description:"WAVING BLACK FLAG",category:"object"},{name:"closed_lock_with_key",unicode:{apple:"1F510",google:"1F510",twitter:"1F510"},shortcode:"closed_lock_with_key",description:"CLOSED LOCK WITH KEY",category:"object"},{name:"lock",unicode:{apple:"1F512",google:"1F512",twitter:"1F512"},shortcode:"lock",description:"LOCK",category:"object"},{name:"unlock",unicode:{apple:"1F513",google:"1F513",twitter:"1F513"},shortcode:"unlock",description:"OPEN LOCK",category:"object"},{name:"lock_with_ink_pen",unicode:{apple:"1F50F",google:"1F50F",twitter:"1F50F"},shortcode:"lock_with_ink_pen",description:"LOCK WITH INK PEN",category:"object"},{name:"lower_left_ballpoint_pen",unicode:{apple:"1F58A",google:"1F58A",twitter:"1F58A"},shortcode:"lower_left_ballpoint_pen",description:"LOWER LEFT BALLPOINT PEN",category:"object"},{name:"lower_left_fountain_pen",unicode:{apple:"1F58B",google:"1F58B",twitter:"1F58B"},shortcode:"lower_left_fountain_pen",description:"LOWER LEFT FOUNTAIN PEN",category:"object"},{name:"black_nib",unicode:{apple:"2712",google:"2712",twitter:"2712"},shortcode:"black_nib",description:"BLACK NIB",category:"folderol"},{name:"memo",unicode:{apple:"1F4DD",google:"1F4DD",twitter:"1F4DD"},shortcode:"memo",description:"MEMO",category:"object"},{name:"pencil2",unicode:{apple:"270F-FE0F",google:"270F-FE0F",twitter:"270F-FE0F"},shortcode:"pencil2",description:"PENCIL",category:"object"},{name:"lower_left_crayon",unicode:{apple:"1F58D",google:"1F58D",twitter:"1F58D"},shortcode:"lower_left_crayon",description:"LOWER LEFT CRAYON",category:"object"},{name:"lower_left_paintbrush",unicode:{apple:"1F58C",google:"1F58C",twitter:"1F58C"},shortcode:"lower_left_paintbrush",description:"LOWER LEFT PAINTBRUSH",category:"object"},{name:"mag",unicode:{apple:"1F50D",google:"1F50D",twitter:"1F50D"},shortcode:"mag",description:"LEFT-POINTING MAGNIFYING GLASS",category:"object"},{name:"mag_right",unicode:{apple:"1F50E",google:"1F50E",twitter:"1F50E"},shortcode:"mag_right",description:"RIGHT-POINTING MAGNIFYING GLASS",category:"object"},{name:"heart",unicode:{apple:"2764",google:"2764",twitter:"2764"},shortcode:"heart",description:"HEAVY BLACK HEART",category:"symbol"},{name:"yellow_heart",unicode:{apple:"1F49B",google:"1F49B",twitter:"1F49B"},shortcode:"yellow_heart",description:"YELLOW HEART",category:"symbol"},{name:"green_heart",unicode:{apple:"1F49A",google:"1F49A",twitter:"1F49A"},shortcode:"green_heart",description:"GREEN HEART",category:"symbol"},{name:"blue_heart",unicode:{apple:"1F499",google:"1F499",twitter:"1F499"},shortcode:"blue_heart",description:"BLUE HEART",category:"symbol"},{name:"purple_heart",unicode:{apple:"1F49C",google:"1F49C",twitter:"1F49C"},shortcode:"purple_heart",description:"PURPLE HEART",category:"symbol"},{name:"broken_heart",unicode:{apple:"1F494",google:"1F494",twitter:"1F494"},shortcode:"broken_heart",description:"BROKEN HEART",category:"symbol"},{name:"heavy_heart_exclamation_mark_ornament",unicode:{apple:"2763",google:"2763",twitter:"2763"},shortcode:"heavy_heart_exclamation_mark_ornament",description:"HEAVY HEART EXCLAMATION MARK ORNAMENT",category:"symbol"},{name:"two_hearts",unicode:{apple:"1F495",google:"1F495",twitter:"1F495"},shortcode:"two_hearts",description:"TWO HEARTS",category:"symbol"},{name:"revolving_hearts",unicode:{apple:"1F49E",google:"1F49E",twitter:"1F49E"},shortcode:"revolving_hearts",description:"REVOLVING HEARTS",category:"symbol"},{name:"heartbeat",unicode:{apple:"1F493",google:"1F493",twitter:"1F493"},shortcode:"heartbeat",description:"BEATING HEART",category:"symbol"},{name:"heartpulse",unicode:{apple:"1F497",google:"1F497",twitter:"1F497"},shortcode:"heartpulse",description:"GROWING HEART",category:"symbol"},{name:"sparkling_heart",unicode:{apple:"1F496",google:"1F496",twitter:"1F496"},shortcode:"sparkling_heart",description:"SPARKLING HEART",category:"symbol"},{name:"cupid",unicode:{apple:"1F498",google:"1F498",twitter:"1F498"},shortcode:"cupid",description:"HEART WITH ARROW",category:"symbol"},{name:"gift_heart",unicode:{apple:"1F49D",google:"1F49D",twitter:"1F49D"},shortcode:"gift_heart",description:"HEART WITH RIBBON",category:"symbol"},{name:"heart_decoration",unicode:{apple:"1F49F",google:"1F49F",twitter:"1F49F"},shortcode:"heart_decoration",description:"HEART DECORATION",category:"symbol"},{name:"peace_symbol",unicode:{apple:"262E",google:"262E",twitter:"262E"},shortcode:"peace_symbol",description:"PEACE SYMBOL",category:"symbol"},{name:"latin_cross",unicode:{apple:"271D",google:"271D",twitter:"271D"},shortcode:"latin_cross",description:"LATIN CROSS",category:"symbol"},{name:"star_and_crescent",unicode:{apple:"262A",google:"262A",twitter:"262A"},shortcode:"star_and_crescent",description:"STAR AND CRESCENT",category:"symbol"},{name:"om_symbol",unicode:{apple:"1F549",google:"1F549",twitter:"1F549"},shortcode:"om_symbol",description:"OM SYMBOL",category:"symbol"},{name:"wheel_of_dharma",unicode:{apple:"2638",google:"2638",twitter:"2638"},shortcode:"wheel_of_dharma",description:"WHEEL OF DHARMA",category:"symbol"},{name:"star_of_david",unicode:{apple:"2721",google:"2721",twitter:"2721"},shortcode:"star_of_david",description:"STAR OF DAVID",category:"symbol"},{name:"six_pointed_star",unicode:{apple:"1F52F",google:"1F52F",twitter:"1F52F"},shortcode:"six_pointed_star",description:"SIX POINTED STAR WITH MIDDLE DOT",category:"symbol"},{name:"menorah_with_nine_branches",unicode:{apple:"1F54E",google:"1F54E",twitter:"1F54E"},shortcode:"menorah_with_nine_branches",description:"MENORAH WITH NINE BRANCHES",category:"symbol"},{name:"yin_yang",unicode:{apple:"262F",google:"262F",twitter:"262F"},shortcode:"yin_yang",description:"YIN YANG",category:"symbol"},{name:"orthodox_cross",unicode:{apple:"2626",google:"2626",twitter:"2626"},shortcode:"orthodox_cross",description:"ORTHODOX CROSS",category:"symbol"},{name:"place_of_worship",unicode:{apple:"1F6D0",google:"1F6D0",twitter:"1F6D0"},shortcode:"place_of_worship",description:"PLACE OF WORSHIP",category:"symbol"},{name:"ophiuchus",unicode:{apple:"26CE",google:"26CE",twitter:"26CE"},shortcode:"ophiuchus",description:"OPHIUCHUS",category:"symbol"},{name:"aries",unicode:{apple:"2648",google:"2648",twitter:"2648"},shortcode:"aries",description:"ARIES",category:"symbol"},{name:"taurus",unicode:{apple:"2649",google:"2649",twitter:"2649"},shortcode:"taurus",description:"TAURUS",category:"symbol"},{name:"gemini",unicode:{apple:"264A",google:"264A",twitter:"264A"},shortcode:"gemini",description:"GEMINI",category:"symbol"},{name:"cancer",unicode:{apple:"264B",google:"264B",twitter:"264B"},shortcode:"cancer",description:"CANCER",category:"symbol"},{name:"leo",unicode:{apple:"264C",google:"264C",twitter:"264C"},shortcode:"leo",description:"LEO",category:"symbol"},{name:"virgo",unicode:{apple:"264D",google:"264D",twitter:"264D"},shortcode:"virgo",description:"VIRGO",category:"symbol"},{name:"libra",unicode:{apple:"264E",google:"264E",twitter:"264E"},shortcode:"libra",description:"LIBRA",category:"symbol"},{name:"scorpius",unicode:{apple:"264F",google:"264F",twitter:"264F"},shortcode:"scorpius",description:"SCORPIUS",category:"symbol"},{name:"sagittarius",unicode:{apple:"2650",google:"2650",twitter:"2650"},shortcode:"sagittarius",description:"SAGITTARIUS",category:"symbol"},{name:"capricorn",unicode:{apple:"2651",google:"2651",twitter:"2651"},shortcode:"capricorn",description:"CAPRICORN",category:"symbol"},{name:"aquarius",unicode:{apple:"2652",google:"2652",twitter:"2652"},shortcode:"aquarius",description:"AQUARIUS",category:"symbol"},{name:"pisces",unicode:{apple:"2653",google:"2653",twitter:"2653"},shortcode:"pisces",description:"PISCES",category:"symbol"},{name:"id",unicode:{apple:"1F194",google:"1F194",twitter:"1F194"},shortcode:"id",description:"SQUARED ID",category:"symbol"},{name:"atom_symbol",unicode:{apple:"269B",google:"269B",twitter:"269B"},shortcode:"atom_symbol",description:"ATOM SYMBOL",category:"symbol"},{name:"u7a7a",unicode:{apple:"1F233",google:"1F233",twitter:"1F233"},shortcode:"u7a7a",description:"SQUARED CJK UNIFIED IDEOGRAPH-7A7A",category:"symbol"},{name:"u5272",unicode:{apple:"1F239",google:"1F239",twitter:"1F239"},shortcode:"u5272",description:"SQUARED CJK UNIFIED IDEOGRAPH-5272",category:"symbol"},{name:"radioactive_sign",unicode:{apple:"2622",google:"2622",twitter:"2622"},shortcode:"radioactive_sign",description:"RADIOACTIVE SIGN",category:"symbol"},{name:"biohazard_sign",unicode:{apple:"2623",google:"2623",twitter:"2623"},shortcode:"biohazard_sign",description:"BIOHAZARD SIGN",category:"symbol"},{name:"mobile_phone_off",unicode:{apple:"1F4F4",google:"1F4F4",twitter:"1F4F4"},shortcode:"mobile_phone_off",description:"MOBILE PHONE OFF",category:"symbol"},{name:"vibration_mode",unicode:{apple:"1F4F3",google:"1F4F3",twitter:"1F4F3"},shortcode:"vibration_mode",description:"VIBRATION MODE",category:"symbol"},{name:"u6709",unicode:{apple:"1F236",google:"1F236",twitter:"1F236"},shortcode:"u6709",description:"SQUARED CJK UNIFIED IDEOGRAPH-6709",category:"symbol"},{name:"u7121",unicode:{apple:"1F21A",google:"1F21A",twitter:"1F21A"},shortcode:"u7121",description:"SQUARED CJK UNIFIED IDEOGRAPH-7121",category:"symbol"},{name:"u7533",unicode:{apple:"1F238",google:"1F238",twitter:"1F238"},shortcode:"u7533",description:"SQUARED CJK UNIFIED IDEOGRAPH-7533",category:"symbol"},{name:"u55b6",unicode:{apple:"1F23A",google:"1F23A",twitter:"1F23A"},shortcode:"u55b6",description:"SQUARED CJK UNIFIED IDEOGRAPH-55B6",category:"symbol"},{name:"u6708",unicode:{apple:"1F237",google:"1F237",twitter:"1F237"},shortcode:"u6708",description:"SQUARED CJK UNIFIED IDEOGRAPH-6708",category:"symbol"},{name:"eight_pointed_black_star",unicode:{apple:"2734",google:"2734",twitter:"2734"},shortcode:"eight_pointed_black_star",description:"EIGHT POINTED BLACK STAR",category:"symbol"},{name:"vs",unicode:{apple:"1F19A",google:"1F19A",twitter:"1F19A"},shortcode:"vs",description:"SQUARED VS",category:"symbol"},{name:"accept",unicode:{apple:"1F251",google:"1F251",twitter:"1F251"},shortcode:"accept",description:"CIRCLED IDEOGRAPH ACCEPT",category:"symbol"},{name:"white_flower",unicode:{apple:"1F4AE",google:"1F4AE",twitter:"1F4AE"},shortcode:"white_flower",description:"WHITE FLOWER",category:"symbol"},{name:"ideograph_advantage",unicode:{apple:"1F250",google:"1F250",twitter:"1F250"},shortcode:"ideograph_advantage",description:"CIRCLED IDEOGRAPH ADVANTAGE",category:"symbol"},{name:"secret",unicode:{apple:"3299",google:"3299",twitter:"3299"},shortcode:"secret",description:"CIRCLED IDEOGRAPH SECRET",category:"symbol"},{name:"congratulations",unicode:{apple:"3297",google:"3297",twitter:"3297"},shortcode:"congratulations",description:"CIRCLED IDEOGRAPH CONGRATULATION",category:"symbol"},{name:"u5408",unicode:{apple:"1F234",google:"1F234",twitter:"1F234"},shortcode:"u5408",description:"SQUARED CJK UNIFIED IDEOGRAPH-5408",category:"symbol"},{name:"u6e80",unicode:{apple:"1F235",google:"1F235",twitter:"1F235"},shortcode:"u6e80",description:"SQUARED CJK UNIFIED IDEOGRAPH-6E80",category:"symbol"},{name:"u7981",unicode:{apple:"1F232",google:"1F232",twitter:"1F232"},shortcode:"u7981",description:"SQUARED CJK UNIFIED IDEOGRAPH-7981",category:"symbol"},{name:"a",unicode:{apple:"1F170",google:"1F170",twitter:"1F170"},shortcode:"a",description:"NEGATIVE SQUARED LATIN CAPITAL LETTER A",category:"symbol"},{name:"b",unicode:{apple:"1F171",google:"1F171",twitter:"1F171"},shortcode:"b",description:"NEGATIVE SQUARED LATIN CAPITAL LETTER B",category:"symbol"},{name:"ab",unicode:{apple:"1F18E",google:"1F18E",twitter:"1F18E"},shortcode:"ab",description:"NEGATIVE SQUARED AB",category:"symbol"},{name:"cl",unicode:{apple:"1F191",google:"1F191",twitter:"1F191"},shortcode:"cl",description:"SQUARED CL",category:"symbol"},{name:"o2",unicode:{apple:"1F17E",google:"1F17E",twitter:"1F17E"},shortcode:"o2",description:"NEGATIVE SQUARED LATIN CAPITAL LETTER O",category:"symbol"},{name:"sos",unicode:{apple:"1F198",google:"1F198",twitter:"1F198"},shortcode:"sos",description:"SQUARED SOS",category:"symbol"},{name:"no_entry",unicode:{apple:"26D4",google:"26D4",twitter:"26D4"},shortcode:"no_entry",description:"NO ENTRY",category:"symbol"},{name:"name_badge",unicode:{apple:"1F4DB",google:"1F4DB",twitter:"1F4DB"},shortcode:"name_badge",description:"NAME BADGE",category:"symbol"},{name:"no_entry_sign",unicode:{apple:"1F6AB",google:"1F6AB",twitter:"1F6AB"},shortcode:"no_entry_sign",description:"NO ENTRY SIGN",category:"symbol"},{name:"x",unicode:{apple:"274C",google:"274C",twitter:"274C"},shortcode:"x",description:"CROSS MARK",category:"symbol"},{name:"o",unicode:{apple:"2B55",google:"2B55",twitter:"2B55"},shortcode:"o",description:"HEAVY LARGE CIRCLE",category:"symbol"},{name:"anger",unicode:{apple:"1F4A2",google:"1F4A2",twitter:"1F4A2"},shortcode:"anger",description:"ANGER SYMBOL",category:"symbol"},{name:"hotsprings",unicode:{apple:"2668",google:"2668",twitter:"2668"},shortcode:"hotsprings",description:"HOT SPRINGS",category:"symbol"},{name:"no_pedestrians",unicode:{apple:"1F6B7",google:"1F6B7",twitter:"1F6B7"},shortcode:"no_pedestrians",description:"NO PEDESTRIANS",category:"symbol"},{name:"do_not_litter",unicode:{apple:"1F6AF",google:"1F6AF",twitter:"1F6AF"},shortcode:"do_not_litter",description:"DO NOT LITTER SYMBOL",category:"symbol"},{name:"no_bicycles",unicode:{apple:"1F6B3",google:"1F6B3",twitter:"1F6B3"},shortcode:"no_bicycles",description:"NO BICYCLES",category:"symbol"},{name:"non-potable_water",unicode:{apple:"1F6B1",google:"1F6B1",twitter:"1F6B1"},shortcode:"non-potable_water",description:"NON-POTABLE WATER SYMBOL",category:"symbol"},{name:"underage",unicode:{apple:"1F51E",google:"1F51E",twitter:"1F51E"},shortcode:"underage",description:"NO ONE UNDER EIGHTEEN SYMBOL",category:"symbol"},{name:"no_mobile_phones",unicode:{apple:"1F4F5",google:"1F4F5",twitter:"1F4F5"},shortcode:"no_mobile_phones",description:"NO MOBILE PHONES",category:"symbol"},{name:"no_smoking",unicode:{apple:"1F6AD",google:"1F6AD",twitter:"1F6AD"},shortcode:"no_smoking",description:"NO SMOKING SYMBOL",category:"symbol"},{name:"exclamation",unicode:{apple:"2757",google:"2757",twitter:"2757"},shortcode:"exclamation",description:"HEAVY EXCLAMATION MARK SYMBOL",category:"symbol"},{name:"grey_exclamation",unicode:{apple:"2755",google:"2755",twitter:"2755"},shortcode:"grey_exclamation",description:"WHITE EXCLAMATION MARK ORNAMENT",category:"symbol"},{name:"question",unicode:{apple:"2753",google:"2753",twitter:"2753"},shortcode:"question",description:"BLACK QUESTION MARK ORNAMENT",category:"symbol"},{name:"grey_question",unicode:{apple:"2754",google:"2754",twitter:"2754"},shortcode:"grey_question",description:"WHITE QUESTION MARK ORNAMENT",category:"symbol"},{name:"bangbang",unicode:{apple:"203C",google:"203C",twitter:"203C"},shortcode:"bangbang",description:"DOUBLE EXCLAMATION MARK",category:"symbol"},{name:"interrobang",unicode:{apple:"2049",google:"2049",twitter:"2049"},shortcode:"interrobang",description:"EXCLAMATION QUESTION MARK",category:"symbol"},{name:"100",unicode:{apple:"1F4AF",google:"1F4AF",twitter:"1F4AF"},shortcode:"100",description:"HUNDRED POINTS SYMBOL",category:"symbol"},{name:"low_brightness",unicode:{apple:"1F505",google:"1F505",twitter:"1F505"},shortcode:"low_brightness",description:"LOW BRIGHTNESS SYMBOL",category:"symbol"},{name:"high_brightness",unicode:{apple:"1F506",google:"1F506",twitter:"1F506"},shortcode:"high_brightness",description:"HIGH BRIGHTNESS SYMBOL",category:"symbol"},{name:"trident",unicode:{apple:"1F531",google:"1F531",twitter:"1F531"},shortcode:"trident",description:"TRIDENT EMBLEM",category:"symbol"},{name:"fleur_de_lis",unicode:{apple:"269C",google:"269C",twitter:"269C"},shortcode:"fleur_de_lis",description:"FLEUR-DE-LIS",category:"symbol"},{name:"part_alternation_mark",unicode:{apple:"303D",google:"303D",twitter:"303D"},shortcode:"part_alternation_mark",description:"PART ALTERNATION MARK",category:"symbol"},{name:"warning",unicode:{apple:"26A0",google:"26A0",twitter:"26A0"},shortcode:"warning",description:"WARNING SIGN",category:"symbol"},{name:"children_crossing",unicode:{apple:"1F6B8",google:"1F6B8",twitter:"1F6B8"},shortcode:"children_crossing",description:"CHILDREN CROSSING",category:"symbol"},{name:"beginner",unicode:{apple:"1F530",google:"1F530",twitter:"1F530"},shortcode:"beginner",description:"JAPANESE SYMBOL FOR BEGINNER",category:"symbol"},{name:"recycle",unicode:{apple:"267B",google:"267B",twitter:"267B"},shortcode:"recycle",description:"BLACK UNIVERSAL RECYCLING SYMBOL",category:"symbol"},{name:"u6307",unicode:{apple:"1F22F",google:"1F22F",twitter:"1F22F"},shortcode:"u6307",description:"SQUARED CJK UNIFIED IDEOGRAPH-6307",category:"symbol"},{name:"chart",unicode:{apple:"1F4B9",google:"1F4B9",twitter:"1F4B9"},shortcode:"chart",description:"CHART WITH UPWARDS TREND AND YEN SIGN",category:"symbol"},{name:"sparkle",unicode:{apple:"2747",google:"2747",twitter:"2747"},shortcode:"sparkle",description:"SPARKLE",category:"symbol"},{name:"eight_spoked_asterisk",unicode:{apple:"2733-FE0F",google:"2733-FE0F",twitter:"2733-FE0F"},shortcode:"eight_spoked_asterisk",description:"EIGHT SPOKED ASTERISK",category:"symbol"},{name:"negative_squared_cross_mark",unicode:{apple:"274E",google:"274E",twitter:"274E"},shortcode:"negative_squared_cross_mark",description:"NEGATIVE SQUARED CROSS MARK",category:"symbol"},{name:"white_check_mark",unicode:{apple:"2705",google:"2705",twitter:"2705"},shortcode:"white_check_mark",description:"WHITE HEAVY CHECK MARK",category:"symbol"},{name:"diamond_shape_with_a_dot_inside",unicode:{apple:"1F4A0",google:"1F4A0",twitter:"1F4A0"},shortcode:"diamond_shape_with_a_dot_inside",description:"DIAMOND SHAPE WITH A DOT INSIDE",category:"symbol"},{name:"cyclone",unicode:{apple:"1F300",google:"1F300",twitter:"1F300"},shortcode:"cyclone",description:"CYCLONE",category:"symbol"},{name:"loop",unicode:{apple:"27BF",google:"27BF",twitter:"27BF"},shortcode:"loop",description:"DOUBLE CURLY LOOP",category:"symbol"},{name:"globe_with_meridians",unicode:{apple:"1F310",google:"1F310",twitter:"1F310"},shortcode:"globe_with_meridians",description:"GLOBE WITH MERIDIANS",category:"symbol"},{name:"m",unicode:{apple:"24C2",google:"24C2",twitter:"24C2"},shortcode:"m",description:"CIRCLED LATIN CAPITAL LETTER M",category:"symbol"},{name:"atm",unicode:{apple:"1F3E7",google:"1F3E7",twitter:"1F3E7"},shortcode:"atm",description:"AUTOMATED TELLER MACHINE",category:"symbol"},{name:"sa",unicode:{apple:"1F202",google:"1F202",twitter:"1F202"},shortcode:"sa",description:"SQUARED KATAKANA SA",category:"symbol"},{name:"passport_control",unicode:{apple:"1F6C2",google:"1F6C2",twitter:"1F6C2"},shortcode:"passport_control",description:"PASSPORT CONTROL",category:"symbol"},{name:"customs",unicode:{apple:"1F6C3",google:"1F6C3",twitter:"1F6C3"},shortcode:"customs",description:"CUSTOMS",category:"symbol"},{name:"baggage_claim",unicode:{apple:"1F6C4",google:"1F6C4",twitter:"1F6C4"},shortcode:"baggage_claim",description:"BAGGAGE CLAIM",category:"symbol"},{name:"left_luggage",unicode:{apple:"1F6C5",google:"1F6C5",twitter:"1F6C5"},shortcode:"left_luggage",description:"LEFT LUGGAGE",category:"symbol"},{name:"wheelchair",unicode:{apple:"267F",google:"267F",twitter:"267F"},shortcode:"wheelchair",description:"WHEELCHAIR SYMBOL",category:"symbol"},{name:"wc",unicode:{apple:"1F6BE",google:"1F6BE",twitter:"1F6BE"},shortcode:"wc",description:"WATER CLOSET",category:"symbol"},{name:"parking",unicode:{apple:"1F17F",google:"1F17F",twitter:"1F17F"},shortcode:"parking",description:"NEGATIVE SQUARED LATIN CAPITAL LETTER P",category:"symbol"},{name:"potable_water",unicode:{apple:"1F6B0",google:"1F6B0",twitter:"1F6B0"},shortcode:"potable_water",description:"POTABLE WATER SYMBOL",category:"symbol"},{name:"mens",unicode:{apple:"1F6B9",google:"1F6B9",twitter:"1F6B9"},shortcode:"mens",description:"MENS SYMBOL",category:"symbol"},{name:"womens",unicode:{apple:"1F6BA",google:"1F6BA",twitter:"1F6BA"},shortcode:"womens",description:"WOMENS SYMBOL",category:"symbol"},{name:"baby_symbol",unicode:{apple:"1F6BC",google:"1F6BC",twitter:"1F6BC"},shortcode:"baby_symbol",description:"BABY SYMBOL",category:"symbol"},{name:"restroom",unicode:{apple:"1F6BB",google:"1F6BB",twitter:"1F6BB"},shortcode:"restroom",description:"RESTROOM",category:"symbol"},{name:"put_litter_in_its_place",unicode:{apple:"1F6AE",google:"1F6AE",twitter:"1F6AE"},shortcode:"put_litter_in_its_place",description:"PUT LITTER IN ITS PLACE SYMBOL",category:"symbol"},{name:"cinema",unicode:{apple:"1F3A6",google:"1F3A6",twitter:"1F3A6"},shortcode:"cinema",description:"CINEMA",category:"symbol"},{name:"signal_strength",unicode:{apple:"1F4F6",google:"1F4F6",twitter:"1F4F6"},shortcode:"signal_strength",description:"ANTENNA WITH BARS",category:"symbol"},{name:"koko",unicode:{apple:"1F201",google:"1F201",twitter:"1F201"},shortcode:"koko",description:"SQUARED KATAKANA KOKO",category:"symbol"},{name:"ng",unicode:{apple:"1F196",google:"1F196",twitter:"1F196"},shortcode:"ng",description:"SQUARED NG",category:"symbol"},{name:"ok",unicode:{apple:"1F197",google:"1F197",twitter:"1F197"},shortcode:"ok",description:"SQUARED OK",category:"symbol"},{name:"up",unicode:{apple:"1F199",google:"1F199",twitter:"1F199"},shortcode:"up",description:"SQUARED UP WITH EXCLAMATION MARK",category:"symbol"},{name:"cool",unicode:{apple:"1F192",google:"1F192",twitter:"1F192"},shortcode:"cool",description:"SQUARED COOL",category:"symbol"},{name:"new",unicode:{apple:"1F195",google:"1F195",twitter:"1F195"},shortcode:"new",description:"SQUARED NEW",category:"symbol"},{name:"free",unicode:{apple:"1F193",google:"1F193",twitter:"1F193"},shortcode:"free",description:"SQUARED FREE",category:"symbol"},{name:"zero",unicode:{apple:"0030-20E3",google:"0030-20E3",twitter:"0030-20E3"},shortcode:"zero",description:"KEYCAP 0",category:"symbol"},{name:"one",unicode:{apple:"0031-20E3",google:"0031-20E3",twitter:"0031-20E3"},shortcode:"one",description:"KEYCAP 1",category:"symbol"},{name:"two",unicode:{apple:"0032-20E3",google:"0032-20E3",twitter:"0032-20E3"},shortcode:"two",description:"KEYCAP 2",category:"symbol"},{name:"three",unicode:{apple:"0033-20E3",google:"0033-20E3",twitter:"0033-20E3"},shortcode:"three",description:"KEYCAP 3",category:"symbol"},{name:"four",unicode:{apple:"0034-20E3",google:"0034-20E3",twitter:"0034-20E3"},shortcode:"four",description:"KEYCAP 4",category:"symbol"},{name:"five",unicode:{apple:"0035-20E3",google:"0035-20E3",twitter:"0035-20E3"},shortcode:"five",description:"KEYCAP 5",category:"symbol"},{name:"six",unicode:{apple:"0036-20E3",google:"0036-20E3",twitter:"0036-20E3"},shortcode:"six",description:"KEYCAP 6",category:"symbol"},{name:"seven",unicode:{apple:"0037-20E3",google:"0037-20E3",twitter:"0037-20E3"},shortcode:"seven",description:"KEYCAP 7",category:"symbol"},{name:"eight",unicode:{apple:"0038-20E3",google:"0038-20E3",twitter:"0038-20E3"},shortcode:"eight",description:"KEYCAP 8",category:"symbol"},{name:"nine",unicode:{apple:"0039-20E3",google:"0039-20E3",twitter:"0039-20E3"},shortcode:"nine",description:"KEYCAP 9",category:"symbol"},{name:"keycap_ten",unicode:{apple:"1F51F",google:"1F51F",twitter:"1F51F"},shortcode:"keycap_ten",description:"KEYCAP TEN",category:"symbol"},{name:"1234",unicode:{apple:"1F522",google:"1F522",twitter:"1F522"},shortcode:"1234",description:"INPUT SYMBOL FOR NUMBERS",category:"symbol"},{name:"arrow_forward",unicode:{apple:"25B6",google:"25B6",twitter:"25B6"},shortcode:"arrow_forward",description:"BLACK RIGHT-POINTING TRIANGLE",category:"symbol"},{name:"double_vertical_bar",unicode:{apple:"23F8",google:"23F8",twitter:"23F8"},shortcode:"double_vertical_bar",description:"DOUBLE VERTICAL BAR"},{name:"black_right_pointing_triangle_with_double_vertical_bar",unicode:{apple:"23EF",google:"23EF",twitter:"23EF"},shortcode:"black_right_pointing_triangle_with_double_vertical_bar",description:"BLACK RIGHT-POINTING TRIANGLE WITH DOUBLE VERTICAL BAR"},{name:"black_square_for_stop",unicode:{apple:"23F9",google:"23F9",twitter:"23F9"},shortcode:"black_square_for_stop",description:"BLACK SQUARE FOR STOP"},{name:"black_circle_for_record",unicode:{apple:"23FA",google:"23FA",twitter:"23FA"},shortcode:"black_circle_for_record",description:"BLACK CIRCLE FOR RECORD"},{name:"black_right_pointing_double_triangle_with_vertical_bar",unicode:{apple:"23ED",google:"23ED",twitter:"23ED"},shortcode:"black_right_pointing_double_triangle_with_vertical_bar",description:"BLACK RIGHT-POINTING DOUBLE TRIANGLE WITH VERTICAL BAR"},{name:"black_left_pointing_double_triangle_with_vertical_bar",unicode:{apple:"23EE",google:"23EE",twitter:"23EE"},shortcode:"black_left_pointing_double_triangle_with_vertical_bar",description:"BLACK LEFT-POINTING DOUBLE TRIANGLE WITH VERTICAL BAR"},{name:"fast_forward",unicode:{apple:"23E9",google:"23E9",twitter:"23E9"},shortcode:"fast_forward",description:"BLACK RIGHT-POINTING DOUBLE TRIANGLE"},{name:"rewind",unicode:{apple:"23EA",google:"23EA",twitter:"23EA"},shortcode:"rewind",description:"BLACK LEFT-POINTING DOUBLE TRIANGLE",category:"symbol"},{name:"twisted_rightwards_arrows",unicode:{apple:"1F500",google:"1F500",twitter:"1F500"},shortcode:"twisted_rightwards_arrows",description:"TWISTED RIGHTWARDS ARROWS",category:"symbol"},{name:"repeat",unicode:{apple:"1F501",google:"1F501",twitter:"1F501"},shortcode:"repeat",description:"CLOCKWISE RIGHTWARDS AND LEFTWARDS OPEN CIRCLE ARROWS",category:"symbol"},{name:"repeat_one",unicode:{apple:"1F502",google:"1F502",twitter:"1F502"},shortcode:"repeat_one",description:"CLOCKWISE RIGHTWARDS AND LEFTWARDS OPEN CIRCLE ARROWS WITH CIRCLED ONE OVERLAY",category:"symbol"},{name:"arrow_backward",unicode:{apple:"25C0",google:"25C0",twitter:"25C0"},shortcode:"arrow_backward",description:"BLACK LEFT-POINTING TRIANGLE",category:"symbol"},{name:"arrow_up_small",unicode:{apple:"1F53C",google:"1F53C",twitter:"1F53C"},shortcode:"arrow_up_small",description:"UP-POINTING SMALL RED TRIANGLE",category:"symbol"},{name:"arrow_down_small",unicode:{apple:"1F53D",google:"1F53D",twitter:"1F53D"},shortcode:"arrow_down_small",description:"DOWN-POINTING SMALL RED TRIANGLE",category:"symbol"},{name:"arrow_double_up",unicode:{apple:"23EB",google:"23EB",twitter:"23EB"},shortcode:"arrow_double_up",description:"BLACK UP-POINTING DOUBLE TRIANGLE",category:"symbol"},{name:"arrow_double_down",unicode:{apple:"23EC",google:"23EC",twitter:"23EC"},shortcode:"arrow_double_down",description:"BLACK DOWN-POINTING DOUBLE TRIANGLE",category:"symbol"},{name:"arrow_right",unicode:{apple:"27A1",google:"27A1",twitter:"27A1"},shortcode:"arrow_right",description:"BLACK RIGHTWARDS ARROW",category:"symbol"},{name:"arrow_left",unicode:{apple:"2B05",google:"2B05",twitter:"2B05"},shortcode:"arrow_left",description:"LEFTWARDS BLACK ARROW",category:"symbol"},{name:"arrow_up",unicode:{apple:"2B06",google:"2B06",twitter:"2B06"},shortcode:"arrow_up",description:"UPWARDS BLACK ARROW",category:"symbol"},{name:"arrow_down",unicode:{apple:"2B07",google:"2B07",twitter:"2B07"},shortcode:"arrow_down",description:"DOWNWARDS BLACK ARROW",category:"symbol"},{name:"arrow_upper_right",unicode:{apple:"2197",google:"2197",twitter:"2197"},shortcode:"arrow_upper_right",description:"NORTH EAST ARROW",category:"symbol"},{name:"arrow_lower_right",unicode:{apple:"2198",google:"2198",twitter:"2198"},shortcode:"arrow_lower_right",description:"SOUTH EAST ARROW",category:"symbol"},{name:"arrow_lower_left",unicode:{apple:"2199",google:"2199",twitter:"2199"},shortcode:"arrow_lower_left",description:"SOUTH WEST ARROW",category:"symbol"},{name:"arrow_upper_left",unicode:{apple:"2196",google:"2196",twitter:"2196"},shortcode:"arrow_upper_left",description:"NORTH WEST ARROW",category:"symbol"},{name:"arrow_up_down",unicode:{apple:"2195",google:"2195",twitter:"2195"},shortcode:"arrow_up_down",description:"UP DOWN ARROW",category:"symbol"},{name:"left_right_arrow",unicode:{apple:"2194",google:"2194",twitter:"2194"},shortcode:"left_right_arrow",description:"LEFT RIGHT ARROW",category:"symbol"},{name:"arrows_counterclockwise",unicode:{apple:"1F504",google:"1F504",twitter:"1F504"},shortcode:"arrows_counterclockwise",description:"ANTICLOCKWISE DOWNWARDS AND UPWARDS OPEN CIRCLE ARROWS",category:"symbol"},{name:"arrow_right_hook",unicode:{apple:"21AA",google:"21AA",twitter:"21AA"},shortcode:"arrow_right_hook",description:"RIGHTWARDS ARROW WITH HOOK",category:"symbol"},{name:"leftwards_arrow_with_hook",unicode:{apple:"21A9",google:"21A9",twitter:"21A9"},shortcode:"leftwards_arrow_with_hook",description:"LEFTWARDS ARROW WITH HOOK",category:"symbol"},{name:"arrow_heading_up",unicode:{apple:"2934",google:"2934",twitter:"2934"},shortcode:"arrow_heading_up",description:"ARROW POINTING RIGHTWARDS THEN CURVING UPWARDS",category:"symbol"},{name:"arrow_heading_down",unicode:{apple:"2935",google:"2935",twitter:"2935"},shortcode:"arrow_heading_down",description:"ARROW POINTING RIGHTWARDS THEN CURVING DOWNWARDS",category:"symbol"},{name:"arrows_clockwise",unicode:{apple:"1F503",google:"1F503",twitter:"1F503"},shortcode:"arrows_clockwise",description:"CLOCKWISE DOWNWARDS AND UPWARDS OPEN CIRCLE ARROWS",category:"symbol"},{name:"hash",unicode:{apple:"0023-20E3",google:"0023-20E3",twitter:"0023-20E3"},shortcode:"hash",description:"HASH KEY",category:"symbol"},{name:"information_source",unicode:{apple:"2139",google:"2139",twitter:"2139"},shortcode:"information_source",description:"INFORMATION SOURCE",category:"symbol"},{name:"abc",unicode:{apple:"1F524",google:"1F524",twitter:"1F524"},shortcode:"abc",description:"INPUT SYMBOL FOR LATIN LETTERS",category:"symbol"},{name:"abcd",unicode:{apple:"1F521",google:"1F521",twitter:"1F521"},shortcode:"abcd",description:"INPUT SYMBOL FOR LATIN SMALL LETTERS",category:"symbol"},{name:"capital_abcd",unicode:{apple:"1F520",google:"1F520",twitter:"1F520"},shortcode:"capital_abcd",description:"INPUT SYMBOL FOR LATIN CAPITAL LETTERS",category:"symbol"},{name:"symbols",unicode:{apple:"1F523",google:"1F523",twitter:"1F523"},shortcode:"symbols",description:"INPUT SYMBOL FOR SYMBOLS",category:"symbol"},{name:"musical_note",unicode:{apple:"1F3B5",google:"1F3B5",twitter:"1F3B5"},shortcode:"musical_note",description:"MUSICAL NOTE",category:"symbol"},{name:"notes",unicode:{apple:"1F3B6",google:"1F3B6",twitter:"1F3B6"},shortcode:"notes",description:"MULTIPLE MUSICAL NOTES",category:"symbol"},{name:"wavy_dash",unicode:{apple:"3030",google:"3030",twitter:"3030"},shortcode:"wavy_dash",description:"WAVY DASH",category:"symbol"},{name:"curly_loop",unicode:{apple:"27B0",google:"27B0",twitter:"27B0"},shortcode:"curly_loop",description:"CURLY LOOP",category:"symbol"},{name:"heavy_check_mark",unicode:{apple:"2714",google:"2714",twitter:"2714"},shortcode:"heavy_check_mark",description:"HEAVY CHECK MARK",category:"symbol"},{name:"heavy_plus_sign",unicode:{apple:"2795",google:"2795",twitter:"2795"},shortcode:"heavy_plus_sign",description:"HEAVY PLUS SIGN",category:"symbol"},{name:"heavy_minus_sign",unicode:{apple:"2796",google:"2796",twitter:"2796"},shortcode:"heavy_minus_sign",description:"HEAVY MINUS SIGN",category:"symbol"},{name:"heavy_multiplication_x",unicode:{apple:"2716",google:"2716",twitter:"2716"},shortcode:"heavy_multiplication_x",description:"HEAVY MULTIPLICATION X",category:"symbol"},{name:"heavy_division_sign",unicode:{apple:"2797",google:"2797",twitter:"2797"},shortcode:"heavy_division_sign",description:"HEAVY DIVISION SIGN",category:"symbol"},{name:"heavy_dollar_sign",unicode:{apple:"1F4B2",google:"1F4B2",twitter:"1F4B2"},shortcode:"heavy_dollar_sign",description:"HEAVY DOLLAR SIGN",category:"symbol"},{name:"copyright",unicode:{apple:"00A9",google:"00A9-FE0F",twitter:"00A9-FE0F"},shortcode:"copyright",description:"COPYRIGHT SIGN",category:"symbol"},{name:"registered",unicode:{apple:"00AE",google:"00AE-FE0F",twitter:"00AE-FE0F"},shortcode:"registered",description:"REGISTERED SIGN",category:"symbol"},{name:"tm",unicode:{apple:"2122",google:"2122",twitter:"2122"},shortcode:"tm",description:"TRADE MARK SIGN",category:"symbol"},{name:"end",unicode:{apple:"1F51A",google:"1F51A",twitter:"1F51A"},shortcode:"end",description:"END WITH LEFTWARDS ARROW ABOVE",category:"symbol"},{name:"back",unicode:{apple:"1F519",google:"1F519",twitter:"1F519"},shortcode:"back",description:"BACK WITH LEFTWARDS ARROW ABOVE",category:"symbol"},{name:"on",unicode:{apple:"1F51B",google:"1F51B",twitter:"1F51B"},shortcode:"on",description:"ON WITH EXCLAMATION MARK WITH LEFT RIGHT ARROW ABOVE",category:"symbol"},{name:"top",unicode:{apple:"1F51D",google:"1F51D",twitter:"1F51D"},shortcode:"top",description:"TOP WITH UPWARDS ARROW ABOVE",category:"symbol"},{name:"soon",unicode:{apple:"1F51C",google:"1F51C",twitter:"1F51C"},shortcode:"soon",description:"SOON WITH RIGHTWARDS ARROW ABOVE",category:"symbol"},{name:"ballot_box_with_check",unicode:{apple:"2611",google:"2611",twitter:"2611"},shortcode:"ballot_box_with_check",description:"BALLOT BOX WITH CHECK",category:"symbol"},{name:"radio_button",unicode:{apple:"1F518",google:"1F518",twitter:"1F518"},shortcode:"radio_button",description:"RADIO BUTTON",category:"symbol"},{name:"white_circle",unicode:{apple:"26AA",google:"26AA",twitter:"26AA"},shortcode:"white_circle",description:"MEDIUM WHITE CIRCLE",category:"symbol"},{name:"black_circle",unicode:{apple:"26AB",google:"26AB",twitter:"26AB"},shortcode:"black_circle",description:"MEDIUM BLACK CIRCLE",category:"symbol"},{name:"red_circle",unicode:{apple:"1F534",google:"1F534",twitter:"1F534"},shortcode:"red_circle",description:"LARGE RED CIRCLE",category:"symbol"},{name:"large_blue_circle",unicode:{apple:"1F535",google:"1F535",twitter:"1F535"},shortcode:"large_blue_circle",description:"LARGE BLUE CIRCLE",category:"symbol"},{name:"small_orange_diamond",unicode:{apple:"1F538",google:"1F538",twitter:"1F538"},shortcode:"small_orange_diamond",description:"SMALL ORANGE DIAMOND",category:"symbol"},{name:"small_blue_diamond",unicode:{apple:"1F539",google:"1F539",twitter:"1F539"},shortcode:"small_blue_diamond",description:"SMALL BLUE DIAMOND",category:"symbol"},{name:"large_orange_diamond",unicode:{apple:"1F536",google:"1F536",twitter:"1F536"},shortcode:"large_orange_diamond",description:"LARGE ORANGE DIAMOND",category:"symbol"},{name:"large_blue_diamond",unicode:{apple:"1F537",google:"1F537",twitter:"1F537"},shortcode:"large_blue_diamond",description:"LARGE BLUE DIAMOND",category:"symbol"},{name:"small_red_triangle",unicode:{apple:"1F53A",google:"1F53A",twitter:"1F53A"},shortcode:"small_red_triangle",description:"UP-POINTING RED TRIANGLE",category:"symbol"},{name:"black_small_square",unicode:{apple:"25AA",google:"25AA",twitter:"25AA"},shortcode:"black_small_square",description:"BLACK SMALL SQUARE",category:"symbol"},{name:"white_small_square",unicode:{apple:"25AB",google:"25AB",twitter:"25AB"},shortcode:"white_small_square",description:"WHITE SMALL SQUARE",category:"symbol"},{name:"black_large_square",unicode:{apple:"2B1B",google:"2B1B",twitter:"2B1B"},shortcode:"black_large_square",description:"BLACK LARGE SQUARE",category:"symbol"},{name:"white_large_square",unicode:{apple:"2B1C",google:"2B1C",twitter:"2B1C"},shortcode:"white_large_square",description:"WHITE LARGE SQUARE",category:"symbol"},{name:"small_red_triangle_down",unicode:{apple:"1F53B",google:"1F53B",twitter:"1F53B"},shortcode:"small_red_triangle_down",description:"DOWN-POINTING RED TRIANGLE",category:"symbol"},{name:"black_medium_square",unicode:{apple:"25FC",google:"25FC",twitter:"25FC"},shortcode:"black_medium_square",description:"BLACK MEDIUM SQUARE",category:"symbol"},{name:"white_medium_square",unicode:{apple:"25FB",google:"25FB",twitter:"25FB"},shortcode:"white_medium_square",description:"WHITE MEDIUM SQUARE",category:"symbol"},{name:"black_medium_small_square",unicode:{apple:"25FE",google:"25FE",twitter:"25FE"},shortcode:"black_medium_small_square",description:"BLACK MEDIUM SMALL SQUARE",category:"symbol"},{name:"white_medium_small_square",unicode:{apple:"25FD",google:"25FD",twitter:"25FD"},shortcode:"white_medium_small_square",description:"WHITE MEDIUM SMALL SQUARE",category:"symbol"},{name:"black_square_button",unicode:{apple:"1F532",google:"1F532",twitter:"1F532"},shortcode:"black_square_button",description:"BLACK SQUARE BUTTON",category:"symbol"},{name:"white_square_button",unicode:{apple:"1F533",google:"1F533",twitter:"1F533"},shortcode:"white_square_button",description:"WHITE SQUARE BUTTON",category:"symbol"},{name:"speaker",unicode:{apple:"1F508",google:"1F508",twitter:"1F508"},shortcode:"speaker",description:"SPEAKER",category:"symbol"},{name:"sound",unicode:{apple:"1F509",google:"1F509",twitter:"1F509"},shortcode:"sound",description:"SPEAKER WITH ONE SOUND WAVE",category:"symbol"},{name:"loud_sound",unicode:{apple:"1F50A",google:"1F50A",twitter:"1F50A"},shortcode:"loud_sound",description:"SPEAKER WITH THREE SOUND WAVES",category:"symbol"},{name:"mute",unicode:{apple:"1F507",google:"1F507",twitter:"1F507"},shortcode:"mute",description:"SPEAKER WITH CANCELLATION STROKE",category:"symbol"},{name:"mega",unicode:{apple:"1F4E3",google:"1F4E3",twitter:"1F4E3"},shortcode:"mega",description:"CHEERING MEGAPHONE",category:"symbol"},{name:"loudspeaker",unicode:{apple:"1F4E2",google:"1F4E2",twitter:"1F4E2"},shortcode:"loudspeaker",description:"PUBLIC ADDRESS LOUDSPEAKER",category:"symbol"},{name:"bell",unicode:{apple:"1F514",google:"1F514",twitter:"1F514"},shortcode:"bell",description:"BELL",category:"symbol"},{name:"no_bell",unicode:{apple:"1F515",google:"1F515",twitter:"1F515"},shortcode:"no_bell",description:"BELL WITH CANCELLATION STROKE",category:"symbol"},{name:"black_joker",unicode:{apple:"1F0CF",google:"1F0CF",twitter:"1F0CF"},shortcode:"black_joker",description:"PLAYING CARD BLACK JOKER",category:"symbol"},{name:"mahjong",unicode:{apple:"1F004",google:"1F004",twitter:"1F004"},shortcode:"mahjong",description:"MAHJONG TILE RED DRAGON",category:"symbol"},{name:"spades",unicode:{apple:"2660",google:"2660",twitter:"2660"},shortcode:"spades",description:"BLACK SPADE SUIT",category:"symbol"},{name:"clubs",unicode:{apple:"2663",google:"2663",twitter:"2663"},shortcode:"clubs",description:"BLACK CLUB SUIT",category:"symbol"},{name:"hearts",unicode:{apple:"2665",google:"2665",twitter:"2665"},shortcode:"hearts",description:"BLACK HEART SUIT",category:"symbol"},{name:"diamonds",unicode:{apple:"2666",google:"2666",twitter:"2666"},shortcode:"diamonds",description:"BLACK DIAMOND SUIT",category:"symbol"},{name:"flower_playing_cards",unicode:{apple:"1F3B4",google:"1F3B4",twitter:"1F3B4"},shortcode:"flower_playing_cards",description:"FLOWER PLAYING CARDS",category:"symbol"},{name:"thought_balloon",unicode:{apple:"1F4AD",google:"1F4AD",twitter:"1F4AD"},shortcode:"thought_balloon",description:"THOUGHT BALLOON",category:"symbol"},{name:"right_anger_bubble",unicode:{apple:"1F5EF",google:"1F5EF",twitter:"1F5EF"},shortcode:"right_anger_bubble",description:"RIGHT ANGER BUBBLE"},{name:"speech_balloon",unicode:{apple:"1F4AC",google:"1F4AC",twitter:"1F4AC"},shortcode:"speech_balloon",description:"SPEECH BALLOON",category:"symbol"},{name:"left_speech_bubble",unicode:{apple:"1F5E8",google:"1F5E8",twitter:"1F5E8"},shortcode:"left_speech_bubble",description:"LEFT SPEECH BUBBLE"},{name:"clock1",unicode:{apple:"1F550",google:"1F550",twitter:"1F550"},shortcode:"clock1",description:"CLOCK FACE ONE OCLOCK",category:"symbol"},{name:"clock2",unicode:{apple:"1F551",google:"1F551",twitter:"1F551"},shortcode:"clock2",description:"CLOCK FACE TWO OCLOCK",category:"symbol"},{name:"clock3",unicode:{apple:"1F552",google:"1F552",twitter:"1F552"},shortcode:"clock3",description:"CLOCK FACE THREE OCLOCK",category:"symbol"},{name:"clock4",unicode:{apple:"1F553",google:"1F553",twitter:"1F553"},shortcode:"clock4",description:"CLOCK FACE FOUR OCLOCK",category:"symbol"},{name:"clock5",unicode:{apple:"1F554",google:"1F554",twitter:"1F554"},shortcode:"clock5",description:"CLOCK FACE FIVE OCLOCK",category:"symbol"},{name:"clock6",unicode:{apple:"1F555",google:"1F555",twitter:"1F555"},shortcode:"clock6",description:"CLOCK FACE SIX OCLOCK",category:"symbol"},{name:"clock7",unicode:{apple:"1F556",google:"1F556",twitter:"1F556"},shortcode:"clock7",description:"CLOCK FACE SEVEN OCLOCK",category:"symbol"},{name:"clock8",unicode:{apple:"1F557",google:"1F557",twitter:"1F557"},shortcode:"clock8",description:"CLOCK FACE EIGHT OCLOCK",category:"symbol"},{name:"clock9",unicode:{apple:"1F558",google:"1F558",twitter:"1F558"},shortcode:"clock9",description:"CLOCK FACE NINE OCLOCK",category:"symbol"},{name:"clock10",unicode:{apple:"1F559",google:"1F559",twitter:"1F559"},shortcode:"clock10",description:"CLOCK FACE TEN OCLOCK",category:"symbol"},{name:"clock11",unicode:{apple:"1F55A",google:"1F55A",twitter:"1F55A"},shortcode:"clock11",description:"CLOCK FACE ELEVEN OCLOCK",category:"symbol"},{name:"clock12",unicode:{apple:"1F55B",google:"1F55B",twitter:"1F55B"},shortcode:"clock12",description:"CLOCK FACE TWELVE OCLOCK",category:"symbol"},{name:"clock130",unicode:{apple:"1F55C",google:"1F55C",twitter:"1F55C"},shortcode:"clock130",description:"CLOCK FACE ONE-THIRTY",category:"symbol"},{name:"clock230",unicode:{apple:"1F55D",google:"1F55D",twitter:"1F55D"},shortcode:"clock230",description:"CLOCK FACE TWO-THIRTY",category:"symbol"},{name:"clock330",unicode:{apple:"1F55E",google:"1F55E",twitter:"1F55E"},shortcode:"clock330",description:"CLOCK FACE THREE-THIRTY",category:"symbol"},{name:"clock430",unicode:{apple:"1F55F",google:"1F55F",twitter:"1F55F"},shortcode:"clock430",description:"CLOCK FACE FOUR-THIRTY",category:"symbol"},{name:"clock530",unicode:{apple:"1F560",google:"1F560",twitter:"1F560"},shortcode:"clock530",description:"CLOCK FACE FIVE-THIRTY",category:"symbol"},{name:"clock630",unicode:{apple:"1F561",google:"1F561",twitter:"1F561"},shortcode:"clock630",description:"CLOCK FACE SIX-THIRTY",category:"symbol"},{name:"clock730",unicode:{apple:"1F562",google:"1F562",twitter:"1F562"},shortcode:"clock730",description:"CLOCK FACE SEVEN-THIRTY",category:"symbol"},{name:"clock830",unicode:{apple:"1F563",google:"1F563",twitter:"1F563"},shortcode:"clock830",description:"CLOCK FACE EIGHT-THIRTY",category:"symbol"},{name:"clock930",unicode:{apple:"1F564",google:"1F564",twitter:"1F564"},shortcode:"clock930",description:"CLOCK FACE NINE-THIRTY",category:"symbol"},{name:"clock1030",unicode:{apple:"1F565",google:"1F565",twitter:"1F565"},shortcode:"clock1030",description:"CLOCK FACE TEN-THIRTY",category:"symbol"},{name:"clock1130",unicode:{apple:"1F566",google:"1F566",twitter:"1F566"},shortcode:"clock1130",description:"CLOCK FACE ELEVEN-THIRTY",category:"symbol"},{name:"clock1230",unicode:{apple:"1F567",google:"1F567",twitter:"1F567"},shortcode:"clock1230",description:"CLOCK FACE TWELVE-THIRTY",category:"symbol"},{name:"flag-ac",unicode:{apple:"1F1E6-1F1E8",google:"1F1E6-1F1E8",twitter:"1F1E6-1F1E8"},shortcode:"flag-ac",description:"REGIONAL INDICATOR SYMBOL LETTERS AC",category:"flags"},{name:"flag-ad",unicode:{apple:"1F1E6-1F1E9",google:"1F1E6-1F1E9",twitter:"1F1E6-1F1E9"},shortcode:"flag-ad",description:"REGIONAL INDICATOR SYMBOL LETTERS AD",category:"flags"},{name:"flag-ae",unicode:{apple:"1F1E6-1F1EA",google:"1F1E6-1F1EA",twitter:"1F1E6-1F1EA"},shortcode:"flag-ae",description:"REGIONAL INDICATOR SYMBOL LETTERS AE",category:"folderol",category:"flags"},{name:"flag-af",unicode:{apple:"1F1E6-1F1EB",google:"1F1E6-1F1EB",twitter:"1F1E6-1F1EB"},shortcode:"flag-af",description:"REGIONAL INDICATOR SYMBOL LETTERS AF",category:"flags"},{name:"flag-ag",unicode:{apple:"1F1E6-1F1EC",google:"1F1E6-1F1EC",twitter:"1F1E6-1F1EC"},shortcode:"flag-ag",description:"REGIONAL INDICATOR SYMBOL LETTERS AG",category:"flags"},{name:"flag-ai",unicode:{apple:"1F1E6-1F1EE",google:"1F1E6-1F1EE",twitter:"1F1E6-1F1EE"},shortcode:"flag-ai",description:"REGIONAL INDICATOR SYMBOL LETTERS AI",category:"flags"},{name:"flag-al",unicode:{apple:"1F1E6-1F1F1",google:"1F1E6-1F1F1",twitter:"1F1E6-1F1F1"},shortcode:"flag-al",description:"REGIONAL INDICATOR SYMBOL LETTERS AL",category:"flags"},{name:"flag-am",unicode:{apple:"1F1E6-1F1F2",google:"1F1E6-1F1F2",twitter:"1F1E6-1F1F2"},shortcode:"flag-am",description:"REGIONAL INDICATOR SYMBOL LETTERS AM",category:"flags"},{name:"flag-ao",unicode:{apple:"1F1E6-1F1F4",google:"1F1E6-1F1F4",twitter:"1F1E6-1F1F4"},shortcode:"flag-ao",description:"REGIONAL INDICATOR SYMBOL LETTERS AO",category:"flags"},{name:"flag-aq",unicode:{apple:"1F1E6-1F1F6",google:"1F1E6-1F1F6",twitter:"1F1E6-1F1F6"},shortcode:"flag-aq",description:"REGIONAL INDICATOR SYMBOL LETTERS AQ",category:"flags"},{name:"flag-ar",unicode:{apple:"1F1E6-1F1F7",google:"1F1E6-1F1F7",twitter:"1F1E6-1F1F7"},shortcode:"flag-ar",description:"REGIONAL INDICATOR SYMBOL LETTERS AR",category:"flags"},{name:"flag-as",unicode:{apple:"1F1E6-1F1F8",google:"1F1E6-1F1F8",twitter:"1F1E6-1F1F8"},shortcode:"flag-as",description:"REGIONAL INDICATOR SYMBOL LETTERS AS",category:"flags"},{name:"flag-at",unicode:{apple:"1F1E6-1F1F9",google:"1F1E6-1F1F9",twitter:"1F1E6-1F1F9"},shortcode:"flag-at",description:"REGIONAL INDICATOR SYMBOL LETTERS AT",category:"folderol",category:"flags"},{name:"flag-au",unicode:{apple:"1F1E6-1F1FA",google:"1F1E6-1F1FA",twitter:"1F1E6-1F1FA"},shortcode:"flag-au",description:"REGIONAL INDICATOR SYMBOL LETTERS AU",category:"folderol",category:"flags"},{name:"flag-aw",unicode:{apple:"1F1E6-1F1FC",google:"1F1E6-1F1FC",twitter:"1F1E6-1F1FC"},shortcode:"flag-aw",description:"REGIONAL INDICATOR SYMBOL LETTERS AW",category:"flags"},{name:"flag-ax",unicode:{apple:"1F1E6-1F1FD",google:"1F1E6-1F1FD",twitter:"1F1E6-1F1FD"},shortcode:"flag-ax",description:"REGIONAL INDICATOR SYMBOL LETTERS AX",category:"flags"},{name:"flag-az",unicode:{apple:"1F1E6-1F1FF",google:"1F1E6-1F1FF",twitter:"1F1E6-1F1FF"},shortcode:"flag-az",description:"REGIONAL INDICATOR SYMBOL LETTERS AZ",category:"flags"},{name:"flag-ba",unicode:{apple:"1F1E7-1F1E6",google:"1F1E7-1F1E6",twitter:"1F1E7-1F1E6"},shortcode:"flag-ba",description:"REGIONAL INDICATOR SYMBOL LETTERS BA",category:"flags"},{name:"flag-bb",unicode:{apple:"1F1E7-1F1E7",google:"1F1E7-1F1E7",twitter:"1F1E7-1F1E7"},shortcode:"flag-bb",description:"REGIONAL INDICATOR SYMBOL LETTERS BB",category:"flags"},{name:"flag-bd",unicode:{apple:"1F1E7-1F1E9",google:"1F1E7-1F1E9",twitter:"1F1E7-1F1E9"},shortcode:"flag-bd",description:"REGIONAL INDICATOR SYMBOL LETTERS BD",category:"flags"},{name:"flag-be",unicode:{apple:"1F1E7-1F1EA",google:"1F1E7-1F1EA",twitter:"1F1E7-1F1EA"},shortcode:"flag-be",description:"REGIONAL INDICATOR SYMBOL LETTERS BE",category:"folderol",category:"flags"},{name:"flag-bf",unicode:{apple:"1F1E7-1F1EB",google:"1F1E7-1F1EB",twitter:"1F1E7-1F1EB"},shortcode:"flag-bf",description:"REGIONAL INDICATOR SYMBOL LETTERS BF",category:"flags"},{name:"flag-bg",unicode:{apple:"1F1E7-1F1EC",google:"1F1E7-1F1EC",twitter:"1F1E7-1F1EC"},shortcode:"flag-bg",description:"REGIONAL INDICATOR SYMBOL LETTERS BG",category:"flags"},{name:"flag-bh",unicode:{apple:"1F1E7-1F1ED",google:"1F1E7-1F1ED",twitter:"1F1E7-1F1ED"},shortcode:"flag-bh",description:"REGIONAL INDICATOR SYMBOL LETTERS BH",category:"flags"},{name:"flag-bi",unicode:{apple:"1F1E7-1F1EE",google:"1F1E7-1F1EE",twitter:"1F1E7-1F1EE"},shortcode:"flag-bi",description:"REGIONAL INDICATOR SYMBOL LETTERS BI",category:"flags"},{name:"flag-bj",unicode:{apple:"1F1E7-1F1EF",google:"1F1E7-1F1EF",twitter:"1F1E7-1F1EF"},shortcode:"flag-bj",description:"REGIONAL INDICATOR SYMBOL LETTERS BJ",category:"flags"},{name:"flag-bl",unicode:{apple:"1F1E7-1F1F1",google:"1F1E7-1F1F1",twitter:"1F1E7-1F1F1"},shortcode:"flag-bl",description:"REGIONAL INDICATOR SYMBOL LETTERS BL",category:"flags"},{name:"flag-bm",unicode:{apple:"1F1E7-1F1F2",google:"1F1E7-1F1F2",twitter:"1F1E7-1F1F2"},shortcode:"flag-bm",description:"REGIONAL INDICATOR SYMBOL LETTERS BM",category:"flags"},{name:"flag-bn",unicode:{apple:"1F1E7-1F1F3",google:"1F1E7-1F1F3",twitter:"1F1E7-1F1F3"},shortcode:"flag-bn",description:"REGIONAL INDICATOR SYMBOL LETTERS BN",category:"flags"},{name:"flag-bo",unicode:{apple:"1F1E7-1F1F4",google:"1F1E7-1F1F4",twitter:"1F1E7-1F1F4"},shortcode:"flag-bo",description:"REGIONAL INDICATOR SYMBOL LETTERS BO",category:"flags"},{name:"flag-bq",unicode:{apple:"1F1E7-1F1F6",google:"1F1E7-1F1F6",twitter:"1F1E7-1F1F6"},shortcode:"flag-bq",description:"REGIONAL INDICATOR SYMBOL LETTERS BQ",category:"flags"},{name:"flag-br",unicode:{apple:"1F1E7-1F1F7",google:"1F1E7-1F1F7",twitter:"1F1E7-1F1F7"},shortcode:"flag-br",description:"REGIONAL INDICATOR SYMBOL LETTERS BR",category:"folderol",category:"flags"},{name:"flag-bs",unicode:{apple:"1F1E7-1F1F8",google:"1F1E7-1F1F8",twitter:"1F1E7-1F1F8"},shortcode:"flag-bs",description:"REGIONAL INDICATOR SYMBOL LETTERS BS",category:"flags"},{name:"flag-bt",unicode:{apple:"1F1E7-1F1F9",google:"1F1E7-1F1F9",twitter:"1F1E7-1F1F9"},shortcode:"flag-bt",description:"REGIONAL INDICATOR SYMBOL LETTERS BT",category:"flags"},{name:"flag-bv",unicode:{apple:"1F1E7-1F1FB",google:"1F1E7-1F1FB",twitter:"1F1E7-1F1FB"},shortcode:"flag-bv",description:"REGIONAL INDICATOR SYMBOL LETTERS BV",category:"flags"},{name:"flag-bw",unicode:{apple:"1F1E7-1F1FC",google:"1F1E7-1F1FC",twitter:"1F1E7-1F1FC"},shortcode:"flag-bw",description:"REGIONAL INDICATOR SYMBOL LETTERS BW",category:"flags"},{name:"flag-by",unicode:{apple:"1F1E7-1F1FE",google:"1F1E7-1F1FE",twitter:"1F1E7-1F1FE"},shortcode:"flag-by",description:"REGIONAL INDICATOR SYMBOL LETTERS BY",category:"flags"},{name:"flag-bz",unicode:{apple:"1F1E7-1F1FF",google:"1F1E7-1F1FF",twitter:"1F1E7-1F1FF"},shortcode:"flag-bz",description:"REGIONAL INDICATOR SYMBOL LETTERS BZ",category:"flags"},{name:"flag-ca",unicode:{apple:"1F1E8-1F1E6",google:"1F1E8-1F1E6",twitter:"1F1E8-1F1E6"},shortcode:"flag-ca",description:"REGIONAL INDICATOR SYMBOL LETTERS CA",category:"folderol",category:"flags"},{name:"flag-cc",unicode:{apple:"1F1E8-1F1E8",google:"1F1E8-1F1E8",twitter:"1F1E8-1F1E8"},shortcode:"flag-cc",description:"REGIONAL INDICATOR SYMBOL LETTERS CC",category:"flags"},{name:"flag-cd",unicode:{apple:"1F1E8-1F1E9",google:"1F1E8-1F1E9",twitter:"1F1E8-1F1E9"},shortcode:"flag-cd",description:"REGIONAL INDICATOR SYMBOL LETTERS CD",category:"flags"},{name:"flag-cf",unicode:{apple:"1F1E8-1F1EB",google:"1F1E8-1F1EB",twitter:"1F1E8-1F1EB"},shortcode:"flag-cf",description:"REGIONAL INDICATOR SYMBOL LETTERS CF",category:"flags"},{name:"flag-cg",unicode:{apple:"1F1E8-1F1EC",google:"1F1E8-1F1EC",twitter:"1F1E8-1F1EC"},shortcode:"flag-cg",description:"REGIONAL INDICATOR SYMBOL LETTERS CG",category:"flags"},{name:"flag-ch",unicode:{apple:"1F1E8-1F1ED",google:"1F1E8-1F1ED",twitter:"1F1E8-1F1ED"},shortcode:"flag-ch",description:"REGIONAL INDICATOR SYMBOL LETTERS CH",category:"folderol",category:"flags"},{name:"flag-ci",unicode:{apple:"1F1E8-1F1EE",google:"1F1E8-1F1EE",twitter:"1F1E8-1F1EE"},shortcode:"flag-ci",description:"REGIONAL INDICATOR SYMBOL LETTERS CI",category:"flags"},{name:"flag-ck",unicode:{apple:"1F1E8-1F1F0",google:"1F1E8-1F1F0",twitter:"1F1E8-1F1F0"},shortcode:"flag-ck",description:"REGIONAL INDICATOR SYMBOL LETTERS CK",category:"flags"},{name:"flag-cl",unicode:{apple:"1F1E8-1F1F1",google:"1F1E8-1F1F1",twitter:"1F1E8-1F1F1"},shortcode:"flag-cl",description:"REGIONAL INDICATOR SYMBOL LETTERS CL",category:"folderol",category:"flags"},{name:"flag-cm",unicode:{apple:"1F1E8-1F1F2",google:"1F1E8-1F1F2",twitter:"1F1E8-1F1F2"},shortcode:"flag-cm",description:"REGIONAL INDICATOR SYMBOL LETTERS CM",category:"flags"},{name:"flag-cn",unicode:{apple:"1F1E8-1F1F3",google:"1F1E8-1F1F3",twitter:"1F1E8-1F1F3"},shortcode:"flag-cn",description:"REGIONAL INDICATOR SYMBOL LETTERS CN",category:"folderol",category:"flags"},{name:"flag-co",unicode:{apple:"1F1E8-1F1F4",google:"1F1E8-1F1F4",twitter:"1F1E8-1F1F4"},shortcode:"flag-co",description:"REGIONAL INDICATOR SYMBOL LETTERS CO",category:"folderol",category:"flags"},{name:"flag-cp",unicode:{apple:"1F1E8-1F1F5",google:"1F1E8-1F1F5",twitter:"1F1E8-1F1F5"},shortcode:"flag-cp",description:"REGIONAL INDICATOR SYMBOL LETTERS CP",category:"flags"},{name:"flag-cr",unicode:{apple:"1F1E8-1F1F7",google:"1F1E8-1F1F7",twitter:"1F1E8-1F1F7"},shortcode:"flag-cr",description:"REGIONAL INDICATOR SYMBOL LETTERS CR",category:"flags"},{name:"flag-cu",unicode:{apple:"1F1E8-1F1FA",google:"1F1E8-1F1FA",twitter:"1F1E8-1F1FA"},shortcode:"flag-cu",description:"REGIONAL INDICATOR SYMBOL LETTERS CU",category:"flags"},{name:"flag-cv",unicode:{apple:"1F1E8-1F1FB",google:"1F1E8-1F1FB",twitter:"1F1E8-1F1FB"},shortcode:"flag-cv",description:"REGIONAL INDICATOR SYMBOL LETTERS CV",category:"flags"},{name:"flag-cw",unicode:{apple:"1F1E8-1F1FC",google:"1F1E8-1F1FC",twitter:"1F1E8-1F1FC"},shortcode:"flag-cw",description:"REGIONAL INDICATOR SYMBOL LETTERS CW",category:"flags"},{name:"flag-cx",unicode:{apple:"1F1E8-1F1FD",google:"1F1E8-1F1FD",twitter:"1F1E8-1F1FD"},shortcode:"flag-cx",description:"REGIONAL INDICATOR SYMBOL LETTERS CX",category:"flags"},{name:"flag-cy",unicode:{apple:"1F1E8-1F1FE",google:"1F1E8-1F1FE",twitter:"1F1E8-1F1FE"},shortcode:"flag-cy",description:"REGIONAL INDICATOR SYMBOL LETTERS CY",category:"flags"},{name:"flag-cz",unicode:{apple:"1F1E8-1F1FF",google:"1F1E8-1F1FF",twitter:"1F1E8-1F1FF"},shortcode:"flag-cz",description:"REGIONAL INDICATOR SYMBOL LETTERS CZ",category:"flags"},{name:"flag-de",unicode:{apple:"1F1E9-1F1EA",google:"1F1E9-1F1EA",twitter:"1F1E9-1F1EA"},shortcode:"flag-de",description:"REGIONAL INDICATOR SYMBOL LETTERS DE",category:"folderol",category:"flags"},{name:"flag-dg",unicode:{apple:"1F1E9-1F1EC",google:"1F1E9-1F1EC",twitter:"1F1E9-1F1EC"},shortcode:"flag-dg",description:"REGIONAL INDICATOR SYMBOL LETTERS DG",category:"flags"},{name:"flag-dj",unicode:{apple:"1F1E9-1F1EF",google:"1F1E9-1F1EF",twitter:"1F1E9-1F1EF"},shortcode:"flag-dj",description:"REGIONAL INDICATOR SYMBOL LETTERS DJ",category:"flags"},{name:"flag-dk",unicode:{apple:"1F1E9-1F1F0",google:"1F1E9-1F1F0",twitter:"1F1E9-1F1F0"},shortcode:"flag-dk",description:"REGIONAL INDICATOR SYMBOL LETTERS DK",category:"folderol",category:"flags"},{name:"flag-dm",unicode:{apple:"1F1E9-1F1F2",google:"1F1E9-1F1F2",twitter:"1F1E9-1F1F2"},shortcode:"flag-dm",description:"REGIONAL INDICATOR SYMBOL LETTERS DM",category:"flags"},{name:"flag-do",unicode:{apple:"1F1E9-1F1F4",google:"1F1E9-1F1F4",twitter:"1F1E9-1F1F4"},shortcode:"flag-do",description:"REGIONAL INDICATOR SYMBOL LETTERS DO",category:"flags"},{name:"flag-dz",unicode:{apple:"1F1E9-1F1FF",google:"1F1E9-1F1FF",twitter:"1F1E9-1F1FF"},shortcode:"flag-dz",description:"REGIONAL INDICATOR SYMBOL LETTERS DZ",category:"flags"},{name:"flag-ea",unicode:{apple:"1F1EA-1F1E6",google:"1F1EA-1F1E6",twitter:"1F1EA-1F1E6"},shortcode:"flag-ea",description:"REGIONAL INDICATOR SYMBOL LETTERS EA",category:"flags"},{name:"flag-ec",unicode:{apple:"1F1EA-1F1E8",google:"1F1EA-1F1E8",twitter:"1F1EA-1F1E8"},shortcode:"flag-ec",description:"REGIONAL INDICATOR SYMBOL LETTERS EC",category:"flags"},{name:"flag-ee",unicode:{apple:"1F1EA-1F1EA",google:"1F1EA-1F1EA",twitter:"1F1EA-1F1EA"},shortcode:"flag-ee",description:"REGIONAL INDICATOR SYMBOL LETTERS EE",category:"flags"},{name:"flag-eg",unicode:{apple:"1F1EA-1F1EC",google:"1F1EA-1F1EC",twitter:"1F1EA-1F1EC"},shortcode:"flag-eg",description:"REGIONAL INDICATOR SYMBOL LETTERS EG",category:"flags"},{name:"flag-eh",unicode:{apple:"1F1EA-1F1ED",google:"1F1EA-1F1ED",twitter:"1F1EA-1F1ED"},shortcode:"flag-eh",description:"REGIONAL INDICATOR SYMBOL LETTERS EH",category:"flags"},{name:"flag-er",unicode:{apple:"1F1EA-1F1F7",google:"1F1EA-1F1F7",twitter:"1F1EA-1F1F7"},shortcode:"flag-er",description:"REGIONAL INDICATOR SYMBOL LETTERS ER",category:"flags"},{name:"flag-es",unicode:{apple:"1F1EA-1F1F8",google:"1F1EA-1F1F8",twitter:"1F1EA-1F1F8"},shortcode:"flag-es",description:"REGIONAL INDICATOR SYMBOL LETTERS ES",category:"folderol",category:"flags"},{name:"flag-et",unicode:{apple:"1F1EA-1F1F9",google:"1F1EA-1F1F9",twitter:"1F1EA-1F1F9"},shortcode:"flag-et",description:"REGIONAL INDICATOR SYMBOL LETTERS ET",category:"flags"},{name:"flag-eu",unicode:{apple:"1F1EA-1F1FA",google:"1F1EA-1F1FA",twitter:"1F1EA-1F1FA"},shortcode:"flag-eu",description:"REGIONAL INDICATOR SYMBOL LETTERS EU",category:"flags"},{name:"flag-fi",unicode:{apple:"1F1EB-1F1EE",google:"1F1EB-1F1EE",twitter:"1F1EB-1F1EE"},shortcode:"flag-fi",description:"REGIONAL INDICATOR SYMBOL LETTERS FI",category:"folderol",category:"flags"},{name:"flag-fj",unicode:{apple:"1F1EB-1F1EF",google:"1F1EB-1F1EF",twitter:"1F1EB-1F1EF"},shortcode:"flag-fj",description:"REGIONAL INDICATOR SYMBOL LETTERS FJ",category:"flags"},{name:"flag-fk",unicode:{apple:"1F1EB-1F1F0",google:"1F1EB-1F1F0",twitter:"1F1EB-1F1F0"},shortcode:"flag-fk",description:"REGIONAL INDICATOR SYMBOL LETTERS FK",category:"flags"},{name:"flag-fm",unicode:{apple:"1F1EB-1F1F2",google:"1F1EB-1F1F2",twitter:"1F1EB-1F1F2"},shortcode:"flag-fm",description:"REGIONAL INDICATOR SYMBOL LETTERS FM",category:"flags"},{name:"flag-fo",unicode:{apple:"1F1EB-1F1F4",google:"1F1EB-1F1F4",twitter:"1F1EB-1F1F4"},shortcode:"flag-fo",description:"REGIONAL INDICATOR SYMBOL LETTERS FO",category:"flags"},{name:"flag-fr",unicode:{apple:"1F1EB-1F1F7",google:"1F1EB-1F1F7",twitter:"1F1EB-1F1F7"},shortcode:"flag-fr",description:"REGIONAL INDICATOR SYMBOL LETTERS FR",category:"folderol",category:"flags"},{name:"flag-ga",unicode:{apple:"1F1EC-1F1E6",google:"1F1EC-1F1E6",twitter:"1F1EC-1F1E6"},shortcode:"flag-ga",description:"REGIONAL INDICATOR SYMBOL LETTERS GA",category:"flags"},{name:"flag-gb",unicode:{apple:"1F1EC-1F1E7",google:"1F1EC-1F1E7",twitter:"1F1EC-1F1E7"},shortcode:"flag-gb",description:"REGIONAL INDICATOR SYMBOL LETTERS GB",category:"folderol",category:"flags"},{name:"flag-gd",unicode:{apple:"1F1EC-1F1E9",google:"1F1EC-1F1E9",twitter:"1F1EC-1F1E9"},shortcode:"flag-gd",description:"REGIONAL INDICATOR SYMBOL LETTERS GD",category:"flags"},{name:"flag-ge",unicode:{apple:"1F1EC-1F1EA",google:"1F1EC-1F1EA",twitter:"1F1EC-1F1EA"},shortcode:"flag-ge",description:"REGIONAL INDICATOR SYMBOL LETTERS GE",category:"flags"},{name:"flag-gf",unicode:{apple:"1F1EC-1F1EB",google:"1F1EC-1F1EB",twitter:"1F1EC-1F1EB"},shortcode:"flag-gf",description:"REGIONAL INDICATOR SYMBOL LETTERS GF",category:"flags"},{name:"flag-gg",unicode:{apple:"1F1EC-1F1EC",google:"1F1EC-1F1EC",twitter:"1F1EC-1F1EC"},shortcode:"flag-gg",description:"REGIONAL INDICATOR SYMBOL LETTERS GG",category:"flags"},{name:"flag-gh",unicode:{apple:"1F1EC-1F1ED",google:"1F1EC-1F1ED",twitter:"1F1EC-1F1ED"},shortcode:"flag-gh",description:"REGIONAL INDICATOR SYMBOL LETTERS GH",category:"flags"},{name:"flag-gi",unicode:{apple:"1F1EC-1F1EE",google:"1F1EC-1F1EE",twitter:"1F1EC-1F1EE"},shortcode:"flag-gi",description:"REGIONAL INDICATOR SYMBOL LETTERS GI",category:"flags"},{name:"flag-gl",unicode:{apple:"1F1EC-1F1F1",google:"1F1EC-1F1F1",twitter:"1F1EC-1F1F1"},shortcode:"flag-gl",description:"REGIONAL INDICATOR SYMBOL LETTERS GL",category:"flags"},{name:"flag-gm",unicode:{apple:"1F1EC-1F1F2",google:"1F1EC-1F1F2",twitter:"1F1EC-1F1F2"},shortcode:"flag-gm",description:"REGIONAL INDICATOR SYMBOL LETTERS GM",category:"flags"},{name:"flag-gn",unicode:{apple:"1F1EC-1F1F3",google:"1F1EC-1F1F3",twitter:"1F1EC-1F1F3"},shortcode:"flag-gn",description:"REGIONAL INDICATOR SYMBOL LETTERS GN",category:"flags"},{name:"flag-gp",unicode:{apple:"1F1EC-1F1F5",google:"1F1EC-1F1F5",twitter:"1F1EC-1F1F5"},shortcode:"flag-gp",description:"REGIONAL INDICATOR SYMBOL LETTERS GP",category:"flags"},{name:"flag-gq",unicode:{apple:"1F1EC-1F1F6",google:"1F1EC-1F1F6",twitter:"1F1EC-1F1F6"},shortcode:"flag-gq",description:"REGIONAL INDICATOR SYMBOL LETTERS GQ",category:"flags"},{name:"flag-gr",unicode:{apple:"1F1EC-1F1F7",google:"1F1EC-1F1F7",twitter:"1F1EC-1F1F7"},shortcode:"flag-gr",description:"REGIONAL INDICATOR SYMBOL LETTERS GR",category:"flags"},{name:"flag-gs",unicode:{apple:"1F1EC-1F1F8",google:"1F1EC-1F1F8",twitter:"1F1EC-1F1F8"},shortcode:"flag-gs",description:"REGIONAL INDICATOR SYMBOL LETTERS GS",category:"flags"},{name:"flag-gt",unicode:{apple:"1F1EC-1F1F9",google:"1F1EC-1F1F9",twitter:"1F1EC-1F1F9"},shortcode:"flag-gt",description:"REGIONAL INDICATOR SYMBOL LETTERS GT",category:"flags"},{name:"flag-gu",unicode:{apple:"1F1EC-1F1FA",google:"1F1EC-1F1FA",twitter:"1F1EC-1F1FA"},shortcode:"flag-gu",description:"REGIONAL INDICATOR SYMBOL LETTERS GU",category:"flags"},{name:"flag-gw",unicode:{apple:"1F1EC-1F1FC",google:"1F1EC-1F1FC",twitter:"1F1EC-1F1FC"},shortcode:"flag-gw",description:"REGIONAL INDICATOR SYMBOL LETTERS GW",category:"flags"},{name:"flag-gy",unicode:{apple:"1F1EC-1F1FE",google:"1F1EC-1F1FE",twitter:"1F1EC-1F1FE"},shortcode:"flag-gy",description:"REGIONAL INDICATOR SYMBOL LETTERS GY",category:"flags"},{name:"flag-hk",unicode:{apple:"1F1ED-1F1F0",google:"1F1ED-1F1F0",twitter:"1F1ED-1F1F0"},shortcode:"flag-hk",description:"REGIONAL INDICATOR SYMBOL LETTERS HK",category:"folderol",category:"flags"},{name:"flag-hm",unicode:{apple:"1F1ED-1F1F2",google:"1F1ED-1F1F2",twitter:"1F1ED-1F1F2"},shortcode:"flag-hm",description:"REGIONAL INDICATOR SYMBOL LETTERS HM",category:"flags"},{name:"flag-hn",unicode:{apple:"1F1ED-1F1F3",google:"1F1ED-1F1F3",twitter:"1F1ED-1F1F3"},shortcode:"flag-hn",description:"REGIONAL INDICATOR SYMBOL LETTERS HN",category:"flags"},{name:"flag-hr",unicode:{apple:"1F1ED-1F1F7",google:"1F1ED-1F1F7",twitter:"1F1ED-1F1F7"},shortcode:"flag-hr",description:"REGIONAL INDICATOR SYMBOL LETTERS HR",category:"flags"},{name:"flag-ht",unicode:{apple:"1F1ED-1F1F9",google:"1F1ED-1F1F9",twitter:"1F1ED-1F1F9"},shortcode:"flag-ht",description:"REGIONAL INDICATOR SYMBOL LETTERS HT",category:"flags"},{name:"flag-hu",unicode:{apple:"1F1ED-1F1FA",google:"1F1ED-1F1FA",twitter:"1F1ED-1F1FA"},shortcode:"flag-hu",description:"REGIONAL INDICATOR SYMBOL LETTERS HU",category:"flags"},{name:"flag-ic",unicode:{apple:"1F1EE-1F1E8",google:"1F1EE-1F1E8",twitter:"1F1EE-1F1E8"},shortcode:"flag-ic",description:"REGIONAL INDICATOR SYMBOL LETTERS IC",category:"flags"},{name:"flag-id",unicode:{apple:"1F1EE-1F1E9",google:"1F1EE-1F1E9",twitter:"1F1EE-1F1E9"},shortcode:"flag-id",description:"REGIONAL INDICATOR SYMBOL LETTERS ID",category:"folderol",category:"flags"},{name:"flag-ie",unicode:{apple:"1F1EE-1F1EA",google:"1F1EE-1F1EA",twitter:"1F1EE-1F1EA"},shortcode:"flag-ie",description:"REGIONAL INDICATOR SYMBOL LETTERS IE",category:"folderol",category:"flags"},{name:"flag-il",unicode:{apple:"1F1EE-1F1F1",google:"1F1EE-1F1F1",twitter:"1F1EE-1F1F1"},shortcode:"flag-il",description:"REGIONAL INDICATOR SYMBOL LETTERS IL",category:"folderol",category:"flags"},{name:"flag-im",unicode:{apple:"1F1EE-1F1F2",google:"1F1EE-1F1F2",twitter:"1F1EE-1F1F2"},shortcode:"flag-im",description:"REGIONAL INDICATOR SYMBOL LETTERS IM",category:"flags"},{name:"flag-in",unicode:{apple:"1F1EE-1F1F3",google:"1F1EE-1F1F3",twitter:"1F1EE-1F1F3"},shortcode:"flag-in",description:"REGIONAL INDICATOR SYMBOL LETTERS IN",category:"folderol",category:"flags"},{name:"flag-io",unicode:{apple:"1F1EE-1F1F4",google:"1F1EE-1F1F4",twitter:"1F1EE-1F1F4"},shortcode:"flag-io",description:"REGIONAL INDICATOR SYMBOL LETTERS IO",category:"flags"},{name:"flag-iq",unicode:{apple:"1F1EE-1F1F6",google:"1F1EE-1F1F6",twitter:"1F1EE-1F1F6"},shortcode:"flag-iq",description:"REGIONAL INDICATOR SYMBOL LETTERS IQ",category:"flags"},{name:"flag-ir",unicode:{apple:"1F1EE-1F1F7",google:"1F1EE-1F1F7",twitter:"1F1EE-1F1F7"},shortcode:"flag-ir",description:"REGIONAL INDICATOR SYMBOL LETTERS IR",category:"flags"},{name:"flag-is",unicode:{apple:"1F1EE-1F1F8",google:"1F1EE-1F1F8",twitter:"1F1EE-1F1F8"},shortcode:"flag-is",description:"REGIONAL INDICATOR SYMBOL LETTERS IS",category:"flags"},{name:"flag-it",unicode:{apple:"1F1EE-1F1F9",google:"1F1EE-1F1F9",twitter:"1F1EE-1F1F9"},shortcode:"flag-it",description:"REGIONAL INDICATOR SYMBOL LETTERS IT",category:"folderol",category:"flags"},{name:"flag-je",unicode:{apple:"1F1EF-1F1EA",google:"1F1EF-1F1EA",twitter:"1F1EF-1F1EA"},shortcode:"flag-je",description:"REGIONAL INDICATOR SYMBOL LETTERS JE",category:"flags"},{name:"flag-jm",unicode:{apple:"1F1EF-1F1F2",google:"1F1EF-1F1F2",twitter:"1F1EF-1F1F2"},shortcode:"flag-jm",description:"REGIONAL INDICATOR SYMBOL LETTERS JM",category:"flags"},{name:"flag-jo",unicode:{apple:"1F1EF-1F1F4",google:"1F1EF-1F1F4",twitter:"1F1EF-1F1F4"},shortcode:"flag-jo",description:"REGIONAL INDICATOR SYMBOL LETTERS JO",category:"flags"},{name:"flag-jp",unicode:{apple:"1F1EF-1F1F5",google:"1F1EF-1F1F5",twitter:"1F1EF-1F1F5"},shortcode:"flag-jp",description:"REGIONAL INDICATOR SYMBOL LETTERS JP",category:"folderol",category:"flags"},{name:"flag-ke",unicode:{apple:"1F1F0-1F1EA",google:"1F1F0-1F1EA",twitter:"1F1F0-1F1EA"},shortcode:"flag-ke",description:"REGIONAL INDICATOR SYMBOL LETTERS KE",category:"flags"},{name:"flag-kg",unicode:{apple:"1F1F0-1F1EC",google:"1F1F0-1F1EC",twitter:"1F1F0-1F1EC"},shortcode:"flag-kg",description:"REGIONAL INDICATOR SYMBOL LETTERS KG",category:"flags"},{name:"flag-kh",unicode:{apple:"1F1F0-1F1ED",google:"1F1F0-1F1ED",twitter:"1F1F0-1F1ED"},shortcode:"flag-kh",description:"REGIONAL INDICATOR SYMBOL LETTERS KH",category:"flags"},{name:"flag-ki",unicode:{apple:"1F1F0-1F1EE",google:"1F1F0-1F1EE",twitter:"1F1F0-1F1EE"},shortcode:"flag-ki",description:"REGIONAL INDICATOR SYMBOL LETTERS KI",category:"flags"},{name:"flag-km",unicode:{apple:"1F1F0-1F1F2",google:"1F1F0-1F1F2",twitter:"1F1F0-1F1F2"},shortcode:"flag-km",description:"REGIONAL INDICATOR SYMBOL LETTERS KM",category:"flags"},{name:"flag-kn",unicode:{apple:"1F1F0-1F1F3",google:"1F1F0-1F1F3",twitter:"1F1F0-1F1F3"},shortcode:"flag-kn",description:"REGIONAL INDICATOR SYMBOL LETTERS KN",category:"flags"},{name:"flag-kp",unicode:{apple:"1F1F0-1F1F5",google:"1F1F0-1F1F5",twitter:"1F1F0-1F1F5"},shortcode:"flag-kp",description:"REGIONAL INDICATOR SYMBOL LETTERS KP",category:"flags"},{name:"flag-kr",unicode:{apple:"1F1F0-1F1F7",google:"1F1F0-1F1F7",twitter:"1F1F0-1F1F7"},shortcode:"flag-kr",description:"REGIONAL INDICATOR SYMBOL LETTERS KR",category:"folderol",category:"flags"},{name:"flag-kw",unicode:{apple:"1F1F0-1F1FC",google:"1F1F0-1F1FC",twitter:"1F1F0-1F1FC"},shortcode:"flag-kw",description:"REGIONAL INDICATOR SYMBOL LETTERS KW",category:"flags"},{name:"flag-ky",unicode:{apple:"1F1F0-1F1FE",google:"1F1F0-1F1FE",twitter:"1F1F0-1F1FE"},shortcode:"flag-ky",description:"REGIONAL INDICATOR SYMBOL LETTERS KY",category:"flags"},{name:"flag-kz",unicode:{apple:"1F1F0-1F1FF",google:"1F1F0-1F1FF",twitter:"1F1F0-1F1FF"},shortcode:"flag-kz",description:"REGIONAL INDICATOR SYMBOL LETTERS KZ",category:"flags"},{name:"flag-la",unicode:{apple:"1F1F1-1F1E6",google:"1F1F1-1F1E6",twitter:"1F1F1-1F1E6"},shortcode:"flag-la",description:"REGIONAL INDICATOR SYMBOL LETTERS LA",category:"flags"},{name:"flag-lb",unicode:{apple:"1F1F1-1F1E7",google:"1F1F1-1F1E7",twitter:"1F1F1-1F1E7"},shortcode:"flag-lb",description:"REGIONAL INDICATOR SYMBOL LETTERS LB",category:"flags"},{name:"flag-lc",unicode:{apple:"1F1F1-1F1E8",google:"1F1F1-1F1E8",twitter:"1F1F1-1F1E8"},shortcode:"flag-lc",description:"REGIONAL INDICATOR SYMBOL LETTERS LC",category:"flags"},{name:"flag-li",unicode:{apple:"1F1F1-1F1EE",google:"1F1F1-1F1EE",twitter:"1F1F1-1F1EE"},shortcode:"flag-li",description:"REGIONAL INDICATOR SYMBOL LETTERS LI",category:"flags"},{name:"flag-lk",unicode:{apple:"1F1F1-1F1F0",google:"1F1F1-1F1F0",twitter:"1F1F1-1F1F0"},shortcode:"flag-lk",description:"REGIONAL INDICATOR SYMBOL LETTERS LK",category:"flags"},{name:"flag-lr",unicode:{apple:"1F1F1-1F1F7",google:"1F1F1-1F1F7",twitter:"1F1F1-1F1F7"},shortcode:"flag-lr",description:"REGIONAL INDICATOR SYMBOL LETTERS LR",category:"flags"},{name:"flag-ls",unicode:{apple:"1F1F1-1F1F8",google:"1F1F1-1F1F8",twitter:"1F1F1-1F1F8"},shortcode:"flag-ls",description:"REGIONAL INDICATOR SYMBOL LETTERS LS",category:"flags"},{name:"flag-lt",unicode:{apple:"1F1F1-1F1F9",google:"1F1F1-1F1F9",twitter:"1F1F1-1F1F9"},shortcode:"flag-lt",description:"REGIONAL INDICATOR SYMBOL LETTERS LT",category:"flags"},{name:"flag-lu",unicode:{apple:"1F1F1-1F1FA",google:"1F1F1-1F1FA",twitter:"1F1F1-1F1FA"},shortcode:"flag-lu",description:"REGIONAL INDICATOR SYMBOL LETTERS LU",category:"flags"},{name:"flag-lv",unicode:{apple:"1F1F1-1F1FB",google:"1F1F1-1F1FB",twitter:"1F1F1-1F1FB"},shortcode:"flag-lv",description:"REGIONAL INDICATOR SYMBOL LETTERS LV",category:"flags"},{name:"flag-ly",unicode:{apple:"1F1F1-1F1FE",google:"1F1F1-1F1FE",twitter:"1F1F1-1F1FE"},shortcode:"flag-ly",description:"REGIONAL INDICATOR SYMBOL LETTERS LY",category:"flags"},{name:"flag-ma",unicode:{apple:"1F1F2-1F1E6",google:"1F1F2-1F1E6",twitter:"1F1F2-1F1E6"},shortcode:"flag-ma",description:"REGIONAL INDICATOR SYMBOL LETTERS MA",category:"flags"},{name:"flag-mc",unicode:{apple:"1F1F2-1F1E8",google:"1F1F2-1F1E8",twitter:"1F1F2-1F1E8"},shortcode:"flag-mc",description:"REGIONAL INDICATOR SYMBOL LETTERS MC",category:"flags"},{name:"flag-md",unicode:{apple:"1F1F2-1F1E9",google:"1F1F2-1F1E9",twitter:"1F1F2-1F1E9"},shortcode:"flag-md",description:"REGIONAL INDICATOR SYMBOL LETTERS MD",category:"flags"},{name:"flag-me",unicode:{apple:"1F1F2-1F1EA",google:"1F1F2-1F1EA",twitter:"1F1F2-1F1EA"},shortcode:"flag-me",description:"REGIONAL INDICATOR SYMBOL LETTERS ME",category:"flags"},{name:"flag-mf",unicode:{apple:"1F1F2-1F1EB",google:"1F1F2-1F1EB",twitter:"1F1F2-1F1EB"},shortcode:"flag-mf",description:"REGIONAL INDICATOR SYMBOL LETTERS MF",category:"flags"},{name:"flag-mg",unicode:{apple:"1F1F2-1F1EC",google:"1F1F2-1F1EC",twitter:"1F1F2-1F1EC"},shortcode:"flag-mg",description:"REGIONAL INDICATOR SYMBOL LETTERS MG",category:"flags"},{name:"flag-mh",unicode:{apple:"1F1F2-1F1ED",google:"1F1F2-1F1ED",twitter:"1F1F2-1F1ED"},shortcode:"flag-mh",description:"REGIONAL INDICATOR SYMBOL LETTERS MH",category:"flags"},{name:"flag-mk",unicode:{apple:"1F1F2-1F1F0",google:"1F1F2-1F1F0",twitter:"1F1F2-1F1F0"},shortcode:"flag-mk",description:"REGIONAL INDICATOR SYMBOL LETTERS MK",category:"flags"},{name:"flag-ml",unicode:{apple:"1F1F2-1F1F1",google:"1F1F2-1F1F1",twitter:"1F1F2-1F1F1"},shortcode:"flag-ml",description:"REGIONAL INDICATOR SYMBOL LETTERS ML",category:"flags"},{name:"flag-mm",unicode:{apple:"1F1F2-1F1F2",google:"1F1F2-1F1F2",twitter:"1F1F2-1F1F2"},shortcode:"flag-mm",description:"REGIONAL INDICATOR SYMBOL LETTERS MM",category:"flags"},{name:"flag-mn",unicode:{apple:"1F1F2-1F1F3",google:"1F1F2-1F1F3",twitter:"1F1F2-1F1F3"},shortcode:"flag-mn",description:"REGIONAL INDICATOR SYMBOL LETTERS MN",category:"flags"},{name:"flag-mo",unicode:{apple:"1F1F2-1F1F4",google:"1F1F2-1F1F4",twitter:"1F1F2-1F1F4"},shortcode:"flag-mo",description:"REGIONAL INDICATOR SYMBOL LETTERS MO",category:"folderol",category:"flags"},{name:"flag-mp",unicode:{apple:"1F1F2-1F1F5",google:"1F1F2-1F1F5",twitter:"1F1F2-1F1F5"},shortcode:"flag-mp",description:"REGIONAL INDICATOR SYMBOL LETTERS MP",category:"flags"},{name:"flag-mq",unicode:{apple:"1F1F2-1F1F6",google:"1F1F2-1F1F6",twitter:"1F1F2-1F1F6"},shortcode:"flag-mq",description:"REGIONAL INDICATOR SYMBOL LETTERS MQ",category:"flags"},{name:"flag-mr",unicode:{apple:"1F1F2-1F1F7",google:"1F1F2-1F1F7",twitter:"1F1F2-1F1F7"},shortcode:"flag-mr",description:"REGIONAL INDICATOR SYMBOL LETTERS MR",category:"flags"},{name:"flag-ms",unicode:{apple:"1F1F2-1F1F8",google:"1F1F2-1F1F8",twitter:"1F1F2-1F1F8"},shortcode:"flag-ms",description:"REGIONAL INDICATOR SYMBOL LETTERS MS",category:"flags"},{name:"flag-mt",unicode:{apple:"1F1F2-1F1F9",google:"1F1F2-1F1F9",twitter:"1F1F2-1F1F9"},shortcode:"flag-mt",description:"REGIONAL INDICATOR SYMBOL LETTERS MT",category:"flags"},{name:"flag-mu",unicode:{apple:"1F1F2-1F1FA",google:"1F1F2-1F1FA",twitter:"1F1F2-1F1FA"},shortcode:"flag-mu",description:"REGIONAL INDICATOR SYMBOL LETTERS MU",category:"flags"},{name:"flag-mv",unicode:{apple:"1F1F2-1F1FB",google:"1F1F2-1F1FB",twitter:"1F1F2-1F1FB"},shortcode:"flag-mv",description:"REGIONAL INDICATOR SYMBOL LETTERS MV",category:"flags"},{name:"flag-mw",unicode:{apple:"1F1F2-1F1FC",google:"1F1F2-1F1FC",twitter:"1F1F2-1F1FC"},shortcode:"flag-mw",description:"REGIONAL INDICATOR SYMBOL LETTERS MW",category:"flags"},{name:"flag-mx",unicode:{apple:"1F1F2-1F1FD",google:"1F1F2-1F1FD",twitter:"1F1F2-1F1FD"},shortcode:"flag-mx",description:"REGIONAL INDICATOR SYMBOL LETTERS MX",category:"flags"},{name:"flag-my",unicode:{apple:"1F1F2-1F1FE",google:"1F1F2-1F1FE",twitter:"1F1F2-1F1FE"},shortcode:"flag-my",description:"REGIONAL INDICATOR SYMBOL LETTERS MY",category:"flags"},{name:"flag-mz",unicode:{apple:"1F1F2-1F1FF",google:"1F1F2-1F1FF",twitter:"1F1F2-1F1FF"},shortcode:"flag-mz",description:"REGIONAL INDICATOR SYMBOL LETTERS MZ",category:"flags"},{name:"flag-na",unicode:{apple:"1F1F3-1F1E6",google:"1F1F3-1F1E6",twitter:"1F1F3-1F1E6"},shortcode:"flag-na",description:"REGIONAL INDICATOR SYMBOL LETTERS NA",category:"flags"},{name:"flag-nc",unicode:{apple:"1F1F3-1F1E8",google:"1F1F3-1F1E8",twitter:"1F1F3-1F1E8"},shortcode:"flag-nc",description:"REGIONAL INDICATOR SYMBOL LETTERS NC",category:"flags"},{name:"flag-ne",unicode:{apple:"1F1F3-1F1EA",google:"1F1F3-1F1EA",twitter:"1F1F3-1F1EA"},shortcode:"flag-ne",description:"REGIONAL INDICATOR SYMBOL LETTERS NE",category:"flags"},{name:"flag-nf",unicode:{apple:"1F1F3-1F1EB",google:"1F1F3-1F1EB",twitter:"1F1F3-1F1EB"},shortcode:"flag-nf",description:"REGIONAL INDICATOR SYMBOL LETTERS NF",category:"flags"},{name:"flag-ng",unicode:{apple:"1F1F3-1F1EC",google:"1F1F3-1F1EC",twitter:"1F1F3-1F1EC"},shortcode:"flag-ng",description:"REGIONAL INDICATOR SYMBOL LETTERS NG",category:"flags"},{name:"flag-ni",unicode:{apple:"1F1F3-1F1EE",google:"1F1F3-1F1EE",twitter:"1F1F3-1F1EE"},shortcode:"flag-ni",description:"REGIONAL INDICATOR SYMBOL LETTERS NI",category:"flags"},{name:"flag-nl",unicode:{apple:"1F1F3-1F1F1",google:"1F1F3-1F1F1",twitter:"1F1F3-1F1F1"},shortcode:"flag-nl",description:"REGIONAL INDICATOR SYMBOL LETTERS NL",category:"flags"},{name:"flag-no",unicode:{apple:"1F1F3-1F1F4",google:"1F1F3-1F1F4",twitter:"1F1F3-1F1F4"},shortcode:"flag-no",description:"REGIONAL INDICATOR SYMBOL LETTERS NO",category:"flags"},{name:"flag-np",unicode:{apple:"1F1F3-1F1F5",google:"1F1F3-1F1F5",twitter:"1F1F3-1F1F5"},shortcode:"flag-np",description:"REGIONAL INDICATOR SYMBOL LETTERS NP",category:"flags"},{name:"flag-nr",unicode:{apple:"1F1F3-1F1F7",google:"1F1F3-1F1F7",twitter:"1F1F3-1F1F7"},shortcode:"flag-nr",description:"REGIONAL INDICATOR SYMBOL LETTERS NR",category:"flags"},{name:"flag-nu",unicode:{apple:"1F1F3-1F1FA",google:"1F1F3-1F1FA",twitter:"1F1F3-1F1FA"},shortcode:"flag-nu",description:"REGIONAL INDICATOR SYMBOL LETTERS NU",category:"flags"},{name:"flag-nz",unicode:{apple:"1F1F3-1F1FF",google:"1F1F3-1F1FF",twitter:"1F1F3-1F1FF"},shortcode:"flag-nz",description:"REGIONAL INDICATOR SYMBOL LETTERS NZ",category:"flags"},{name:"flag-om",unicode:{apple:"1F1F4-1F1F2",google:"1F1F4-1F1F2",twitter:"1F1F4-1F1F2"},shortcode:"flag-om",description:"REGIONAL INDICATOR SYMBOL LETTERS OM",category:"flags"},{name:"flag-pa",unicode:{apple:"1F1F5-1F1E6",google:"1F1F5-1F1E6",twitter:"1F1F5-1F1E6"},shortcode:"flag-pa",description:"REGIONAL INDICATOR SYMBOL LETTERS PA",category:"flags"},{name:"flag-pe",unicode:{apple:"1F1F5-1F1EA",google:"1F1F5-1F1EA",twitter:"1F1F5-1F1EA"},shortcode:"flag-pe",description:"REGIONAL INDICATOR SYMBOL LETTERS PE",category:"flags"},{name:"flag-pf",unicode:{apple:"1F1F5-1F1EB",google:"1F1F5-1F1EB",twitter:"1F1F5-1F1EB"},shortcode:"flag-pf",description:"REGIONAL INDICATOR SYMBOL LETTERS PF",category:"flags"},{name:"flag-pg",unicode:{apple:"1F1F5-1F1EC",google:"1F1F5-1F1EC",twitter:"1F1F5-1F1EC"},shortcode:"flag-pg",description:"REGIONAL INDICATOR SYMBOL LETTERS PG",category:"flags"},{name:"flag-ph",unicode:{apple:"1F1F5-1F1ED",google:"1F1F5-1F1ED",twitter:"1F1F5-1F1ED"},shortcode:"flag-ph",description:"REGIONAL INDICATOR SYMBOL LETTERS PH",category:"flags"},{name:"flag-pk",unicode:{apple:"1F1F5-1F1F0",google:"1F1F5-1F1F0",twitter:"1F1F5-1F1F0"},shortcode:"flag-pk",description:"REGIONAL INDICATOR SYMBOL LETTERS PK",category:"flags"},{name:"flag-pl",unicode:{apple:"1F1F5-1F1F1",google:"1F1F5-1F1F1",twitter:"1F1F5-1F1F1"},shortcode:"flag-pl",description:"REGIONAL INDICATOR SYMBOL LETTERS PL",category:"flags"},{name:"flag-pm",unicode:{apple:"1F1F5-1F1F2",google:"1F1F5-1F1F2",twitter:"1F1F5-1F1F2"},shortcode:"flag-pm",description:"REGIONAL INDICATOR SYMBOL LETTERS PM",category:"flags"},{name:"flag-pn",unicode:{apple:"1F1F5-1F1F3",google:"1F1F5-1F1F3",twitter:"1F1F5-1F1F3"},shortcode:"flag-pn",description:"REGIONAL INDICATOR SYMBOL LETTERS PN",category:"flags"},{name:"flag-pr",unicode:{apple:"1F1F5-1F1F7",google:"1F1F5-1F1F7",twitter:"1F1F5-1F1F7"},shortcode:"flag-pr",description:"REGIONAL INDICATOR SYMBOL LETTERS PR",category:"flags"},{name:"flag-ps",unicode:{apple:"1F1F5-1F1F8",google:"1F1F5-1F1F8",twitter:"1F1F5-1F1F8"},shortcode:"flag-ps",description:"REGIONAL INDICATOR SYMBOL LETTERS PS",category:"flags"},{name:"flag-pt",unicode:{apple:"1F1F5-1F1F9",google:"1F1F5-1F1F9",twitter:"1F1F5-1F1F9"},shortcode:"flag-pt",description:"REGIONAL INDICATOR SYMBOL LETTERS PT",category:"flags"},{name:"flag-pw",unicode:{apple:"1F1F5-1F1FC",google:"1F1F5-1F1FC",twitter:"1F1F5-1F1FC"},shortcode:"flag-pw",description:"REGIONAL INDICATOR SYMBOL LETTERS PW",category:"flags"},{name:"flag-py",unicode:{apple:"1F1F5-1F1FE",google:"1F1F5-1F1FE",twitter:"1F1F5-1F1FE"},shortcode:"flag-py",description:"REGIONAL INDICATOR SYMBOL LETTERS PY",category:"flags"},{name:"flag-qa",unicode:{apple:"1F1F6-1F1E6",google:"1F1F6-1F1E6",twitter:"1F1F6-1F1E6"},shortcode:"flag-qa",description:"REGIONAL INDICATOR SYMBOL LETTERS QA",category:"flags"},{name:"flag-re",unicode:{apple:"1F1F7-1F1EA",google:"1F1F7-1F1EA",twitter:"1F1F7-1F1EA"},shortcode:"flag-re",description:"REGIONAL INDICATOR SYMBOL LETTERS RE",category:"flags"},{name:"flag-ro",unicode:{apple:"1F1F7-1F1F4",google:"1F1F7-1F1F4",twitter:"1F1F7-1F1F4"},shortcode:"flag-ro",description:"REGIONAL INDICATOR SYMBOL LETTERS RO",category:"flags"},{name:"flag-rs",unicode:{apple:"1F1F7-1F1F8",google:"1F1F7-1F1F8",twitter:"1F1F7-1F1F8"},shortcode:"flag-rs",description:"REGIONAL INDICATOR SYMBOL LETTERS RS",category:"flags"},{name:"flag-ru",unicode:{apple:"1F1F7-1F1FA",google:"1F1F7-1F1FA",twitter:"1F1F7-1F1FA"},shortcode:"flag-ru",description:"REGIONAL INDICATOR SYMBOL LETTERS RU",category:"flags"},{name:"flag-rw",unicode:{apple:"1F1F7-1F1FC",google:"1F1F7-1F1FC",twitter:"1F1F7-1F1FC"},shortcode:"flag-rw",description:"REGIONAL INDICATOR SYMBOL LETTERS RW",category:"flags"},{name:"flag-sa",unicode:{apple:"1F1F8-1F1E6",google:"1F1F8-1F1E6",twitter:"1F1F8-1F1E6"},shortcode:"flag-sa",description:"REGIONAL INDICATOR SYMBOL LETTERS SA",category:"flags"},{name:"flag-sb",unicode:{apple:"1F1F8-1F1E7",google:"1F1F8-1F1E7",twitter:"1F1F8-1F1E7"},shortcode:"flag-sb",description:"REGIONAL INDICATOR SYMBOL LETTERS SB",category:"flags"},{name:"flag-sc",unicode:{apple:"1F1F8-1F1E8",google:"1F1F8-1F1E8",twitter:"1F1F8-1F1E8"},shortcode:"flag-sc",description:"REGIONAL INDICATOR SYMBOL LETTERS SC",category:"flags"},{name:"flag-sd",unicode:{apple:"1F1F8-1F1E9",google:"1F1F8-1F1E9",twitter:"1F1F8-1F1E9"},shortcode:"flag-sd",description:"REGIONAL INDICATOR SYMBOL LETTERS SD",category:"flags"},{name:"flag-se",unicode:{apple:"1F1F8-1F1EA",google:"1F1F8-1F1EA",twitter:"1F1F8-1F1EA"},shortcode:"flag-se",description:"REGIONAL INDICATOR SYMBOL LETTERS SE",category:"flags"},{name:"flag-sg",unicode:{apple:"1F1F8-1F1EC",google:"1F1F8-1F1EC",twitter:"1F1F8-1F1EC"},shortcode:"flag-sg",description:"REGIONAL INDICATOR SYMBOL LETTERS SG",category:"flags"},{name:"flag-sh",unicode:{apple:"1F1F8-1F1ED",google:"1F1F8-1F1ED",twitter:"1F1F8-1F1ED"},shortcode:"flag-sh",description:"REGIONAL INDICATOR SYMBOL LETTERS SH",category:"flags"},{name:"flag-si",unicode:{apple:"1F1F8-1F1EE",google:"1F1F8-1F1EE",twitter:"1F1F8-1F1EE"},shortcode:"flag-si",description:"REGIONAL INDICATOR SYMBOL LETTERS SI",category:"flags"},{name:"flag-sj",unicode:{apple:"1F1F8-1F1EF",google:"1F1F8-1F1EF",twitter:"1F1F8-1F1EF"},shortcode:"flag-sj",description:"REGIONAL INDICATOR SYMBOL LETTERS SJ",category:"flags"},{name:"flag-sk",unicode:{apple:"1F1F8-1F1F0",google:"1F1F8-1F1F0",twitter:"1F1F8-1F1F0"},shortcode:"flag-sk",description:"REGIONAL INDICATOR SYMBOL LETTERS SK",category:"flags"},{name:"flag-sl",unicode:{apple:"1F1F8-1F1F1",google:"1F1F8-1F1F1",twitter:"1F1F8-1F1F1"},shortcode:"flag-sl",description:"REGIONAL INDICATOR SYMBOL LETTERS SL",category:"flags"},{name:"flag-sm",unicode:{apple:"1F1F8-1F1F2",google:"1F1F8-1F1F2",twitter:"1F1F8-1F1F2"},shortcode:"flag-sm",description:"REGIONAL INDICATOR SYMBOL LETTERS SM",category:"flags"},{name:"flag-sn",unicode:{apple:"1F1F8-1F1F3",google:"1F1F8-1F1F3",twitter:"1F1F8-1F1F3"},shortcode:"flag-sn",description:"REGIONAL INDICATOR SYMBOL LETTERS SN",category:"flags"},{name:"flag-so",unicode:{apple:"1F1F8-1F1F4",google:"1F1F8-1F1F4",twitter:"1F1F8-1F1F4"},shortcode:"flag-so",description:"REGIONAL INDICATOR SYMBOL LETTERS SO",category:"flags"},{name:"flag-sr",unicode:{apple:"1F1F8-1F1F7",google:"1F1F8-1F1F7",twitter:"1F1F8-1F1F7"},shortcode:"flag-sr",description:"REGIONAL INDICATOR SYMBOL LETTERS SR",category:"flags"},{name:"flag-ss",unicode:{apple:"1F1F8-1F1F8",google:"1F1F8-1F1F8",twitter:"1F1F8-1F1F8"},shortcode:"flag-ss",description:"REGIONAL INDICATOR SYMBOL LETTERS SS",category:"flags"},{name:"flag-st",unicode:{apple:"1F1F8-1F1F9",google:"1F1F8-1F1F9",twitter:"1F1F8-1F1F9"},shortcode:"flag-st",description:"REGIONAL INDICATOR SYMBOL LETTERS ST",category:"flags"},{name:"flag-sv",unicode:{apple:"1F1F8-1F1FB",google:"1F1F8-1F1FB",twitter:"1F1F8-1F1FB"},shortcode:"flag-sv",description:"REGIONAL INDICATOR SYMBOL LETTERS SV",category:"flags"},{name:"flag-sx",unicode:{apple:"1F1F8-1F1FD",google:"1F1F8-1F1FD",twitter:"1F1F8-1F1FD"},shortcode:"flag-sx",description:"REGIONAL INDICATOR SYMBOL LETTERS SX",category:"flags"},{name:"flag-sy",unicode:{apple:"1F1F8-1F1FE",google:"1F1F8-1F1FE",twitter:"1F1F8-1F1FE"},shortcode:"flag-sy",description:"REGIONAL INDICATOR SYMBOL LETTERS SY",category:"flags"},{name:"flag-sz",unicode:{apple:"1F1F8-1F1FF",google:"1F1F8-1F1FF",twitter:"1F1F8-1F1FF"},shortcode:"flag-sz",description:"REGIONAL INDICATOR SYMBOL LETTERS SZ",category:"flags"},{name:"flag-ta",unicode:{apple:"1F1F9-1F1E6",google:"1F1F9-1F1E6",twitter:"1F1F9-1F1E6"},shortcode:"flag-ta",description:"REGIONAL INDICATOR SYMBOL LETTERS TA",category:"flags"},{name:"flag-tc",unicode:{apple:"1F1F9-1F1E8",google:"1F1F9-1F1E8",twitter:"1F1F9-1F1E8"},shortcode:"flag-tc",description:"REGIONAL INDICATOR SYMBOL LETTERS TC",category:"flags"},{name:"flag-td",unicode:{apple:"1F1F9-1F1E9",google:"1F1F9-1F1E9",twitter:"1F1F9-1F1E9"},shortcode:"flag-td",description:"REGIONAL INDICATOR SYMBOL LETTERS TD",category:"flags"},{name:"flag-tf",unicode:{apple:"1F1F9-1F1EB",google:"1F1F9-1F1EB",twitter:"1F1F9-1F1EB"},shortcode:"flag-tf",description:"REGIONAL INDICATOR SYMBOL LETTERS TF",category:"flags"},{name:"flag-tg",unicode:{apple:"1F1F9-1F1EC",google:"1F1F9-1F1EC",twitter:"1F1F9-1F1EC"},shortcode:"flag-tg",description:"REGIONAL INDICATOR SYMBOL LETTERS TG",category:"flags"},{name:"flag-th",unicode:{apple:"1F1F9-1F1ED",google:"1F1F9-1F1ED",twitter:"1F1F9-1F1ED"},shortcode:"flag-th",description:"REGIONAL INDICATOR SYMBOL LETTERS TH",category:"flags"},{name:"flag-tj",unicode:{apple:"1F1F9-1F1EF",google:"1F1F9-1F1EF",twitter:"1F1F9-1F1EF"},shortcode:"flag-tj",description:"REGIONAL INDICATOR SYMBOL LETTERS TJ",category:"flags"},{name:"flag-tk",unicode:{apple:"1F1F9-1F1F0",google:"1F1F9-1F1F0",twitter:"1F1F9-1F1F0"},shortcode:"flag-tk",description:"REGIONAL INDICATOR SYMBOL LETTERS TK",category:"flags"},{name:"flag-tl",unicode:{apple:"1F1F9-1F1F1",google:"1F1F9-1F1F1",twitter:"1F1F9-1F1F1"},shortcode:"flag-tl",description:"REGIONAL INDICATOR SYMBOL LETTERS TL",category:"flags"},{name:"flag-tm",unicode:{apple:"1F1F9-1F1F2",google:"1F1F9-1F1F2",twitter:"1F1F9-1F1F2"},shortcode:"flag-tm",description:"REGIONAL INDICATOR SYMBOL LETTERS TM",category:"flags"},{name:"flag-tn",unicode:{apple:"1F1F9-1F1F3",google:"1F1F9-1F1F3",twitter:"1F1F9-1F1F3"},shortcode:"flag-tn",description:"REGIONAL INDICATOR SYMBOL LETTERS TN",category:"flags"},{name:"flag-to",unicode:{apple:"1F1F9-1F1F4",google:"1F1F9-1F1F4",twitter:"1F1F9-1F1F4"},shortcode:"flag-to",description:"REGIONAL INDICATOR SYMBOL LETTERS TO",category:"flags"},{name:"flag-tr",unicode:{apple:"1F1F9-1F1F7",google:"1F1F9-1F1F7",twitter:"1F1F9-1F1F7"},shortcode:"flag-tr",description:"REGIONAL INDICATOR SYMBOL LETTERS TR",category:"flags"},{name:"flag-tt",unicode:{apple:"1F1F9-1F1F9",google:"1F1F9-1F1F9",twitter:"1F1F9-1F1F9"},shortcode:"flag-tt",description:"REGIONAL INDICATOR SYMBOL LETTERS TT",category:"flags"},{name:"flag-tv",unicode:{apple:"1F1F9-1F1FB",google:"1F1F9-1F1FB",twitter:"1F1F9-1F1FB"},shortcode:"flag-tv",description:"REGIONAL INDICATOR SYMBOL LETTERS TV",category:"flags"},{name:"flag-tw",unicode:{apple:"1F1F9-1F1FC",google:"1F1F9-1F1FC",twitter:"1F1F9-1F1FC"},shortcode:"flag-tw",description:"REGIONAL INDICATOR SYMBOL LETTERS TW",category:"flags"},{name:"flag-tz",unicode:{apple:"1F1F9-1F1FF",google:"1F1F9-1F1FF",twitter:"1F1F9-1F1FF"},shortcode:"flag-tz",description:"REGIONAL INDICATOR SYMBOL LETTERS TZ",category:"flags"},{name:"flag-ua",unicode:{apple:"1F1FA-1F1E6",google:"1F1FA-1F1E6",twitter:"1F1FA-1F1E6"},shortcode:"flag-ua",description:"REGIONAL INDICATOR SYMBOL LETTERS UA",category:"flags"},{name:"flag-ug",unicode:{apple:"1F1FA-1F1EC",google:"1F1FA-1F1EC",twitter:"1F1FA-1F1EC"},shortcode:"flag-ug",description:"REGIONAL INDICATOR SYMBOL LETTERS UG",category:"flags"},{name:"flag-um",unicode:{apple:"1F1FA-1F1F2",google:"1F1FA-1F1F2",twitter:"1F1FA-1F1F2"},shortcode:"flag-um",description:"REGIONAL INDICATOR SYMBOL LETTERS UM",category:"flags"},{name:"flag-us",unicode:{apple:"1F1FA-1F1F8",google:"1F1FA-1F1F8",twitter:"1F1FA-1F1F8"},shortcode:"flag-us",description:"REGIONAL INDICATOR SYMBOL LETTERS US",category:"flags"},{name:"flag-uy",unicode:{apple:"1F1FA-1F1FE",google:"1F1FA-1F1FE",twitter:"1F1FA-1F1FE"},shortcode:"flag-uy",description:"REGIONAL INDICATOR SYMBOL LETTERS UY",category:"flags"},{name:"flag-uz",unicode:{apple:"1F1FA-1F1FF",google:"1F1FA-1F1FF",twitter:"1F1FA-1F1FF"},shortcode:"flag-uz",description:"REGIONAL INDICATOR SYMBOL LETTERS UZ",category:"flags"},{name:"flag-va",unicode:{apple:"1F1FB-1F1E6",google:"1F1FB-1F1E6",twitter:"1F1FB-1F1E6"},shortcode:"flag-va",description:"REGIONAL INDICATOR SYMBOL LETTERS VA",category:"flags"},{name:"flag-vc",unicode:{apple:"1F1FB-1F1E8",google:"1F1FB-1F1E8",twitter:"1F1FB-1F1E8"},shortcode:"flag-vc",description:"REGIONAL INDICATOR SYMBOL LETTERS VC",category:"flags"},{name:"flag-ve",unicode:{apple:"1F1FB-1F1EA",google:"1F1FB-1F1EA",twitter:"1F1FB-1F1EA"},shortcode:"flag-ve",description:"REGIONAL INDICATOR SYMBOL LETTERS VE",category:"flags"},{name:"flag-vg",unicode:{apple:"1F1FB-1F1EC",google:"1F1FB-1F1EC",twitter:"1F1FB-1F1EC"},shortcode:"flag-vg",description:"REGIONAL INDICATOR SYMBOL LETTERS VG",category:"flags"},{name:"flag-vi",unicode:{apple:"1F1FB-1F1EE",google:"1F1FB-1F1EE",twitter:"1F1FB-1F1EE"},shortcode:"flag-vi",description:"REGIONAL INDICATOR SYMBOL LETTERS VI",category:"flags"},{name:"flag-vn",unicode:{apple:"1F1FB-1F1F3",google:"1F1FB-1F1F3",twitter:"1F1FB-1F1F3"},shortcode:"flag-vn",description:"REGIONAL INDICATOR SYMBOL LETTERS VN",category:"flags"},{name:"flag-vu",unicode:{apple:"1F1FB-1F1FA",google:"1F1FB-1F1FA",twitter:"1F1FB-1F1FA"},shortcode:"flag-vu",description:"REGIONAL INDICATOR SYMBOL LETTERS VU",category:"flags"},{name:"flag-wf",unicode:{apple:"1F1FC-1F1EB",google:"1F1FC-1F1EB",twitter:"1F1FC-1F1EB"},shortcode:"flag-wf",description:"REGIONAL INDICATOR SYMBOL LETTERS WF",category:"flags"},{name:"flag-ws",unicode:{apple:"1F1FC-1F1F8",google:"1F1FC-1F1F8",twitter:"1F1FC-1F1F8"},shortcode:"flag-ws",description:"REGIONAL INDICATOR SYMBOL LETTERS WS",category:"flags"},{name:"flag-xk",unicode:{apple:"1F1FD-1F1F0",google:"1F1FD-1F1F0",twitter:"1F1FD-1F1F0"},shortcode:"flag-xk",description:"REGIONAL INDICATOR SYMBOL LETTERS XK",category:"flags"},{name:"flag-ye",unicode:{apple:"1F1FE-1F1EA",google:"1F1FE-1F1EA",twitter:"1F1FE-1F1EA"},shortcode:"flag-ye",description:"REGIONAL INDICATOR SYMBOL LETTERS YE",category:"flags"},{name:"flag-yt",unicode:{apple:"1F1FE-1F1F9",google:"1F1FE-1F1F9",twitter:"1F1FE-1F1F9"},shortcode:"flag-yt",description:"REGIONAL INDICATOR SYMBOL LETTERS YT",category:"flags"},{name:"flag-za",unicode:{apple:"1F1FF-1F1E6",google:"1F1FF-1F1E6",twitter:"1F1FF-1F1E6"},shortcode:"flag-za",description:"REGIONAL INDICATOR SYMBOL LETTERS ZA",category:"flags"},{name:"flag-zm",unicode:{apple:"1F1FF-1F1F2",google:"1F1FF-1F1F2",twitter:"1F1FF-1F1F2"},shortcode:"flag-zm",description:"REGIONAL INDICATOR SYMBOL LETTERS ZM",category:"flags"},{name:"flag-zw",unicode:{apple:"1F1FF-1F1FC",google:"1F1FF-1F1FC",twitter:"1F1FF-1F1FC"},shortcode:"flag-zw",description:"REGIONAL INDICATOR SYMBOL LETTERS ZW",category:"flags"}]});

;(function($) {
    var a = 'dsadadsa das a da';

    var pluginName = "emojiPicker",
        defaults = {
            width: '200',
            height: '350',
            position: 'right',
            fadeTime: 100,
            iconColor: 'black',
            iconBackgroundColor: '#eee',
            recentCount: 36,
            emojiSet: 'apple',
            container: 'body',
            button: true
        };

    var MIN_WIDTH = 280,
        MAX_WIDTH = 600,
        MIN_HEIGHT = 100,
        MAX_HEIGHT = 350,
        MAX_ICON_HEIGHT = 50;

    var categories = [
        { name: 'people', label: 'People' },
        { name: 'nature', label: 'Nature' },
        { name: 'food', label: 'Food' },
        { name: 'activity', label: 'Activities' },
        { name: 'travel', label: 'Travel & Places' },
        { name: 'object', label: 'Objects' },
        { name: 'symbol', label: 'Symbols' },
        { name: 'flags', label: 'Flags' }
    ];

    function EmojiPicker( element, options ) {

        this.element = element;
        this.$el = $(element);

        this.settings = $.extend( {}, defaults, options );

        this.$container = $(this.settings.container);

        // (type) Safety first
        this.settings.width = parseInt(this.settings.width);
        this.settings.height = parseInt(this.settings.height);

        // Check for valid width/height
        if(this.settings.width >= MAX_WIDTH) {
            this.settings.width = MAX_WIDTH;
        } else if (this.settings.width < MIN_WIDTH) {
            this.settings.width = MIN_WIDTH;
        }
        if (this.settings.height >= MAX_HEIGHT) {
            this.settings.height = MAX_HEIGHT;
        } else if (this.settings.height < MIN_HEIGHT) {
            this.settings.height = MIN_HEIGHT;
        }

        var possiblePositions = [ 'left',
            'right'
            /*,'top',
            'bottom'*/];
        if($.inArray(this.settings.position,possiblePositions) == -1) {
            this.settings.position = defaults.position; //current default
        }

        // Do not enable if on mobile device (emojis already present)
        if(!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ) {
            this.init();
        } else {
            this.isMobile = true;
        }

    }

    $.extend(EmojiPicker.prototype, {

        init: function() {
            this.active = false;
            this.addPickerIcon();
            this.createPicker();
            this.listen();
        },

        addPickerIcon: function() {
            // The wrapper is not needed if they have chosen to not use a button
            if (this.settings.button) {
                var elementHeight = this.$el.outerHeight();
                var iconHeight = elementHeight > MAX_ICON_HEIGHT ?
                    MAX_ICON_HEIGHT :
                    elementHeight;

                // This can cause issues if the element is not visible when it is initiated
                var objectWidth = this.$el.width();

                this.$el.width(objectWidth);

                this.$wrapper = this.$el
                    .wrap("<div class='emojiPickerIconWrap'></div>")
                    .parent();

                this.$icon = $('<div class="emojiPickerIcon"></div>')
                    .height(iconHeight)
                    .width(iconHeight)
                    .addClass(this.settings.iconColor)
                    .css('backgroundColor', this.settings.iconBackgroundColor);
                this.$wrapper.append( this.$icon );
            }

        },

        createPicker: function() {

            // Show template
            this.$picker = $( getPickerHTML() )
                .appendTo( this.$container )
                .width(this.settings.width)
                .height(this.settings.height)
                .css('z-index',10000);

            // Picker height
            this.$picker.find('.sections')
                .height(parseInt(this.settings.height) - 40); // 40 is height of the tabs

            // Tab size based on width
            if (this.settings.width < 240) {
                this.$picker.find('.emoji').css({'width':'1em', 'height':'1em'});
            }

        },

        destroyPicker: function() {
            if (this.isMobile) return this;

            this.$picker.unbind('mouseover');
            this.$picker.unbind('mouseout');
            this.$picker.unbind('click');
            this.$picker.remove();

            $.removeData(this.$el.get(0), 'emojiPicker');

            return this;
        },

        listen: function() {
            // If the button is being used, wrapper has not been set,
            //    and will not need a listener
            if (this.settings.button){
                // Clicking on the picker icon
                this.$wrapper.find('.emojiPickerIcon')
                    .click( $.proxy(this.iconClicked, this) );
            }

            // Click event for emoji
            this.$picker.on('click', 'em', $.proxy(this.emojiClicked, this));

            // Hover event for emoji
            this.$picker.on('mouseover', 'em', $.proxy(this.emojiMouseover, this) );
            this.$picker.on('mouseout',  'em', $.proxy(this.emojiMouseout, this) );

            // Click event for active tab
            this.$picker.find('nav .tab')
                .click( $.proxy(this.emojiCategoryClicked, this) )
                .mouseover( $.proxy(this.emojiTabMouseover, this) )
                .mouseout( $.proxy(this.emojiMouseout, this) );

            // Scroll event for active tab
            this.$picker.find('.sections')
                .scroll( $.proxy(this.emojiScroll, this) );

            this.$picker.click( $.proxy(this.pickerClicked, this) );

            // Key events for search
            this.$picker.find('section.search input')
                .on('keyup search', $.proxy(this.searchCharEntered, this) );

            // Shortcode hover
            this.$picker.find('.shortcode').mouseover(function(e) { e.stopPropagation(); });

            $(document.body).click( $.proxy(this.clickOutside, this) );

            // Resize events forces a reposition, which may or may not actually be required
            $(window).resize( $.proxy(this.updatePosition, this) );
        },

        updatePosition: function() {

            /*  Process:
                1. Find the nearest positioned element by crawling up the ancestors, record it's offset
                2. Find the bottom left or right of the input element, record this (Account for position setting of left or right)
                3. Find the difference between the two, as this will become our new position
                4. Magic.

                N.B. The removed code had a reference to top/bottom positioning, but I don't see the use case for this..
            */

            // Step 1
            // Luckily jquery already does this...
            var positionedParent = this.$picker.offsetParent();
            var parentOffset = positionedParent.offset(); // now have a top/left object

            // Step 2
            var elOffset = this.$el.offset();
            if(this.settings.position == 'right'){
                elOffset.left += this.$el.outerWidth() - this.settings.width;
            }
            elOffset.top += this.$el.outerHeight();

            // Step 3
            var diffOffset = {
                top: (elOffset.top - parentOffset.top),
                left: (elOffset.left - parentOffset.left)
            };

            // this.$picker.css({
            //     top: diffOffset.top,
            //     left: diffOffset.left
            // });

            return this;
        },

        hide: function() {
            this.$picker.hide(this.settings.fadeTime, 'linear', function() {
                this.active = false;
                if (this.settings.onHide) {
                    this.settings.onHide( this.$picker, this.settings, this.active );
                }
            }.bind(this));
        },

        show: function() {
            this.$el.focus();
            this.updatePosition();
            this.$picker.show(this.settings.fadeTime, 'linear', function() {
                this.active = true;
                if (this.settings.onShow) {
                    this.settings.onShow( this.$picker, this.settings, this.active );
                }
            }.bind(this));
        },

        /************
         *  EVENTS  *
         ************/

        iconClicked : function() {
            if ( this.$picker.is(':hidden') ) {
                this.show();
                if( this.$picker.find('.search input').length > 0 ) {
                    this.$picker.find('.search input').focus();
                }
            } else {
                this.hide();
            }
        },

        emojiClicked: function(e) { var clickTarget = $(e.target);
            var emojiSpan;
            if (clickTarget.is('em')) {
                emojiSpan = clickTarget.find('span');

                if (!emojiSpan.hasClass('emoji')) {
                    emojiSpan = clickTarget.find('div');
                }
            } else {
                emojiSpan = clickTarget.parent().find('span, div');
            }

            var emojiShortcode = emojiSpan.attr('class').split('emoji-')[1];
            var emojiUnicode = toUnicode(findEmoji(emojiShortcode).unicode[defaults.emojiSet]);

            insertAtCaret(this.element, emojiUnicode);
            addToLocalStorage(emojiShortcode);
            updateRecentlyUsed(emojiShortcode);

            // For anyone who is relying on the keyup event
            $(this.element).trigger("keyup");

            // trigger change event on input
            var event = document.createEvent("HTMLEvents");
            event.initEvent("input", true, true);
            this.element.dispatchEvent(event);
        },

        emojiMouseover: function(e) {
            var emojiShortcode = $(e.target).parent().find('.emoji').attr('class').split('emoji-')[1];
            var $shortcode = $(e.target).parents('.emojiPicker').find('.shortcode');
            $shortcode.find('.random').hide();
            $shortcode.find('.info').show().html('<div class="emoji emoji-' + emojiShortcode + '"></div><em>' + emojiShortcode + '</em>');
        },

        emojiMouseout: function(e) {
            $(e.target).parents('.emojiPicker').find('.shortcode .info').empty().hide();
            $(e.target).parents('.emojiPicker').find('.shortcode .random').show();
        },

        emojiCategoryClicked: function(e) {
            var section = '';

            // Update tab
            this.$picker.find('nav .tab').removeClass('active');
            if ($(e.target).parent().hasClass('tab')) {
                section = $(e.target).parent().attr('data-tab');
                $(e.target).parent('.tab').addClass('active');
            }
            else {
                section = $(e.target).attr('data-tab');
                $(e.target).addClass('active');
            }

            var $section = this.$picker.find('section.' + section);

            var heightOfSectionsHidden = $section.parent().scrollTop();
            var heightOfSectionToPageTop = $section.offset().top;
            var heightOfSectionsToPageTop = $section.parent().offset().top;

            var scrollDistance = heightOfSectionsHidden
                + heightOfSectionToPageTop
                - heightOfSectionsToPageTop;

            $('.sections').off('scroll'); // Disable scroll event until animation finishes

            var that = this;
            $('.sections').animate({
                scrollTop: scrollDistance
            }, 250, function() {
                that.$picker.find('.sections').on('scroll', $.proxy(that.emojiScroll, that) ); // Enable scroll event
            });
        },

        emojiTabMouseover: function(e) {
            var section = '';
            if ($(e.target).parent().hasClass('tab')) {
                section = $(e.target).parent().attr('data-tab');
            }
            else {
                section = $(e.target).attr('data-tab');
            }

            var categoryTitle = '';
            for (var i = 0; i < categories.length; i++) {
                if (categories[i].name == section) { categoryTitle = categories[i].label; }
            }
            if (categoryTitle == '') { categoryTitle = 'Recently Used'; }

            var categoryCount = $('section.' + section).attr('data-count');
            var categoryHtml = '<em class="tabTitle">' + categoryTitle + ' <span class="count">(' + categoryCount + ' emojis)</span></em>';

            var $shortcode = $(e.target).parents('.emojiPicker').find('.shortcode');
            $shortcode.find('.random').hide();
            $shortcode.find('.info').show().html(categoryHtml);
        },

        emojiScroll: function(e) {
            var sections = $('section');
            $.each(sections, function(key, value) {
                var section = sections[key];
                var offsetFromTop = $(section).position().top;

                if (section.className == 'search' || (section.className == 'people' && offsetFromTop > 0)) {
                    $(section).parents('.emojiPicker').find('nav tab.recent').addClass('active');
                    return;
                }

                if (offsetFromTop <= 0) {
                    $(section).parents('.emojiPicker').find('nav .tab').removeClass('active');
                    $(section).parents('.emojiPicker').find('nav .tab[data-tab=' + section.className + ']').addClass('active');
                }
            });
        },

        pickerClicked: function(e) {
            e.stopPropagation();
        },

        clickOutside: function(e) {
            if ( this.active ) {
                this.hide();
            }
        },

        searchCharEntered: function(e) {
            var searchTerm = $(e.target).val();
            var searchEmojis = $(e.target).parents('.sections').find('section.search');
            var searchEmojiWrap = searchEmojis.find('.wrap');
            var sections = $(e.target).parents('.sections').find('section');

            // Clear if X is clicked within input
            if (searchTerm == '') {
                sections.show();
                searchEmojiWrap.hide();
            }

            if (searchTerm.length > 0) {
                sections.hide();
                searchEmojis.show();
                searchEmojiWrap.show();

                var results = [];
                searchEmojiWrap.find('em').remove();

                $.each($.fn.emojiPicker.emojis, function(i, emoji) {
                    var shortcode = emoji.shortcode;
                    if ( shortcode.indexOf(searchTerm) > -1 ) {
                        results.push('<em><div class="emoji emoji-' + shortcode + '"></div></em>');
                    }
                });
                searchEmojiWrap.append(results.join(''));
            } else {
                sections.show();
                searchEmojiWrap.hide();
            }
        }
    });

    $.fn[ pluginName ] = function ( options ) {

        // Calling a function
        if (typeof options === 'string') {
            this.each(function() {
                var plugin = $.data( this, pluginName );
                switch(options) {
                    case 'toggle':
                        plugin.iconClicked();
                        break;
                    case 'destroy':
                        plugin.destroyPicker();
                        break;
                }
            });
            return this;
        }

        this.each(function() {
            // Don't attach to the same element twice
            if ( !$.data( this, pluginName ) ) {
                $.data( this, pluginName, new EmojiPicker( this, options ) );
            }
        });
        return this;
    };

    /* ---------------------------------------------------------------------- */

    function getPickerHTML() {
        var nodes = [];
        var aliases = {
            'undefined': 'object'
        }
        var items = {};
        var localStorageSupport = (typeof(Storage) !== 'undefined') ? true : false;

        // Re-Sort Emoji table
        $.each($.fn.emojiPicker.emojis, function(i, emoji) {
            var category = aliases[ emoji.category ] || emoji.category;
            items[ category ] = items[ category ] || [];
            items[ category ].push( emoji );
        });

        nodes.push('<div class="emojiPicker">');
        nodes.push('<nav>');

        // Recent Tab, if localstorage support
        if (localStorageSupport) {
            nodes.push('<div class="tab active" data-tab="recent"><div class="emoji emoji-tab-recent"></div></div>');
        }

        // Emoji category tabs
        var categories_length = categories.length;
        for (var i = 0; i < categories_length; i++) {
            nodes.push('<div class="tab' +
                ( !localStorageSupport && i == 0 ? ' active' : '' ) +
                '" data-tab="' +
                categories[i].name +
                '"><div class="emoji emoji-tab-' +
                categories[i].name +
                '"></div></div>');
        }
        nodes.push('</nav>');
        nodes.push('<div class="sections">');

        // Search
        nodes.push('<section class="search">');
        nodes.push('<input type="search" placeholder="Search...">');
        nodes.push('<div class="wrap" style="display:none;"><h1>Search Results</h1></div>');
        nodes.push('</section>');

        // Recent Section, if localstorage support
        if (localStorageSupport) {
            var recentlyUsedEmojis = [];
            var recentlyUsedCount = 0;
            var displayRecentlyUsed = ' style="display:none;"';

            if (localStorage.emojis) {
                recentlyUsedEmojis = JSON.parse(localStorage.emojis);
                recentlyUsedCount = recentlyUsedEmojis.length;
                displayRecentlyUsed = ' style="display:block;"';
            }

            nodes.push('<section class="recent" data-count="' + recentlyUsedEmojis.length + '"' + displayRecentlyUsed + '>');
            nodes.push('<h1>Recently Used</h1><div class="wrap">');

            for (var i = recentlyUsedEmojis.length-1; i > -1 ; i--) {
                nodes.push('<em><span class="emoji emoji-' + recentlyUsedEmojis[i] + '"></span></em>');
            }
            nodes.push('</div></section>');
        }

        // Emoji sections
        for (var i = 0; i < categories_length; i++) {
            var category_length = items[ categories[i].name ].length;
            nodes.push('<section class="' + categories[i].name + '" data-count="' + category_length + '">');
            nodes.push('<h1>' + categories[i].label + '</h1><div class="wrap">');
            for (var j = 0; j < category_length; j++) {
                var emoji = items[ categories[i].name ][ j ];
                nodes.push('<em><span class="emoji emoji-' + emoji.shortcode + '"></span></em>');
            }
            nodes.push('</div></section>');
        }
        nodes.push('</div>');

        nodes.push('</div>');
        return nodes.join("\n");
    }

    function generateEmojiOfDay() {
        var emojis = $.fn.emojiPicker.emojis;
        var i = Math.floor(Math.random() * (364 - 0) + 0);
        var emoji = emojis[i];
        return 'Daily Emoji: <span class="eod"><span class="emoji emoji-' + emoji.name + '"></span> <span class="emojiName">' + emoji.name + '</span></span>';
    }

    function findEmoji(emojiShortcode) {
        var emojis = $.fn.emojiPicker.emojis;
        for (var i = 0; i < emojis.length; i++) {
            if (emojis[i].shortcode == emojiShortcode) {
                return emojis[i];
            }
        }
    }

    function insertAtCaret(inputField, myValue) {
        if (document.selection) {
            //For browsers like Internet Explorer
            inputField.focus();
            var sel = document.selection.createRange();
            sel.text = myValue;
            inputField.focus();
        }
        else if (inputField.selectionStart || inputField.selectionStart == '0') {
            //For browsers like Firefox and Webkit based
            var startPos = inputField.selectionStart;
            var endPos = inputField.selectionEnd;
            var scrollTop = inputField.scrollTop;
            inputField.value = inputField.value.substring(0, startPos)+myValue+inputField.value.substring(endPos,inputField.value.length);
            inputField.focus();
            inputField.selectionStart = startPos + myValue.length;
            inputField.selectionEnd = startPos + myValue.length;
            inputField.scrollTop = scrollTop;
        } else {
            inputField.focus();
            inputField.value += myValue;
        }
    }

    function toUnicode(code) {
        var codes = code.split('-').map(function(value, index) {
            return parseInt(value, 16);
        });
        return String.fromCodePoint.apply(null, codes);
    }

    function addToLocalStorage(emoji) {
        var recentlyUsedEmojis = [];
        if (localStorage.emojis) {
            recentlyUsedEmojis = JSON.parse(localStorage.emojis);
        }

        // If already in recently used, move to front
        var index = recentlyUsedEmojis.indexOf(emoji);
        if (index > -1) {
            recentlyUsedEmojis.splice(index, 1);
        }
        recentlyUsedEmojis.push(emoji);

        if (recentlyUsedEmojis.length > defaults.recentCount) {
            recentlyUsedEmojis.shift();
        }

        localStorage.emojis = JSON.stringify(recentlyUsedEmojis);
    }

    function updateRecentlyUsed(emoji) {
        var recentlyUsedEmojis = JSON.parse(localStorage.emojis);
        var emojis = [];
        var recent = $('section.recent');

        for (var i = recentlyUsedEmojis.length-1; i >= 0; i--) {
            emojis.push('<em><span class="emoji emoji-' + recentlyUsedEmojis[i] + '"></span></em>');
        }

        // Fix height as emojis are added
        var prevHeight = recent.outerHeight();
        $('section.recent .wrap').html(emojis.join(''));
        var currentScrollTop = $('.sections').scrollTop();
        var newHeight = recent.outerHeight();
        var newScrollToHeight = 0;

        if (!$('section.recent').is(':visible')) {
            recent.show();
            newScrollToHeight = newHeight;
        } else if (prevHeight != newHeight) {
            newScrollToHeight = newHeight - prevHeight;
        }

        $('.sections').animate({
            scrollTop: currentScrollTop + newScrollToHeight
        }, 0);
    }

    if (!String.fromCodePoint) {
        // ES6 Unicode Shims 0.1 ,  2012 Steven Levithan http://slevithan.com/ , MIT License
        String.fromCodePoint = function fromCodePoint () {
            var chars = [], point, offset, units, i;
            for (i = 0; i < arguments.length; ++i) {
                point = arguments[i];
                offset = point - 0x10000;
                units = point > 0xFFFF ? [0xD800 + (offset >> 10), 0xDC00 + (offset & 0x3FF)] : [point];
                chars.push(String.fromCharCode.apply(null, units));
            }
            return chars.join("");
        }
    }

})(jQuery);

jQuery(function() {
    if (ControlledFeatures.USE_EMOJI) {
        var messageBox = jQuery('#msgbox');
        messageBox.emojiPicker({
            button: false,
            container: '#fakechatDiv',
            height: 300,
            width: '470'
        });
        jQuery('#emoticonPicker-emoji').on('click', function(event) {
            messageBox.emojiPicker('toggle');
            event.preventDefault();
        });
    }
});
var ONBOARDING={image:[null,null],identities:[],name:"",page:0,init:function(){$j(".legalName").keyup(function(){ONBOARDING.name=$j(".legalName").val(),ONBOARDING.checkConditions()}),$j(".onboardingCheckbox").on("change",function(){ONBOARDING.checkConditions()}),$j("#uploadFrontId, #uploadBackId").on("change",function(){var file=this.files[0];ONBOARDING.setImage($j(this),file)}),$j(".onboardingWrapper select").on("change",function(){ONBOARDING.checkConditions()}),$j("#onboardingSubmit").on("click",function(){var birthdate=[$j('[name="yearBorn"]').val(),$j('[name="monthBorn"]').val(),$j('[name="dayBorn"]').val()].join("-"),data={username:Cam4User.userName,identityType:"PERFORMER",birthdate:birthdate,name:ONBOARDING.name};"Trans"==$j("#genders").val()?data.gender="shemale":data.gender=$j("#genders").val().toLowerCase(),$j.ajax({url:"/rest/v1.0/identity?username="+data.username,type:"POST",contentType:"application/json; charset=utf-8",data:JSON.stringify(data),success:function(result){var counter=ONBOARDING.image.length,date={username:data.username,identityId:result.id};ONBOARDING.image.map(function(image){image&&(counter--,date.image=image,null==ONBOARDING.image[1]&&counter--,counter||(date.lastImage=!0),$j.ajax({url:"/rest/v1.0/identity/image?username="+data.username,type:"POST",data:date}))})},complete:function(data,status){"error"!==status&&($j(".onboardingForm").length>0&&location.reload(),$j("#addIdentitiesModal .modal-header").remove(),$j("#addIdentitiesModal .modal-footer").remove(),$j(".onboardingModalFormContainer").remove(),$j(".onboardingConfirmation").show(),setTimeout(function(){location.reload()},2e3))}})}),$j(".identitiesTablePrevious").on("click",function(){ONBOARDING.changePagination(-1)}),$j(".identitiesTableForward").on("click",function(){ONBOARDING.changePagination(1)})},checkConditions:function(){var isValid=!0;0!=$j(".onboardingCheckbox:checked").length&&0==$j(".onboardingWrapper option:selected:disabled").length&&""!=ONBOARDING.name&&null!=ONBOARDING.name&&null!=ONBOARDING.image[0]||(isValid=!1),isValid?$j("#onboardingSubmit").removeAttr("disabled"):$j("#onboardingSubmit").attr("disabled","disabled")},setImage:function(context,file){var imageSide=context.attr("name"),reader=new FileReader,_this=context;reader.onloadend=function(){"frontId"==imageSide?ONBOARDING.image[0]=reader.result:ONBOARDING.image[1]=reader.result;var label="[for="+_this.attr("id")+"]";$j(label).find("img").attr("src",reader.result),$j(label).find("div").remove(),$j(label).find("img").removeClass("hidden").addClass("showImage"),ONBOARDING.checkConditions()},reader.readAsDataURL(file)},goToIdentitiesPage:function(){var status,row,type;$j(".identities-table tbody").html(""),ONBOARDING.identities.slice(10*ONBOARDING.page,10*ONBOARDING.page+10).map(function(result){var columnStatus;switch(result.status){case"REJECTED":status=js_i18n.rejected,columnStatus=$j('<td class="rejected-title">').text(status);break;case"APPROVED":status=js_i18n.verified,columnStatus=$j('<td class="verified-title">').text(status);break;default:status=js_i18n.added,columnStatus=$j("<td>").text(status)}var firstElement=ONBOARDING.identities.findIndex(function(){return result.id===ONBOARDING.identities[0].id});type=-1!==firstElement?js_i18n.primary:js_i18n.secondary;var columnName=$j("<td>").text(result.name.split(" ")[0]),columnType=$j("<td>").text(type);row=$j("<tr></tr>").append(columnName).append(columnType).append(columnStatus),$j(".identities-table tbody").append(row)})},changePagination:function(page){ONBOARDING.page=ONBOARDING.page+page;var position=10*ONBOARDING.page;void 0===ONBOARDING.identities[position+11]?$j(".identitiesTableForward").hide():$j(".identitiesTableForward").show(),void 0===ONBOARDING.identities[position-1]?$j(".identitiesTablePrevious").hide():$j(".identitiesTablePrevious").show(),ONBOARDING.goToIdentitiesPage()},verifyStatus:function(results){if(!results.length)return $j(".identitiesTabel").remove(),void ONBOARDING.init();switch($j(".onboardingForm").remove(),$j(".performer-verified").show(),$j(".performer-unverified").remove(),results[0].status){case"APPROVED":$j(".unverifiedPerformer").remove(),$j(".onboarded-title").show();break;case"REJECTED":if(results[0].reason){var response=$j("<p>").text(results[0].reason);$j(".performer-rejected").append(response)}$j(".performer-verified").remove(),$j(".unverifiedPerformer").remove(),$j(".performer-rejected").show()}}};$j(".ageVerificationPage").length&&!0===ControlledFeatures.ONBOARDING&&$j(document).on({dragover:function(e){e.preventDefault()},drop:function(e){e.stopPropagation(),e.preventDefault();var labelName,label,parent=$j(e.target.parentElement),file=e.originalEvent.dataTransfer.files[0];file.name.match(/.(jpg|jpeg|png|gif)$/i)&&(labelName=void 0===parent.attr("for")?parent.parent().attr("for"):parent.attr("for"),label=$j("#"+labelName),ONBOARDING.setImage(label,file),ONBOARDING.checkConditions())},ready:function(){$j.ajax({url:"/rest/v1.0/identity/user/"+Cam4User.userName,success:function(results){results.length?(ONBOARDING.verifyStatus(results),ONBOARDING.init(),$j(".identitiesTabel").show(),ONBOARDING.identities=results,ONBOARDING.changePagination(0)):ONBOARDING.verifyStatus(results)}})}});
$j(function(){Cam4User.isLoggedIn||"true"!==Cam4Cookies.getCookie("CAM4AcceptCookieConsent")||$j("#cookiesConsent").remove(),$j(".promptNotification").length>0&&$j("#promptArea").show(),$j("#promptArea").on("click",".nextNotification",function(){$j(".promptNotification.active").length>0||$j(".promptNotification").first().addClass("active");var activeNotification=$j(".promptNotification.active");activeNotification.addClass("hide").removeClass("active"),0===activeNotification.next(".promptNotification").length?$j("#promptArea").hide():activeNotification.next(".promptNotification").addClass("active").removeClass("hide")}),$j("#promptArea").on("click",".acceptCookieConsent",function(){Cam4User.isLoggedIn?$j.ajax({type:"POST",url:"/rest/v1.0/user/"+Cam4User.userName+"/consent?login_user_name="+Cam4User.userName+"&accessHash="+Cam4User.kN,data:JSON.stringify([{consentType:"COOKIES",userConsentStatus:"APPROVED"}]),dataType:"json",contentType:"application/json; charset=utf-8",error:function(err){console.warn("AJAX error in request: "+JSON.stringify(err,null,2))}}):Cam4Cookies.setCookie("CAM4AcceptCookieConsent",!0)})});
