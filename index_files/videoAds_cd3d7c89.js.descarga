var Cam4VideoAds=function(){var streamType=null,addButtonsContainer=null,isRunningAd=!1,typeOfAd="",adTypes={preroll:{straight:"//a.libertystmedia.com/video?a=128&t=36&s=5&p=4",gay:"//a.libertystmedia.com/video?a=129&t=36&s=5&p=4",trans:"//a.libertystmedia.com/video?a=130&t=36&s=5&p=4",mStraight:"//a.libertystmedia.com/video?a=157&t=36&s=5&p=4",mGay:"//a.libertystmedia.com/video?a=158&t=36&s=5&p=4",mTrans:"//a.libertystmedia.com/video?a=159&t=36&s=5&p=4"},midroll:{straight:"//a.libertystmedia.com/video?a=154&s=5&t=36&p=4",gay:"//a.libertystmedia.com/video?a=155&s=5&t=36&p=4",trans:"//a.libertystmedia.com/video?a=156&s=5&t=36&p=4",mStraight:"//a.libertystmedia.com/video?a=287&s=5&t=36&p=4",mGay:"//a.libertystmedia.com/video?a=288&s=5&t=36&p=4",mTrans:"//a.libertystmedia.com/video?a=291&s=5&t=36&p=4"},postroll:{straight:"//a.libertystmedia.com/video?a=137&t=36&s=5&p=4",gay:"//a.libertystmedia.com/video?a=138&t=36&s=5&p=4",trans:"//a.libertystmedia.com/video?a=139&t=36&s=5&p=4"}},decideSchedueledAdsGender=function(adType){var isGay="male"===Cam4User.userGender&&"gay"===Cam4User.userSexPref||"gay"===Cam4User.xtra.key,isShemale="male"===Cam4User.userGender&&"shemale"===Cam4User.userSexPref||"shemale"===Cam4User.xtra.key,gay="gay",trans="trans",straight="straight";return"preroll"!==adType&&"midroll"!==adType||"Desktop"===cam4UserAgent||(gay="mGay",trans="mTrans",straight="mStraight"),isGay?adTypes[adType][gay]:isShemale?adTypes[adType][trans]:adTypes[adType][straight]},isVideoAdsWhitelisted=PageStatus.has("online_viewer")&&!Cam4User.useVrPlayer&&!Cam4User.isSpy&&!isRunningAd,shouldShowReconnectOverlay=!1,videoAdTimeout=null,videoContent=null,adsLoader=null,adsManager=null,contentEndedListener=null,adsContainer=document.getElementById("vast-overlay"),midRollTimeout=null,adsInitialized=null,adDisplayContainer=null,autoplayAllowed=!1,autoplayRequiresMuted=!0,initAdsLoader=function(){try{videoContent="isHls"==getStreamType()?document.getElementById("Cam4HLSPlayer"):document.querySelector(".chatlessPlayer object")}catch(e){console.log("unable to obtain video player - exiting!!!")}null!=videoContent&&void 0!==videoContent?(BrowserDetect.isIOS()&&google.ima.settings.setDisableCustomPlaybackForIOS10Plus(!0),adDisplayContainer=new google.ima.AdDisplayContainer(adsContainer,videoContent),(adsLoader=new google.ima.AdsLoader(adDisplayContainer)).addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,onAdsManagerLoaded,!1),adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,onAdError,!1)):sessionStorage&&sessionStorage.getItem("va_play_freq")&&sessionStorage.removeItem("va_play_freq")},startAdRequest=function(scheduledVideoAdsUrl){var pS=jQuery("#firebasePrivateShow").is(":visible"),rI=jQuery("#firebaseReturningIn").is(":visible"),gS=jQuery("#firebaseGroupShow").is(":visible"),shouldNotDisplayAds=pS||rI||gS;!adsLoader&&shouldNotDisplayAds||(contentEndedListener=function(){adsLoader.contentComplete()},videoContent.onended=contentEndedListener,document.fullscreenElement?document.exitFullscreen().then(function(){requestAds(scheduledVideoAdsUrl)}):videoContent.webkitDisplayingFullscreen?(videoContent.webkitExitFullscreen(),requestAds(scheduledVideoAdsUrl)):requestAds(scheduledVideoAdsUrl))},requestAds=function(adUrl){var adsRequest=new google.ima.AdsRequest;adsRequest.adTagUrl=adUrl,adsRequest.linearAdSlotWidth=videoContent.offsetWidth,adsRequest.linearAdSlotHeight=videoContent.offsetHeight,adsRequest.nonLinearAdSlotWidth=videoContent.offsetWidth,adsRequest.nonLinearAdSlotHeight=videoContent.offsetHeight,adsRequest.setAdWillAutoPlay(autoplayAllowed),adsRequest.setAdWillPlayMuted(autoplayRequiresMuted),adsLoader.requestAds(adsRequest);var headerHeight=$j(".player-header").outerHeight();if(headerHeight&&(adsContainer.style.top=headerHeight+"px",adsContainer.style.bottom=-1*headerHeight+"px"),"Phone"===cam4UserAgent){var videoStyles=videoContent.currentStyle||window.getComputedStyle(videoContent);adsContainer.style.marginLeft=videoStyles.marginLeft}},onAdsManagerLoaded=function(adsManagerLoadedEvent){var adsRenderingSettings=new google.ima.AdsRenderingSettings;adsRenderingSettings.uiElements=[google.ima.UiElements.COUNTDOWN,google.ima.UiElements.AD_ATTRIBUTION],(adsManager=adsManagerLoadedEvent.getAdsManager(videoContent,adsRenderingSettings)).addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,onAdError),adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,onContentPauseRequested),adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,onContentResumeRequested),adsManager.addEventListener(google.ima.AdEvent.Type.PAUSED,function(event){adsManager.resume();try{document.hasFocus()&&window.open(event.getAd().g.clickThroughUrl,"_blank")}catch(e){console.error(e)}}),autoplayAllowed&&playAds()},playAds=function(){try{adsInitialized||initializeAds(),adsManager.init(videoContent.offsetWidth,videoContent.offsetHeight,google.ima.ViewMode.NORMAL),adsManager.start(),$(window).resize(function(){adsManager.resize(videoContent.offsetWidth,videoContent.offsetHeight,google.ima.ViewMode.NORMAL)})}catch(adError){resumeVideoContent()}},onContentPauseRequested=function(){videoContent.removeEventListener("ended",contentEndedListener),pauseVideoContent(),adsContainer.classList.add("visible"),"preroll"===typeOfAd&&addUpgradeToGoldButton(),"midroll"===typeOfAd&&addBuyTokensButton(),isRunningAd=!0},onContentResumeRequested=function(){videoContent.addEventListener("ended",contentEndedListener),resumeVideoContent(),cleanUpVast(),isRunningAd=!1},onAdError=function(adErrorEvent){console.log("video ad error",adErrorEvent.getError()),adsManager&&adsManager.destroy(),resumeVideoContent(),cleanUpVast()},resumeVideoContent=function(){"isHls"===getStreamType()&&videoContent.play(),"isFlash"===getStreamType()&&ChatlessPlayer.reconnect()},pauseVideoContent=function(){"isHls"===getStreamType()&&videoContent.pause(),"isFlash"===getStreamType()&&ChatlessPlayer.stop()},onAutoplayWithSoundSuccess=function(){autoplayAllowed=!0,autoplayRequiresMuted=!1},onMutedAutoplaySuccess=function(){autoplayAllowed=!0,autoplayRequiresMuted=!0},initializeAds=function(){adDisplayContainer.initialize(),adsInitialized=!0},addUpgradeToGoldButton=function(){jQuery("<button/>",{text:Cam4Chat.videoAdsUpgradeToGold,id:"vastGoldUpgrade",onclick:"Utils.decideOffer('', { pageType: 'gold', contextClass: 'videoAd' })"}).appendTo(addButtonsContainer)},addBuyTokensButton=function(){var span=jQuery("<span />",{id:"vastTokensIconWrapper"}),img=jQuery("<img />",{src:WEB_CDN+"/images/icon-tokns.png",alt:"Buy tokens icon"}),div=jQuery("<button/>",{text:Cam4Chat.videoAdsBuyTokens,id:"vastBuyTokens",onclick:"TipFactory.popTokens()"});img.appendTo(span),span.appendTo(div),div.appendTo(addButtonsContainer)},removeUpgradeToGoldButton=function(){jQuery("#vastGoldUpgrade").remove()},removeBuyTokensButton=function(){jQuery("#vastBuyTokens").remove()},cleanUpVast=function(){removeUpgradeToGoldButton(),removeBuyTokensButton(),adsContainer.classList.remove("visible")},getStreamType=function(){return streamType},mbaPlay=document.querySelector(".chatlessPlayer .mbaPlay"),showPlayButtonForFlash=function(){if(ChatlessPlayer.showPlayer(!1),mbaPlay){mbaPlay.classList.remove("hidden");var playButton=document.querySelector(".mbaPlay > .playButton");playButton&&(playButton.onclick=function(){initializeAds(),onAutoplayWithSoundSuccess(),hidePlayButtonForFlash(),showFlashVideo(),startPrerollAd(),startMidrollAd()})}},hidePlayButtonForFlash=function(){mbaPlay.classList.add("hidden")},showFlashVideo=function(){ChatlessPlayer.showPlayer(!0)},shouldShowPrerollAd=function(){if(sessionStorage)if(sessionStorage.getItem("va_play_freq")){var vaPlayFreq=1*sessionStorage.getItem("va_play_freq");if(vaPlayFreq<3)return sessionStorage.setItem("va_play_freq",++vaPlayFreq+""),!1;sessionStorage.setItem("va_play_freq","1")}else sessionStorage.setItem("va_play_freq","1");return!0},showUnmuteOverlay=function(){videoContent.muted=!0;var unmuteOverlay=$("#androidUnmuteLinkOverlay");unmuteOverlay.show(),onMutedAutoplaySuccess(),unmuteOverlay.off("click"),unmuteOverlay.click(function(){videoContent.muted=!1,unmuteOverlay.hide(),initializeAds(),onAutoplayWithSoundSuccess()}),videoContent.addEventListener("loadeddata",function(){videoContent.play()},!1)},startPrerollAd=function(){videoAdTimeout&&clearTimeout(videoAdTimeout),videoAdTimeout=setTimeout(function(){videoAdTimeout=null,typeOfAd="preroll",startAdRequest(decideSchedueledAdsGender("preroll"))},1e4)},startMidrollAd=function(){var hasPurchases=Cam4User.xtra.hasPurchases,over30Days=((new Date).getTime()-1*Cam4User.creationTimestamp)/1e3/60/60/24>30;ControlledFeatures.MID_ROLL_VIDEO_ADS&&over30Days&&!hasPurchases&&(midRollTimeout&&clearTimeout(midRollTimeout),midRollTimeout=setTimeout(function(){midRollTimeout=null,typeOfAd="midroll",Cam4User.xtra.hasEarnings||startAdRequest(decideSchedueledAdsGender("midroll"))},6e5))};return{init:function(sType,adType){return!!isVideoAdsWhitelisted&&(streamType=sType,addButtonsContainer="isHls"==sType?"#video":".chatlessPlayer",!isRunningAd&&(adType&&"postroll"===adType&&(shouldShowReconnectOverlay=!0),videoAdTimeout&&clearTimeout(videoAdTimeout),midRollTimeout&&clearTimeout(midRollTimeout),adsLoader||initAdsLoader(),BrowserDetect.isIOS()&&showUnmuteOverlay(),shouldShowPrerollAd()&&("isFlash"==sType?showPlayButtonForFlash():videoContent.addEventListener("loadeddata",function(){startPrerollAd()},!1)),startMidrollAd(),!0))},videoAdsRunning:function(){return isRunningAd},cleanUpVast:cleanUpVast,getStreamType:getStreamType,onAutoplayWithSoundSuccess:onAutoplayWithSoundSuccess,onMutedAutoplaySuccess:onMutedAutoplaySuccess,initializeAds:initializeAds}}();Cam4VideoAds.init(Cam4User.cameraData.useHlsVideoOnMobile?"isHls":"isFlash","preroll");