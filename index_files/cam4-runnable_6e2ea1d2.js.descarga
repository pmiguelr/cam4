var requirejs,require,define;!function(global){function isFunction(it){return"[object Function]"===ostring.call(it)}function isArray(it){return"[object Array]"===ostring.call(it)}function each(ary,func){if(ary){var i;for(i=0;i<ary.length&&(!ary[i]||!func(ary[i],i,ary));i+=1);}}function eachReverse(ary,func){if(ary){var i;for(i=ary.length-1;i>-1&&(!ary[i]||!func(ary[i],i,ary));i-=1);}}function hasProp(obj,prop){return hasOwn.call(obj,prop)}function getOwn(obj,prop){return hasProp(obj,prop)&&obj[prop]}function eachProp(obj,func){var prop;for(prop in obj)if(hasProp(obj,prop)&&func(obj[prop],prop))break}function mixin(target,source,force,deepStringMixin){return source&&eachProp(source,function(value,prop){!force&&hasProp(target,prop)||(!deepStringMixin||"object"!=typeof value||!value||isArray(value)||isFunction(value)||value instanceof RegExp?target[prop]=value:(target[prop]||(target[prop]={}),mixin(target[prop],value,force,deepStringMixin)))}),target}function bind(obj,fn){return function(){return fn.apply(obj,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(err){throw err}function getGlobal(value){if(!value)return value;var g=global;return each(value.split("."),function(part){g=g[part]}),g}function makeError(id,msg,err,requireModules){var e=new Error(msg+"\nhttp://requirejs.org/docs/errors.html#"+id);return e.requireType=id,e.requireModules=requireModules,err&&(e.originalError=err),e}function newContext(contextName){function trimDots(ary){var i,part;for(i=0;i<ary.length;i++)if("."===(part=ary[i]))ary.splice(i,1),i-=1;else if(".."===part){if(0===i||1===i&&".."===ary[2]||".."===ary[i-1])continue;i>0&&(ary.splice(i-1,2),i-=2)}}function normalize(name,baseName,applyMap){var mapValue,nameParts,i,j,nameSegment,lastIndex,foundMap,foundI,foundStarMap,starI,baseParts=baseName&&baseName.split("/"),map=config.map,starMap=map&&map["*"];if(name&&(lastIndex=(name=name.split("/")).length-1,config.nodeIdCompat&&jsSuffixRegExp.test(name[lastIndex])&&(name[lastIndex]=name[lastIndex].replace(jsSuffixRegExp,"")),"."===name[0].charAt(0)&&baseParts&&(name=baseParts.slice(0,baseParts.length-1).concat(name)),trimDots(name),name=name.join("/")),applyMap&&map&&(baseParts||starMap)){outerLoop:for(i=(nameParts=name.split("/")).length;i>0;i-=1){if(nameSegment=nameParts.slice(0,i).join("/"),baseParts)for(j=baseParts.length;j>0;j-=1)if((mapValue=getOwn(map,baseParts.slice(0,j).join("/")))&&(mapValue=getOwn(mapValue,nameSegment))){foundMap=mapValue,foundI=i;break outerLoop}!foundStarMap&&starMap&&getOwn(starMap,nameSegment)&&(foundStarMap=getOwn(starMap,nameSegment),starI=i)}!foundMap&&foundStarMap&&(foundMap=foundStarMap,foundI=starI),foundMap&&(nameParts.splice(0,foundI,foundMap),name=nameParts.join("/"))}return getOwn(config.pkgs,name)||name}function removeScript(name){isBrowser&&each(scripts(),function(scriptNode){if(scriptNode.getAttribute("data-requiremodule")===name&&scriptNode.getAttribute("data-requirecontext")===context.contextName)return scriptNode.parentNode.removeChild(scriptNode),!0})}function hasPathFallback(id){var pathConfig=getOwn(config.paths,id);if(pathConfig&&isArray(pathConfig)&&pathConfig.length>1)return pathConfig.shift(),context.require.undef(id),context.makeRequire(null,{skipMap:!0})([id]),!0}function splitPrefix(name){var prefix,index=name?name.indexOf("!"):-1;return index>-1&&(prefix=name.substring(0,index),name=name.substring(index+1,name.length)),[prefix,name]}function makeModuleMap(name,parentModuleMap,isNormalized,applyMap){var url,pluginModule,suffix,nameParts,prefix=null,parentName=parentModuleMap?parentModuleMap.name:null,originalName=name,isDefine=!0,normalizedName="";return name||(isDefine=!1,name="_@r"+(requireCounter+=1)),nameParts=splitPrefix(name),prefix=nameParts[0],name=nameParts[1],prefix&&(prefix=normalize(prefix,parentName,applyMap),pluginModule=getOwn(defined,prefix)),name&&(prefix?normalizedName=pluginModule&&pluginModule.normalize?pluginModule.normalize(name,function(name){return normalize(name,parentName,applyMap)}):-1===name.indexOf("!")?normalize(name,parentName,applyMap):name:(prefix=(nameParts=splitPrefix(normalizedName=normalize(name,parentName,applyMap)))[0],normalizedName=nameParts[1],isNormalized=!0,url=context.nameToUrl(normalizedName))),suffix=!prefix||pluginModule||isNormalized?"":"_unnormalized"+(unnormalizedCounter+=1),{prefix:prefix,name:normalizedName,parentMap:parentModuleMap,unnormalized:!!suffix,url:url,originalName:originalName,isDefine:isDefine,id:(prefix?prefix+"!"+normalizedName:normalizedName)+suffix}}function getModule(depMap){var id=depMap.id,mod=getOwn(registry,id);return mod||(mod=registry[id]=new context.Module(depMap)),mod}function on(depMap,name,fn){var id=depMap.id,mod=getOwn(registry,id);!hasProp(defined,id)||mod&&!mod.defineEmitComplete?(mod=getModule(depMap)).error&&"error"===name?fn(mod.error):mod.on(name,fn):"defined"===name&&fn(defined[id])}function onError(err,errback){var ids=err.requireModules,notified=!1;errback?errback(err):(each(ids,function(id){var mod=getOwn(registry,id);mod&&(mod.error=err,mod.events.error&&(notified=!0,mod.emit("error",err)))}),notified||req.onError(err))}function takeGlobalQueue(){globalDefQueue.length&&(each(globalDefQueue,function(queueItem){var id=queueItem[0];"string"==typeof id&&(context.defQueueMap[id]=!0),defQueue.push(queueItem)}),globalDefQueue=[])}function cleanRegistry(id){delete registry[id],delete enabledRegistry[id]}function breakCycle(mod,traced,processed){var id=mod.map.id;mod.error?mod.emit("error",mod.error):(traced[id]=!0,each(mod.depMaps,function(depMap,i){var depId=depMap.id,dep=getOwn(registry,depId);!dep||mod.depMatched[i]||processed[depId]||(getOwn(traced,depId)?(mod.defineDep(i,defined[depId]),mod.check()):breakCycle(dep,traced,processed))}),processed[id]=!0)}function checkLoaded(){var err,usingPathFallback,waitInterval=1e3*config.waitSeconds,expired=waitInterval&&context.startTime+waitInterval<(new Date).getTime(),noLoads=[],reqCalls=[],stillLoading=!1,needCycleCheck=!0;if(!inCheckLoaded){if(inCheckLoaded=!0,eachProp(enabledRegistry,function(mod){var map=mod.map,modId=map.id;if(mod.enabled&&(map.isDefine||reqCalls.push(mod),!mod.error))if(!mod.inited&&expired)hasPathFallback(modId)?(usingPathFallback=!0,stillLoading=!0):(noLoads.push(modId),removeScript(modId));else if(!mod.inited&&mod.fetched&&map.isDefine&&(stillLoading=!0,!map.prefix))return needCycleCheck=!1}),expired&&noLoads.length)return err=makeError("timeout","Load timeout for modules: "+noLoads,null,noLoads),err.contextName=context.contextName,onError(err);needCycleCheck&&each(reqCalls,function(mod){breakCycle(mod,{},{})}),expired&&!usingPathFallback||!stillLoading||!isBrowser&&!isWebWorker||checkLoadedTimeoutId||(checkLoadedTimeoutId=setTimeout(function(){checkLoadedTimeoutId=0,checkLoaded()},50)),inCheckLoaded=!1}}function callGetModule(args){hasProp(defined,args[0])||getModule(makeModuleMap(args[0],null,!0)).init(args[1],args[2])}function removeListener(node,func,name,ieName){node.detachEvent&&!isOpera?ieName&&node.detachEvent(ieName,func):node.removeEventListener(name,func,!1)}function getScriptData(evt){var node=evt.currentTarget||evt.srcElement;return removeListener(node,context.onScriptLoad,"load","onreadystatechange"),removeListener(node,context.onScriptError,"error"),{node:node,id:node&&node.getAttribute("data-requiremodule")}}function intakeDefines(){var args;for(takeGlobalQueue();defQueue.length;){if(null===(args=defQueue.shift())[0])return onError(makeError("mismatch","Mismatched anonymous define() module: "+args[args.length-1]));callGetModule(args)}context.defQueueMap={}}var inCheckLoaded,Module,context,handlers,checkLoadedTimeoutId,config={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},registry={},enabledRegistry={},undefEvents={},defQueue=[],defined={},urlFetched={},bundlesMap={},requireCounter=1,unnormalizedCounter=1;return handlers={require:function(mod){return mod.require?mod.require:mod.require=context.makeRequire(mod.map)},exports:function(mod){if(mod.usingExports=!0,mod.map.isDefine)return mod.exports?defined[mod.map.id]=mod.exports:mod.exports=defined[mod.map.id]={}},module:function(mod){return mod.module?mod.module:mod.module={id:mod.map.id,uri:mod.map.url,config:function(){return getOwn(config.config,mod.map.id)||{}},exports:mod.exports||(mod.exports={})}}},Module=function(map){this.events=getOwn(undefEvents,map.id)||{},this.map=map,this.shim=getOwn(config.shim,map.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},Module.prototype={init:function(depMaps,factory,errback,options){options=options||{},this.inited||(this.factory=factory,errback?this.on("error",errback):this.events.error&&(errback=bind(this,function(err){this.emit("error",err)})),this.depMaps=depMaps&&depMaps.slice(0),this.errback=errback,this.inited=!0,this.ignore=options.ignore,options.enabled||this.enabled?this.enable():this.check())},defineDep:function(i,depExports){this.depMatched[i]||(this.depMatched[i]=!0,this.depCount-=1,this.depExports[i]=depExports)},fetch:function(){if(!this.fetched){this.fetched=!0,context.startTime=(new Date).getTime();var map=this.map;if(!this.shim)return map.prefix?this.callPlugin():this.load();context.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return map.prefix?this.callPlugin():this.load()}))}},load:function(){var url=this.map.url;urlFetched[url]||(urlFetched[url]=!0,context.load(this.map.id,url))},check:function(){if(this.enabled&&!this.enabling){var err,cjsModule,id=this.map.id,depExports=this.depExports,exports=this.exports,factory=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(factory)){try{exports=context.execCb(id,factory,depExports,exports)}catch(e){err=e}if(this.map.isDefine&&void 0===exports&&((cjsModule=this.module)?exports=cjsModule.exports:this.usingExports&&(exports=this.exports)),err){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)return err.requireMap=this.map,err.requireModules=this.map.isDefine?[this.map.id]:null,err.requireType=this.map.isDefine?"define":"require",onError(this.error=err);"undefined"!=typeof console&&console.error?console.error(err):req.onError(err)}}else exports=factory;if(this.exports=exports,this.map.isDefine&&!this.ignore&&(defined[id]=exports,req.onResourceLoad)){var resLoadMaps=[];each(this.depMaps,function(depMap){resLoadMaps.push(depMap.normalizedMap||depMap)}),req.onResourceLoad(context,this.map,resLoadMaps)}cleanRegistry(id),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else hasProp(context.defQueueMap,id)||this.fetch()}},callPlugin:function(){var map=this.map,id=map.id,pluginMap=makeModuleMap(map.prefix);this.depMaps.push(pluginMap),on(pluginMap,"defined",bind(this,function(plugin){var load,normalizedMap,normalizedMod,bundleId=getOwn(bundlesMap,this.map.id),name=this.map.name,parentName=this.map.parentMap?this.map.parentMap.name:null,localRequire=context.makeRequire(map.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(plugin.normalize&&(name=plugin.normalize(name,function(name){return normalize(name,parentName,!0)})||""),normalizedMap=makeModuleMap(map.prefix+"!"+name,this.map.parentMap),on(normalizedMap,"defined",bind(this,function(value){this.map.normalizedMap=normalizedMap,this.init([],function(){return value},null,{enabled:!0,ignore:!0})})),void((normalizedMod=getOwn(registry,normalizedMap.id))&&(this.depMaps.push(normalizedMap),this.events.error&&normalizedMod.on("error",bind(this,function(err){this.emit("error",err)})),normalizedMod.enable()))):bundleId?(this.map.url=context.nameToUrl(bundleId),void this.load()):((load=bind(this,function(value){this.init([],function(){return value},null,{enabled:!0})})).error=bind(this,function(err){this.inited=!0,this.error=err,err.requireModules=[id],eachProp(registry,function(mod){0===mod.map.id.indexOf(id+"_unnormalized")&&cleanRegistry(mod.map.id)}),onError(err)}),load.fromText=bind(this,function(text,textAlt){var moduleName=map.name,moduleMap=makeModuleMap(moduleName),hasInteractive=useInteractive;textAlt&&(text=textAlt),hasInteractive&&(useInteractive=!1),getModule(moduleMap),hasProp(config.config,id)&&(config.config[moduleName]=config.config[id]);try{req.exec(text)}catch(e){return onError(makeError("fromtexteval","fromText eval for "+id+" failed: "+e,e,[id]))}hasInteractive&&(useInteractive=!0),this.depMaps.push(moduleMap),context.completeLoad(moduleName),localRequire([moduleName],load)}),void plugin.load(map.name,localRequire,load,config))})),context.enable(pluginMap,this),this.pluginMaps[pluginMap.id]=pluginMap},enable:function(){enabledRegistry[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(depMap,i){var id,mod,handler;if("string"==typeof depMap){if(depMap=makeModuleMap(depMap,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[i]=depMap,handler=getOwn(handlers,depMap.id))return void(this.depExports[i]=handler(this));this.depCount+=1,on(depMap,"defined",bind(this,function(depExports){this.undefed||(this.defineDep(i,depExports),this.check())})),this.errback?on(depMap,"error",bind(this,this.errback)):this.events.error&&on(depMap,"error",bind(this,function(err){this.emit("error",err)}))}id=depMap.id,mod=registry[id],hasProp(handlers,id)||!mod||mod.enabled||context.enable(depMap,this)})),eachProp(this.pluginMaps,bind(this,function(pluginMap){var mod=getOwn(registry,pluginMap.id);mod&&!mod.enabled&&context.enable(pluginMap,this)})),this.enabling=!1,this.check()},on:function(name,cb){var cbs=this.events[name];cbs||(cbs=this.events[name]=[]),cbs.push(cb)},emit:function(name,evt){each(this.events[name],function(cb){cb(evt)}),"error"===name&&delete this.events[name]}},context={config:config,contextName:contextName,registry:registry,defined:defined,urlFetched:urlFetched,defQueue:defQueue,defQueueMap:{},Module:Module,makeModuleMap:makeModuleMap,nextTick:req.nextTick,onError:onError,configure:function(cfg){cfg.baseUrl&&"/"!==cfg.baseUrl.charAt(cfg.baseUrl.length-1)&&(cfg.baseUrl+="/");var shim=config.shim,objs={paths:!0,bundles:!0,config:!0,map:!0};eachProp(cfg,function(value,prop){objs[prop]?(config[prop]||(config[prop]={}),mixin(config[prop],value,!0,!0)):config[prop]=value}),cfg.bundles&&eachProp(cfg.bundles,function(value,prop){each(value,function(v){v!==prop&&(bundlesMap[v]=prop)})}),cfg.shim&&(eachProp(cfg.shim,function(value,id){isArray(value)&&(value={deps:value}),!value.exports&&!value.init||value.exportsFn||(value.exportsFn=context.makeShimExports(value)),shim[id]=value}),config.shim=shim),cfg.packages&&each(cfg.packages,function(pkgObj){var name;name=(pkgObj="string"==typeof pkgObj?{name:pkgObj}:pkgObj).name,pkgObj.location&&(config.paths[name]=pkgObj.location),config.pkgs[name]=pkgObj.name+"/"+(pkgObj.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}),eachProp(registry,function(mod,id){mod.inited||mod.map.unnormalized||(mod.map=makeModuleMap(id,null,!0))}),(cfg.deps||cfg.callback)&&context.require(cfg.deps||[],cfg.callback)},makeShimExports:function(value){return function(){var ret;return value.init&&(ret=value.init.apply(global,arguments)),ret||value.exports&&getGlobal(value.exports)}},makeRequire:function(relMap,options){function localRequire(deps,callback,errback){var id,map,requireMod;return options.enableBuildCallback&&callback&&isFunction(callback)&&(callback.__requireJsBuild=!0),"string"==typeof deps?isFunction(callback)?onError(makeError("requireargs","Invalid require call"),errback):relMap&&hasProp(handlers,deps)?handlers[deps](registry[relMap.id]):req.get?req.get(context,deps,relMap,localRequire):(map=makeModuleMap(deps,relMap,!1,!0),id=map.id,hasProp(defined,id)?defined[id]:onError(makeError("notloaded",'Module name "'+id+'" has not been loaded yet for context: '+contextName+(relMap?"":". Use require([])")))):(intakeDefines(),context.nextTick(function(){intakeDefines(),(requireMod=getModule(makeModuleMap(null,relMap))).skipMap=options.skipMap,requireMod.init(deps,callback,errback,{enabled:!0}),checkLoaded()}),localRequire)}return options=options||{},mixin(localRequire,{isBrowser:isBrowser,toUrl:function(moduleNamePlusExt){var ext,index=moduleNamePlusExt.lastIndexOf("."),segment=moduleNamePlusExt.split("/")[0],isRelative="."===segment||".."===segment;return-1!==index&&(!isRelative||index>1)&&(ext=moduleNamePlusExt.substring(index,moduleNamePlusExt.length),moduleNamePlusExt=moduleNamePlusExt.substring(0,index)),context.nameToUrl(normalize(moduleNamePlusExt,relMap&&relMap.id,!0),ext,!0)},defined:function(id){return hasProp(defined,makeModuleMap(id,relMap,!1,!0).id)},specified:function(id){return id=makeModuleMap(id,relMap,!1,!0).id,hasProp(defined,id)||hasProp(registry,id)}}),relMap||(localRequire.undef=function(id){takeGlobalQueue();var map=makeModuleMap(id,relMap,!0),mod=getOwn(registry,id);mod.undefed=!0,removeScript(id),delete defined[id],delete urlFetched[map.url],delete undefEvents[id],eachReverse(defQueue,function(args,i){args[0]===id&&defQueue.splice(i,1)}),delete context.defQueueMap[id],mod&&(mod.events.defined&&(undefEvents[id]=mod.events),cleanRegistry(id))}),localRequire},enable:function(depMap){getOwn(registry,depMap.id)&&getModule(depMap).enable()},completeLoad:function(moduleName){var found,args,mod,shim=getOwn(config.shim,moduleName)||{},shExports=shim.exports;for(takeGlobalQueue();defQueue.length;){if(null===(args=defQueue.shift())[0]){if(args[0]=moduleName,found)break;found=!0}else args[0]===moduleName&&(found=!0);callGetModule(args)}if(context.defQueueMap={},mod=getOwn(registry,moduleName),!found&&!hasProp(defined,moduleName)&&mod&&!mod.inited){if(!(!config.enforceDefine||shExports&&getGlobal(shExports)))return hasPathFallback(moduleName)?void 0:onError(makeError("nodefine","No define call for "+moduleName,null,[moduleName]));callGetModule([moduleName,shim.deps||[],shim.exportsFn])}checkLoaded()},nameToUrl:function(moduleName,ext,skipExt){var paths,syms,i,parentModule,url,parentPath,bundleId,pkgMain=getOwn(config.pkgs,moduleName);if(pkgMain&&(moduleName=pkgMain),bundleId=getOwn(bundlesMap,moduleName))return context.nameToUrl(bundleId,ext,skipExt);if(req.jsExtRegExp.test(moduleName))url=moduleName+(ext||"");else{for(paths=config.paths,i=(syms=moduleName.split("/")).length;i>0;i-=1)if(parentModule=syms.slice(0,i).join("/"),parentPath=getOwn(paths,parentModule)){isArray(parentPath)&&(parentPath=parentPath[0]),syms.splice(0,i,parentPath);break}url=syms.join("/"),url=("/"===(url+=ext||(/^data\:|\?/.test(url),"")).charAt(0)||url.match(/^[\w\+\.\-]+:/)?"":config.baseUrl)+url}return config.urlArgs?url+(-1===url.indexOf("?")?"?":"&")+config.urlArgs:url},load:function(id,url){req.load(context,id,url)},execCb:function(name,callback,args,exports){return callback.apply(exports,args)},onScriptLoad:function(evt){if("load"===evt.type||readyRegExp.test((evt.currentTarget||evt.srcElement).readyState)){interactiveScript=null;var data=getScriptData(evt);context.completeLoad(data.id)}},onScriptError:function(evt){var data=getScriptData(evt);if(!hasPathFallback(data.id)){var parents=[];return eachProp(registry,function(value,key){0!==key.indexOf("_@r")&&each(value.depMaps,function(depMap){return depMap.id===data.id&&parents.push(key),!0})}),onError(makeError("scripterror",'Script error for "'+data.id+(parents.length?'", needed by: '+parents.join(", "):'"'),evt,[data.id]))}}},context.require=context.makeRequire(),context}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(script){if("interactive"===script.readyState)return interactiveScript=script}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.22",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if(void 0===define){if(void 0!==requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}void 0===require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(deps,callback,errback,optional){var context,config,contextName=defContextName;return isArray(deps)||"string"==typeof deps||(config=deps,isArray(callback)?(deps=callback,callback=errback,errback=optional):deps=[]),config&&config.context&&(contextName=config.context),(context=getOwn(contexts,contextName))||(context=contexts[contextName]=req.s.newContext(contextName)),config&&context.configure(config),context.require(deps,callback,errback)},req.config=function(config){return req(config)},req.nextTick="undefined"!=typeof setTimeout?function(fn){setTimeout(fn,4)}:function(fn){fn()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(prop){req[prop]=function(){var ctx=contexts[defContextName];return ctx.require[prop].apply(ctx,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],(baseElement=document.getElementsByTagName("base")[0])&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(config,moduleName,url){var node=config.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return node.type=config.scriptType||"text/javascript",node.charset="utf-8",node.async=!0,node},req.load=function(context,moduleName,url){var node,config=context&&context.config||{};if(isBrowser)return node=req.createNode(config,moduleName,url),config.onNodeCreated&&config.onNodeCreated(node,config,moduleName,url),node.setAttribute("data-requirecontext",context.contextName),node.setAttribute("data-requiremodule",moduleName),!node.attachEvent||node.attachEvent.toString&&node.attachEvent.toString().indexOf("[native code")<0||isOpera?(node.addEventListener("load",context.onScriptLoad,!1),node.addEventListener("error",context.onScriptError,!1)):(useInteractive=!0,node.attachEvent("onreadystatechange",context.onScriptLoad)),node.src=url,currentlyAddingScript=node,baseElement?head.insertBefore(node,baseElement):head.appendChild(node),currentlyAddingScript=null,node;if(isWebWorker)try{importScripts(url),context.completeLoad(moduleName)}catch(e){context.onError(makeError("importscripts","importScripts failed for "+moduleName+" at "+url,e,[moduleName]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(script){if(head||(head=script.parentNode),dataMain=script.getAttribute("data-main"))return mainScript=dataMain,cfg.baseUrl||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0}),define=function(name,deps,callback){var node,context;"string"!=typeof name&&(callback=deps,deps=name,name=null),isArray(deps)||(callback=deps,deps=null),!deps&&isFunction(callback)&&(deps=[],callback.length&&(callback.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(match,dep){deps.push(dep)}),deps=(1===callback.length?["require"]:["require","exports","module"]).concat(deps))),useInteractive&&(node=currentlyAddingScript||getInteractiveScript())&&(name||(name=node.getAttribute("data-requiremodule")),context=contexts[node.getAttribute("data-requirecontext")]),context?(context.defQueue.push([name,deps,callback]),context.defQueueMap[name]=!0):globalDefQueue.push([name,deps,callback])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this);
require.config({baseUrl:WEB_CDN+"/",paths:{jqueryanyslider:"js/modules/jqueryPlugins/jquery.anyslider.js",streamembed:"js/modules/StreamEmbed_8fa6346c.js",marketinglanding:"js/modules/marketingLandingAd_494acb35.js",landingpage:"js/modules/landingPage_f51e4729.js",mailAndNotificationSettings:"js/modules/MailAndNotificationSettings_2118aa56.js"}});
WaitFor.core(function(){$j(document).ready(function(){$j(".introTxt").textfill({maxFontPixels:70}),$j(".introTxt").textfill({maxFontPixels:36,innerTag:"h1"});var srUrl=$j("#wishListStockroomProfilePage a").attr("href");if(null!=srUrl&&"https://"!=srUrl.substring(0,8)&&$j("#wishListStockroomProfilePage a").attr("href","https://"+srUrl),null!=(srUrl=$j("#wishListAmazonProfilePage a").attr("href"))&&"http://"!=srUrl.substring(0,7)&&$j("#wishListAmazonProfilePage a").attr("href","http://"+srUrl),null!=(srUrl=$j("#wishListEdenProfilePage a").attr("href"))&&"http://"!=srUrl.substring(0,7)&&$j("#wishListEdenProfilePage a").attr("href","http://"+srUrl),null!=document.getElementById("makeMeScrollable")){var n=$j("#makeMeScrollable .scrollWrapper .scrollableArea a").length;null!=document.getElementById("adSpace")?n<=2&&$j("#makeMeScrollable .scrollingHotSpotRight").addClass("disableCarouselRightArrow"):n<=3&&$j("#makeMeScrollable .scrollingHotSpotRight").addClass("disableCarouselRightArrow")}var timezoneText="";$j(".choice.timezone_select select[name=timezone] option").each(function(){-1!=(timezoneText=$j(this).text()).indexOf("_")&&$j(this).text(timezoneText.replace(/_/g," "))}),setPrice(),$j('[name="productId"]').live("change",function(event){$j('[name="productId"]').removeAttr("checked"),$j(this).attr("checked","checked"),setPrice()}),$j("#sendContactRequest").attr("disabled","disabled"),$j("#registerForm").submit(function(){return $j("#userName, #email").unbind(),!0}),$j(".sharebox").mouseenter(function(){$j(".sharebox").unbind();var urlToAdd=document.location.href;$j(".g_img, .fb_img").remove(),function(url,call_id){$j(".sharebox").append('<iframe frameborder="0" width="60" height="20" id="'+call_id+'" >'),$j("iframe#"+call_id).attr("src",url)}("https://plusone.google.com/_/+1/fastbutton?url="+urlToAdd+"&size=medium","google_slot"),function(url,call_id){$j(".sharebox").append('<iframe frameborder="0" width="75" height="20" id="'+call_id+'" >'),$j("iframe#"+call_id).attr("src",url)}("https://www.facebook.com/plugins/like.php?href="+urlToAdd+"&layout=button_count","facebook_slot")})})});
var ncTip;WaitFor.dependencies(["jQuery","Cam4Event","js_i18n","nstiplang"],function(){var communicator=TipCommunicator,tippingJarDiv=$("#tippingJarDiv"),modalLayout=$("#modalLayout"),modalContent=$("#modalLayout .modal-content"),bodySelector=$("body"),tipModalHeader='<div class="modal-header"><button type="button" class="close" data-dismiss="modal">&times;</button><h3 class="title">'+nstiplang.tipToUsername+Cam4User.performerName+"</h3></div>",balanceBuyToken='<span class="linkStyle" onclick="TipFactory.popTokens()">'+nstiplang.buyTokens+"</span>",inputAmount=$('#tippingJarDiv input[type="text"]').val("").addClass("form-control").removeAttr("onblur"),balance=0;"undefined"!=typeof TipBalance&&(balance=TipBalance.refresh());var mainText=nstiplang.enterTipAmmount;Cam4User.isBroadcaster()||0!=balance||(mainText=nstiplang.sendAPrivateTip+":"),tippingJarDiv.prepend('<p id="enterTipAmount">'+mainText+"</p>"),$("#enterTipAmount").append('<span class="sentTipBalanceLabel">('+nstiplang.balance+'<span class="balanceLoaded" id="tipBalanceModal"></span>'+nstiplang.tokens+" / "+balanceBuyToken+")</span>").after(inputAmount),$("#tippingJarDiv textarea").val("").addClass("form-control").removeAttr("onblur").after("<hr />"),$("#tipjarHref").addClass("btn btn-orange"),$("#tipjarError .success").attr("id","tippingSuccessDiv"),Utils.popTipJar=function(){Cam4User.isLoggedIn||Cam4User.isLoggedInAsGuest||Cam4User.useGuestBilling?($(".balanceLoaded").html($("#tipJarBalance").html()),$("#tipjarAction").css({display:"block",visibility:"visible"}),modalLayout&&0!=modalLayout.length&&modalContent&&0!=modalContent.length||(bodySelector.prepend('<div class="modal fade" id="modalLayout"><div class="modal-dialog"><div class="modal-content"></div></div></div>'),modalLayout=$("#modalLayout"),modalContent=$("#modalLayout .modal-content")),modalContent.empty().prepend(tipModalHeader).append(tippingJarDiv.show()),modalLayout.modal(),modalLayout.on("shown.bs.modal",function(e){tippingJarDiv.find("#tipJarInput").focus()}),Cam4Event.dispatch(Cam4Event.MODAL_OPENED)):Utils.decideOffer("",{unlockFeature:"tokens",ct:"wost",sendtipuser:Cam4User.performerName})},bodySelector.on("click","#privateTipButton",function(e){Utils.popTipJar()}),!PageStatus.has("online_viewer")||PageStatus.has("cam_embedded")&&!PageStatus.has("embed")||($j(document).ready(function(){Cam4User.isViewer()&&(Cam4User.performerAcceptTips?(ServiceTipViewer.start(),ncTip=new TipWatcher):ncTip=new TipDisabled),ncTip.loadLang(),ncTip.responsiveFix("viewer"),ncTip.setGoalBarData(nstiplang.total,nstiplang.goal,0,0),ControlledFeatures&&ControlledFeatures.TIPPING_BAR_APPS_ENGINE_VIEWER||TipFactory.decrementDeadlineForGuest(),Cam4Event.dispatch(Cam4Event.VIEWER_TIPPING_BAR_LOADED)}),$j(window).resize(function(event){ncTip.responsiveFix("viewer")}));try{if(PageStatus.has("online_performer")){var tippingWidgets=$j("#newTipAreaMain");Cam4User.performerAcceptTips?(tippingWidgets.show(),Cam4Event.hasEventListener(Cam4Event.STARTING_BROADCAST,"createSessionOnStartBroadcast")||Cam4Event.addEventListener(Cam4Event.STARTING_BROADCAST,function(){console.log("createSessionOnStartBroadcast handler called"),ServiceTipPerformer.start(),(ncTip=new TipBroadcaster).loadLang()},"createSessionOnStartBroadcast")):tippingWidgets.hide()}}catch(ex){communicator.log("error",ex)}});
if(Cam4User.isLoggedIn){var cookieLoggedIn=Cam4Cookies.getCookie("userWasLoggedIn");null===cookieLoggedIn&&Cam4Cookies.setCookie("userWasLoggedIn","wasLogged")}PageStatus.has("footer_jsp")&&$j(document).ready(function(){-1!=window.location.toString().indexOf("act=")&&-1!=window.location.toString().indexOf("displayConfirm=true")&&Cam4Event.addEventListener(Cam4Event.WINDOW_ON_BEFORE_UNLOAD,function(){Cam4Xtra.referralAdPrompt()})}),(PageStatus.has("footer_jsp")||UserAgent.phone)&&("undefined"!=typeof Cam4Event&&Cam4Event.addEventListener(Cam4Event.WINDOW_ON_BEFORE_UNLOAD,Cam4Xtra.exit),$j(document).ready(function(){!function(settings){if(settings.enabled&&"false"===settings.showDisclaimer)if(PageStatus.isDirectory)showInitSignupOverlay(settings.rightWidth,settings.zoneName,settings.userName,settings.listingType,settings.isDirectory,settings.isLoggedIn,settings.key,settings.showBroadcast);else if("sponsored"===settings.mode)displayAds(settings.rightWidth,settings.zoneName,settings.userName,settings.listingType,settings.isDirectory,settings.isLoggedIn,settings.key,settings.showBroadcast,settings.isProfilePage);else try{NonSponsoredBanners.loadBottom()}catch(ex){}}(Cam4User.xtra)}));
Cam4User.htmlStates.indexOf("twitterConnect_ftl")>-1?TwitterResponse.handler=function(){window.location.href=window.location.href.split("?")[0]+"?reload="+Math.random(),Cam4User.isAffiliateReferer&&(window.location.href+="&affiliateReferer=true")}:Cam4User.htmlStates.indexOf("overlays_jsp")>-1&&Cam4User.isBroadcastingWindow&&(TwitterOverlay.data={payingMember:Cam4User.isPayingMember(),room:Cam4User.performerName,userName:Cam4User.userName,userId:Cam4User.userId,defaultTxt:{prefix:"#CAM4 ",suffix:["I'm live on "]},showTwitterOptions:Cam4User.showTwitterOptions,wordsNotAllowed:js_i18n.wordsNotAllowed},TwitterResponse.handler=function(){TwitterOverlay.closeTwitterWindow(),TwitterOverlay.openTwitterWindow(Cam4User.userId),console.log("TwitterResponse.handler called")},TwitterOverlay.init());
(Cam4Performer.statusModel.isBroadcasting||useBroadcasterFirebaseChat||"MBA"==Cam4User.broadcastSource)&&(Cam4User.isLoggedIn?((Cam4User.performerName.toLowerCase()!=Cam4User.userName.toLowerCase()||void 0!==RequestParameters.broadcastSource&&"MBA"==RequestParameters.broadcastSource)&&Chat.init(Cam4User.performerName.toLowerCase(),Cam4User.userName.toLowerCase(),Cam4User.kN,UserAgent.phone,""),$j(function(){Chat.toggleChatMenu(),$("#usersTab, #GSTab, #chatTab, #GamesTab").on("click",function(){ChatUIController.tabClick(this),ChatUIController.renderVisibleAvatars(".userListAvatar")}),$("#privateMessageUserList").sortable({revert:!1,axis:"x",containment:"parent"}),$("body").on("click",function(event){event.originalEvent&&"userContextualMenu"!==event.originalEvent.target.id&&"roomModeratorMenu"!==event.originalEvent.target.id&&"roomAdminMenu"!==event.originalEvent.target.id&&ChatUIController.hideContextualMenu()}),UserAgent.phone||$("#chatTab").click(),$("#msgbox").on("keypress",function(e){13===e.which&&(ChatUIController.sendMessage(),e.preventDefault())}),$("#passwordForPrivateRoom").on("keypress",function(e){13===e.which&&(Chat.getPrivateRoomAccess("withPass"),e.preventDefault())}),$("#contextualAddFriend").on("click",function(){var user=Chat.getContextualUser();ChatUIController.friendAction(Cam4User.userName,user),$("#userContextualMenu").hide()}),$("#contextualAddFavorite").on("click",function(){var user=Chat.getContextualUser();ChatUIController.favoriteAction(user),$("#userContextualMenu").hide()}),$("#peekContextual").on("click",function(){if(Cam4User.isPayingMember()||ControlledFeatures.GOLD_FREE_FEATURES){var user=Chat.getContextualUser();ChatPreview.openPreview(user.name)}else Registration.showGoldUpgradeOverlay("picture-in-picture")}),$("#contextualNotes").on("click",function(){ChatUIController.getContextualNotes()}),$("#saveNotes").on("click",function(){ChatUIController.saveContextualNotes()}),$(".noteClasification").on("change",function(){ChatUIController.changeNoteClasification($(this).val())}),$("#removeNotes").on("click",function(){ChatUIController.deleteContextualNotes()}),$("#sendPrivateMessage").removeAttr("onclick").on("click",function(){var msg=$j("#privateMessageText").val(),to=$j("#roomList").val();Chat.sendMessage(msg,to),Overlays.closeAll(),$("#privateMessageText").val("")}),ControlledFeatures.SILENCE_FEATURE&&$j.ajax({url:"/rest/v1.0/profile/"+Cam4User.userName+"/silence",type:"GET",success:function(response){var silencedUsers=response.usersList.map(function(user){return user.username});Cam4User.silencedUsers=silencedUsers}}),$("#silenceUser").on("click",function(){var user=Chat.getContextualUser();ChatUIController.silenceUserConfirmation(Cam4User.userName,user.name,"silence_user")}),$("#unsilenceUser").on("click",function(){var user=Chat.getContextualUser();ChatUIController.silenceUserConfirmation(Cam4User.userName,user.name,"unsilence_user")}),$("#complaintsAboutUser").on("click",function(){Complaints.openAbuseForm()}),$("#ignoreUser").on("click",function(){var user=Chat.getContextualUser();ChatUIController.ignoreUserConfirmation(user.name,"ignore_user"),$("#userContextualMenu").hide()}),$("#unignoreUser").on("click",function(){var user=Chat.getContextualUser();ChatUIController.ignoreUserConfirmation(user.name,"unignore_user"),$("#userContextualMenu").hide()}),$("#inviteJoinMyRoom").on("click",function(){var username=Chat.getContextualUser().name,data={};data.recipient=username,Chat.sendRoomNotification("sendNotification","joinInvite",data,!1)}),$("#chatUsersList").on("scroll",Utils.throttle(function(){ChatUIController.renderVisibleAvatars(".userListAvatar")},500)),$("#sendMessageTo").on("click",function(){var sender=Chat.getUser(Cam4User.userName),senderIsRoomModerator=!1;void 0!==sender&&"1"==sender.isRoomModerator&&(senderIsRoomModerator=!0);var to=Chat.getContextualUser().name,thatUser=Chat.getUser(to),onlineInRoom=void 0!==thatUser,allowedToSendPMToBroadcaster=("1"==sender.isFanclubSubscribed||Cam4User.isSubscribedToFanClub())&&to.toLowerCase()==Cam4User.performerName.toLowerCase();onlineInRoom&&(Cam4User.accessLevel>=AccessLevel.GOLD||senderIsRoomModerator||allowedToSendPMToBroadcaster||Cam4User.isBroadcastingWindow)?(ChatUIController.addMessageTab(thatUser.original_username,thatUser.imageCDN,to,!0,thatUser),$("#"+to+"Tab").click()):Cam4User.accessLevel<AccessLevel.GOLD&&onlineInRoom?Registration.showGoldUpgradeOverlay("private-message"):ProfileModalMessage.open(to),$("#userContextualMenu").hide()})})):(Chat.init(Cam4User.performerName.toLowerCase(),"","",!1,""),$("#msgbox").on("keypress",function(e){13==e.which&&(Chat.showLoginAlert(),Cam4User.isLoggedInAsGuest?Registration.activateGuestRegisterModal():Utils.decideOffer(),e.preventDefault())})),$j(function(){$(window).focus(function(){Cam4User.isBroadcastingWindow||(JsSender.tabFocus(),Cam4User.windowFocused=!0)}),$(window).blur(function(){Cam4User.isBroadcastingWindow||(Cam4User.windowFocused=!1)}),$("#videoSettings").on("click",function(){$("#sliderControls").slideToggle()}),$("#enableAudio").on("click",function(){ChatUIController.showSpeakerOn()}),$("#pauseAudio").on("click",function(){ChatUIController.showSpeakerOff()}),$("#fullScreen").on("click",function(){mobileFullScreenAPI.toggleFullScreen(),$("#exitFullScreen").show(),$("#fullScreen").hide()}),$("#exitFullScreen").on("click",function(){mobileFullScreenAPI.toggleFullScreen(),$("#exitFullScreen").hide(),$("#fullScreen").show()}),ControlledFeatures.EXTERNAL_ENCODER_NO_VIDEO&&Cam4User.isBroadcastingWindow&&$("#toggleOBS").on("click",function(){ChatUIController.toggleOBS()}),UserAgent.tablet&&$(window).on("resize",function(event){event.stopPropagation(),ChatlessPlayer.resize.init()}),$("#fakechatDiv").on("click",".contextualMenu",function(event){event.stopPropagation();var thisObj=$(this);Cam4User.isLoggedIn?ChatUIController.showContextualMenu(thisObj):Cam4User.isLoggedInAsGuest?Registration.activateGuestRegisterModal():(LoginModals.activateLoginModal(),Chat.showLoginAlert())}),$("#fakechatDiv").on("click",".editNote",function(event){event.stopPropagation();var thisObj=$(this);if(Cam4User.isLoggedIn){var user=String(thisObj.attr("data-user"));ChatUIController.getAjaxNotes(user)}})}));
WaitFor.core(function(list){Cam4User.htmlStates.indexOf("any_slyder")>-1&&$j(function(){$j("#slider").AnySlider({bullets:!1})})});
$(function(){var videoContainer=$("#broadcastingApp");UserAgent.phone&&videoContainer.length&&$("body").scrollTop(videoContainer.offset().top-38)}),WaitFor.core(function(){~Cam4User.htmlStates.indexOf("profilePageHeaderInfo_jsp")&&Conversations.bindMessageModalEvents(),$j(document).ready(function(){document.getElementById("rateArticleDiv")&&document.getElementById("voteAverage")&&RatingSystem.init(document.getElementById("voteAverage").innerHTML,"rateArticleDiv"),Cam4User.htmlStates.indexOf("privateShowReceipt_jsp")>-1&&RatingSystem.init(0,"rateNSDiv"),Cam4User.htmlStates.indexOf("profile_ratingstars_jsp")>-1&&RatingSystem.init(RatingData.actualRating,"rateUserDiv",Cam4User.isLoggedIn)})});
(Cam4User.isLoggedIn||Cam4User.isLoggedInAsGuest||Cam4User.useGuestBilling)&&(Cam4Performer.statusModel.isBroadcasting&&"undefined"!=typeof PageStatus&&PageStatus.isProfile||"undefined"!=typeof sourcePage&&"profile"==sourcePage?WaitFor.dependencies(["isChatAuthenticated"],function(){Cam4UserNotifications.init()}):Cam4UserNotifications.init()),Cam4User.isLoggedIn&&$.get("/mail/unreadThreads",function(response){void 0!==response&&void 0!==response.unreadThreads&&("undefined"!=Conversations.unreadThreadsIds&&0!=Conversations.unreadThreadsIds.length||(Conversations.unreadThreadsIds=response.unreadThreads))}),$j(document).ready(function(){(Cam4User.isLoggedIn||Cam4User.isLoggedInAsGuest)&&(ControlledFeatures.USE_EWALLET||ControlledFeatures.USE_PAYOUTS)&&$j.ajax({url:"/rest/v1.0/ewallet/"+Cam4User.userName+"/accounts",type:"GET",cache:!1,dataType:"json",success:function(accounts){var balance="0",earnings=0;if(accounts&&accounts.length>0)for(var i=0;i<accounts.length;i++){var type=accounts[i].type;"WALLET"==type?balance=parseFloat(accounts[i].balance).toFixed():"EARNINGS"==type&&(Cam4User.xtra.hasEarnings=!0,earnings=parseFloat(accounts[i].balance/10).toFixed(2))}(ControlledFeatures.USE_EWALLET||ControlledFeatures.USE_PAYOUTS)&&document.getElementById("ewEarnings")&&(document.getElementById("ewEarnings").innerHTML=earnings),ControlledFeatures.USE_EWALLET&&TipBalance.updateBalanceFields(balance)}})});
$j(function(){~Cam4User.htmlStates.indexOf("threaded_conversations")&&Conversations.init()});
function resizePlayer(){var frameHeight=win.height(),frameWidth=win.width();if(frameWidth>frameHeight){var height=win.height()-$(".player-header").height()-10;Cam4User.cameraData.embed&&(height=height-10-$("#newTippingViewer").height()),ChatlessPlayer.resize.updateChat(1.33*height,height)}else ChatlessPlayer.resize.updateChat(frameWidth,.75*frameWidth)}function _camEmbeddedRedirect(){var urlpath="/"+Cam4Performer.name+(Cam4Performer.referrerUrlId?"?referrerId="+Cam4Performer.referrerUrlId:"");window._camEmbeddedWindow=window.open(urlpath),$(".ui-resizable-e").hide()}if(WaitFor.core(function(){Cam4Event.addEventListener(Cam4Event.PLAYER_LOADED,function(){try{flashObj&&flashObj.jsIsReady()}catch(ex){console.log(ex)}}),Cam4Event.addEventListener(Cam4Event.MULTICAM_DETECTED,function(data){var action="Utils.decideOffer('C4BND_MULTI_CAM_PIP');";Cam4User.isLoggedIn||Cam4User.isLoggedInAsGuest||!data.url||(Registration.__activeUrl=data.url,action="Registration.activateRegModal(Registration.__activeUrl);");var text=js_i18n.multicamDetected.replace("{0}","<span>").replace("{1}",'</span><a href="#" onclick="'+action+'">').replace("{2}","</a>");$j("#profilePostroll .profilePostrollRight").html(text)})}),PageStatus.has("cam_embedded")){window._camEmbeddedWindow=!1,Cam4User.cameraData.embed||$("#camPaneBig").append('<div style="top:0; width: 100%; height: 100%; z-index:99999; position: absolute" onclick="_camEmbeddedRedirect();"></div>'),$("body").addClass("streamEmbed");var win=$(window);win.on("resize",resizePlayer),Cam4Event.addEventListener(Cam4Event.VIEWER_TIPPING_BAR_LOADED,resizePlayer),resizePlayer(),Cam4Performer.statusModel.isBroadcasting||$("body").html('<div class="camembed-off" onclick="_camEmbeddedRedirect();"><span style="background-image: url(\''+Cam4User.profileImageUrl+'\');" class="circle"></span><p class="lead" style="font-size: 16px;">I\'m currently offline. Click here to visit my profile.</p><img src="'+WEB_CDN+'/promo/insights/resources/images/cam4logo.png" width="110" style="margin: 30px 0 0;"> </div>')}
RequireJsModules.length>1&&(RequireJsModules=RequireJsModules.splice(0,RequireJsModules.length-1),require(RequireJsModules,function(myFile){}));
Cam4User.isLoggedIn||WaitFor.core(function(){$j(document).ready(function(){$j("#rateUserDiv a").click(function(){dataLayer.push({event:"starRatingBtn"})}),$j("#whiteShelf .showGift .registerModal").click(function(){dataLayer.push({event:"giftIconShowcase"})}),$j(".removeAds").click(function(){dataLayer.push({event:"removeAds"})})})});
$j(document).ready(function(){idVerificationEnabled||"pending"!=Cam4User.broadcasterStatus||(NetVerify.viewerNotification='<div id="netVerifyViewerNotification"><p>'+js_i18n.netVerify.viewerBroadcastPaused+"</p><p>"+js_i18n.netVerify.viewerWaitBeBack+"</p></div>",NetVerify.toggleAgeCheckNotification(!0))});
"undefined"!=typeof NewShow&&"MBA"!==PageStatus.broadcastSource&&(Cam4User.isBroadcaster()&&(""==NewShow.status.timeInfo&&(NewShow.status.timeInfo=js_i18n.showStartsIn),ncTip.init(),NewShow.styleBroadcaster(),NewShow.setTableMessage(js_i18n.noPsRequest),NewShow.refreshStyle(),NewShow.addDomEvents(),document.getElementById("allowSpy")&&(document.getElementById("allowSpy").checked=!0),function(prices,defaultPrices,c2cPrices){$j("#selectPSPrice").html(""),$j("#selectSSPrice").html(""),$j("#selectC2CPrice").html("");for(var psmap=[],ssmap=[],i=0;i<prices.length;i++)-1===psmap.indexOf(prices[i].psprice)&&($j("#selectPSPrice").append('<option value="'+prices[i].psprice+'">'+prices[i].psprice+" "+nstiplang.tokens+"</option>"),psmap.push(prices[i].psprice)),-1===ssmap.indexOf(prices[i].ssprice)&&($j("#selectSSPrice").append('<option value="'+prices[i].ssprice+'">'+prices[i].ssprice+" "+nstiplang.tokens+"</option>"),ssmap.push(prices[i].ssprice));for(i=0;i<c2cPrices.length;i++)$j("#selectC2CPrice").append('<option value="'+c2cPrices[i]+'">'+c2cPrices[i]+" "+nstiplang.tokens+"</option>")}(GSSelectOpts.prices,GSSelectOpts.defaultPrices,GSSelectOpts.c2cPrices),NewShowReceiver.onPrivateShowPrice(GSSelectOpts.defaultPrices.privateShow,GSSelectOpts.defaultPrices.spyShow)),Cam4User.isViewer()&&(""==NewShow.status.timeInfo&&(NewShow.status.timeInfo=js_i18n.timeRemaining),$j(document).ready(function(){try{NewShow.displayProperties.lastAction=ffUpdate.update}catch(ex){setTimeout(function(){NewShow.displayProperties.lastAction=ffUpdate.update},1e3)}NewShow.updateTippingData(NewShow.status.info),NewShow.refreshStyle(),$j("#sendPrivateForm").hide(),ncTip.init()})));
WaitFor.core(function(){$j(document).ready(function(){if("support_article"===PageStatus.sourcePage){var iframes=$j("#support-right-col").find("iframe");if(iframes.length>0)for(var k=0;k<iframes.length;k++)iframes[k].outerHTML='<div class="iframe-wrapper">'+iframes[k].outerHTML+"</div>"}})});
var ImageServer=function(){function ImageServer(){}return Object.defineProperty(ImageServer,"IMAGE_EXTENSION",{get:function(){return".jpg"},enumerable:!0,configurable:!0}),Object.defineProperty(ImageServer,"SNAPSHOT_IMAGE_SERVERS",{get:function(){return imageServers.map(function(imageServer){return imageServer+"/avatar/400x300/"})},enumerable:!0,configurable:!0}),Object.defineProperty(ImageServer,"GENDER_URL",{get:function(){return WEB_CDN+"/images/defaults/"},enumerable:!0,configurable:!0}),ImageServer.GET_CHAT_AVATAR=function(username){return"/avatar/user/60x60/"+username+this.IMAGE_EXTENSION},ImageServer}();
function loadSnapshots(){$j(".profile-thumb").each(function(){var _this=$j(this),useShapshotsAPI=ControlledFeatures.USE_SNAPSHOTS_API&&!SFW,link=$j(this).parent("a"),snapshots=useShapshotsAPI?"":String(_this.data("thumbs")),profile=useShapshotsAPI?THUMBNAILS_CDN+"/"+_this.data("username")+"?s="+encodeURIComponent(_this.data("thumbnail-sig")):_this.data("profile"),initial=_this.data("src"),gender=_this.data("gender");useShapshotsAPI&&ControlledFeatures.FACIAL_DETECTION_SNAPSHOTS&&(profile+="&fd=true"),snapshots=""!=snapshots?snapshots.split(","):[];new DirectorySnapshot(this,link,snapshots,initial,profile,"default_Unknown",_this.data("thumbnail-sig"),_this.data("username"),gender,function(image){image.addEventListener("load",function(){image.naturalWidth>image.naturalHeight?$j(image).parent().parent().addClass("wide-thumbnails"):$j(image).parent().parent().addClass("portrait-thumbnails")}),SearchDirectory.cycleImage($j(image))})})}var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}(),ImageSource;!function(ImageSource){ImageSource[ImageSource.profile=0]="profile",ImageSource[ImageSource.gender=1]="gender",ImageSource[ImageSource.snapshot=2]="snapshot"}(ImageSource||(ImageSource={}));var Snapshots;!function(Snapshots){var Snapshot=function(){function Snapshot(snapshots,snapshotImageLink,profileImageLink,defaultImageLink,thumbnailId,username){this.snapshots=snapshots;var snapshotLink=snapshotImageLink;ControlledFeatures.USE_SNAPSHOTS_API&&!SFW&&(snapshotLink=THUMBNAILS_CDN+"/"+username+"?s="+encodeURIComponent(thumbnailId),ControlledFeatures.FACIAL_DETECTION_SNAPSHOTS&&(snapshotLink+="&fd=true")),this.snapshotImageLink=snapshotLink,this.profileImageLink=profileImageLink,this.defaultImageLink=defaultImageLink,this.thumbnailId=thumbnailId,this.username=username}return Snapshot.prototype.getSnapshotBaseUrl=function(url){return url.substring(0,url.lastIndexOf("/")+1)},Snapshot.prototype.getSnapshotExtension=function(url){return url.substring(url.lastIndexOf("."),url.length)},Snapshot.prototype.getProfileImage=function(){return this.snapshots.length>0?(this.imageSource=ImageSource.snapshot,this.snapshots[0]):this.profileImageLink?(this.imageSource=ImageSource.profile,this.profileImageLink):(this.imageSource=ImageSource.gender,this.defaultImageLink)},Snapshot.prototype.getProfileImageUrl=function(){this.getProfileImage();var url=this.defaultImageLink;return this.imageSource==ImageSource.snapshot&&(url=this.snapshotImageLink),this.imageSource==ImageSource.profile&&(url=this.profileImageLink),url},Snapshot.prototype.getLastImageSource=function(){return this.imageSource},Snapshot.prototype.removeProfileImage=function(){this.profileImageLink=""},Snapshot.prototype.removeFirstSnapshot=function(){this.snapshots.length>0&&this.snapshots.shift()},Snapshot}();Snapshots.Snapshot=Snapshot}(Snapshots||(Snapshots={}));var Gender;!function(Gender){Gender[Gender.male=0]="male",Gender[Gender.female=1]="female",Gender[Gender.shemale=2]="shemale",Gender[Gender.unknown=3]="unknown"}(Gender||(Gender={}));var ImageServer=function(){function ImageServer(){}return Object.defineProperty(ImageServer,"IMAGE_EXTENSION",{get:function(){return".jpg"},enumerable:!0,configurable:!0}),Object.defineProperty(ImageServer,"SNAPSHOT_IMAGE_SERVERS",{get:function(){return imageServers.map(function(imageServer){return imageServer+"/avatar/400x300/"})},enumerable:!0,configurable:!0}),Object.defineProperty(ImageServer,"GENDER_URL",{get:function(){return WEB_CDN+"/images/defaults/"},enumerable:!0,configurable:!0}),ImageServer.GET_CHAT_AVATAR=function(username){return"/avatar/user/60x60/"+username+this.IMAGE_EXTENSION},ImageServer}(),DirectorySnapshot=function(_super){function DirectorySnapshot(image,link,snapshots,snapshotsLink,profileLink,defaultLink,thumbnailId,username,gender,onLoad){var _this=_super.call(this,snapshots,snapshotsLink,profileLink,defaultLink,thumbnailId,username)||this;return _this.show=function(){_this.inViewport()&&($j(window).unbind("scroll",_this.scrollHandler),_this.validate())},_this.getProfileId=function(){return _this.profileImageLink.replace(_this.getSnapshotBaseUrl(_this.profileImageLink),"")},_this.getShard=function(snapshotId){return ImageServer.SNAPSHOT_IMAGE_SERVERS[snapshotId%ImageServer.SNAPSHOT_IMAGE_SERVERS.length]},_this.removeProfileImg=function(){_this.profileImageLink=null},_this.removeFirstSnapshotFromDom=function(){_this.removeFirstSnapshot(),typeof _this.snapshots==typeof[]&&$j(_this.image).data("thumbs",_this.snapshots.join(","))},_this.replace=function(){_this.removeFirstSnapshotFromDom(),_this.getLastImageSource()==ImageSource.profile&&_this.removeProfileImg(),_this.validate(_this.getUrl())},_this.validate=function(src){src||(src=_this.getUrl());var temporary=new Image,startTime=(new Date).getTime();temporary.onerror=function(){SnapshotsLogger.logSnapshotFail((new Date).getTime()-startTime),console.log("replacing ",src),_this.replace()},temporary.onload=function(event){SnapshotsLogger.logSnapshotSuccess((new Date).getTime()-startTime),_this.isValid(temporary)?(_this.onLoad(_this.image),_this.link.removeClass("loading"),_this.image.src=src):(console.log("replacing ",src),_this.replace())},temporary.src=src},_this.isValid=function(img){return img.complete&&!(void 0!==img.naturalWidth&&0===img.naturalWidth)},_this.getUrl=function(){var imageId=_this.getProfileImage();return _this.imageSource==ImageSource.snapshot?ControlledFeatures.USE_SNAPSHOTS_API&&!SFW?_this.snapshotImageLink:[_this.getShard(imageId),imageId,ImageServer.IMAGE_EXTENSION].join(""):_this.imageSource==ImageSource.profile?imageId:[ImageServer.GENDER_URL,imageId,ImageServer.IMAGE_EXTENSION].join("")},_this.inViewport=function(){var rect=_this.image.getBoundingClientRect(),offset=window.innerHeight||600;return rect.top>=-offset&&rect.left>=0&&rect.bottom<=(window.innerHeight||document.documentElement.clientHeight)+offset&&rect.right<=(window.innerWidth||document.documentElement.clientWidth)},_this.throttle=function(func,wait,options){var context,args,result,timeout=null,previous=0;options||(options={});var later=function(){previous=!1===options.leading?0:Date.now(),timeout=null,result=func.apply(context,args),context=args=null};return function(){var now=Date.now();previous||!1!==options.leading||(previous=now);var remaining=wait-(now-previous);return context=this,args=arguments,remaining<=0?(clearTimeout(timeout),timeout=null,previous=now,result=func.apply(context,args),context=args=null):timeout||!1===options.trailing||(timeout=setTimeout(later,remaining)),result}},link instanceof $j?_this.link=link:_this.link=$j(image).parent("a"),_this.image=image,_this.gender=gender,_this.defaultImageLink=_this.getGenderProfileImage(),_this.onLoad=onLoad||$j.noop,_this.scrollHandler=_this.throttle(function(){_this.show()},300,{}),_this.inViewport()?_this.show():$j(window).on("scroll",_this.scrollHandler),_this}return __extends(DirectorySnapshot,_super),DirectorySnapshot.prototype.getUserAgent=function(UserAgent){return UserAgent.phone?"phone":UserAgent.tablet?"tablet":"desktop"},DirectorySnapshot.prototype.getGenderProfileImage=function(){var genderImages={f:"default_Female",female:"default_Female",t:"default_Shemale",shemale:"default_Shemale",transgender:"default_Shemale",m:"default_Male",male:"default_Male",u:"default_Unknown",unknown:"default_Unknown",c:"default_Unknown"},genderImagesSizes={phone:"400x300",tablet:"400x300",desktop:"400x300"};return void 0===this.gender&&(this.gender="u"),genderImages[this.gender]+"."+genderImagesSizes[this.getUserAgent(UserAgent)]},DirectorySnapshot}(Snapshots.Snapshot);
if(PageStatus.isDirectory){document.addEventListener("visibilitychange",function(){SearchDirectory.activeTab="visible"===document.visibilityState}),"undefined"==typeof $j&&($j=jQuery),$j.fn.reverse=[].reverse,$j.fn.fadeTags=function(hide){var delay=0;return 0==hide?this.reverse().each(function(){$j(this).delay(delay).fadeOut(200),delay+=100}):this.each(function(){$j(this).delay(delay).fadeIn(200),delay+=100})};var SearchDirectory={activeTab:"visible"===document.visibilityState,tagsContainer:$j(".searchBar .tags, #directory .tags"),tagsMap:[],lastRemoved:-1,searchMap:[],searchBuffer:"",searchQuery:"",lastResult:null,debug:"",ajaxParams:{},dropdownLimit:5,countLimit:1e4,animationId:null,globalCounter:0,globalHtmlCounter:0,initialLoad:!0,cycleTimes:{id:0,timeouts:[]},lastQuery:null,lastSuccessQuery:null,servers:{results:"/directoryResults?online=true&",counts:"/directoryCounts?"},directoryTagsHeader:$j("#directoryTagHeader"),resultsSubmitMethod:1,delayCountOnUsername:5e3,toggleValue:function(element){var e=$j(element).children("input:first");""==e.val()?e.val(e.attr("data-id")):e.val(""),$j(element).hasClass("subcategoryon")?this.removeTag($j(element)):this.generateTag($j(element).text(),$j(element),$j(element).prevAll(".category").attr("id")),$j(element).toggleClass("subcategoryon"),$j("span.counter").empty();this.formatURL()},getUrl:function(url){var currentParams=url.split(/(search\?page=\d+.)/);return 2 in currentParams?"&"+currentParams[2]:""},formatURL:function(){this.initialLoad&&(this.initialLoad=!1);var queryParams="",country="",language="",coupleValues=["male_group","female_group","male_female_group"];$j('#sform input[type!="button"]').each(function(){var name=$j(this).attr("name"),value=$j(this).val(),type=$j(this).attr("type");"broadcastType"==name&&"couple"==value?coupleValues.map(function(coupleValue){queryParams+="&broadcastType="+coupleValue}):"checkbox"!=type&&void 0!==name&&"showTag"!=name&&""!=value&&(queryParams+="&"+name+"="+value)});var showTags=window.location.href.match(/\/tags\/(.*)/);return showTags&&(queryParams+="&showTag="+showTags[1]),$j("#countries").find(".delimiter").prevAll(".toggleCheckLi").each(function(){country+=$j(this).find("input").val()+","}),$j("#languages").find(".delimiter").prevAll(".toggleCheckLi").each(function(){language+=$j(this).find("input").val()+","}),""!=country&&(country=country.substring(0,country.length-1),queryParams+="&country="+country),""!=language&&(language=language.substring(0,language.length-1),queryParams+="&language="+language),queryParams.length>0&&"&"==queryParams.charAt(0)&&(queryParams=queryParams.substring(1)),queryParams},formatURLJson:function(){return JSON.parse('{"'+decodeURI(SearchDirectory.lastSuccessQuery.replace(/&/g,'","').replace(/=/g,'":"'))+'"}')},resetForm:function(softReset,skipOnline){if(this.resetCheckBoxLists(),this.tagsMap=[],this.tagsContainer.find("span").trigger("click"),this.tagsContainer.html(""),this.resetQuery("#countries"),this.resetQuery("#languages"),DirectoryEvents.sortByContainer.find(".activeSort").trigger("click"),$j('#directory input[type=hidden], #directory input[name="username"]').val(""),!skipOnline){var onlineTag=$j('input[name="online"]');""==onlineTag.val()&&onlineTag.trigger("click")}this.lastQuery=this.formatURL(),softReset||this.getDirectoryHtml(1,!1,!0,!1)},toggleFilterCategories:function(){$j("#filters .category").on("click",function(){var category=$j(this).find("em");category.hasClass("glyphicon-menu-down")?category.removeClass("glyphicon-menu-down").addClass("glyphicon-menu-up"):category.hasClass("glyphicon-menu-up")&&category.removeClass("glyphicon-menu-up").addClass("glyphicon-menu-down")})},toggleMobileFilter:function(){$j("#toggMobileFilters").on("click",function(){$j(".allFilters").slideToggle("fast")})},showMoreCount:function(){var sidebarMoreFilters=$j("#sidebarMoreFilters"),additionalSelectedLength=$j(".additionalSidebarFilter").find(".subcategoryon").length;additionalSelectedLength?sidebarMoreFilters.val(js_i18n.directoryFiltersShowMore+" ("+additionalSelectedLength+")"):sidebarMoreFilters.val(js_i18n.directoryFiltersShowMore)},toggleMoreFilters:function(){var sidebarMoreFilters=$j("#sidebarMoreFilters"),additionalSidebarFilter=$j(".additionalSidebarFilter");sidebarMoreFilters.on("click",function(){additionalSidebarFilter.slideToggle("fast",function(){additionalSidebarFilter.is(":visible")?sidebarMoreFilters.val(js_i18n.directoryFiltersShowLess):sidebarMoreFilters.val(js_i18n.directoryFiltersShowMore)})})},countSelectedLocale:function(type){var index=0;return $j(type+" input[type=checkbox]:checked").each(function(){index++}),index},countLocale:function(){var total=0,localeCounter=$j("#tags_locale span");total=this.countSelectedLocale("#countries")+this.countSelectedLocale("#languages"),localeCounter.length?localeCounter.html(total):0!=total&&$j("#tags_locale").append("<span>"+total+"</span>")},countSelected:function(ul){var index=0;$j("input[type=checkbox]:checked",$j(ul)).each(function(){index++});var button=$j("input[type=button]",$j(ul).parent().parent());return index>0?("languages"==$j(ul).parent().attr("id")?$j(button).val(index+" "+directoryInt.selectedLanguages):$j(button).val(index+" "+directoryInt.selectedCountries),this.countLocale()):("languages"==$j(ul).parent().attr("id")?$j(button).val(directoryInt.selectLanguages):$j(button).val(directoryInt.selectCountries),0==this.countSelectedLocale("#countries")&&0==this.countSelectedLocale("#languages")?$j("#tags_locale span").remove():this.countLocale()),index},moveCheckBox:function(checkbox,checkBoxClicked){var li=$j(checkbox).parent(),ul=$j(li).parent(),curentText=$j("label",$j(li)).text();if(checkBoxClicked||$j(checkbox).attr("checked",!$j(checkbox).attr("checked")),$j(checkbox).attr("checked")){var state=":checked",first=$j(".delimiter",$j(ul)).first();li.removeClass("checked")}else var state=":not(:checked)",first=$j("li",$j(ul)).last();$j("input[type=checkbox]"+state,$j(ul)).each(function(){if($j("label",$j(this).parent()).text()>curentText)return first=$j(this).parent(),!1}),$j(first).before($j(li)),this.countSelected(ul)},resetCheckBoxLists:function(){$j("#countries").find(".delimiter").prevAll(".toggleCheckLi").trigger("click"),$j("#languages").find(".delimiter").prevAll(".toggleCheckLi").trigger("click")},addNextPrevLinksToHead:function(){var directoryPagerSpan=$j("#pagerSpan"),directoryHeader=$j("head"),directoryPrevBtn=directoryPagerSpan.prev("a"),directoryNextBtn=directoryPagerSpan.next("a"),directoryCanonicalLink=directoryHeader.find('[rel="canonical"]'),directoryPrevLink=directoryHeader.find('[rel="prev"]'),directoryNextLink=directoryHeader.find('[rel="next"]');directoryPrevBtn.length?directoryPrevLink.length?$j('[rel="prev"]').attr("href",directoryPrevBtn.attr("href")):directoryHeader.append($j("<link>",{rel:"prev",href:directoryPrevBtn.attr("href")})):directoryPrevLink.length&&directoryPrevLink.remove(),directoryNextBtn.length?directoryNextLink.length?$j('[rel="next"]').attr("href",directoryNextBtn.attr("href")):directoryHeader.append($j("<link>",{rel:"next",href:directoryNextBtn.attr("href")})):directoryNextLink.length&&directoryNextLink.remove(),directoryCanonicalLink.length?$j('[rel="canonical"]').attr("href",window.location.href):directoryHeader.append($j("<link>",{rel:"canonical",href:window.location.href}))},getDirectoryHtml:function(page,skipLoad,reset,customQuery,callback){this.initialLoad=skipLoad,$j("span.counter").empty();var queryParams=reset?"online=true":this.formatURL();if(null!=typeof queryParams){var isGay=~queryParams.indexOf("gender=male")&&!Cam4User.isLoggedIn||~queryParams.indexOf("gender=male")&&"male"===Cam4User.userGender||"male"===Cam4User.userGender&&"gay"===Cam4User.userSexPref,isShemale=~queryParams.indexOf("gender=shemale")&&!Cam4User.isLoggedIn||~queryParams.indexOf("gender=shemale")&&"male"===Cam4User.userGender||"male"===Cam4User.userGender&&"shemale"===Cam4User.userSexPref;changeDatingURL(UserAgent.desktop,isGay,isShemale),changeSexGameURL(UserAgent.desktop,isGay,isShemale)}customQuery&&(queryParams=customQuery),queryParams="page="+page+"&"+queryParams,window.history.pushState||3==SearchDirectory.resultsSubmitMethod&&SearchDirectory.isFirefox(29)?(SearchDirectory.isOldInternetExplorer()?skipLoad||this.loadDirectoryHtml(queryParams):skipLoad||this.loadDirectoryHtml(queryParams,callback),skipLoad&&!DirectoryEvents.useInfiniteScroll&&SearchDirectory.addNextPrevLinksToHead()):skipLoad||(window.location="/search?"+queryParams)},loadDirectoryHtml:function(queryParams,callback){$j(".alertMessage").remove(),this.ajaxParams.get_html=queryParams,this.globalCounter++,DirectoryEvents.useInfiniteScroll||Directory.showLoading&&$j("#directoryHtml").addClass("loading");var ajaxParams={url:SearchDirectory.servers.results+queryParams,type:"get",success:function(count){return $j(window).trigger("resize"),function(response){if(count==SearchDirectory.globalCounter)if(-1!=response.html.toLowerCase().search("<html>"))window.location="/";else{SearchDirectory.lastSuccessQuery=queryParams;var niceUrl=/featured\/1$/.test(response.url)?"/":response.url,orderBy=SearchDirectory.parseOrderFromFilters(SearchDirectory.lastQuery);orderBy&&!~["PROMOTED","VIDEO_QUALITY"].indexOf(orderBy)&&(niceUrl=niceUrl+(~niceUrl.indexOf("?")?"&":"?")+"orderBy="+orderBy),window.history.replaceState(null,directoryInt.search,niceUrl),"undefined"!=typeof DirectoryPreviewHLS&&DirectoryPreviewHLS.stop(),SearchDirectory.lastResult=SearchDirectory.ajaxParams.get_html;var directoryHtml=$j("#directoryHtml");if(DirectoryEvents.useInfiniteScroll){$j(".pager, .infinite-scroll-wrapper").remove();var newResults=$(response.html);directoryHtml.append(newResults.filter("#directoryDiv").html()),directoryHtml.append(newResults.filter(".pager")),directoryHtml.append(newResults.filter(".infinite-scroll-wrapper")),DirectoryEvents.bindInfiniteScroll(),DirectoryEvents.useInfiniteScroll=!1}else directoryHtml.html(response.html),SearchDirectory.addNextPrevLinksToHead();responsiveDirectoryForMobile&&directoryHtml.find(".profile-thumb").lazyLoad(),Directory.arrangeEmbeddedAds(),document.title=response.title,loadSnapshots();var noResults=SearchDirectory.checkNoResults(directoryHtml);if(noResults&&directoryHtml.html(noResults.html()),"function"==typeof showInitSignupOverlay&&Directory.checkSignupOverlay(),Cam4User.xtra&&Cam4User.xtra.isLoggedIn){var settings=Cam4User.xtra;displayAds(settings.rightWidth,settings.zoneName,settings.userName,settings.listingType,settings.isDirectory,settings.isLoggedIn,settings.key,settings.showBroadcast,settings.isProfilePage)}else $j("#sidebarTop").html('<iframe src="/ads/right/rightSidebarTop.jsp?gender=female&category=straight" width=250 height=250 frameborder=0 marginheight="0" marginwidth="0" scrolling="no"></iframe>'),DirectoryEvents.reloadAds();"undefined"!=typeof updateDirectorySegments&&updateDirectorySegments(),"undefined"!=typeof DirectoryPreviewHLS&&DirectoryPreviewHLS.load(),"undefined"!=typeof Cam4Analytics&&Cam4Analytics.pageLoaded(),directoryHtml.removeClass("loading"),Cam4Event.dispatch("directoryHtmlLoaded"),callback&&callback()}}}(SearchDirectory.globalCounter),error:function(err){console.log(err)}};1==SearchDirectory.resultsSubmitMethod&&(ajaxParams.dataType="json"),$j.ajax(ajaxParams)},parseOrderFromFilters:function(filters){return!!(filters=_.chain(filters.split("&")).map(function(item){if(item)return item.split("=")}).compact().object().value()).hasOwnProperty("orderBy")&&filters.orderBy},orderBy:function(order){if($j("#orderBy").val(order),SearchDirectory.lastQuery=SearchDirectory.formatURL(),this.isOldInternetExplorer()||3==this.resultsSubmitMethod&&this.isFirefox(29))return window.location="/search?"+SearchDirectory.formatURL(),!1;this.getDirectoryHtml(1,!1,!1,!1),$j("#searchOrderBy").find(".clicked").removeClass("clicked"),$j("#"+order).addClass("clicked")},getExtensionFrom:function(url){return(url=url.split("."))[url.length-1]},generateTag:function(text,identifier,parent){if("subcategoryoff no-hover"==identifier.attr("class"))return!1;var tag=$j("<li></li>").text(text).append("<span>&times;</span>").hide();if(this.tagsContainer.find("."+parent).length||this.tagsContainer.append($j("<ul></ul>").hide().addClass(parent)),!1===this.isInTagsMap(identifier)){var key=this.getNextIndex();return this.tagsMap[key]=identifier,this.tagsContainer.find("."+parent).append(tag),tag.attr("data-key",key).find("span").click(function(e){"text"==$j(identifier).attr("type")?($j(identifier).val(""),SearchDirectory.removeTag(identifier)):$j(identifier).is("input")?(identifier=$j(identifier).parent(".toggleCheckLi"),$j(identifier).trigger("click")):$j(identifier).trigger("click"),void 0!==e.originalEvent&&Directory.applyFilters(),e.preventDefault()}),!0}return this.removeTag(identifier),!1},removeTag:function(identifier){var key=this.isInTagsMap(identifier),tag=this.tagsContainer.find('[data-key="'+key+'"]');tag.parent("ul").attr("class");return delete this.tagsMap[key],tag.remove(),this.lastRemoved=key,this.tagsContainer.find("ul").each(function(e){$j(this).find("li").length||$j(this).remove()}),!0},isInTagsMap:function(needle){for(var i in this.tagsMap)if(this.tagsMap[i][0]==needle[0])return i;return!1},getNextIndex:function(){return this.tagsMap.length},generateSearchMap:function(dropdown){return SearchDirectory.searchMap=[],$j(dropdown).find(".delimiter").nextAll(".toggleCheckLi").find("label").each(function(){SearchDirectory.searchMap.push($j(this).text().toLowerCase())}),SearchDirectory.searchMap},resetQuery:function(dropdown){return $j(dropdown)[0].scrollTop=0,this.searchQuery="",this.searchBuffer="",this.lastResult=null,!0},urlToForm:function(){return History.getState().hash},paramsToFilters:function(){var params=this.urlToForm(),paramsMap=[],form=$j("#sform");paramsMap=params.replace("/search?","").split("&");for(var i=0;i<paramsMap.length;i++){var _temp=paramsMap[i].split("="),key=_temp[0],value=_temp[1];if("_suid"!=key&&"page"!=key&&("country"!=key&&"language"!=key))form.find('[name="'+key+'"][value="'+value+'"]')}return paramsMap},searchFor:function(needle,haystack){for(var i=0;i<haystack.length;i++)if(0==haystack[i].indexOf(needle))return i;return-1},sortElements:function(map){map.each(function(){var asc=$j(this).find(".delimiter").nextAll("li.toggleCheckLi").get().sort(function(a,b){var $text1=$j(a).find("label").text().toLowerCase(),$text2=$j(b).find("label").text().toLowerCase();return $text1>$text2?1:$text1<$text2?-1:0}),delimiter=$j(this).find(".delimiter");delimiter.nextAll("li.toggleCheckLi").remove(),delimiter.after(asc)})},switchViews:function(){var bodytype=$j("#tags_bodytype");"none"==bodytype.css("display")?bodytype.add(bodytype.nextUntil(".column-3")).fadeTags():bodytype.nextUntil(".category").add(bodytype).fadeTags(!1)},fixLayout:function(){var searchBar=$j(".searchBar"),filterBy=searchBar.find(".filterDiv"),orderByBtn=searchBar.find("#orderByButton"),btns=searchBar.find(".buttons"),hdCams=searchBar.find(".hd-cams"),tags=searchBar.find(".tags");tags.css("padding-left",parseInt(filterBy.innerWidth())+20),tags.css("padding-right",parseInt(orderByBtn.innerWidth())+parseInt(hdCams.innerWidth())+30),btns.css("width",parseInt(orderByBtn.innerWidth())+parseInt(hdCams.innerWidth())+20),$j(window).resize(function(){$j("#main-content > div:eq(0)").css("min-height",parseInt($j("#directoryDiv").height())+40)})},fixDropdownHeight:function(){$j(".buttons-container").height()>100&&$j(".dropdown").height("98px")},getActiveSort:function(){var currentOption=$j("#searchOrderBy .clicked");return!!currentOption.length&&currentOption.attr("id")},cycleImage:function(_image){var $this=SearchDirectory,mockImage=$j("<img/>");_image.on("mouseenter",function(){var image=$j(this),src=image.attr("src"),thumbs_raw=image.attr("data-thumbs"),url=src.replace(/(\d+.jpg)/,"");if(""==thumbs_raw||-1==thumbs_raw.search(","))return!1;var thumbs=thumbs_raw.split(",");0!==thumbs.length&&thumbs.splice(0,1),$this.cycleTimes.buffer={image:image,src:src,thumbs:thumbs,thumbs_raw:thumbs_raw,url:url},image.attr("data-first")||image.attr("data-first",src),$this.hasSnapshots(url)&&($this.cycleTimes.current=setTimeout(function(){$this.cycleStep(url,thumbs,image,mockImage)},100),$this.cycleTimes.timeouts.push($this.cycleTimes.current))}),_image.on("mouseleave",function(){$this.cycleTimes.i=0;var image=$j(this),thumbs=image.attr("data-thumbs");if(image.attr("data-loading",0),""==thumbs||-1==thumbs.search(","))return!1;$this.clearTimeouts($this.cycleTimes.current),image.attr("src",image.attr("data-first"))}),mockImage.error(function(){$this.clearTimeouts($this.cycleTimes.current),$this.cycleStep($this.cycleTimes.buffer.url,$this.cycleTimes.buffer.thumbs,$this.cycleTimes.buffer.image,mockImage)}).load(function(){$this.clearTimeouts($this.cycleTimes.current),$this.cycleTimes.buffer.image.attr("data-loading")&&$this.cycleTimes.buffer.image.attr("src",$j(this).attr("src")),$this.cycleTimes.current=setTimeout(function(){$this.cycleStep($this.cycleTimes.buffer.url,$this.cycleTimes.buffer.thumbs,$this.cycleTimes.buffer.image,mockImage)},500),$this.cycleTimes.timeouts.push($this.cycleTimes.current)})},cycleStep:function(url,thumbs,image,mockImage){image.attr("data-loading",1),this.cycleTimes.i=this.cycleTimes.i<thumbs.length?this.cycleTimes.i:0;var thumb=thumbs[this.cycleTimes.i++];if(-1!=image.attr("data-thumbs").search(thumb)){var src=url+thumb+".jpg";mockImage.attr("src",src)}},is:function(selector1,selector2){return!!selector2&&("string"==typeof selector2?$j.expr.match.POS.test(selector2)?$j(selector2,selector1.context).index(selector1[0])>=0:$j.filter(selector1,selector2).length>0:selector1.filter(selector2).length>0)},hasSnapshots:function(url){return~url.indexOf("avatar")},clearTimeouts:function(last){this.cycleTimes.timeouts.push(last);for(var i=0;i<this.cycleTimes.timeouts.length;i++)clearTimeout(this.cycleTimes.timeouts[i]);this.cycleTimes.timeouts=[]},formatResultsNumber:function(n){return n.toString().replace(/(\d)(?=(\d{3})+$)/g,"$1 ")},checkNoResults:function(directoryContainer){if(0==directoryContainer.find(".profileBox").length){""!=$j("#usernameFilter").val()&&dataLayer.push({event:"Failed Username Search"});var noResults=$j("<div/>");return noResults.html('<div class="no-results"><p>'+directoryInt.noResults+"</p></div>"),noResults}return""!=$j("#usernameFilter").val()&&dataLayer.push({event:"Successful Username Search"}),!1},isOldInternetExplorer:function(){return-1!=navigator.appVersion.indexOf("MSIE 7.")||-1!=navigator.appVersion.indexOf("MSIE 8.")||-1!=navigator.appVersion.indexOf("MSIE 9.")},isFirefox:function(version){return BrowserDetect.isFirefoxVersion(version)},setResultsSubmitMethod:function(value){this.resultsSubmitMethod=value},isPopRegistration:function(){return $("#toggleFilters").hasClass("popRegistration")}},DirectoryEvents={directoryContainer:$j("#directorySavedSearches, #stickyHeader"),optionsWrapepr:$j(".optionsWrapper"),sortByContainer:$j(".sortByOptions"),sortByButton:$j(".sortByOptions .selectedSort"),toggleFiltersButton:$j("#toggleFilters"),filtersContainer:$j("#filters"),predefinedTabs:$j("[data-tab]"),deleteSearchButton:$j("#deleteSearch"),saveSearchButton:$j("#saveSearch"),deleteTabModal:$j(".deleteTab-modal-overlay"),savedSearches:$j("[data-search]"),replaceTabModal:$j(".replaceTabs-modal-overlay"),canSave:!0,useInfiniteScroll:!1,saveSearchAction:!1,bindGlobalEvents:function(){$j(document).click(this.sortEvents),this.selectSortOption(),this.toggleFiltersContainer(),this.bindTabControls(),this.bindInfiniteScroll()},bindInfiniteScroll:function(){$j(document).on("click",".infinite-scroll",function(event){DirectoryEvents.useInfiniteScroll=!0,$j(".directory-next").trigger("click"),event.preventDefault()})},bindCategoryToggle:function(){Directory.templates.directoryCategories.on("click",function(event){$(this).nextUntil(".category").toggle(),event.preventDefault()})},sortEvents:function(event){var activeOption=DirectoryEvents.sortByContainer.find(".activeSort");$j(event.target).is(DirectoryEvents.sortByButton)?(activeOption.toggleClass("active"),event.preventDefault()):activeOption.removeClass("active")},selectSortOption:function(){var sortOptions=this.sortByContainer.find(".activeSort li");sortOptions.on("click",function(event){var sortCriteria=$j(this).find("a").attr("id");SearchDirectory.directoryTagsHeader.removeClass("shown").hide(),DirectoryEvents.sortByButton.text($j(this).text()),sortOptions.removeClass("selected"),$j(this).addClass("selected"),event.isTrigger||SearchDirectory.orderBy(sortCriteria),event.preventDefault()})},toggleFiltersContainer:function(){this.toggleFiltersButton.on("click",function(event){SearchDirectory.isPopRegistration()?Utils.decideOffer():($j(this).toggleClass("active"),DirectoryEvents.filtersContainer.slideToggle("fast"),event.preventDefault())})},initDropdownSearch:function(){$j(document).keydown(function(key){if(32==key.which&&($j("#countries.dropdown").is(":visible")||$j("#languages.dropdown").is(":visible"))&&(SearchDirectory.searchQuery+=" ",event.preventDefault()),$j("#countries.dropdown").is(":visible"))var currentSelect=$j("#countriesButton"),currentSearch=$j("#countries");else if($j("#languages.dropdown").is(":visible"))var currentSelect=$j("#languagesButton"),currentSearch=$j("#languages");if($j("#countries.dropdown").is(":visible")||$j("#languages.dropdown").is(":visible")){if(27==key.which)currentSelect.trigger("click");else if(8==key.which){SearchDirectory.searchQuery=SearchDirectory.searchQuery.slice(0,-1);var searchIndex=SearchDirectory.searchFor(SearchDirectory.searchQuery,SearchDirectory.searchMap);"-1"!=searchIndex?SearchDirectory.lastResult=searchIndex:searchIndex=SearchDirectory.lastResult,currentSelect.val(directoryInt.search+": "+SearchDirectory.searchQuery);var result=currentSearch.find(".delimiter").nextAll(".toggleCheckLi:eq("+searchIndex+")");currentSearch.find(".toggleCheckLi.checked").removeClass("active"),result.addClass("active"),result[0].parentNode.parentNode.scrollTop=result[0].offsetTop,SearchDirectory.lastResult="-1"!=searchIndex?searchIndex:0,key.preventDefault()}else if(13==key.which&&!window.Cam4MiniLoginOpened)return currentSearch.find(".active").removeClass("active").trigger("click"),!1}else 13==key.which&&$j("#usernameFilter").is(":focus")&&(Directory.applyFilters(),key.preventDefault())}),$j(document).keypress(function(a){if($j("#countries.dropdown").is(":visible")||$j("#languages.dropdown").is(":visible")){if($j("#countries.dropdown").is(":visible"))var currentSelect=$j("#countriesButton"),currentSearch=$j("#countries");else var currentSelect=$j("#languagesButton"),currentSearch=$j("#languages");SearchDirectory.searchBuffer=""==SearchDirectory.searchBuffer?currentSelect.val():SearchDirectory.searchBuffer,SearchDirectory.searchQuery+=String.fromCharCode(a.which).toLowerCase(),currentSelect.val(directoryInt.search+": "+SearchDirectory.searchQuery);var searchIndex=SearchDirectory.searchFor(SearchDirectory.searchQuery,SearchDirectory.searchMap);"-1"!=searchIndex?SearchDirectory.lastResult=searchIndex:searchIndex=SearchDirectory.lastResult;var result=currentSearch.find(".delimiter").nextAll(".toggleCheckLi:eq("+searchIndex+")");currentSearch.find(".toggleCheckLi.active").removeClass("active"),result.addClass("active"),result[0].parentNode.parentNode.scrollTop=result[0].offsetTop+0}}),$j(".gold-upgrade a").addClass("nopop").on("click",function(e){$j("#newSearch").remove(),DirectoryEvents.hideTooManySearchesModal(),openCheckoutMembership(),e.preventDefault()})},replaceBrokenImages:function(){$j("#directoryHtml .profile-thumb").error(function(){Directory.globalBrokenSnapshots++<=Directory.brokenSnapshotsCapPerPage&&Directory.replaceBrokenImages($j(this))}).one("load",function(){$j(this).parents(".profileBox").hasClass("promo-ad")||SearchDirectory.cycleImage($j(this))}).each(function(){this.complete&&$(this).load()})},showTabControls:function(button){if("NOT_DELETABLE"==Directory.getTabDetails())return DirectoryEvents.hideTabControls("save"),DirectoryEvents.hideTabControls("delete"),!0;if("search"==button){Directory.savedSearches;if(!this.userCanSave())return DirectoryEvents.reportTooManySearches(),!1}$j(".searchControls").css("display","inline-block").find("#"+button+"Search").show()},hideTabControls:function(button){$j(".searchControls").css("display","inline-block").find("#"+button+"Search").hide()},pillsState:function(){var controlTabsContainer=$j("#main-content .searchControls-tags");$j(".tags li").length>=1?($j(".tags").show(),controlTabsContainer.show()):controlTabsContainer.hide()},modalSavedFiltersActions:function(deleteSearchId){DirectoryEvents.deleteTabModal.find(".deleteTab-modal .confirm-button").off("click").one("click",function(){($j('[data-search="'+deleteSearchId+'"]').length||Directory.getTabDetails())&&Directory.deleteTab(deleteSearchId),event.preventDefault()}),DirectoryEvents.deleteTabModal.find(".cancel-button").off("click").one("click",function(){DirectoryEvents.hideDeleteTabModal()}),DirectoryEvents.showDeleteTabModal(),event.preventDefault()},bindDeleteSidebarOption:function(){$j(".savedSearchesContainer .deleteEntry").on("click",function(){var deleteSearchId=$j(this).data("delete-search");DirectoryEvents.modalSavedFiltersActions(deleteSearchId)})},bindTabControls:function(){Directory.getTabDetails()&&Directory.userHasAccess()?this.showTabControls("delete"):!Directory.getTabDetails()&&Directory.userHasAccess()&&this.showTabControls("save"),DirectoryEvents.bindDeleteSidebarOption(),this.deleteSearchButton.on("click",function(){var modalTitle=DirectoryEvents.deleteTabModal.find("h3 .tab-name"),activeTabObj=Directory.getTabDetails();modalTitle.text(activeTabObj.title),"search"==activeTabObj.type?$j(".modal-buttons + p").hide():$j(".modal-buttons + p").show(),DirectoryEvents.modalSavedFiltersActions("")})},bindSaveSearchEvents:function(){var savedSearchTemplate=$j("<li></li>").attr("id","newSearch").append('<input type="text" value="" />').find("input").prop("placeholder",directoryInt.nameYourFilter).end();DirectoryEvents.saveSearchButton.on("click",function(event){Cam4User.isLoggedIn||Cam4User.isLoggedInAsGuest?$("#newSearch").find("input").length?Directory.saveCurrentSearch():($j(".savedSearchesContainer").before(savedSearchTemplate).find("#newSearch input").focus().val(""),$j(".favouriteFiltersContainer").show(1,function(){$j("#newSearch input").focus().val("")}),savedSearchTemplate.on("keydown",function(event){if(13==event.which&&!DirectoryEvents.replaceTabModal.is(":visible"))return Directory.saveCurrentSearch(),!1}).focusout(function(){$j(".replaceTabs-modal .saved-searches").length||Directory.saveCurrentSearch()}).on("click",function(){event.stopPropagation(),DirectoryEvents.removeTooltip(!1)}),event.preventDefault()):Utils.decideOffer()})},generateSavedSearches:function(){$j(".savedSearchesWrapper").length&&$j(".savedSearchesWrapper").remove();var savedSearchesWrapper=$j('<ul id="savedSearches"></ul>'),additionalSearchesWrapper=$j('<ul id="additionalSavedSearches"></ul>'),i=0,options=$j("#mobileSavedSearches select");Directory.getSavedSearches().success(function(searches){if(searches.length){for(i=0;i<searches.length;i++){var item;(item=$j('<li data-search="'+searches[i].searchId+'"><div class="savedFilterEntry"><a href="#" class="nopop"><span class="glyphicon glyphicon-star"></span></a></div></li><div class="deleteEntry pull-right" data-delete-search="'+searches[i].searchId+'">&times;</div>')).find("a").append($("<div/>").text(searches[i].searchName).html()),i>=Directory.numberOfDisplayedSearches?additionalSearchesWrapper.append(item):savedSearchesWrapper.append(item);var option=$j('<option data-search="'+searches[i].searchId+'">'+searches[i].searchName+"</option>");options.append(option)}options.selectpicker("refresh"),$j(".favouriteFiltersContainer").show(),$j(".savedSearchesContainer").html(savedSearchesWrapper).append(additionalSearchesWrapper),additionalSearchesWrapper.children().length>0&&additionalSearchesWrapper.after($j('<p id="loadMoreSearchesContainer" class="text-center small"><input type="button" id="loadMoreSearches"class="btn btn-default btn-xs" value="'+js_i18n.directoryFiltersShowMore+'"/></p>'));var loadMoreSearches=$j("#loadMoreSearches");loadMoreSearches.on("click",function(){additionalSearchesWrapper.toggleClass("slideSearches"),additionalSearchesWrapper.hasClass("slideSearches")?loadMoreSearches.val(js_i18n.directoryFiltersShowLess):loadMoreSearches.val(js_i18n.directoryFiltersShowMore)}),DirectoryEvents.pillsState(),DirectoryEvents.bindDeleteSidebarOption(),$j("#newSearch").remove()}})},toggleSearchesDropdown:function(){$j(document).on("click",".savedSearchesWrapper > a",function(){Directory.cancelSaveSearch(),1==Directory.savedSearches.length?$j("[data-search]:eq(0)").trigger("click"):$j(this).parent("li").toggleClass("active")}),$j(document).click(function(event){$j(".savedSearchesWrapper > a").is(event.target)||$j(".savedSearchesWrapper > a").parent("li").removeClass("active")}),$j(document).on("click","[data-search]",function(){var searchId=$j(this).attr("data-search"),title=$j(this).text();$j("#directorySavedSearches .active, #savedSearches .active, #additionalSavedSearches .active").removeClass("active"),$j(".savedSearchesWrapper > a").text(title).addClass("active"),$j(this).find("a").addClass("active"),DirectoryEvents.saveSearchAction=!0,DirectoryEvents.applySearchFilters(searchId)})},reportDuplicateSearch:function(){DirectoryEvents.showTooltip(directoryInt.duplicateFilterName,"error",!1)},reportSearchError:function(status){DirectoryEvents.showTooltip(status,"error",!1)},reportTooManySearches:function(){DirectoryEvents.removeTooltip(!1),$j(".replaceTabs-modal .saved-searches").remove();var searches=Directory.savedSearches,searchesTemplate=$j('<ul class="saved-searches"></ul>'),i=0;for(i=0;i<searches.length;i++)searchesTemplate.append($j("<li></li>").append($j('<a href="#" class="nopop"></a>').text(searches[i].searchName).attr("data-searchId",searches[i].searchId).click(function(event){$j(".existing-searches").find(".active").removeClass("active"),$j(this).addClass("active"),event.preventDefault()})));searchesTemplate.find("a:eq(0)").addClass("active"),DirectoryEvents.replaceTabModal.find(".existing-searches p").append(searchesTemplate),DirectoryEvents.replaceTabModal.find(".existing-searches p span").text(Directory.getUserSearchLimit());var confirmButton=DirectoryEvents.replaceTabModal.find(".confirm-button"),cancelButton=DirectoryEvents.replaceTabModal.find(".cancel-button");confirmButton.one("click",function(event){var selectedSearch=$j(".existing-searches").find(".active"),deleteAjaxUrl=Directory.deleteSearchQueryUrl.replace("%userid%",Cam4User.id).replace("%search_id%",selectedSearch.attr("data-searchid"));$j.ajax({type:"DELETE",url:deleteAjaxUrl}).success(function(){var title,parameters=SearchDirectory.formatURL();title=$j("#newSearch input").val(),Directory.saveSearch(title,parameters),Directory.saveSearchRequest.success(function(){DirectoryEvents.showTooltip(directoryInt.filterSaved.replace("%searchname%",title),"success",!0),DirectoryEvents.updateSavedSearches(),DirectoryEvents.hideTooManySearchesModal()})}),event.preventDefault()}),cancelButton.one("click",function(event){$j("#newSearch").remove(),DirectoryEvents.hideTooManySearchesModal()}),Registration.showGoldUpgradeOverlay("save-searches")},generateResponsiveModalLayout:function(){return $j('<div class="modal-container">                    <div class="modal-header">                        <button type="button" class="close" data-dismiss="modal"></button>                        <h3 class="title"></h3>                    </div>                    <div class="modal-body"></div>                </div>')},showDeleteTabModal:function(){var modal=$j("#modalLayout");DirectoryEvents.generateResponsiveModalLayout();modal.find(".modal-content").empty().append(DirectoryEvents.deleteTabModal.clone(!0,!0).show()),modal.modal("show")},hideDeleteTabModal:function(){$j("#modalLayout").modal("hide")},removeSavedSearch:function(searchId){Directory.savedSearches.some(function(savedSearch,index){if(savedSearch.searchId===searchId)return Directory.savedSearches.splice(index,1),!0}),Directory.savedSearches.length===Directory.numberOfDisplayedSearches&&$j("#loadMoreSearchesContainer").remove()},showTooManySearchesModal:function(){var modal=$j("#modalLayout"),deleteTabLayout=DirectoryEvents.generateResponsiveModalLayout();modal.find(".modal-content").html("").append(deleteTabLayout),modal.find(".modal-body").append(DirectoryEvents.replaceTabModal.clone(!0,!0).show()),modal.find(".modal-header .title").html(modal.find(".existing-searches h3").html()),modal.modal("show")},hideTooManySearchesModal:function(){DirectoryEvents.replaceTabModal.find(".saved-searches").remove(),$j("#modalLayout").modal("hide")},updateSavedSearches:function(){DirectoryEvents.generateSavedSearches(),DirectoryEvents.hideTabControls("save"),DirectoryEvents.showTabControls("delete"),$j(".searchControls").hide()},applySearchFilters:function(searchId){var getSearch=Directory.getSearch(searchId);SearchDirectory.resetForm(!0,!0),getSearch.success(function(response){if($j("#deleteSearch span:first-child").removeClass("show").addClass("hide"),$j("#deleteSearch span:last-child").removeClass("hide"),"filters"in response){var filters=response.filters,allFilters=$j("#directory input");$j.each(filters,function(filter,values){if("username"==filter)$j("#usernameFilter").val(Directory.formatUsername(values[0]));else{var filterItems=allFilters.filter('input[name="'+filter+'"]');if(0==filterItems.length){for(var possibleSelectors=[],i=0;i<values.length;i++)possibleSelectors.push('#directory input[name="'+values[i]+'"]');filterItems=$j(possibleSelectors.join(", "))}for(i=0;i<values.length;i++){var currentValue=values[i].replace(/\W+/g,"").trim(),filterItem=filterItems.filter('[data-id="'+currentValue+'"]');0==filterItem.length&&(filterItem="country"==filter||"language"==filter?filterItems.filter('[value="'+currentValue+'"]'):filterItems.filter('[name="'+currentValue+'"]')),filterItem.parent(".subcategoryoff, .toggleCheckLi").filter(':not(".subcategoryon")').trigger("click")}}})}if("orderBy"in response){var orderItem=response.orderBy;$j(".sortByOptions").find("#"+orderItem).trigger("click")}Directory.isSavedSearchAction=!0,Directory.applyFilters(),Directory.isSavedSearchAction=!1,DirectoryEvents.hideTabControls("save"),DirectoryEvents.pillsState()})},showTooltip:function(message,type,autoRemove){DirectoryEvents.removeTooltip(!1);var tooltipTemplate=$j('<div class="searchTooltip"></div>');"error"==type?tooltipTemplate.addClass("error"):tooltipTemplate.addClass("success"),tooltipTemplate.text(message),$j("#newSearch").popover({html:!0,placement:"right",content:message}),$j("#newSearch").popover("show");var popover=$j(".favouriteFiltersContainer .popover");if("error"==type){popover.addClass("error");var close=$('<button type="button" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></button>').click(function(){popover.popover("destroy")});popover.append(close)}else popover.addClass("success");autoRemove&&setTimeout(function(){popover.fadeOut(500,function(){$j("#newSearch").popover("destroy")})},3e3)},removeTooltip:function(withFade){var tooltip=$j(".searchTooltip");tooltip.length&&(withFade?tooltip.fadeOut(500,function(){tooltip.remove()}):tooltip.remove()),$j("#newSearch").popover("destroy")},reloadAds:function(){function updateCam4Ads(){Cam4AdsTool.decideFooterAds(),0!==$j("#cam4UltimateFooterAd .profile-box").length||Cam4AdsTool.isIframe||setTimeout(updateCam4Ads,1e3)}for(var adsIframes=$j("#subfoot iframe, .sponsorAd iframe, #headerBanner iframe"),i=0;i<adsIframes.length;i++)$j("body").hasClass("taboocamscom")?$j(adsIframes[i]).attr("src",$j(adsIframes[i]).attr("src")):$j(adsIframes[i]).attr("src",Directory.formatAdsUrl($j(adsIframes[i]).attr("src")));Directory.getAdsParamsFrom(SearchDirectory.formatURL());"undefined"!=typeof Cam4AdsTool&&($j("#cam4UltimateFooterAd").html(""),updateCam4Ads())}},Directory={tabsQueryUrl:"/directory/tabs/user_%userid%/tab_%tabid%",searchQueryUrl:"/directory/search/user_%userid%",deleteSearchQueryUrl:"/directory/search/user_%userid%/search_%search_id%",getSearchQueryUrl:"/directory/search/user_%userid%/search_%search_id%",savedSearches:[],numberOfDisplayedSearches:5,lastUsernameValue:null,saveSearchRequest:{},getSearchesRequest:{},deleteSearchRequest:{},loggedInUserSearchLimit:3,goldUserSearchLimit:6,unlimitedSearchLimit:200,isSavedSearchAction:!1,brokenSnapshots:{},globalBrokenSnapshots:0,brokenSnapshotsCapPerPage:500,enableSearchesForResponsive:!0,showLoading:!0,reloadInterval:18e4,savedSearchTitleMaxLength:32,templates:{directoryCategories:$("#directory").find(".category"),directoryToggleFilters:$("#directory").find(".subcategoryoff")},userHasAccess:function(){return!!Cam4User.isLoggedIn},stripHTMLtags:function(html){return $("<div/>").text(html).html()},getSavedSearches:function(){var getSearchesUrl=Directory.searchQueryUrl.replace("%userid%",Cam4User.id);return this.getSearchesRequest=$j.ajax({type:"GET",url:getSearchesUrl}),this.getSearchesRequest.success(function(result){Directory.savedSearches=result}),this.getSearchesRequest},saveCurrentSearch:function(){var title,parameters=SearchDirectory.formatURL();0==(title=$j("#newSearch input").val().trim()).length?DirectoryEvents.showTooltip(directoryInt.searchNameEmpty,"error"):title.length>Directory.savedSearchTitleMaxLength?DirectoryEvents.showTooltip(directoryInt.filterNameTooLong,"error"):Directory.isDuplicateSearchSoftCheck(title)?DirectoryEvents.reportDuplicateSearch():Directory.userCanSave()?DirectoryEvents.canSave&&(DirectoryEvents.canSave=!1,this.saveSearch(title,parameters),Directory.saveSearchRequest.success(function(response){"SAVED_FAILED_DUPLICATE_NAME"==response.status_code?DirectoryEvents.reportDuplicateSearch():"SAVED_FAILED_TOO_MANY_SAVED_SEARCHES"==response.status_code?DirectoryEvents.reportTooManySearches():"SAVED_FAILED_ON_STORAGE"==response.status_code?DirectoryEvents.reportSearchError(response.status_code):(DirectoryEvents.showTooltip(Directory.stripHTMLtags(directoryInt.filterSaved.replace("%searchname%",title)),"success",!0),DirectoryEvents.updateSavedSearches()),DirectoryEvents.canSave=!0})):DirectoryEvents.reportTooManySearches()},cancelSaveSearch:function(){$j("#newSearch").remove(),$j("#newSearch").popover("destroy")},saveSearch:function(title,searchParams){var saveSearchUrl=Directory.searchQueryUrl.replace("%userid%",Cam4User.id);Directory.urlToArray(searchParams);this.saveSearchRequest=$j.ajax({type:"POST",url:saveSearchUrl,data:SearchDirectory.formatURL()+"&name_search="+title})},urlToArray:function(url){for(var request={},pairs=url.substring(url.indexOf("?")+1).split("&"),i=0;i<pairs.length;i++){var pair=pairs[i].split("="),filter=decodeURIComponent(pair[0]),value=decodeURIComponent(pair[1]);filter in request?request[filter].push(value):request[filter]=[value]}return request},checkForDuplicateSearches:function(haystack,key,value){var i=0;for(i=0;i<haystack.length;i++)if(key==haystack[i][0])return{position:i,where:"title"};for(i=0;i<haystack.length;i++)if(value==haystack[i][1])return{position:i,where:"value"};return!1},deleteTab:function(deleteSearchId){var activeTabObj=Directory.getTabDetails();if(activeTabObj||""!=deleteSearchId){if(""!=deleteSearchId)deleteAjaxUrl=Directory.deleteSearchQueryUrl.replace("%userid%",Cam4User.id).replace("%search_id%",deleteSearchId);else if("search"==activeTabObj.type)deleteAjaxUrl=Directory.deleteSearchQueryUrl.replace("%userid%",Cam4User.id).replace("%search_id%",activeTabObj.id);else var deleteAjaxUrl=this.tabsQueryUrl.replace("%userid%",Cam4User.id).replace("%tabid%",activeTabObj.id);this.deleteSearchRequest=$j.ajax({type:"DELETE",url:deleteAjaxUrl}),this.deleteSearchRequest.success(function(response){"OK"==response.status_code||"DELETED_OK"==response.status_code?(DirectoryEvents.hideDeleteTabModal(),DirectoryEvents.removeSavedSearch(deleteSearchId),$j('[data-search="'+deleteSearchId+'"], [data-delete-search="'+deleteSearchId+'"]').remove(),DirectoryEvents.hideTabControls("delete"),DirectoryEvents.showTabControls("save"),Directory.savedSearches.length?5==Directory.savedSearches.length&&DirectoryEvents.generateSavedSearches():$j(".favouriteFiltersContainer").hide()):Directory.reportDeleteError()}),this.deleteSearchRequest.error(function(response){Directory.reportDeleteError()})}else Directory.reportDeleteError()},reportDeleteError:function(){DirectoryEvents.deleteTabModal.find(".confirm-button, p").hide(),DirectoryEvents.deleteTabModal.find("h3").text(directoryInt.deleteTabError)},getTabDetails:function(){var activeSelection=DirectoryEvents.directoryContainer.find(".active").parent("li").not(".savedSearchesWrapper");return activeSelection.length?0==activeSelection.data("deletable")?"NOT_DELETABLE":activeSelection.data("tab")?{type:"tab",id:activeSelection.data("tab"),title:activeSelection.find(".active").text(),url:activeSelection.find(".active").attr("href"),element:activeSelection}:activeSelection.data("search")?{type:"search",id:activeSelection.data("search"),title:activeSelection.find(".active").text(),url:activeSelection.find(".active").attr("href"),element:activeSelection}:0:0},useNonAjaxSearch:function(){return SearchDirectory.isOldInternetExplorer()||3==SearchDirectory.resultsSubmitMethod&&SearchDirectory.isFirefox(29)},getProfileImageUniqueClass:function(image){return image.attr("class").replace("profile-thumb ","")},removeArrayEmptyElements:function(array){for(var _array=[],i=0;i<array.length;i++)""!=array[i]&&_array.push(array[i]);return _array},resetBrokenImages:function(){this.brokenSnapshots={}},getGenderImage:function(genderIndex){return{f:"default_Female.png",m:"default_Male.png",c:"default_Female.png",t:"default_Shemale.png",u:"default_Unknown.png"}[genderIndex]},getGenderImageUrl:function(genderIndex){return[WEB_CDN,"/images/defaults/",this.getGenderImage(genderIndex)].join("")},replaceBrokenImages:function(image){var uniqueClass=this.getProfileImageUniqueClass(image),profileImage=image.attr("data-profile"),snapshots=image.attr("data-thumbs"),url=image.attr("src"),gender=image.attr("data-gender"),snapshotsArray=this.removeArrayEmptyElements(snapshots.split(",")),snapshotUrl=url.replace(/(\d+.jpg)/,""),extension=SearchDirectory.getExtensionFrom(url),snapshotsArrayLength=snapshotsArray.length;uniqueClass in this.brokenSnapshots?this.brokenSnapshots[uniqueClass].counter++:this.brokenSnapshots[uniqueClass]={counter:1,maxCycles:snapshotsArrayLength},0!==snapshotsArrayLength&&SearchDirectory.hasSnapshots(url)&&this.brokenSnapshots[uniqueClass].counter<=this.brokenSnapshots[uniqueClass].maxCycles?image.attr("src",snapshotUrl+snapshotsArray.shift()+"."+extension).attr("data-thumbs",snapshotsArray.join(",")):void 0!==profileImage?image.attr("src",profileImage).removeAttr("data-profile"):image.attr("src",this.getGenderImageUrl(gender)).removeAttr("data-first")},countAllActiveFilters:function(){Directory.templates.directoryToggleFilters.prev(".category").each(function(){$(this).hasClass("locale")||Directory.countActiveFilters($(this))})},countActiveFilters:function(category){var activeFiltersCount=category.nextUntil(".category").filter(".subcategoryon").length;0!=activeFiltersCount?0==category.find("span").length?category.append("<span>"+activeFiltersCount+"</span>"):category.find("span").text(activeFiltersCount):category.find("span").remove()},bindEvents:function(page){function reloadResults(){$j("#directoryTagHeader").is(":visible")||(SearchDirectory.activeTab?(clearTimeout(directoryReloadSetTimeout),Directory.reloadResults(),Directory.reloadInterval=18e4,setTimeout(reloadResults,Directory.reloadInterval)):(clearTimeout(directoryReloadSetTimeout),Directory.reloadInterval=1e3,setTimeout(reloadResults,Directory.reloadInterval)))}loadSnapshots(),DirectoryEvents.bindGlobalEvents(),$j(".subcategoryoff").not(".with-dropdown").on("click",function(event){SearchDirectory.toggleValue($j(this)),Directory.countAllActiveFilters(),event.isTrigger||Directory.applyFilters()}),DirectoryEvents.bindCategoryToggle(),SearchDirectory.sortElements($j("#languages, #countries")),SearchDirectory.getDirectoryHtml(page,!0,!1,!1);var noResults=SearchDirectory.checkNoResults($j("#directoryHtml"));noResults&&$j("#directoryHtml").html(noResults.html()),$j(".subcategoryon").each(function(e){SearchDirectory.generateTag($j(this).text(),$j(this),$j(this).prevAll(".category:first").attr("id"))}),$j("#countries .delimiter").prevAll(".toggleCheckLi").find('input[type="checkbox"]').each(function(e){SearchDirectory.generateTag($j(this).parent().find("label").text(),$j(this),"tags_countries")}),$j("#languages .delimiter").prevAll(".toggleCheckLi").find('input[type="checkbox"]').each(function(e){SearchDirectory.generateTag($j(this).parent().find("label").text(),$j(this),"tags_language")});var username=$j("#usernameFilter"),usernameValue=username.val();""!=usernameValue&&SearchDirectory.generateTag(usernameValue,username,"tags_username"),SearchDirectory.tagsContainer.find("li").fadeIn(),SearchDirectory.tagsContainer.find("ul").fadeTags(),$j(".toggleCheckLi").click(function(e){e.stopPropagation();var checkBoxClicked=!1;$j(e.target).closest('input[type="checkbox"]').length>0&&(checkBoxClicked=!0);var dropdown_id=$j(this).parents("li.subcategoryoff").prevAll(".category").attr("id"),state=$j(this).find("input:checked").length;if(dropdown_id=$j(this).parents("#countries, #languages").attr("id"),!state){if(-1!==dropdown_id.indexOf("countries")&&$j("#countries").find(".delimiter").prevAll(".toggleCheckLi").length>=SearchDirectory.dropdownLimit)return!1;if(-1!==dropdown_id.indexOf("languages")&&$j("#languages").find(".delimiter").prevAll(".toggleCheckLi").length>=SearchDirectory.dropdownLimit)return!1}SearchDirectory.generateTag($j("label",this).text(),$j("input",this),dropdown_id),SearchDirectory.moveCheckBox($j("input",this),checkBoxClicked),SearchDirectory.generateSearchMap("#"+dropdown_id.replace("tags_","")),$j(this).removeClass("active"),e.isTrigger||Directory.applyFilters(),$j("#countries input[type=checkbox]").is(":checked")?SearchDirectory.resetQuery("#countries"):$j("#languages input[type=checkbox]").is(":checked")&&SearchDirectory.resetQuery("#languages")}),$j("#countriesButton, .dropdown_arrow_countries").click(function(e){e.stopPropagation(),SearchDirectory.fixDropdownHeight(),$j("#countriesButton").toggleClass("toggled"),$j("#languagesButton").removeClass("toggled"),$j("#countries").toggle(),$j("#languages").hide(),0==SearchDirectory.countSelected("#languages ul")&&($j("#languagesButton").val(directoryInt.selectLanguages),SearchDirectory.resetQuery("#languages")),$j("#countriesButton").hasClass("toggled")?SearchDirectory.generateSearchMap("#countries"):SearchDirectory.resetQuery("#countries"),0==SearchDirectory.countSelected("#countries ul")&&($j("#countriesButton").val(directoryInt.selectCountries),SearchDirectory.resetQuery("#languages"))}),$j("#languagesButton, .dropdown_arrow_languages").click(function(e){e.stopPropagation(),SearchDirectory.fixDropdownHeight(),$j("#languages").toggle(),$j("#languagesButton").toggleClass("toggled"),$j("#countriesButton").removeClass("toggled"),$j("#countries").hide(),0==SearchDirectory.countSelected("#countries ul")&&($j("#countriesButton").val(directoryInt.selectCountries),SearchDirectory.resetQuery("#languages")),$j("#languagesButton").hasClass("toggled")?SearchDirectory.generateSearchMap("#languages"):SearchDirectory.resetQuery("#languages"),0==SearchDirectory.countSelected("#languages ul")&&($j("#languagesButton").val(directoryInt.selectLanguages),SearchDirectory.resetQuery("#languages"))}),$j("#directory").click(function(){$j("#countriesButton").hasClass("toggled")&&$j("#countriesButton").trigger("click"),$j("#languagesButton").hasClass("toggled")&&$j("#languagesButton").trigger("click")}),$j(".pager a").live("click",function(e){SearchDirectory.getDirectoryHtml($j(this).attr("data-page"),!1,!1,SearchDirectory.lastQuery),e.preventDefault()}),$j("#directoryHtml").delegate(".pager a","click",function(){DirectoryEvents.useInfiniteScroll||$j(window).scrollTop(0)}),$j(".controls .reset").on("click",function(){SearchDirectory.directoryTagsHeader.removeClass("shown").hide(),SearchDirectory.resetForm();var desktopTabs=$j(".desktop-tabs"),savedSearches=$("#savedSearches"),tagsContainer=$j(".searchControls-tags");desktopTabs.find("li a").removeClass("active"),tagsContainer.hide(),savedSearches.find(".active").removeClass("active")}),$j(".username-search button").on("click",function(event){Directory.applyFilters(),event.preventDefault()}),SearchDirectory.countSelected($j("#countries ul").first()),SearchDirectory.countSelected($j("#languages ul").first()),DirectoryEvents.initDropdownSearch(),SearchDirectory.lastQuery=SearchDirectory.formatURL(),Directory.userHasAccess()&&Directory.enableSearchesForResponsive&&(DirectoryEvents.bindSaveSearchEvents(),DirectoryEvents.toggleSearchesDropdown(),DirectoryEvents.generateSavedSearches()),Directory.toggleTabsDisplay(),"NOT_DELETABLE"===Directory.getTabDetails()&&$j(".searchControls").hide(),$j("#countries, #languages").find(".delimiter").prevAll(".toggleCheckLi").each(function(){$j(this).find("input").attr("checked","checked")}),$j("#countries, #languages").find(".delimiter").nextAll(".toggleCheckLi").each(function(){$j(this).find("input").removeAttr("checked")}),SearchDirectory.lastSuccessQuery=SearchDirectory.lastQuery;var directoryReloadSetTimeout=setTimeout(reloadResults,Directory.reloadInterval);SearchDirectory.toggleFilterCategories(),SearchDirectory.toggleMobileFilter(),this.combinedGroupTabs(),this.checkTabsSelectedInFirstLoad(),SearchDirectory.toggleMoreFilters(),DirectoryEvents.pillsState(),$j(".magnifying-search-glass").on("click",function(e){e.preventDefault(),Cam4User.isLoggedIn||Cam4User.isLoggedInAsGuest||Utils.decideOffer()})},applyFilters:function(callback){if(SearchDirectory.directoryTagsHeader.removeClass("shown").hide(),!Cam4User.isLoggedIn&&!Cam4User.isLoggedInAsGuest&&!$j("body").hasClass("modal-open")&&$j("#usernameFilter").val().trim())return Utils.decideOffer(),!1;if($j("#loginForm").is(":visible"))LoginModals.submitLogin();else{if(Directory.useNonAjaxSearch())return window.location="/search?"+SearchDirectory.formatURL(),!1;$j("#countries").is(":visible")&&$j("#countriesButton").trigger("click"),$j("#languages").is(":visible")&&$j("#languagesButton").trigger("click"),Directory.isSavedSearchAction||(DirectoryEvents.directoryContainer.find(".active").removeClass("active"),Directory.isSavedSearchAction=!1),DirectoryEvents.saveSearchAction||Directory.cleanSavedSearches(),DirectoryEvents.saveSearchAction=!1;var username=$j("#usernameFilter"),usernameValue=username.val();""!=usernameValue&&(Directory.lastUsernameValue?Directory.lastUsernameValue!=usernameValue&&(SearchDirectory.removeTag(username),SearchDirectory.generateTag(usernameValue,username,"tags_username")):SearchDirectory.generateTag(usernameValue,username,"tags_username"),Directory.lastUsernameValue=usernameValue),SearchDirectory.tagsContainer.find("li").show(),SearchDirectory.tagsContainer.css("display","inline-block").find("ul").fadeTags(),SearchDirectory.lastQuery=SearchDirectory.formatURL(),SearchDirectory.getDirectoryHtml(1,!1,!1,!1),Directory.cancelSaveSearch(),DirectoryEvents.hideTabControls("delete"),DirectoryEvents.showTabControls("save"),DirectoryEvents.pillsState(),callback&&callback()}},checkTabsSelectedInFirstLoad:function(){var parameters=SearchDirectory.formatURLJson(),language=(parameters.gender,parameters.language),country=parameters.country,newPerformer=(parameters.broadcastType,parameters.newPerformer),hd=parameters.hd,shop=parameters.hasShopContent,languageTab=$j('.optionalTabs [data-tab="5"]'),countryTab=$j('.optionalTabs [data-tab="6"]'),newTab=$j('.optionalTabs [data-tab="9"]'),hdTab=$j('.optionalTabs [data-tab="11"]'),shopTab=$j('.optionalTabs [data-tab="12"]');void 0!==language&&language==languageTab.data("language")&&languageTab.find("a").addClass("active"),void 0!==countryTab&&country==countryTab.data("country")&&countryTab.find("a").addClass("active"),void 0!==newPerformer&&newPerformer&&newTab.find("a").addClass("active"),void 0!==hd&&hd&&hdTab.find("a").addClass("active"),void 0!==shop&&shop&&shopTab.find("a").addClass("active")},cleanActiveMainTabs:function(){$j(".desktop-tabs .mainTabs li a").removeClass("active")},cleanSavedSearches:function(){$j(".savedFilterEntry a").removeClass("active")},checkOptionalTabs:function(){var optionalParameters="";return $j(".desktop-tabs .optionalTabs a").each(function(e){var tab=$j(this).parent("li").data("tab");if($j(this).hasClass("active"))switch(tab){case 5:optionalParameters+="&language="+$j(this).parent("li").data("language");break;case 6:optionalParameters+="&country="+$j(this).parent("li").data("country");break;case 9:optionalParameters+="&newPerformer=true";break;case 11:optionalParameters+="&hd=true"}}),$j(".searchControls-tags").hide(),""!==optionalParameters&&(optionalParameters+="&online=true"),optionalParameters},combinedGroupTabs:function(){$j(".desktop-tabs .optionalTabs a").on("click",function(event){var tab=$j(this).parent("li").data("tab");$(this).toggleClass("active");var isActive=$j(this).hasClass("active");switch(tab){case 5:var languageFilters=$("#languages").find(".toggleCheckLi input"),currentLanguage=$j(this).parent("li").data("language");languageFilters.filter('[value="'+currentLanguage+'"]').parent().trigger("click");break;case 6:var countryFilters=$("#countries").find(".toggleCheckLi input"),currentCountry=$j(this).parent("li").data("country");countryFilters.filter('[value="'+currentCountry+'"]').parent().trigger("click");break;case 9:var newPerformerFilter=$('[name="newPerformer"]');isActive?newPerformerFilter.val(!0):newPerformerFilter.removeAttr("value");break;case 11:$('[name="hd"]').parent().trigger("click");break;case 12:var myShop=$('[name="hasShopContent"]');isActive?myShop.val(!0):myShop.removeAttr("value")}Directory.applyFilters(),event.preventDefault()})},toggleTabsDisplay:function(){$j(".tags").css("display",$j("[data-tab] .active, #directorySavedSearches li:first-child .active").length?"none":"inline-block")},getUserSearchLimit:function(){return Cam4User.isPayingMember()&&Cam4User.useNewGoldFeatures||Cam4User.userFeatures.C4BND_UNLIMITED_SAVED_SEARCHES?this.unlimitedSearchLimit:Cam4User.isPayingMember()?this.goldUserSearchLimit:this.loggedInUserSearchLimit},isDuplicateSearchSoftCheck:function(name){var duplicate=!1;return $j.each(Directory.savedSearches,function(id,search){if(search.searchName.toLowerCase()==name.toLowerCase())return duplicate=!0,!1}),duplicate},userCanSave:function(){return Directory.savedSearches.length<Directory.getUserSearchLimit()},getSearch:function(searchId){var searchQueryUrl=Directory.getSearchQueryUrl.replace("%userid%",Cam4User.id).replace("%search_id%",searchId);return $j.ajax({url:searchQueryUrl,type:"GET"})},formatUsername:function(username){return username.replace(/"/g,"")},getFanclubParams:function(){var activeFilters=Directory.getAdsParamsFrom(SearchDirectory.formatURL()),category=""!==activeFilters.gender?activeFilters.gender:"all";return["cams/group","couple"].some(function(filter){return window.location.pathname.indexOf(filter)>=0})&&(category="couple"),{category:category}},loadDirectoryAd:function(){var gender,category;return $('[data-tab="2"] a').hasClass("active")?(gender="male",category="gay"):$('[data-tab="4"] a').hasClass("active")?(gender="shemale",category="shemale"):(gender="female",category="straight"),{gender:gender,sexualPreference:category}},formatAdsUrl:function(src){var filters=Directory.loadDirectoryAd(),adsNewUrl=[];return adsNewUrl.push("gender="+filters.gender),adsNewUrl.push("category="+filters.sexualPreference),adsNewUrl=adsNewUrl.join("&"),src.replace(/(\?)(.*)/,"?"+adsNewUrl)},checkSignupOverlay:function(){},getAdsParamsFrom:function(url){var filters=Directory.urlToArray(url),adsParamsDefaults={gender:"",sexualPreference:""},adsParams={gender:"male",sexualPreference:"straight"};return adsParams.gender="gender"in filters?filters.gender[0]:adsParamsDefaults.gender,adsParams.sexualPreference="sexPreference"in filters?filters.sexPreference[0]:adsParamsDefaults.sexualPreference,adsParams},reloadResults:function(){this.showLoading=!1,SearchDirectory.loadDirectoryHtml(SearchDirectory.lastSuccessQuery),this.showLoading=!0},arrangeEmbeddedAds:function(){if(!Campaigns.activeCampaignName||"default"==Campaigns.activeCampaignName)return!1;var adElem,directoryDiv=$j("#directoryDiv");if(0!=directoryDiv.find(".profileBox").length){adElem=directoryDiv.find(".profileBox.promo-ad").first().clone();var position=this.determinePositionInGrid(2,2);1!==position&&directoryDiv.find(".profileBox:nth-child("+position+")").before(adElem)}},determinePositionInGrid:function(rowNumber,colNumber){if(rowNumber<=0||colNumber<=0)return 0;var directoryDiv=$j("#directoryDiv"),pos=Math.floor(directoryDiv.width()/directoryDiv.find(".profileBox").width())*(rowNumber-1)+colNumber;return pos>directoryDiv.find(".profileBox").length?1:pos},guestModalAd:function(){if("undefined"!=typeof SFW&&SFW)return null;if($j("#guestModalLayout").length)$j("#guestModalAdContainer iframe").remove();else{var guestModalLayout='<div class="modal fade" id="guestModalLayout"><div class="modal-dialog modal-lg"><div id="guestModalAdContainer"><img id="close-guest-ad" src="'+WEB_CDN+'/images/close_white.png"></div></div></div>';$j("body").append(guestModalLayout)}var params,link="/ads/guest-auto-overlay/guest-modal.jsp"+(params="male"==Directory.loadDirectoryAd().gender?"?gender=male&category=gay&id=70":"shemale"==Directory.loadDirectoryAd().gender?"?gender=shemale&category=shemale&id=71":"?gender=female&category=straight&id=69"),iframe=document.createElement("iframe");iframe.frameBorder=0,iframe.marginheight=0,iframe.marginwidth=0,iframe.scrolling="no",iframe.width="900px",iframe.height="475px",iframe.setAttribute("src",link),document.getElementById("guestModalAdContainer").appendChild(iframe),$j("#guestModalLayout").modal("show"),$j("#close-guest-ad").on("click",function(){$j("#guestModalLayout").modal("hide")})},checkDirectoryAutoOverlay:function(){function activateModal(oldRefresh){oldRefresh%5==0&&5!=oldRefresh&&(oldRefresh%10==0&&UserAgent.desktop?Directory.guestModalAd():Registration.guestModal())}if(document.getElementById("directory")&&!Cam4User.isLoggedIn&&!Cam4User.isLoggedInAsGuest){var oldValue,cookieName="directory-refresh";try{null==sessionStorage.getItem("autoOverlay")?sessionStorage.setItem("autoOverlay",1):(oldValue=parseInt(Number(sessionStorage.getItem("autoOverlay"))),sessionStorage.setItem("autoOverlay",oldValue+1),activateModal(oldValue))}catch(ex){null==Cam4Cookies.getCookie(cookieName)?Cam4Cookies.setCookie(cookieName,1):(oldValue=parseInt(Cam4Cookies.getCookie(cookieName)),Cam4Cookies.setCookie(cookieName,oldValue+1),activateModal(oldValue))}}}},FetchFilters=function(){function buildUrl(filter){var url;switch(filter){case"languages":url="/rest/v1.0/options/languages";break;case"countries":url="/rest/v1.0/options/countries";break;default:url="/rest/v1.0/options/languages"}return url}function buildBundleUrl(bundle){return"/api/i18n?lang="+cookieLang+"&bundle="+bundle}function parseLeftFilters(data,bundle,divId,_id){for(var labelName,li,ul=$j("<ul></ul>"),delimiter=$j('<li class="delimiter"><hr><li>'),selectedString=$j("#"+divId).attr("data-selected-"+divId),selectedArray=void 0!==selectedString?selectedString.split(","):[],i=0;i<data.length;i++)if(-1!==selectedArray.indexOf(data[i].code)){var input=$j('<input type="checkbox" name="'+_id+'" value="'+data[i].code+'" >'),label=$j("<label>"+data[i].name+"</label>");(li=$j('<li class="toggleCheckLi"></li>')).append(input),li.append(label),ul.append(li)}ul.append(delimiter);for(i=0;i<data.length;i++)-1===selectedArray.indexOf(data[i].code)&&(input=$j('<input type="checkbox" name="'+_id+'" value="'+data[i].code+'" >'),labelName=void 0!==bundle[data[i].code]?bundle[data[i].code]:data[i].name,label=$j("<label>"+labelName+"</label>"),(li=$j('<li class="toggleCheckLi"></li>')).append(input),li.append(label),ul.append(li));$j("#"+divId).append(ul)}function parseBottomRightSelectLanguages(data){for(var selected,option,select=$j('<select onchange="location = this.options[this.selectedIndex].value;" class="lang-change pull-left">'),i=0;i<data.length;i++)selected=cookieLang===data[i].code?"selected":"",option=$j('<option value="/setlanguage?lang='+data[i].code+'" '+selected+">"+data[i].nativeName+"</option>"),select.append(option);$j("#websiteLanguageSelect").append(select)}var cookieLang=Cam4Cookies.getCookie("cam4_user_language")||Cam4User.lang,callTimeoutDuration=5e3;return{getLanguages:function(){var defLanguages=$j.Deferred(),ajaxParams={url:buildUrl("languages"),type:"get",timeout:callTimeoutDuration},bundleParams={url:buildBundleUrl("languages"),type:"get",timeout:callTimeoutDuration};return $j.when($j.ajax(ajaxParams),$j.ajax(bundleParams)).then(function(resultsLanguages,resultsBundle){var languages=void 0!==resultsLanguages[0]&&resultsLanguages[0].length>0?resultsLanguages[0]:[];parseLeftFilters(languages,void 0!==resultsBundle[0]?resultsBundle[0]:{},"languages","language"),parseBottomRightSelectLanguages(languages),defLanguages.resolve()},function(){defLanguages.reject()}),defLanguages},getCountries:function(){var defCountries=$j.Deferred(),ajaxParams={url:buildUrl("countries"),type:"get",timeout:callTimeoutDuration},bundleParams={url:buildBundleUrl("countries"),type:"get",timeout:callTimeoutDuration};return $j.when($j.ajax(ajaxParams),$j.ajax(bundleParams)).then(function(resultsCountries,resultsBundle){parseLeftFilters(void 0!==resultsCountries[0]&&resultsCountries[0].length>0?resultsCountries[0]:[],void 0!==resultsBundle[0]?resultsBundle[0]:{},"countries","country"),defCountries.resolve()},function(){defCountries.reject()}),defCountries}}}();$j(document).ready(function(){function ifItsDirectory(){Directory.bindEvents(RequestParameters.page),Directory.countAllActiveFilters(),RequestParameters.responsiveDirectoryForMobile&&$j("#directoryHtml").find(".profile-thumb").lazyLoad(),UserAgent.phone||updateDirectorySegments()}if(RequestParameters.isDirectory&&(!1===ControlledFeatures.EMBEDDED_DIRECTORY_FILTERS?$j.when(FetchFilters.getLanguages(),FetchFilters.getCountries()).then(function(){ifItsDirectory(),SearchDirectory.countSelected($j("#countries ul").first()),SearchDirectory.countSelected($j("#languages ul").first())},function(){ifItsDirectory()}):ifItsDirectory()),!Cam4User.isLoggedIn&&!Cam4User.isLoggedInAsGuest){var usernameFilter=$j("#usernameFilter");usernameFilter.keydown(function(event){usernameFilter.attr("autocomplete","off"),13===event.keyCode&&Utils.decideOffer()})}Directory.arrangeEmbeddedAds(),SearchDirectory.countLocale()})}
function loadSnapshots(){$j(".profile-thumb").each(function(){var _this=$j(this),useShapshotsAPI=ControlledFeatures.USE_SNAPSHOTS_API&&!SFW,link=$j(this).parent("a"),snapshots=useShapshotsAPI?"":String(_this.data("thumbs")),profile=useShapshotsAPI?THUMBNAILS_CDN+"/"+_this.data("username")+"?s="+encodeURIComponent(_this.data("thumbnail-sig")):_this.data("profile"),initial=_this.data("src"),gender=_this.data("gender");useShapshotsAPI&&ControlledFeatures.FACIAL_DETECTION_SNAPSHOTS&&(profile+="&fd=true"),snapshots=""!=snapshots?snapshots.split(","):[];new DirectorySnapshot(this,link,snapshots,initial,profile,"default_Unknown",_this.data("thumbnail-sig"),_this.data("username"),gender,function(image){image.addEventListener("load",function(){image.naturalWidth>image.naturalHeight?$j(image).parent().parent().addClass("wide-thumbnails"):$j(image).parent().parent().addClass("portrait-thumbnails")}),SearchDirectory.cycleImage($j(image))})})}var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}(),ImageSource;!function(ImageSource){ImageSource[ImageSource.profile=0]="profile",ImageSource[ImageSource.gender=1]="gender",ImageSource[ImageSource.snapshot=2]="snapshot"}(ImageSource||(ImageSource={}));var Snapshots;!function(Snapshots){var Snapshot=function(){function Snapshot(snapshots,snapshotImageLink,profileImageLink,defaultImageLink,thumbnailId,username){this.snapshots=snapshots;var snapshotLink=snapshotImageLink;ControlledFeatures.USE_SNAPSHOTS_API&&!SFW&&(snapshotLink=THUMBNAILS_CDN+"/"+username+"?s="+encodeURIComponent(thumbnailId),ControlledFeatures.FACIAL_DETECTION_SNAPSHOTS&&(snapshotLink+="&fd=true")),this.snapshotImageLink=snapshotLink,this.profileImageLink=profileImageLink,this.defaultImageLink=defaultImageLink,this.thumbnailId=thumbnailId,this.username=username}return Snapshot.prototype.getSnapshotBaseUrl=function(url){return url.substring(0,url.lastIndexOf("/")+1)},Snapshot.prototype.getSnapshotExtension=function(url){return url.substring(url.lastIndexOf("."),url.length)},Snapshot.prototype.getProfileImage=function(){return this.snapshots.length>0?(this.imageSource=ImageSource.snapshot,this.snapshots[0]):this.profileImageLink?(this.imageSource=ImageSource.profile,this.profileImageLink):(this.imageSource=ImageSource.gender,this.defaultImageLink)},Snapshot.prototype.getProfileImageUrl=function(){this.getProfileImage();var url=this.defaultImageLink;return this.imageSource==ImageSource.snapshot&&(url=this.snapshotImageLink),this.imageSource==ImageSource.profile&&(url=this.profileImageLink),url},Snapshot.prototype.getLastImageSource=function(){return this.imageSource},Snapshot.prototype.removeProfileImage=function(){this.profileImageLink=""},Snapshot.prototype.removeFirstSnapshot=function(){this.snapshots.length>0&&this.snapshots.shift()},Snapshot}();Snapshots.Snapshot=Snapshot}(Snapshots||(Snapshots={}));var Gender;!function(Gender){Gender[Gender.male=0]="male",Gender[Gender.female=1]="female",Gender[Gender.shemale=2]="shemale",Gender[Gender.unknown=3]="unknown"}(Gender||(Gender={}));var ImageServer=function(){function ImageServer(){}return Object.defineProperty(ImageServer,"IMAGE_EXTENSION",{get:function(){return".jpg"},enumerable:!0,configurable:!0}),Object.defineProperty(ImageServer,"SNAPSHOT_IMAGE_SERVERS",{get:function(){return imageServers.map(function(imageServer){return imageServer+"/avatar/400x300/"})},enumerable:!0,configurable:!0}),Object.defineProperty(ImageServer,"GENDER_URL",{get:function(){return WEB_CDN+"/images/defaults/"},enumerable:!0,configurable:!0}),ImageServer.GET_CHAT_AVATAR=function(username){return"/avatar/user/60x60/"+username+this.IMAGE_EXTENSION},ImageServer}(),DirectorySnapshot=function(_super){function DirectorySnapshot(image,link,snapshots,snapshotsLink,profileLink,defaultLink,thumbnailId,username,gender,onLoad){var _this=_super.call(this,snapshots,snapshotsLink,profileLink,defaultLink,thumbnailId,username)||this;return _this.show=function(){_this.inViewport()&&($j(window).unbind("scroll",_this.scrollHandler),_this.validate())},_this.getProfileId=function(){return _this.profileImageLink.replace(_this.getSnapshotBaseUrl(_this.profileImageLink),"")},_this.getShard=function(snapshotId){return ImageServer.SNAPSHOT_IMAGE_SERVERS[snapshotId%ImageServer.SNAPSHOT_IMAGE_SERVERS.length]},_this.removeProfileImg=function(){_this.profileImageLink=null},_this.removeFirstSnapshotFromDom=function(){_this.removeFirstSnapshot(),typeof _this.snapshots==typeof[]&&$j(_this.image).data("thumbs",_this.snapshots.join(","))},_this.replace=function(){_this.removeFirstSnapshotFromDom(),_this.getLastImageSource()==ImageSource.profile&&_this.removeProfileImg(),_this.validate(_this.getUrl())},_this.validate=function(src){src||(src=_this.getUrl());var temporary=new Image,startTime=(new Date).getTime();temporary.onerror=function(){SnapshotsLogger.logSnapshotFail((new Date).getTime()-startTime),console.log("replacing ",src),_this.replace()},temporary.onload=function(event){SnapshotsLogger.logSnapshotSuccess((new Date).getTime()-startTime),_this.isValid(temporary)?(_this.onLoad(_this.image),_this.link.removeClass("loading"),_this.image.src=src):(console.log("replacing ",src),_this.replace())},temporary.src=src},_this.isValid=function(img){return img.complete&&!(void 0!==img.naturalWidth&&0===img.naturalWidth)},_this.getUrl=function(){var imageId=_this.getProfileImage();return _this.imageSource==ImageSource.snapshot?ControlledFeatures.USE_SNAPSHOTS_API&&!SFW?_this.snapshotImageLink:[_this.getShard(imageId),imageId,ImageServer.IMAGE_EXTENSION].join(""):_this.imageSource==ImageSource.profile?imageId:[ImageServer.GENDER_URL,imageId,ImageServer.IMAGE_EXTENSION].join("")},_this.inViewport=function(){var rect=_this.image.getBoundingClientRect(),offset=window.innerHeight||600;return rect.top>=-offset&&rect.left>=0&&rect.bottom<=(window.innerHeight||document.documentElement.clientHeight)+offset&&rect.right<=(window.innerWidth||document.documentElement.clientWidth)},_this.throttle=function(func,wait,options){var context,args,result,timeout=null,previous=0;options||(options={});var later=function(){previous=!1===options.leading?0:Date.now(),timeout=null,result=func.apply(context,args),context=args=null};return function(){var now=Date.now();previous||!1!==options.leading||(previous=now);var remaining=wait-(now-previous);return context=this,args=arguments,remaining<=0?(clearTimeout(timeout),timeout=null,previous=now,result=func.apply(context,args),context=args=null):timeout||!1===options.trailing||(timeout=setTimeout(later,remaining)),result}},link instanceof $j?_this.link=link:_this.link=$j(image).parent("a"),_this.image=image,_this.gender=gender,_this.defaultImageLink=_this.getGenderProfileImage(),_this.onLoad=onLoad||$j.noop,_this.scrollHandler=_this.throttle(function(){_this.show()},300,{}),_this.inViewport()?_this.show():$j(window).on("scroll",_this.scrollHandler),_this}return __extends(DirectorySnapshot,_super),DirectorySnapshot.prototype.getUserAgent=function(UserAgent){return UserAgent.phone?"phone":UserAgent.tablet?"tablet":"desktop"},DirectorySnapshot.prototype.getGenderProfileImage=function(){var genderImages={f:"default_Female",female:"default_Female",t:"default_Shemale",shemale:"default_Shemale",transgender:"default_Shemale",m:"default_Male",male:"default_Male",u:"default_Unknown",unknown:"default_Unknown",c:"default_Unknown"},genderImagesSizes={phone:"400x300",tablet:"400x300",desktop:"400x300"};return void 0===this.gender&&(this.gender="u"),genderImages[this.gender]+"."+genderImagesSizes[this.getUserAgent(UserAgent)]},DirectorySnapshot}(Snapshots.Snapshot),SearchType;!function(SearchType){SearchType[SearchType.online=0]="online",SearchType[SearchType.offline=1]="offline",SearchType[SearchType.tags=2]="tags",SearchType[SearchType.attributes=3]="attributes"}(SearchType||(SearchType={}));var Search;if(function(Search){var User=function(){return function(user,type){for(var key in user)user.hasOwnProperty(key)&&(this[key]=m.prop(user[key])),user.hasOwnProperty("type")||(this.type=m.prop(type))}}();Search.User=User;var Model=function(){return function(){var _this=this;this.list=[],this.add=function(_user,type){_this.list.push(new User(_user,type))},this.length=function(){return _this.list.length},this.getAll=function(){return _this.list},this.deleteAll=function(){_this.list=[]},this.deleteByType=function(type){_this.list=_this.getAll().filter(function(user){return user.type()!==type})}}}(),Controller=function(){return function(args){var _this=this;this.args=args,this.users=new Model,this.directoryURL="/directoryCams?directoryJson=true",this.container=document.getElementById("usernameSearch"),this.previousQuery=m.prop(""),this.queryRestriction=m.prop(/([A-Za-z0-9_])+/g),this.lengthRestriction=m.prop(15),this.includeOffline=m.prop(!1),this.numberOfTags=m.prop(8),this.numberOfAttributes=m.prop(8),this.statusMessageLength=m.prop(42),this.currentAttribute=m.prop({}),this.minimumTagCharacters=m.prop(3),this.abortPreviousRequest=function(){_this.currentRequest&&_this.currentRequest().abort(),_this.currentRequest=m.prop()},this.queryValue=function(value){_this.abortPreviousRequest();var request=m.request({method:"GET",url:"/usernameSearch?username="+value,config:_this.currentRequest});_this.getAttribute(value),request.then(function(response){_this.deleteAll(),response.map(function(user){_this.add(user,SearchType.online)}),value.length>=_this.minimumTagCharacters()&&_this.queryTags(value),_this.includeOffline()&&!_this.userExists(value)&&_this.queryOffline(value)})},this.userExists=function(username){return _this.getAll().some(function(user){return user.username()===username})},this.queryTags=function(tag){m.request({method:"GET",url:_this.directoryURL+"&online=true&resultsPerPage="+_this.numberOfTags()+"&showTag="+tag,config:_this.currentRequest}).then(function(response){_this.deleteByType(SearchType.tags),response.map(function(tag){_this.add(tag,SearchType.tags)})})},this.queryOffline=function(username){m.request({method:"GET",url:"/usernameSearch?username="+username+"&offline=true"}).then(function(response){_this.deleteByType(SearchType.offline),response.map(function(user){_this.add(user,SearchType.offline)})})},this.queryAttribute=function(attribute,value){m.request({method:"GET",url:_this.directoryURL+"&online=true&"+attribute+"="+value+"&resultsPerPage="+_this.numberOfAttributes(),config:_this.currentRequest}).then(function(response){_this.deleteByType(SearchType.attributes),response.map(function(user){_this.add(user,SearchType.attributes)})})},this.query=function(instance){instance.value=instance.value.match(_this.queryRestriction()),null!=instance.value&&""!==instance.value&&instance.value!==_this.previousQuery()&&_this.queryValue(instance.value.toLowerCase()),_this.previousQuery(instance.value),m.redraw.strategy("none")},this.getAttribute=function(input){filterAliases.some(function(attribute){~attribute.filterAliases.split(",").indexOf(input)&&(_this.queryAttribute(attribute.filterKey,attribute.filterValue),_this.currentAttribute({attributeKey:attribute.filterKey,attributeValue:attribute.filterValue}))})},this.closeModal=function(){_this.container.style.display="none",_this.deleteAll(),_this.previousQuery("")},this.add=function(user,type){_this.users.add(user,type)},this.deleteByType=function(type){_this.users.deleteByType(type)},this.deleteAll=function(){_this.users.deleteAll()},this.getAll=function(){return _this.users.getAll()}}}();Search.controller=function(args){return new Controller(args)},Search.view=function(ctrl){function headerView(){return[m("div",{class:"search-brand"},m("span",{class:"glyphicon glyphicon-search pull-left"}),m("img",{src:WEB_CDN+"/images/logo.png",onclick:function(){ctrl.closeModal()}})),m("span",{class:"close",onclick:function(){ctrl.closeModal()}},m.trust("&times;"))]}function inputView(){return[m("input",{id:"inputUsername",class:"form-control input-lg",type:"text",maxlength:ctrl.lengthRestriction(),placeholder:directoryInt.startTyping,oninput:m.withAttr("value",function(){ctrl.includeOffline()||ctrl.query(this)}),onchange:m.withAttr("value",function(){ctrl.includeOffline()&&ctrl.query(this)})})]}function includeOfflineView(){return[m("input",{id:"includeOffline",type:"checkbox",checked:ctrl.includeOffline(),onclick:function(){ctrl.includeOffline(!ctrl.includeOffline()),ctrl.includeOffline()&&""!==ctrl.previousQuery()&&!ctrl.userExists(ctrl.previousQuery())&&ctrl.queryOffline(ctrl.previousQuery())}}),m("label",{for:"includeOffline"},directoryInt.includeOffline),m("div",{class:"hint"},ctrl.includeOffline()?[m("span",{class:"glyphicon glyphicon-bell"}),directoryInt.searchOfflineHint]:"")]}function searchWrapView(){return[m("div",{id:"searchWrap"},inputView(),includeOfflineView())]}function subcategoryHeaderView(title){return[m("div",{class:"list-title",config:function(el,isInit,ctx){isInit||(ctx.retain=!0)}},title)]}function userView(user,type){return[m("div",{class:"user"},m("a",{href:"/"+user.username().toLowerCase()},m("img",{src:WEB_CDN+"/images/blank.gif",key:user.username(),config:function(el,isInit,ctx){isInit||(type===SearchType.offline?ctx.snapshot=new DirectorySnapshot(el,$j(el).parent("a"),[],"",user.profileImageLink(),"default_Unknown",user.thumbnailId(),user.username(),user.gender(),""):ctx.snapshot=new DirectorySnapshot(el,$j(el).parent("a"),user.snapshotThumbnailIds(),user.snapshotImageLink(),user.profileImageLink(),"default_Unknown",user.thumbnailId(),user.username(),user.gender(),""))}})),type===SearchType.tags?statusMessageView(user):usernameView(user))]}function statusMessageView(user){return[m("div",{class:"userInfo"},usernameView(user),m("div",{class:"hashTags"},user.statusMessage().substring(0,ctrl.statusMessageLength())))]}function usernameView(user){return[m("a",{href:"/"+user.username().toLowerCase()},user.username())]}function userListView(users,type){return[users.length||type===SearchType.offline?[users.map(function(user){return userView(user,type)})]:noResultsView()]}function sectionWrapView(title,users,type,offlineUsers){return[m("div",{class:"col-xs-12 col-sm-6 col-md-4"},subcategoryHeaderView(title),userListView(users,type),type===SearchType.online&&ctrl.includeOffline()?offlineView(offlineUsers):"",type===SearchType.tags&&users.length==ctrl.numberOfTags()?seeAllCamsView():"")]}function seeAllCamsView(){return[m("a",{class:"btn btn-default btn-sm",href:"/tags/"+ctrl.previousQuery().toLowerCase()},js_i18n.showTagsSeeAllCams)]}function noResultsView(){if(""!==ctrl.previousQuery())return[m("div",{class:"list-title noResults"},directoryInt.searchNoResults)]}function subcategoryView(title){return[m("div",{class:"subcategory"},title)]}function offlineView(users){return[subcategoryView(directoryInt.searchOfflineUsers),users.length?userListView(users,SearchType.offline):noResultsView()]}return function(){var onlineUsers=[],offlineUsers=[],tags=[],attributes=[];ctrl.getAll().map(function(user){switch(user.type()){case SearchType.online:onlineUsers.push(user);break;case SearchType.offline:offlineUsers.push(user);break;case SearchType.tags:tags.push(user);break;case SearchType.attributes:attributes.push(user)}});var tagsTitle=directoryInt.taggedCams.toUpperCase(),attributesTitle=directoryInt.userAttributesTitle.toUpperCase();if(attributes.length){var key=ctrl.currentAttribute().attributeKey,value=ctrl.currentAttribute().attributeValue;attributesTitle=[attributesTitle," | ",DirectoryFilters.category[key]," - ",DirectoryFilters[key][value]].join("").toUpperCase()}return tags.length&&(tagsTitle=[tagsTitle," - #",ctrl.previousQuery().toUpperCase()].join("")),[m("div",{onkeyup:function(e){27==e.which&&ctrl.closeModal()}},headerView(),searchWrapView(),m("div",{class:"row"},sectionWrapView(directoryInt.searchUsers.toUpperCase(),onlineUsers,SearchType.online,offlineUsers),sectionWrapView(tagsTitle,tags,SearchType.tags,""),sectionWrapView(attributesTitle,attributes,SearchType.attributes,"")))]}()}}(Search||(Search={})),document.getElementById("usernameSearch")&&(Cam4User.isLoggedIn||Cam4User.isLoggedInAsGuest)){filterAliases=JSON.parse(filterAliases);var SearchComponent=m.component(Search,{});m.mount(document.getElementById("usernameSearch"),SearchComponent),$("#usernameFilter").attr("autocomplete","off"),$(document).on("keyup keypress",function(){$("#usernameSearch").is(":visible")&&$("#inputUsername").focus()}),$("#directory").on("click","#usernameFilter, .magnifying-search-glass",function(e){e.stopPropagation(),$("#usernameSearch").show(),$("#inputUsername").focus()})}
var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}(),NewShowType;!function(NewShowType){NewShowType[NewShowType.NORMAL=0]="NORMAL",NewShowType[NewShowType.PRIVATE_SHOW=1]="PRIVATE_SHOW",NewShowType[NewShowType.GROUP_SHOW=2]="GROUP_SHOW",NewShowType[NewShowType.GROUP_SHOW_SELLING_TICKETS=3]="GROUP_SHOW_SELLING_TICKETS"}(NewShowType||(NewShowType={}));var Gender;!function(Gender){Gender[Gender.male=0]="male",Gender[Gender.female=1]="female",Gender[Gender.shemale=2]="shemale",Gender[Gender.unknown=3]="unknown"}(Gender||(Gender={}));var ImageSource;!function(ImageSource){ImageSource[ImageSource.profile=0]="profile",ImageSource[ImageSource.gender=1]="gender",ImageSource[ImageSource.snapshot=2]="snapshot"}(ImageSource||(ImageSource={}));var FilterState;!function(FilterState){FilterState[FilterState.disabled=0]="disabled",FilterState[FilterState.on=1]="on",FilterState[FilterState.off=2]="off"}(FilterState||(FilterState={}));var FilterType;!function(FilterType){FilterType[FilterType.input=0]="input",FilterType[FilterType.dropdown=1]="dropdown"}(FilterType||(FilterType={}));var Filters;if(function(Filters){var Filter=function(){return function(directoryKey,id,name,type,state){void 0===state&&(state=FilterState.off),this.directoryKey=m.prop(directoryKey),this.id=m.prop(id),this.name=m.prop(name),this.type=m.prop(type),this.state=m.prop(state)}}();Filters.Filter=Filter;var InputFilter=function(_super){function InputFilter(directoryKey,id,name,state,placeholder){var _this=_super.call(this,directoryKey,id,name,FilterType.input)||this;return _this.input_id=m.prop(id),_this.placeholder=m.prop(placeholder),_this.val=m.prop(""),_this}return __extends(InputFilter,_super),InputFilter}(Filter);Filters.InputFilter=InputFilter;var DropdownFilter=function(_super){function DropdownFilter(directoryKey,id,name,state){var _this=_super.call(this,directoryKey,id,name,FilterType.dropdown)||this;return _this.val=m.prop(id),_this}return __extends(DropdownFilter,_super),DropdownFilter}(Filter),Group=function(){function Group(id,visible){void 0===visible&&(visible=!0);var _this=this;this.push=function(filter){_this._filters.push(filter)},this.id=id,this._filters=new Array,this.visible=m.prop(visible)}return Object.defineProperty(Group.prototype,"filters",{get:function(){return this._filters},enumerable:!0,configurable:!0}),Group.prototype.getFilterById=function(id){for(var i=0;i<this.filters.length;i++)if(this.filters[i].id()===id)return this.filters[i];return null},Group}(),Model=function(){function Model(){this._groups=[]}return Object.defineProperty(Model.prototype,"groups",{get:function(){return this._groups},enumerable:!0,configurable:!0}),Model.prototype.addGroup=function(group){this._groups.push(group)},Model.prototype.getActiveFilters=function(){var activeFilters=new Array;return this.groups.map(function(group){group.filters.map(function(filter){filter.state()===FilterState.on&&activeFilters.push(filter)})}),activeFilters},Model}(),Controller=function(){return function(_activeFilters){var _this=this;this._activeFilters=_activeFilters,this.filters=new Model,this.activeFilters=new Array,this.activeDropdownFilter=new DropdownFilter("category","",js_i18n.showTagsAllCams,FilterState.on),this.noResults=m.prop(!1),this.getGroupById=function(id){for(var i=0;_this.filters.groups.length;i++)if(_this.filters.groups[i].id===id)return _this.filters.groups[i]},this.getActiveDropdownFilter=function(){return _this.activeDropdownFilter},this.setDropdownFilter=function(dropdownList,activeFilter){dropdownList.filters.map(function(filter){filter.state(FilterState.off),filter.val()==activeFilter.val()&&""!==activeFilter.val()&&filter.state(FilterState.on)}),_this.activeDropdownFilter=activeFilter},this.applyFilters=function(event){var filters=_this.filters.getActiveFilters();new Request.tagsRequest(filters).promise.then(function(response){var tags=response;tags.length>0?(_this.noResults(!1),TagsComponent=m.component(showTags,{tags:tags}),TagsModule=m.module(document.getElementById("tags-listing"),TagsComponent)):(_this.noResults(!0),m.redraw()),TagsModule.loadMoreTags(tags.length===TagsModule.numberOfMoreTags)})},this.toggleFilter=function(filter){filter.state()==FilterState.on?filter.state(FilterState.off):filter.state(FilterState.on)},this.sanitizeFilter=function(filter){filter.val(filter.val().replace("#","").trim())};var dropdownFiltersGroup=new Group(0);dropdownFiltersGroup.push(new DropdownFilter("category","",js_i18n.showTagsAllCams,FilterState.off)),dropdownFiltersGroup.push(new DropdownFilter("category","female",js_i18n.showTagsFemale,FilterState.off)),dropdownFiltersGroup.push(new DropdownFilter("category","male",js_i18n.showTagsMale,FilterState.off)),dropdownFiltersGroup.push(new DropdownFilter("category","couple",js_i18n.showTagsCouple,FilterState.off)),dropdownFiltersGroup.push(new DropdownFilter("category","shemale",js_i18n.showTagsTrans,FilterState.off)),this.filters.addGroup(dropdownFiltersGroup);var inputFiltersGroup=new Group(1);inputFiltersGroup.push(new InputFilter("name","tags-search","name",FilterState.off,js_i18n.showTagsSearchTags)),this.filters.addGroup(inputFiltersGroup)}}();Filters.controller=function(activeFilters){return new Controller(activeFilters)},Filters.view=function(ctrl){function dropdownFilterView(){return[m("ul",{class:"dropdown-menu inner",role:"menu"},dropdownList.filters.map(function(filter){return dropdownElementView(filter)}))]}function dropdownElementView(filter){return[m("li",{onclick:function(event){ctrl.setDropdownFilter(dropdownList,filter),ctrl.applyFilters(event)}},m("a",{class:"nopop"},m("span",{class:"text"},filter.name())))]}var dropdownList=ctrl.getGroupById(0),inputFilter=ctrl.getGroupById(1).getFilterById("tags-search");return[function(){var activeDropdownFilterName=ctrl.getActiveDropdownFilter().name()||js_i18n.showTagsAllCams;return[m("div",{type:"button",class:"btn dropdown-toggle btn-default","data-toggle":"dropdown",id:"tags-select"},m("span",{class:"filter-option pull-left"},activeDropdownFilterName,m("span",{class:"caret"}))),dropdownFilterView()]}(),function(filter){return m("input",{class:"form-control",type:"text",maxlength:32,value:filter.val(),placeholder:filter.placeholder(),id:filter.input_id(),onchange:m.withAttr("value",function(value){filter.val(value),""!==value?(filter.state(FilterState.on),dataLayer.push({event:"SearchTag",eventCategory:"Tags",eventAction:"Choose Tag From Search Field",eventLabel:value.toLowerCase()})):filter.state(FilterState.off),ctrl.applyFilters()})})}(inputFilter),[m("button",{class:"btn btn-default",id:"submitButton",onclick:function(event){ctrl.applyFilters(event)}},m("span",{class:"glyphicon glyphicon-search"}))]]}}(Filters||(Filters={})),document.getElementById("tags-filters"))var FiltersComponent=m.component(Filters,{}),FiltersModule=m.module(document.getElementById("tags-filters"),FiltersComponent);var Request;!function(Request){var tagsRequest=function(){return function(filters,index,count){void 0===index&&(index=0),void 0===count&&(count=15),this.filters=filters;var params={},defaultParams={json:!0,index:index,count:count};for(var param in defaultParams)params[param]=defaultParams[param];this.filters.length>0&&this.filters.map(function(filter){params.hasOwnProperty(filter.directoryKey())||(filter instanceof Filters.InputFilter&&FiltersModule.sanitizeFilter(filter),Object.defineProperty(params,filter.directoryKey(),{value:filter.val(),enumerable:!0,writable:!0}))}),this.promise=m.request({method:"GET",url:"/tags",data:params})}}();Request.tagsRequest=tagsRequest}(Request||(Request={}));var Snapshots;!function(Snapshots){var Snapshot=function(){function Snapshot(snapshots,snapshotImageLink,profileImageLink,defaultImageLink,thumbnailId,username){this.snapshots=snapshots;var snapshotLink=snapshotImageLink;ControlledFeatures.USE_SNAPSHOTS_API&&!SFW&&(snapshotLink=THUMBNAILS_CDN+"/"+username+"?s="+encodeURIComponent(thumbnailId),ControlledFeatures.FACIAL_DETECTION_SNAPSHOTS&&(snapshotLink+="&fd=true")),this.snapshotImageLink=snapshotLink,this.profileImageLink=profileImageLink,this.defaultImageLink=defaultImageLink,this.thumbnailId=thumbnailId,this.username=username}return Snapshot.prototype.getSnapshotBaseUrl=function(url){return url.substring(0,url.lastIndexOf("/")+1)},Snapshot.prototype.getSnapshotExtension=function(url){return url.substring(url.lastIndexOf("."),url.length)},Snapshot.prototype.getProfileImage=function(){return this.snapshots.length>0?(this.imageSource=ImageSource.snapshot,this.snapshots[0]):this.profileImageLink?(this.imageSource=ImageSource.profile,this.profileImageLink):(this.imageSource=ImageSource.gender,this.defaultImageLink)},Snapshot.prototype.getProfileImageUrl=function(){this.getProfileImage();var url=this.defaultImageLink;return this.imageSource==ImageSource.snapshot&&(url=this.snapshotImageLink),this.imageSource==ImageSource.profile&&(url=this.profileImageLink),url},Snapshot.prototype.getLastImageSource=function(){return this.imageSource},Snapshot.prototype.removeProfileImage=function(){this.profileImageLink=""},Snapshot.prototype.removeFirstSnapshot=function(){this.snapshots.length>0&&this.snapshots.shift()},Snapshot}();Snapshots.Snapshot=Snapshot}(Snapshots||(Snapshots={}));var showTags;if(function(showTags){var Tag=function(){return function(tag){var _this=this;for(var key in tag)tag.hasOwnProperty(key)&&(this[key]=m.prop(tag[key]));this.cams=new Array,this.users().map(function(user){_this.cams.push(new Cam(user))})}}(),Cam=function(){return function(cam){for(var key in cam)cam.hasOwnProperty(key)&&(this[key]=m.prop(cam[key]));this.hasOwnProperty("countryCode")||(this.countryCode=m.prop("us")),this.showType(NewShowType[this.showType()]);var snapshots=~[NewShowType.GROUP_SHOW,NewShowType.PRIVATE_SHOW].indexOf(this.showType())||this.privateRoom()?[]:this.snapshotThumbnailIds();this.snapshots=new Snapshots.Snapshot(snapshots,this.snapshotImageLink(),this.profileImageLink(),this.defaultImageLink(),this.thumbnailId(),this.username())}}(),Model=function(){function Model(){var _this=this;this.list=new Array,this.add=function(tag){_this.list.push(new Tag(tag))},this.length=function(){return _this.list.length}}return Model.prototype.fetch=function(){var _this=this,tagsRequest=m.request({background:!0,method:"GET",url:"/tags",data:{json:!0}});return tagsRequest.then(function(response){response.map(function(tag,index){_this.add(tag)})}),tagsRequest},Model.prototype.getAll=function(){return this.list},Model}(),Controller=function(){return function(args){var _this=this;this.args=args,this.tags=new Model,this.numberOfMoreTags=15,this.index=m.prop(0),this.count=m.prop(15),this.loadMoreTags=m.prop(!0),this.add=function(tag){_this.tags.add(tag)},this.loadMore=function(event){var count=_this.count(),index=_this.index()+count;_this.index(index);var filters=FiltersModule.filters.getActiveFilters();new Request.tagsRequest(filters,index,count).promise.then(function(response){var tags=response;_this.loadMoreTags(tags.length===_this.numberOfMoreTags),tags.length>0&&tags.map(function(tag,index){_this.tags.add(tag)})})},this.showSeeAllCams=function(tag){return tag.totalCount()>tag.cams.length},this.seeAllCams=function(tag){var selectedGender=FiltersModule.getActiveDropdownFilter().id();return["/tags/",""!==selectedGender?selectedGender+"/":"",tag.name()].join("")},this.onunload=function(){console.log("unloading tags component")},this.getAll=function(){return _this.tags.getAll()},this.onSnapshotError=function(event,cam){return cam.snapshots.removeFirstSnapshot(),cam.snapshots.getLastImageSource()==ImageSource.profile&&cam.snapshots.removeProfileImage(),cam.snapshots.getProfileImageUrl()},this.inViewport=function(el){var rect=el.getBoundingClientRect(),offset=window.innerHeight||600;return rect.top>=-offset&&rect.left>=0&&rect.bottom<=(window.innerHeight||document.documentElement.clientHeight)+offset&&rect.right<=(window.innerWidth||document.documentElement.clientWidth)},args.tags?args.tags.map(function(tag,index){_this.add(tag)}):this.tags.fetch()}}();showTags.controller=function(args){return new Controller(args)},showTags.view=function(ctrl,args){function tagView(tag){return[m("div",{class:"tags-wrap"},categoryView(tag),m("div",{class:"cam-wrap"},camView(tag)))]}function categoryView(tag){return[m("div",{class:"seg-title"},m("a",{href:ctrl.seeAllCams(tag),class:"blended nopop"},"#"+tag.name()),m("div",{class:"extra"},tagInfoView(tag)),m("span",{class:"pull-right"},ctrl.showSeeAllCams(tag)?m("a",{href:ctrl.seeAllCams(tag),class:"btn btn-xs btn-default nopop"},js_i18n.showTagsSeeAllCams):""))]}function tagInfoView(tag){return[m("span",{class:"element"},m("span",{class:"glyphicon glyphicon-eye-open"}),tag.viewers()),m("span",{class:"element"},m("span",{class:"glyphicon glyphicon-facetime-video"}),tag.totalCount()+" "+js_i18n.showTagsCams)]}function camView(tag){return tag.cams.map(function(cam){return m("div",{class:"cam"},m("div",{class:"cam-prev"},m("a",{href:"/"+cam.username(),class:"imageContainer nopop"},m("img",{class:"thumb",src:WEB_CDN+"/images/loading-bg.png","data-src":cam.snapshots.getProfileImageUrl(),onerror:function(event){var el=event.target,imageUrl=ctrl.onSnapshotError(event,cam);el.setAttribute("data-src",imageUrl),el.src=imageUrl},config:function(el){ctrl.inViewport(el)&&el.getAttribute("data-src")&&(el.setAttribute("src",el.getAttribute("data-src")),el.removeAttribute("data-src"))}})),m("a",{href:"/"+cam.username(),class:"fade nopop"}),camInfoView(cam),statusMessageView(cam)))})}function statusMessageView(cam){var statusMessage=cam.statusMessage();if(""!==statusMessage)return[m("a",{href:"/"+cam.username(),class:"statusMessage nopop"},statusMessage)]}function camInfoView(cam){var flagClasses=["flag","flag-"+cam.countryCode()].join(" "),genderClasses=["gender",cam.gender()].join(" ");return[m("div",{class:"info-wrap"},m("div",{},m("div",{class:"name"},cam.username())),m("div",{},m("img",{class:flagClasses,src:BLANK_IMG}),m("img",{class:genderClasses,src:BLANK_IMG}),m("div",{class:"views"},cam.viewers())))]}var BLANK_IMG=WEB_CDN+"/images/blank.gif";return[FiltersModule.noResults()?[m("div",{class:"segment"},m("div",{id:"no-results",class:"alert feedback"},js_i18n.showTagsNoResults))]:"",ctrl.getAll().map(function(tag){return tagView(tag)}),ctrl.loadMoreTags()?[m("div",{class:"center-fix"},m("div",{id:"loadMore",class:"text-center"},m("div",{class:"btn btn-orange btn-wide sm-block",onclick:function(event){ctrl.loadMore(event)}},js_i18n.showTagsSeeMoreTags)))]:""]}}(showTags||(showTags={})),document.getElementById("tags-listing")){var scrollHandler=Utils.throttle(function(e){m.redraw()},400,{});window.addEventListener("scroll",scrollHandler),TagsComponent=m.component(showTags,{}),FiltersModule.applyFilters()}
function loadSnapshots(){$j(".profile-thumb").each(function(){var _this=$j(this),useShapshotsAPI=ControlledFeatures.USE_SNAPSHOTS_API&&!SFW,link=$j(this).parent("a"),snapshots=useShapshotsAPI?"":String(_this.data("thumbs")),profile=useShapshotsAPI?THUMBNAILS_CDN+"/"+_this.data("username")+"?s="+encodeURIComponent(_this.data("thumbnail-sig")):_this.data("profile"),initial=_this.data("src"),gender=_this.data("gender");useShapshotsAPI&&ControlledFeatures.FACIAL_DETECTION_SNAPSHOTS&&(profile+="&fd=true"),snapshots=""!=snapshots?snapshots.split(","):[];new DirectorySnapshot(this,link,snapshots,initial,profile,"default_Unknown",_this.data("thumbnail-sig"),_this.data("username"),gender,function(image){image.addEventListener("load",function(){image.naturalWidth>image.naturalHeight?$j(image).parent().parent().addClass("wide-thumbnails"):$j(image).parent().parent().addClass("portrait-thumbnails")}),SearchDirectory.cycleImage($j(image))})})}var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}(),ImageSource;!function(ImageSource){ImageSource[ImageSource.profile=0]="profile",ImageSource[ImageSource.gender=1]="gender",ImageSource[ImageSource.snapshot=2]="snapshot"}(ImageSource||(ImageSource={}));var Snapshots;!function(Snapshots){var Snapshot=function(){function Snapshot(snapshots,snapshotImageLink,profileImageLink,defaultImageLink,thumbnailId,username){this.snapshots=snapshots;var snapshotLink=snapshotImageLink;ControlledFeatures.USE_SNAPSHOTS_API&&!SFW&&(snapshotLink=THUMBNAILS_CDN+"/"+username+"?s="+encodeURIComponent(thumbnailId),ControlledFeatures.FACIAL_DETECTION_SNAPSHOTS&&(snapshotLink+="&fd=true")),this.snapshotImageLink=snapshotLink,this.profileImageLink=profileImageLink,this.defaultImageLink=defaultImageLink,this.thumbnailId=thumbnailId,this.username=username}return Snapshot.prototype.getSnapshotBaseUrl=function(url){return url.substring(0,url.lastIndexOf("/")+1)},Snapshot.prototype.getSnapshotExtension=function(url){return url.substring(url.lastIndexOf("."),url.length)},Snapshot.prototype.getProfileImage=function(){return this.snapshots.length>0?(this.imageSource=ImageSource.snapshot,this.snapshots[0]):this.profileImageLink?(this.imageSource=ImageSource.profile,this.profileImageLink):(this.imageSource=ImageSource.gender,this.defaultImageLink)},Snapshot.prototype.getProfileImageUrl=function(){this.getProfileImage();var url=this.defaultImageLink;return this.imageSource==ImageSource.snapshot&&(url=this.snapshotImageLink),this.imageSource==ImageSource.profile&&(url=this.profileImageLink),url},Snapshot.prototype.getLastImageSource=function(){return this.imageSource},Snapshot.prototype.removeProfileImage=function(){this.profileImageLink=""},Snapshot.prototype.removeFirstSnapshot=function(){this.snapshots.length>0&&this.snapshots.shift()},Snapshot}();Snapshots.Snapshot=Snapshot}(Snapshots||(Snapshots={}));var Gender;!function(Gender){Gender[Gender.male=0]="male",Gender[Gender.female=1]="female",Gender[Gender.shemale=2]="shemale",Gender[Gender.unknown=3]="unknown"}(Gender||(Gender={}));var ImageServer=function(){function ImageServer(){}return Object.defineProperty(ImageServer,"IMAGE_EXTENSION",{get:function(){return".jpg"},enumerable:!0,configurable:!0}),Object.defineProperty(ImageServer,"SNAPSHOT_IMAGE_SERVERS",{get:function(){return imageServers.map(function(imageServer){return imageServer+"/avatar/400x300/"})},enumerable:!0,configurable:!0}),Object.defineProperty(ImageServer,"GENDER_URL",{get:function(){return WEB_CDN+"/images/defaults/"},enumerable:!0,configurable:!0}),ImageServer.GET_CHAT_AVATAR=function(username){return"/avatar/user/60x60/"+username+this.IMAGE_EXTENSION},ImageServer}(),DirectorySnapshot=function(_super){function DirectorySnapshot(image,link,snapshots,snapshotsLink,profileLink,defaultLink,thumbnailId,username,gender,onLoad){var _this=_super.call(this,snapshots,snapshotsLink,profileLink,defaultLink,thumbnailId,username)||this;return _this.show=function(){_this.inViewport()&&($j(window).unbind("scroll",_this.scrollHandler),_this.validate())},_this.getProfileId=function(){return _this.profileImageLink.replace(_this.getSnapshotBaseUrl(_this.profileImageLink),"")},_this.getShard=function(snapshotId){return ImageServer.SNAPSHOT_IMAGE_SERVERS[snapshotId%ImageServer.SNAPSHOT_IMAGE_SERVERS.length]},_this.removeProfileImg=function(){_this.profileImageLink=null},_this.removeFirstSnapshotFromDom=function(){_this.removeFirstSnapshot(),typeof _this.snapshots==typeof[]&&$j(_this.image).data("thumbs",_this.snapshots.join(","))},_this.replace=function(){_this.removeFirstSnapshotFromDom(),_this.getLastImageSource()==ImageSource.profile&&_this.removeProfileImg(),_this.validate(_this.getUrl())},_this.validate=function(src){src||(src=_this.getUrl());var temporary=new Image,startTime=(new Date).getTime();temporary.onerror=function(){SnapshotsLogger.logSnapshotFail((new Date).getTime()-startTime),console.log("replacing ",src),_this.replace()},temporary.onload=function(event){SnapshotsLogger.logSnapshotSuccess((new Date).getTime()-startTime),_this.isValid(temporary)?(_this.onLoad(_this.image),_this.link.removeClass("loading"),_this.image.src=src):(console.log("replacing ",src),_this.replace())},temporary.src=src},_this.isValid=function(img){return img.complete&&!(void 0!==img.naturalWidth&&0===img.naturalWidth)},_this.getUrl=function(){var imageId=_this.getProfileImage();return _this.imageSource==ImageSource.snapshot?ControlledFeatures.USE_SNAPSHOTS_API&&!SFW?_this.snapshotImageLink:[_this.getShard(imageId),imageId,ImageServer.IMAGE_EXTENSION].join(""):_this.imageSource==ImageSource.profile?imageId:[ImageServer.GENDER_URL,imageId,ImageServer.IMAGE_EXTENSION].join("")},_this.inViewport=function(){var rect=_this.image.getBoundingClientRect(),offset=window.innerHeight||600;return rect.top>=-offset&&rect.left>=0&&rect.bottom<=(window.innerHeight||document.documentElement.clientHeight)+offset&&rect.right<=(window.innerWidth||document.documentElement.clientWidth)},_this.throttle=function(func,wait,options){var context,args,result,timeout=null,previous=0;options||(options={});var later=function(){previous=!1===options.leading?0:Date.now(),timeout=null,result=func.apply(context,args),context=args=null};return function(){var now=Date.now();previous||!1!==options.leading||(previous=now);var remaining=wait-(now-previous);return context=this,args=arguments,remaining<=0?(clearTimeout(timeout),timeout=null,previous=now,result=func.apply(context,args),context=args=null):timeout||!1===options.trailing||(timeout=setTimeout(later,remaining)),result}},link instanceof $j?_this.link=link:_this.link=$j(image).parent("a"),_this.image=image,_this.gender=gender,_this.defaultImageLink=_this.getGenderProfileImage(),_this.onLoad=onLoad||$j.noop,_this.scrollHandler=_this.throttle(function(){_this.show()},300,{}),_this.inViewport()?_this.show():$j(window).on("scroll",_this.scrollHandler),_this}return __extends(DirectorySnapshot,_super),DirectorySnapshot.prototype.getUserAgent=function(UserAgent){return UserAgent.phone?"phone":UserAgent.tablet?"tablet":"desktop"},DirectorySnapshot.prototype.getGenderProfileImage=function(){var genderImages={f:"default_Female",female:"default_Female",t:"default_Shemale",shemale:"default_Shemale",transgender:"default_Shemale",m:"default_Male",male:"default_Male",u:"default_Unknown",unknown:"default_Unknown",c:"default_Unknown"},genderImagesSizes={phone:"400x300",tablet:"400x300",desktop:"400x300"};return void 0===this.gender&&(this.gender="u"),genderImages[this.gender]+"."+genderImagesSizes[this.getUserAgent(UserAgent)]},DirectorySnapshot}(Snapshots.Snapshot),SexualPreference;!function(SexualPreference){SexualPreference[SexualPreference.straight=0]="straight",SexualPreference[SexualPreference.gay=1]="gay",SexualPreference[SexualPreference.bisexual=2]="bisexual",SexualPreference[SexualPreference.bicurious=3]="bicurious",SexualPreference[SexualPreference.unknown=4]="unknown"}(SexualPreference||(SexualPreference={}));var ShowType;!function(ShowType){ShowType[ShowType.free=0]="free",ShowType[ShowType.privateShow=1]="privateShow",ShowType[ShowType.groupShow=2]="groupShow"}(ShowType||(ShowType={}));var BroadcastType;!function(BroadcastType){BroadcastType[BroadcastType.solo=0]="solo",BroadcastType[BroadcastType.couple=1]="couple",BroadcastType[BroadcastType.male_female_group=2]="male_female_group",BroadcastType[BroadcastType.male_group=3]="male_group",BroadcastType[BroadcastType.female_group=4]="female_group",BroadcastType[BroadcastType.party=5]="party"}(BroadcastType||(BroadcastType={}));var CamType;!function(CamType){CamType[CamType.standard=0]="standard",CamType[CamType.valentinesDay=1]="valentinesDay",CamType[CamType.standardAd=2]="standardAd",CamType[CamType.summerSale=3]="summerSale",CamType[CamType.olympicGold=4]="olympicGold",CamType[CamType.goldBonusTokens=5]="goldBonusTokens"}(CamType||(CamType={}));var CampaignsForAll;!function(CampaignsForAll){CampaignsForAll[CampaignsForAll.SUMMER_TOKENS=0]="SUMMER_TOKENS",CampaignsForAll[CampaignsForAll.BONUS_TOKENS=1]="BONUS_TOKENS"}(CampaignsForAll||(CampaignsForAll={}));var NewShowType;!function(NewShowType){NewShowType[NewShowType.NORMAL=0]="NORMAL",NewShowType[NewShowType.PRIVATE_SHOW=1]="PRIVATE_SHOW",NewShowType[NewShowType.GROUP_SHOW=2]="GROUP_SHOW",NewShowType[NewShowType.GROUP_SHOW_SELLING_TICKETS=3]="GROUP_SHOW_SELLING_TICKETS"}(NewShowType||(NewShowType={}));var CamsListing;!function(CamsListing){var Cam=function(){return function(cam){for(var key in cam)cam.hasOwnProperty(key)&&(this[key]=m.prop(cam[key]));this.hasOwnProperty("type")||(this.type=m.prop(CamType.standard)),this.hasOwnProperty("profileThumbnailId")||(this.profileThumbnailId=m.prop(0)),this.hasOwnProperty("broadcastType")?this.broadcastType=m.prop(BroadcastType[this.broadcastType()]):this.broadcastType=m.prop(BroadcastType.solo),this.hasOwnProperty("sexPreference")||(this.sexPreference=m.prop(SexualPreference.unknown)),this.hasOwnProperty("newPerformer")||(this.newPerformer=m.prop(!1)),this.hasOwnProperty("kiiroo")||(this.kiiroo=m.prop(!1)),this.hasOwnProperty("resolution")||(this.resolution=m.prop("")),this.hasOwnProperty("mbaVersion")||(this.mbaVersion=m.prop("")),this.hasOwnProperty("hlsPreviewUrl")||(this.hlsPreviewUrl=m.prop("")),this.hasOwnProperty("rec")||(this.rec=m.prop(!1)),this.showType(NewShowType[this.showType()])}}();CamsListing.Cam=Cam;var Model=function(){function Model(){var _this=this;this.list=new Array,this.add=function(_cam){_this.list.push(new Cam(_cam))},this.length=function(){return _this.list.length},this.splice=function(a,b){return _this.list.splice(a,b)}}return Model.prototype.getAll=function(){return this.list},Model}(),Controller=function(){return function(args){var _this=this;this.args=args,this.cams=new Model,this.onunload=function(){console.log("unloading cams component")},this.getAll=function(){return _this.cams.getAll()},this.add=function(cam){_this.cams.add(cam)},this.genderOneLetter=function(gender,broadcastType){var genders={female:"f",male:"m",shemale:"t",unknown:"u"};return broadcastType!=BroadcastType.solo?"c":genders.hasOwnProperty(gender)?genders[gender]:"u"},this.broadcastTime=function(broadcastDuration){return new Date((new Date).getTime()-broadcastDuration).getMinutes()},args.cams.map(function(cam){_this.add(cam)})}}();CamsListing.controller=function(args){return new Controller(args)},CamsListing.view=function(ctrl,args){function generateHashtags(status){return status.replace(/[#]+[A-Za-z0-9-_]+/g,function(tag){return['<a class="show-tags" href="/tags/',tag.replace("#",""),'">',tag,"</a>"].join("")})}function countryFlagView(country){return m("span",{class:"country"},[m("img",{src:BLANK_IMG,class:"flag flag-"+country,alt:country,title:country})])}function sexualOrientationView(gender,orientation,broadcastType){var genderShort=ctrl.genderOneLetter(gender,broadcastType);return m("div",{class:"sexnorientation"},[m("img",{src:BLANK_IMG,class:"align-top gender gender-"+genderShort,alt:gender,title:gender}),m("span",{class:"orientation"},orientation)])}function broadcastStatsView(cam){return m("div",{class:"broadcastTime"},[m("span",{class:"timeContainer"},[m("img",{src:BLANK_IMG,class:"align-top stats time",alt:"Broadcast time",title:"Broadcast time"}),m("span",{},[]," "+ctrl.broadcastTime(cam.broadcastTime())+"m ")]),m("span",{class:"viewers"},cam.viewers())])}function profileStatus(cam){var status=cam.statusMessage();return status.length?m("div",{class:"statusMsg2"},[m.trust(generateHashtags(status))]):[]}function profileDetailsView(cam){return m("div",{class:"profileDetailBox clearfix"},[m("div",{class:"profileBoxTitle"},[m("a",{href:"/"+cam.username().toLowerCase()},cam.username())]),m("div",{class:"profileDetailArea"},[countryFlagView(cam.countryCode()),sexualOrientationView(cam.gender(),cam.sexPreference(),cam.broadcastType()),broadcastStatsView(cam)])])}function showTypeView(showType){return~[NewShowType.GROUP_SHOW_SELLING_TICKETS,NewShowType.GROUP_SHOW].indexOf(showType)?m("span",{class:"inPrivateKey groupShow"}):[]}function privateShowView(cam){return cam.goldPartyWinner()?m("div",{class:"sticker-icon show_sticker"},[m("div",{class:"gold_party_winner"},directoryInt.goldExclusive)]):cam.showType()===NewShowType.PRIVATE_SHOW?m("div",{class:"banner private-show"},directoryInt.inPrivateShow):[]}function camTypeView(cam){return cam.vrStream()?m("div",{class:"vrStreamIcon"}):cam.hdStream()?m("div",{class:"cameraStat cameraStatHD"}):[]}function awardView(dailyAward,monthlyAward){return dailyAward||monthlyAward?m("div",{class:"sticker-icon award_sticker"},m("div",{class:"award_gold",title:"award winner"})):[]}function newTagView(newPerformer){if(newPerformer)return m("span",{class:"new-tag"},[m("span",{class:"glyphicon glyphicon-asterisk"}),"New!"])}function sourceView(source){return"mobile"===source?m("div",{class:"sticker-icon mobile-broadcast"},m("div",{class:"mobile-icon",title:"Mobile broadcast"})):[]}function kiirooView(kiiroo){return kiiroo?m("div",{class:"kiirooIcon"}):[]}function adCam(cam){return[m("div",{class:["profileBox","promo-ad",cam.ad().classes,Cam4User.lang].join(" "),onclick:function(){var callback,onClick=cam.ad().onClick;switch(onClick){case"popTokens":callback=TipFactory[onClick];break;default:callback=Registration[onClick]}"function"==typeof callback&&callback(),ctrl.pushGTMEvent()}},[m("div",{class:"profileDataBox"},[m("a",[m("img",{src:BLANK_IMG,width:120,height:90})]),m("div",{class:"profileDetailBox"})])])]}function camType(cam){switch(cam.type()){case CamType.valentinesDay:case CamType.standardAd:case CamType.summerSale:case CamType.olympicGold:case CamType.goldBonusTokens:return adCam(cam);case CamType.standard:default:return standardCam(cam)}}function getAspectRatioClass(cam){var resolution=cam.resolution().split(":"),width=resolution[0],height=resolution[1];return cam.vrStream()&&(height>width?height/=2:width/=2),width/height>=1?"wide-thumbnails":"portrait-thumbnails"}function standardCam(cam){return[m("div",{class:"profileBox"},[m("div",{class:"profileDataBox "+(cam.rec()?"recEng ":"")+getAspectRatioClass(cam),opacity:0,config:function(element,isInitialized,ctx){isInitialized||"undefined"!=typeof DirectoryPreviewHLS&&DirectoryPreviewHLS.load(element)}},[newTagView(cam.newPerformer()),m("a",{href:"/"+cam.username(),class:"profile-preview","data-profile-preview":"true",style:"display:none","data-hls-preview-url":cam.hlsPreviewUrl()},[m("video",{id:"inlinepreview_segment_"+(new Date).getTime()+"_"+cam.username(),muted:"",loop:"","data-setup":"{}",class:"video-js profile-preview "+(cam.vrStream()?"vrPreview ":"")+("mobile"===cam.source()?"mobilePreview ":""),autoplay:""})]),m("a",{href:"/"+cam.username(),class:"loading clearfix"},[m("img",{src:BLANK_IMG,class:"profile-thumb",width:"120",height:"90","data-thumbs":cam.snapshotThumbnailIds(),key:cam.userId(),config:function(element,isInitialized,ctx){if(!isInitialized){var snapshots=~[NewShowType.GROUP_SHOW,NewShowType.PRIVATE_SHOW].indexOf(cam.showType())||cam.privateRoom()?[]:cam.snapshotThumbnailIds();SFW?ctx.snapshot=new DirectorySnapshot(element,null,[],cam.snapshotImageLink(),cam.profileImageLinkSFW(),cam.defaultImageLink(),cam.thumbnailId(),cam.username(),cam.gender(),function(){"undefined"!=typeof SearchDirectory&&SearchDirectory.cycleImage($j(element))}):ctx.snapshot=new DirectorySnapshot(element,null,snapshots,cam.snapshotImageLink(),cam.profileImageLink(),cam.defaultImageLink(),cam.thumbnailId(),cam.username(),cam.gender(),function(){"undefined"!=typeof SearchDirectory&&SearchDirectory.cycleImage($j(element))})}}}),UserAgent.desktop?m("div",{class:"fade"}):""]),privateShowView(cam),profileStatus(cam),m("div",{class:"icon-wrp"},kiirooView(cam.kiiroo()),awardView(cam.dailyAward(),cam.monthlyAward()),showTypeView(cam.showType()),sourceView(cam.source()),camTypeView(cam)),profileDetailsView(cam)])])]}var BLANK_IMG=WEB_CDN+"/images/blank.gif";return ctrl.getAll().length<args.minimumCamsToDisplay?[]:["headerView"in args?args.headerView(ctrl):[],m("div",{class:"cams-wrapper clearfix",config:function(element,isInitialized){isInitialized||Cam4Event.dispatch("segmentLoaded",args.key)}},[ctrl.getAll().slice(0,args.numberOfCams).map(function(cam){return camType(cam)})])]}}(CamsListing||(CamsListing={}));
function loadSnapshots(){$j(".profile-thumb").each(function(){var _this=$j(this),useShapshotsAPI=ControlledFeatures.USE_SNAPSHOTS_API&&!SFW,link=$j(this).parent("a"),snapshots=useShapshotsAPI?"":String(_this.data("thumbs")),profile=useShapshotsAPI?THUMBNAILS_CDN+"/"+_this.data("username")+"?s="+encodeURIComponent(_this.data("thumbnail-sig")):_this.data("profile"),initial=_this.data("src"),gender=_this.data("gender");useShapshotsAPI&&ControlledFeatures.FACIAL_DETECTION_SNAPSHOTS&&(profile+="&fd=true"),snapshots=""!=snapshots?snapshots.split(","):[];new DirectorySnapshot(this,link,snapshots,initial,profile,"default_Unknown",_this.data("thumbnail-sig"),_this.data("username"),gender,function(image){image.addEventListener("load",function(){image.naturalWidth>image.naturalHeight?$j(image).parent().parent().addClass("wide-thumbnails"):$j(image).parent().parent().addClass("portrait-thumbnails")}),SearchDirectory.cycleImage($j(image))})})}var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}(),ImageSource;!function(ImageSource){ImageSource[ImageSource.profile=0]="profile",ImageSource[ImageSource.gender=1]="gender",ImageSource[ImageSource.snapshot=2]="snapshot"}(ImageSource||(ImageSource={}));var Snapshots;!function(Snapshots){var Snapshot=function(){function Snapshot(snapshots,snapshotImageLink,profileImageLink,defaultImageLink,thumbnailId,username){this.snapshots=snapshots;var snapshotLink=snapshotImageLink;ControlledFeatures.USE_SNAPSHOTS_API&&!SFW&&(snapshotLink=THUMBNAILS_CDN+"/"+username+"?s="+encodeURIComponent(thumbnailId),ControlledFeatures.FACIAL_DETECTION_SNAPSHOTS&&(snapshotLink+="&fd=true")),this.snapshotImageLink=snapshotLink,this.profileImageLink=profileImageLink,this.defaultImageLink=defaultImageLink,this.thumbnailId=thumbnailId,this.username=username}return Snapshot.prototype.getSnapshotBaseUrl=function(url){return url.substring(0,url.lastIndexOf("/")+1)},Snapshot.prototype.getSnapshotExtension=function(url){return url.substring(url.lastIndexOf("."),url.length)},Snapshot.prototype.getProfileImage=function(){return this.snapshots.length>0?(this.imageSource=ImageSource.snapshot,this.snapshots[0]):this.profileImageLink?(this.imageSource=ImageSource.profile,this.profileImageLink):(this.imageSource=ImageSource.gender,this.defaultImageLink)},Snapshot.prototype.getProfileImageUrl=function(){this.getProfileImage();var url=this.defaultImageLink;return this.imageSource==ImageSource.snapshot&&(url=this.snapshotImageLink),this.imageSource==ImageSource.profile&&(url=this.profileImageLink),url},Snapshot.prototype.getLastImageSource=function(){return this.imageSource},Snapshot.prototype.removeProfileImage=function(){this.profileImageLink=""},Snapshot.prototype.removeFirstSnapshot=function(){this.snapshots.length>0&&this.snapshots.shift()},Snapshot}();Snapshots.Snapshot=Snapshot}(Snapshots||(Snapshots={}));var Gender;!function(Gender){Gender[Gender.male=0]="male",Gender[Gender.female=1]="female",Gender[Gender.shemale=2]="shemale",Gender[Gender.unknown=3]="unknown"}(Gender||(Gender={}));var ImageServer=function(){function ImageServer(){}return Object.defineProperty(ImageServer,"IMAGE_EXTENSION",{get:function(){return".jpg"},enumerable:!0,configurable:!0}),Object.defineProperty(ImageServer,"SNAPSHOT_IMAGE_SERVERS",{get:function(){return imageServers.map(function(imageServer){return imageServer+"/avatar/400x300/"})},enumerable:!0,configurable:!0}),Object.defineProperty(ImageServer,"GENDER_URL",{get:function(){return WEB_CDN+"/images/defaults/"},enumerable:!0,configurable:!0}),ImageServer.GET_CHAT_AVATAR=function(username){return"/avatar/user/60x60/"+username+this.IMAGE_EXTENSION},ImageServer}(),DirectorySnapshot=function(_super){function DirectorySnapshot(image,link,snapshots,snapshotsLink,profileLink,defaultLink,thumbnailId,username,gender,onLoad){var _this=_super.call(this,snapshots,snapshotsLink,profileLink,defaultLink,thumbnailId,username)||this;return _this.show=function(){_this.inViewport()&&($j(window).unbind("scroll",_this.scrollHandler),_this.validate())},_this.getProfileId=function(){return _this.profileImageLink.replace(_this.getSnapshotBaseUrl(_this.profileImageLink),"")},_this.getShard=function(snapshotId){return ImageServer.SNAPSHOT_IMAGE_SERVERS[snapshotId%ImageServer.SNAPSHOT_IMAGE_SERVERS.length]},_this.removeProfileImg=function(){_this.profileImageLink=null},_this.removeFirstSnapshotFromDom=function(){_this.removeFirstSnapshot(),typeof _this.snapshots==typeof[]&&$j(_this.image).data("thumbs",_this.snapshots.join(","))},_this.replace=function(){_this.removeFirstSnapshotFromDom(),_this.getLastImageSource()==ImageSource.profile&&_this.removeProfileImg(),_this.validate(_this.getUrl())},_this.validate=function(src){src||(src=_this.getUrl());var temporary=new Image,startTime=(new Date).getTime();temporary.onerror=function(){SnapshotsLogger.logSnapshotFail((new Date).getTime()-startTime),console.log("replacing ",src),_this.replace()},temporary.onload=function(event){SnapshotsLogger.logSnapshotSuccess((new Date).getTime()-startTime),_this.isValid(temporary)?(_this.onLoad(_this.image),_this.link.removeClass("loading"),_this.image.src=src):(console.log("replacing ",src),_this.replace())},temporary.src=src},_this.isValid=function(img){return img.complete&&!(void 0!==img.naturalWidth&&0===img.naturalWidth)},_this.getUrl=function(){var imageId=_this.getProfileImage();return _this.imageSource==ImageSource.snapshot?ControlledFeatures.USE_SNAPSHOTS_API&&!SFW?_this.snapshotImageLink:[_this.getShard(imageId),imageId,ImageServer.IMAGE_EXTENSION].join(""):_this.imageSource==ImageSource.profile?imageId:[ImageServer.GENDER_URL,imageId,ImageServer.IMAGE_EXTENSION].join("")},_this.inViewport=function(){var rect=_this.image.getBoundingClientRect(),offset=window.innerHeight||600;return rect.top>=-offset&&rect.left>=0&&rect.bottom<=(window.innerHeight||document.documentElement.clientHeight)+offset&&rect.right<=(window.innerWidth||document.documentElement.clientWidth)},_this.throttle=function(func,wait,options){var context,args,result,timeout=null,previous=0;options||(options={});var later=function(){previous=!1===options.leading?0:Date.now(),timeout=null,result=func.apply(context,args),context=args=null};return function(){var now=Date.now();previous||!1!==options.leading||(previous=now);var remaining=wait-(now-previous);return context=this,args=arguments,remaining<=0?(clearTimeout(timeout),timeout=null,previous=now,result=func.apply(context,args),context=args=null):timeout||!1===options.trailing||(timeout=setTimeout(later,remaining)),result}},link instanceof $j?_this.link=link:_this.link=$j(image).parent("a"),_this.image=image,_this.gender=gender,_this.defaultImageLink=_this.getGenderProfileImage(),_this.onLoad=onLoad||$j.noop,_this.scrollHandler=_this.throttle(function(){_this.show()},300,{}),_this.inViewport()?_this.show():$j(window).on("scroll",_this.scrollHandler),_this}return __extends(DirectorySnapshot,_super),DirectorySnapshot.prototype.getUserAgent=function(UserAgent){return UserAgent.phone?"phone":UserAgent.tablet?"tablet":"desktop"},DirectorySnapshot.prototype.getGenderProfileImage=function(){var genderImages={f:"default_Female",female:"default_Female",t:"default_Shemale",shemale:"default_Shemale",transgender:"default_Shemale",m:"default_Male",male:"default_Male",u:"default_Unknown",unknown:"default_Unknown",c:"default_Unknown"},genderImagesSizes={phone:"400x300",tablet:"400x300",desktop:"400x300"};return void 0===this.gender&&(this.gender="u"),genderImages[this.gender]+"."+genderImagesSizes[this.getUserAgent(UserAgent)]},DirectorySnapshot}(Snapshots.Snapshot),SexualPreference;!function(SexualPreference){SexualPreference[SexualPreference.straight=0]="straight",SexualPreference[SexualPreference.gay=1]="gay",SexualPreference[SexualPreference.bisexual=2]="bisexual",SexualPreference[SexualPreference.bicurious=3]="bicurious",SexualPreference[SexualPreference.unknown=4]="unknown"}(SexualPreference||(SexualPreference={}));var ShowType;!function(ShowType){ShowType[ShowType.free=0]="free",ShowType[ShowType.privateShow=1]="privateShow",ShowType[ShowType.groupShow=2]="groupShow"}(ShowType||(ShowType={}));var BroadcastType;!function(BroadcastType){BroadcastType[BroadcastType.solo=0]="solo",BroadcastType[BroadcastType.couple=1]="couple",BroadcastType[BroadcastType.male_female_group=2]="male_female_group",BroadcastType[BroadcastType.male_group=3]="male_group",BroadcastType[BroadcastType.female_group=4]="female_group",BroadcastType[BroadcastType.party=5]="party"}(BroadcastType||(BroadcastType={}));var CamType;!function(CamType){CamType[CamType.standard=0]="standard",CamType[CamType.valentinesDay=1]="valentinesDay",CamType[CamType.standardAd=2]="standardAd",CamType[CamType.summerSale=3]="summerSale",CamType[CamType.olympicGold=4]="olympicGold",CamType[CamType.goldBonusTokens=5]="goldBonusTokens"}(CamType||(CamType={}));var CampaignsForAll;!function(CampaignsForAll){CampaignsForAll[CampaignsForAll.SUMMER_TOKENS=0]="SUMMER_TOKENS",CampaignsForAll[CampaignsForAll.BONUS_TOKENS=1]="BONUS_TOKENS"}(CampaignsForAll||(CampaignsForAll={}));var NewShowType;!function(NewShowType){NewShowType[NewShowType.NORMAL=0]="NORMAL",NewShowType[NewShowType.PRIVATE_SHOW=1]="PRIVATE_SHOW",NewShowType[NewShowType.GROUP_SHOW=2]="GROUP_SHOW",NewShowType[NewShowType.GROUP_SHOW_SELLING_TICKETS=3]="GROUP_SHOW_SELLING_TICKETS"}(NewShowType||(NewShowType={}));var CamsListing;!function(CamsListing){var Cam=function(){return function(cam){for(var key in cam)cam.hasOwnProperty(key)&&(this[key]=m.prop(cam[key]));this.hasOwnProperty("type")||(this.type=m.prop(CamType.standard)),this.hasOwnProperty("profileThumbnailId")||(this.profileThumbnailId=m.prop(0)),this.hasOwnProperty("broadcastType")?this.broadcastType=m.prop(BroadcastType[this.broadcastType()]):this.broadcastType=m.prop(BroadcastType.solo),this.hasOwnProperty("sexPreference")||(this.sexPreference=m.prop(SexualPreference.unknown)),this.hasOwnProperty("newPerformer")||(this.newPerformer=m.prop(!1)),this.hasOwnProperty("kiiroo")||(this.kiiroo=m.prop(!1)),this.hasOwnProperty("resolution")||(this.resolution=m.prop("")),this.hasOwnProperty("mbaVersion")||(this.mbaVersion=m.prop("")),this.hasOwnProperty("hlsPreviewUrl")||(this.hlsPreviewUrl=m.prop("")),this.hasOwnProperty("rec")||(this.rec=m.prop(!1)),this.showType(NewShowType[this.showType()])}}();CamsListing.Cam=Cam;var Model=function(){function Model(){var _this=this;this.list=new Array,this.add=function(_cam){_this.list.push(new Cam(_cam))},this.length=function(){return _this.list.length},this.splice=function(a,b){return _this.list.splice(a,b)}}return Model.prototype.getAll=function(){return this.list},Model}(),Controller=function(){return function(args){var _this=this;this.args=args,this.cams=new Model,this.onunload=function(){console.log("unloading cams component")},this.getAll=function(){return _this.cams.getAll()},this.add=function(cam){_this.cams.add(cam)},this.genderOneLetter=function(gender,broadcastType){var genders={female:"f",male:"m",shemale:"t",unknown:"u"};return broadcastType!=BroadcastType.solo?"c":genders.hasOwnProperty(gender)?genders[gender]:"u"},this.broadcastTime=function(broadcastDuration){return new Date((new Date).getTime()-broadcastDuration).getMinutes()},args.cams.map(function(cam){_this.add(cam)})}}();CamsListing.controller=function(args){return new Controller(args)},CamsListing.view=function(ctrl,args){function generateHashtags(status){return status.replace(/[#]+[A-Za-z0-9-_]+/g,function(tag){return['<a class="show-tags" href="/tags/',tag.replace("#",""),'">',tag,"</a>"].join("")})}function countryFlagView(country){return m("span",{class:"country"},[m("img",{src:BLANK_IMG,class:"flag flag-"+country,alt:country,title:country})])}function sexualOrientationView(gender,orientation,broadcastType){var genderShort=ctrl.genderOneLetter(gender,broadcastType);return m("div",{class:"sexnorientation"},[m("img",{src:BLANK_IMG,class:"align-top gender gender-"+genderShort,alt:gender,title:gender}),m("span",{class:"orientation"},orientation)])}function broadcastStatsView(cam){return m("div",{class:"broadcastTime"},[m("span",{class:"timeContainer"},[m("img",{src:BLANK_IMG,class:"align-top stats time",alt:"Broadcast time",title:"Broadcast time"}),m("span",{},[]," "+ctrl.broadcastTime(cam.broadcastTime())+"m ")]),m("span",{class:"viewers"},cam.viewers())])}function profileStatus(cam){var status=cam.statusMessage();return status.length?m("div",{class:"statusMsg2"},[m.trust(generateHashtags(status))]):[]}function profileDetailsView(cam){return m("div",{class:"profileDetailBox clearfix"},[m("div",{class:"profileBoxTitle"},[m("a",{href:"/"+cam.username().toLowerCase()},cam.username())]),m("div",{class:"profileDetailArea"},[countryFlagView(cam.countryCode()),sexualOrientationView(cam.gender(),cam.sexPreference(),cam.broadcastType()),broadcastStatsView(cam)])])}function showTypeView(showType){return~[NewShowType.GROUP_SHOW_SELLING_TICKETS,NewShowType.GROUP_SHOW].indexOf(showType)?m("span",{class:"inPrivateKey groupShow"}):[]}function privateShowView(cam){return cam.goldPartyWinner()?m("div",{class:"sticker-icon show_sticker"},[m("div",{class:"gold_party_winner"},directoryInt.goldExclusive)]):cam.showType()===NewShowType.PRIVATE_SHOW?m("div",{class:"banner private-show"},directoryInt.inPrivateShow):[]}function camTypeView(cam){return cam.vrStream()?m("div",{class:"vrStreamIcon"}):cam.hdStream()?m("div",{class:"cameraStat cameraStatHD"}):[]}function awardView(dailyAward,monthlyAward){return dailyAward||monthlyAward?m("div",{class:"sticker-icon award_sticker"},m("div",{class:"award_gold",title:"award winner"})):[]}function newTagView(newPerformer){if(newPerformer)return m("span",{class:"new-tag"},[m("span",{class:"glyphicon glyphicon-asterisk"}),"New!"])}function sourceView(source){return"mobile"===source?m("div",{class:"sticker-icon mobile-broadcast"},m("div",{class:"mobile-icon",title:"Mobile broadcast"})):[]}function kiirooView(kiiroo){return kiiroo?m("div",{class:"kiirooIcon"}):[]}function adCam(cam){return[m("div",{class:["profileBox","promo-ad",cam.ad().classes,Cam4User.lang].join(" "),onclick:function(){var callback,onClick=cam.ad().onClick;switch(onClick){case"popTokens":callback=TipFactory[onClick];break;default:callback=Registration[onClick]}"function"==typeof callback&&callback(),ctrl.pushGTMEvent()}},[m("div",{class:"profileDataBox"},[m("a",[m("img",{src:BLANK_IMG,width:120,height:90})]),m("div",{class:"profileDetailBox"})])])]}function camType(cam){switch(cam.type()){case CamType.valentinesDay:case CamType.standardAd:case CamType.summerSale:case CamType.olympicGold:case CamType.goldBonusTokens:return adCam(cam);case CamType.standard:default:return standardCam(cam)}}function getAspectRatioClass(cam){var resolution=cam.resolution().split(":"),width=resolution[0],height=resolution[1];return cam.vrStream()&&(height>width?height/=2:width/=2),width/height>=1?"wide-thumbnails":"portrait-thumbnails"}function standardCam(cam){return[m("div",{class:"profileBox"},[m("div",{class:"profileDataBox "+(cam.rec()?"recEng ":"")+getAspectRatioClass(cam),opacity:0,config:function(element,isInitialized,ctx){isInitialized||"undefined"!=typeof DirectoryPreviewHLS&&DirectoryPreviewHLS.load(element)}},[newTagView(cam.newPerformer()),m("a",{href:"/"+cam.username(),class:"profile-preview","data-profile-preview":"true",style:"display:none","data-hls-preview-url":cam.hlsPreviewUrl()},[m("video",{id:"inlinepreview_segment_"+(new Date).getTime()+"_"+cam.username(),muted:"",loop:"","data-setup":"{}",class:"video-js profile-preview "+(cam.vrStream()?"vrPreview ":"")+("mobile"===cam.source()?"mobilePreview ":""),autoplay:""})]),m("a",{href:"/"+cam.username(),class:"loading clearfix"},[m("img",{src:BLANK_IMG,class:"profile-thumb",width:"120",height:"90","data-thumbs":cam.snapshotThumbnailIds(),key:cam.userId(),config:function(element,isInitialized,ctx){if(!isInitialized){var snapshots=~[NewShowType.GROUP_SHOW,NewShowType.PRIVATE_SHOW].indexOf(cam.showType())||cam.privateRoom()?[]:cam.snapshotThumbnailIds();SFW?ctx.snapshot=new DirectorySnapshot(element,null,[],cam.snapshotImageLink(),cam.profileImageLinkSFW(),cam.defaultImageLink(),cam.thumbnailId(),cam.username(),cam.gender(),function(){"undefined"!=typeof SearchDirectory&&SearchDirectory.cycleImage($j(element))}):ctx.snapshot=new DirectorySnapshot(element,null,snapshots,cam.snapshotImageLink(),cam.profileImageLink(),cam.defaultImageLink(),cam.thumbnailId(),cam.username(),cam.gender(),function(){"undefined"!=typeof SearchDirectory&&SearchDirectory.cycleImage($j(element))})}}}),UserAgent.desktop?m("div",{class:"fade"}):""]),privateShowView(cam),profileStatus(cam),m("div",{class:"icon-wrp"},kiirooView(cam.kiiroo()),awardView(cam.dailyAward(),cam.monthlyAward()),showTypeView(cam.showType()),sourceView(cam.source()),camTypeView(cam)),profileDetailsView(cam)])])]}var BLANK_IMG=WEB_CDN+"/images/blank.gif";return ctrl.getAll().length<args.minimumCamsToDisplay?[]:["headerView"in args?args.headerView(ctrl):[],m("div",{class:"cams-wrapper clearfix",config:function(element,isInitialized){isInitialized||Cam4Event.dispatch("segmentLoaded",args.key)}},[ctrl.getAll().slice(0,args.numberOfCams).map(function(cam){return camType(cam)})])]}}(CamsListing||(CamsListing={}));var Segment=function(){function Segment(title,selector,filters,condition){var _this=this;this.title=title,this.selector=selector,this.filters=filters,this.condition=condition,this.condition&&Segment.getCams(this.filters).then(function(response){_this.cams=response.users,_this.moreLink=response.url,_this.mountCams()})}return Object.defineProperty(Segment,"REQUEST_URL",{get:function(){return"/directoryCams"},enumerable:!0,configurable:!0}),Segment.prototype.mountCams=function(){var _this=this,container=document.getElementById(this.selector);container&&(this.cams.length?(this.camsComponent=m.component(CamsListing,{cams:this.cams,headerView:function(ctrl){return m("div",{class:"seg-title"},[m("span",_this.title),m("div",{class:"extra"},[m("a",{class:"btn btn-xs btn-orange nopop",href:_this.moreLink},directoryInt.showAll)])])},numberOfCams:20,minimumCamsToDisplay:3,key:this.selector}),this.camsModule=m.module(container,this.camsComponent)):container.parentNode.removeChild(container))},Segment.getCams=function(filters){return m.request({url:Segment.REQUEST_URL+"?directoryJson=true&online=true&url=true&"+filters.join("&")})},Segment}(),updateDirectorySegments=function(activeFilters){activeFilters=activeFilters||SearchDirectory.formatURLJson();var countryFilters=[],languageFilters=[],genderTranslation="",genderNameTranslation={shemale:directoryInt.segmentGenderTransgender,male:directoryInt.segmentGenderMale,female:directoryInt.segmentGenderFemale},newPerformersFilter=[];"gender"in activeFilters&&(genderTranslation=genderNameTranslation[activeFilters.gender],countryFilters.push(["gender",activeFilters.gender].join("=")),languageFilters.push(["gender",activeFilters.gender].join("=")),newPerformersFilter.push(["gender",activeFilters.gender].join("="))),languageFilters.push(["language",Cam4User.lang].join("=")),countryFilters.push(["country",Cam4User.countryCode].join("="));var languageTitle=directoryInt.segmentTrendingLanguage.replace("$1",genderTranslation),countryTranslation=directoryInt.segmentNewPerformers;newPerformersFilter.push(["newPerformer","true"].join("="));new Segment(languageTitle,"trending-gender-language",languageFilters,!0),new Segment(countryTranslation,"new-performers",newPerformersFilter,!0)};
function loadSnapshots(){$j(".profile-thumb").each(function(){var _this=$j(this),useShapshotsAPI=ControlledFeatures.USE_SNAPSHOTS_API&&!SFW,link=$j(this).parent("a"),snapshots=useShapshotsAPI?"":String(_this.data("thumbs")),profile=useShapshotsAPI?THUMBNAILS_CDN+"/"+_this.data("username")+"?s="+encodeURIComponent(_this.data("thumbnail-sig")):_this.data("profile"),initial=_this.data("src"),gender=_this.data("gender");useShapshotsAPI&&ControlledFeatures.FACIAL_DETECTION_SNAPSHOTS&&(profile+="&fd=true"),snapshots=""!=snapshots?snapshots.split(","):[];new DirectorySnapshot(this,link,snapshots,initial,profile,"default_Unknown",_this.data("thumbnail-sig"),_this.data("username"),gender,function(image){image.addEventListener("load",function(){image.naturalWidth>image.naturalHeight?$j(image).parent().parent().addClass("wide-thumbnails"):$j(image).parent().parent().addClass("portrait-thumbnails")}),SearchDirectory.cycleImage($j(image))})})}var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}(),ImageSource;!function(ImageSource){ImageSource[ImageSource.profile=0]="profile",ImageSource[ImageSource.gender=1]="gender",ImageSource[ImageSource.snapshot=2]="snapshot"}(ImageSource||(ImageSource={}));var Snapshots;!function(Snapshots){var Snapshot=function(){function Snapshot(snapshots,snapshotImageLink,profileImageLink,defaultImageLink,thumbnailId,username){this.snapshots=snapshots;var snapshotLink=snapshotImageLink;ControlledFeatures.USE_SNAPSHOTS_API&&!SFW&&(snapshotLink=THUMBNAILS_CDN+"/"+username+"?s="+encodeURIComponent(thumbnailId),ControlledFeatures.FACIAL_DETECTION_SNAPSHOTS&&(snapshotLink+="&fd=true")),this.snapshotImageLink=snapshotLink,this.profileImageLink=profileImageLink,this.defaultImageLink=defaultImageLink,this.thumbnailId=thumbnailId,this.username=username}return Snapshot.prototype.getSnapshotBaseUrl=function(url){return url.substring(0,url.lastIndexOf("/")+1)},Snapshot.prototype.getSnapshotExtension=function(url){return url.substring(url.lastIndexOf("."),url.length)},Snapshot.prototype.getProfileImage=function(){return this.snapshots.length>0?(this.imageSource=ImageSource.snapshot,this.snapshots[0]):this.profileImageLink?(this.imageSource=ImageSource.profile,this.profileImageLink):(this.imageSource=ImageSource.gender,this.defaultImageLink)},Snapshot.prototype.getProfileImageUrl=function(){this.getProfileImage();var url=this.defaultImageLink;return this.imageSource==ImageSource.snapshot&&(url=this.snapshotImageLink),this.imageSource==ImageSource.profile&&(url=this.profileImageLink),url},Snapshot.prototype.getLastImageSource=function(){return this.imageSource},Snapshot.prototype.removeProfileImage=function(){this.profileImageLink=""},Snapshot.prototype.removeFirstSnapshot=function(){this.snapshots.length>0&&this.snapshots.shift()},Snapshot}();Snapshots.Snapshot=Snapshot}(Snapshots||(Snapshots={}));var Gender;!function(Gender){Gender[Gender.male=0]="male",Gender[Gender.female=1]="female",Gender[Gender.shemale=2]="shemale",Gender[Gender.unknown=3]="unknown"}(Gender||(Gender={}));var ImageServer=function(){function ImageServer(){}return Object.defineProperty(ImageServer,"IMAGE_EXTENSION",{get:function(){return".jpg"},enumerable:!0,configurable:!0}),Object.defineProperty(ImageServer,"SNAPSHOT_IMAGE_SERVERS",{get:function(){return imageServers.map(function(imageServer){return imageServer+"/avatar/400x300/"})},enumerable:!0,configurable:!0}),Object.defineProperty(ImageServer,"GENDER_URL",{get:function(){return WEB_CDN+"/images/defaults/"},enumerable:!0,configurable:!0}),ImageServer.GET_CHAT_AVATAR=function(username){return"/avatar/user/60x60/"+username+this.IMAGE_EXTENSION},ImageServer}(),DirectorySnapshot=function(_super){function DirectorySnapshot(image,link,snapshots,snapshotsLink,profileLink,defaultLink,thumbnailId,username,gender,onLoad){var _this=_super.call(this,snapshots,snapshotsLink,profileLink,defaultLink,thumbnailId,username)||this;return _this.show=function(){_this.inViewport()&&($j(window).unbind("scroll",_this.scrollHandler),_this.validate())},_this.getProfileId=function(){return _this.profileImageLink.replace(_this.getSnapshotBaseUrl(_this.profileImageLink),"")},_this.getShard=function(snapshotId){return ImageServer.SNAPSHOT_IMAGE_SERVERS[snapshotId%ImageServer.SNAPSHOT_IMAGE_SERVERS.length]},_this.removeProfileImg=function(){_this.profileImageLink=null},_this.removeFirstSnapshotFromDom=function(){_this.removeFirstSnapshot(),typeof _this.snapshots==typeof[]&&$j(_this.image).data("thumbs",_this.snapshots.join(","))},_this.replace=function(){_this.removeFirstSnapshotFromDom(),_this.getLastImageSource()==ImageSource.profile&&_this.removeProfileImg(),_this.validate(_this.getUrl())},_this.validate=function(src){src||(src=_this.getUrl());var temporary=new Image,startTime=(new Date).getTime();temporary.onerror=function(){SnapshotsLogger.logSnapshotFail((new Date).getTime()-startTime),console.log("replacing ",src),_this.replace()},temporary.onload=function(event){SnapshotsLogger.logSnapshotSuccess((new Date).getTime()-startTime),_this.isValid(temporary)?(_this.onLoad(_this.image),_this.link.removeClass("loading"),_this.image.src=src):(console.log("replacing ",src),_this.replace())},temporary.src=src},_this.isValid=function(img){return img.complete&&!(void 0!==img.naturalWidth&&0===img.naturalWidth)},_this.getUrl=function(){var imageId=_this.getProfileImage();return _this.imageSource==ImageSource.snapshot?ControlledFeatures.USE_SNAPSHOTS_API&&!SFW?_this.snapshotImageLink:[_this.getShard(imageId),imageId,ImageServer.IMAGE_EXTENSION].join(""):_this.imageSource==ImageSource.profile?imageId:[ImageServer.GENDER_URL,imageId,ImageServer.IMAGE_EXTENSION].join("")},_this.inViewport=function(){var rect=_this.image.getBoundingClientRect(),offset=window.innerHeight||600;return rect.top>=-offset&&rect.left>=0&&rect.bottom<=(window.innerHeight||document.documentElement.clientHeight)+offset&&rect.right<=(window.innerWidth||document.documentElement.clientWidth)},_this.throttle=function(func,wait,options){var context,args,result,timeout=null,previous=0;options||(options={});var later=function(){previous=!1===options.leading?0:Date.now(),timeout=null,result=func.apply(context,args),context=args=null};return function(){var now=Date.now();previous||!1!==options.leading||(previous=now);var remaining=wait-(now-previous);return context=this,args=arguments,remaining<=0?(clearTimeout(timeout),timeout=null,previous=now,result=func.apply(context,args),context=args=null):timeout||!1===options.trailing||(timeout=setTimeout(later,remaining)),result}},link instanceof $j?_this.link=link:_this.link=$j(image).parent("a"),_this.image=image,_this.gender=gender,_this.defaultImageLink=_this.getGenderProfileImage(),_this.onLoad=onLoad||$j.noop,_this.scrollHandler=_this.throttle(function(){_this.show()},300,{}),_this.inViewport()?_this.show():$j(window).on("scroll",_this.scrollHandler),_this}return __extends(DirectorySnapshot,_super),DirectorySnapshot.prototype.getUserAgent=function(UserAgent){return UserAgent.phone?"phone":UserAgent.tablet?"tablet":"desktop"},DirectorySnapshot.prototype.getGenderProfileImage=function(){var genderImages={f:"default_Female",female:"default_Female",t:"default_Shemale",shemale:"default_Shemale",transgender:"default_Shemale",m:"default_Male",male:"default_Male",u:"default_Unknown",unknown:"default_Unknown",c:"default_Unknown"},genderImagesSizes={phone:"400x300",tablet:"400x300",desktop:"400x300"};return void 0===this.gender&&(this.gender="u"),genderImages[this.gender]+"."+genderImagesSizes[this.getUserAgent(UserAgent)]},DirectorySnapshot}(Snapshots.Snapshot),SexualPreference;!function(SexualPreference){SexualPreference[SexualPreference.straight=0]="straight",SexualPreference[SexualPreference.gay=1]="gay",SexualPreference[SexualPreference.bisexual=2]="bisexual",SexualPreference[SexualPreference.bicurious=3]="bicurious",SexualPreference[SexualPreference.unknown=4]="unknown"}(SexualPreference||(SexualPreference={}));var ShowType;!function(ShowType){ShowType[ShowType.free=0]="free",ShowType[ShowType.privateShow=1]="privateShow",ShowType[ShowType.groupShow=2]="groupShow"}(ShowType||(ShowType={}));var BroadcastType;!function(BroadcastType){BroadcastType[BroadcastType.solo=0]="solo",BroadcastType[BroadcastType.couple=1]="couple",BroadcastType[BroadcastType.male_female_group=2]="male_female_group",BroadcastType[BroadcastType.male_group=3]="male_group",BroadcastType[BroadcastType.female_group=4]="female_group",BroadcastType[BroadcastType.party=5]="party"}(BroadcastType||(BroadcastType={}));var CamType;!function(CamType){CamType[CamType.standard=0]="standard",CamType[CamType.valentinesDay=1]="valentinesDay",CamType[CamType.standardAd=2]="standardAd",CamType[CamType.summerSale=3]="summerSale",CamType[CamType.olympicGold=4]="olympicGold",CamType[CamType.goldBonusTokens=5]="goldBonusTokens"}(CamType||(CamType={}));var CampaignsForAll;!function(CampaignsForAll){CampaignsForAll[CampaignsForAll.SUMMER_TOKENS=0]="SUMMER_TOKENS",CampaignsForAll[CampaignsForAll.BONUS_TOKENS=1]="BONUS_TOKENS"}(CampaignsForAll||(CampaignsForAll={}));var NewShowType;!function(NewShowType){NewShowType[NewShowType.NORMAL=0]="NORMAL",NewShowType[NewShowType.PRIVATE_SHOW=1]="PRIVATE_SHOW",NewShowType[NewShowType.GROUP_SHOW=2]="GROUP_SHOW",NewShowType[NewShowType.GROUP_SHOW_SELLING_TICKETS=3]="GROUP_SHOW_SELLING_TICKETS"}(NewShowType||(NewShowType={}));var CamsListing;!function(CamsListing){var Cam=function(){return function(cam){for(var key in cam)cam.hasOwnProperty(key)&&(this[key]=m.prop(cam[key]));this.hasOwnProperty("type")||(this.type=m.prop(CamType.standard)),this.hasOwnProperty("profileThumbnailId")||(this.profileThumbnailId=m.prop(0)),this.hasOwnProperty("broadcastType")?this.broadcastType=m.prop(BroadcastType[this.broadcastType()]):this.broadcastType=m.prop(BroadcastType.solo),this.hasOwnProperty("sexPreference")||(this.sexPreference=m.prop(SexualPreference.unknown)),this.hasOwnProperty("newPerformer")||(this.newPerformer=m.prop(!1)),this.hasOwnProperty("kiiroo")||(this.kiiroo=m.prop(!1)),this.hasOwnProperty("resolution")||(this.resolution=m.prop("")),this.hasOwnProperty("mbaVersion")||(this.mbaVersion=m.prop("")),this.hasOwnProperty("hlsPreviewUrl")||(this.hlsPreviewUrl=m.prop("")),this.hasOwnProperty("rec")||(this.rec=m.prop(!1)),this.showType(NewShowType[this.showType()])}}();CamsListing.Cam=Cam;var Model=function(){function Model(){var _this=this;this.list=new Array,this.add=function(_cam){_this.list.push(new Cam(_cam))},this.length=function(){return _this.list.length},this.splice=function(a,b){return _this.list.splice(a,b)}}return Model.prototype.getAll=function(){return this.list},Model}(),Controller=function(){return function(args){var _this=this;this.args=args,this.cams=new Model,this.onunload=function(){console.log("unloading cams component")},this.getAll=function(){return _this.cams.getAll()},this.add=function(cam){_this.cams.add(cam)},this.genderOneLetter=function(gender,broadcastType){var genders={female:"f",male:"m",shemale:"t",unknown:"u"};return broadcastType!=BroadcastType.solo?"c":genders.hasOwnProperty(gender)?genders[gender]:"u"},this.broadcastTime=function(broadcastDuration){return new Date((new Date).getTime()-broadcastDuration).getMinutes()},args.cams.map(function(cam){_this.add(cam)})}}();CamsListing.controller=function(args){return new Controller(args)},CamsListing.view=function(ctrl,args){function generateHashtags(status){return status.replace(/[#]+[A-Za-z0-9-_]+/g,function(tag){return['<a class="show-tags" href="/tags/',tag.replace("#",""),'">',tag,"</a>"].join("")})}function countryFlagView(country){return m("span",{class:"country"},[m("img",{src:BLANK_IMG,class:"flag flag-"+country,alt:country,title:country})])}function sexualOrientationView(gender,orientation,broadcastType){var genderShort=ctrl.genderOneLetter(gender,broadcastType);return m("div",{class:"sexnorientation"},[m("img",{src:BLANK_IMG,class:"align-top gender gender-"+genderShort,alt:gender,title:gender}),m("span",{class:"orientation"},orientation)])}function broadcastStatsView(cam){return m("div",{class:"broadcastTime"},[m("span",{class:"timeContainer"},[m("img",{src:BLANK_IMG,class:"align-top stats time",alt:"Broadcast time",title:"Broadcast time"}),m("span",{},[]," "+ctrl.broadcastTime(cam.broadcastTime())+"m ")]),m("span",{class:"viewers"},cam.viewers())])}function profileStatus(cam){var status=cam.statusMessage();return status.length?m("div",{class:"statusMsg2"},[m.trust(generateHashtags(status))]):[]}function profileDetailsView(cam){return m("div",{class:"profileDetailBox clearfix"},[m("div",{class:"profileBoxTitle"},[m("a",{href:"/"+cam.username().toLowerCase()},cam.username())]),m("div",{class:"profileDetailArea"},[countryFlagView(cam.countryCode()),sexualOrientationView(cam.gender(),cam.sexPreference(),cam.broadcastType()),broadcastStatsView(cam)])])}function showTypeView(showType){return~[NewShowType.GROUP_SHOW_SELLING_TICKETS,NewShowType.GROUP_SHOW].indexOf(showType)?m("span",{class:"inPrivateKey groupShow"}):[]}function privateShowView(cam){return cam.goldPartyWinner()?m("div",{class:"sticker-icon show_sticker"},[m("div",{class:"gold_party_winner"},directoryInt.goldExclusive)]):cam.showType()===NewShowType.PRIVATE_SHOW?m("div",{class:"banner private-show"},directoryInt.inPrivateShow):[]}function camTypeView(cam){return cam.vrStream()?m("div",{class:"vrStreamIcon"}):cam.hdStream()?m("div",{class:"cameraStat cameraStatHD"}):[]}function awardView(dailyAward,monthlyAward){return dailyAward||monthlyAward?m("div",{class:"sticker-icon award_sticker"},m("div",{class:"award_gold",title:"award winner"})):[]}function newTagView(newPerformer){if(newPerformer)return m("span",{class:"new-tag"},[m("span",{class:"glyphicon glyphicon-asterisk"}),"New!"])}function sourceView(source){return"mobile"===source?m("div",{class:"sticker-icon mobile-broadcast"},m("div",{class:"mobile-icon",title:"Mobile broadcast"})):[]}function kiirooView(kiiroo){return kiiroo?m("div",{class:"kiirooIcon"}):[]}function adCam(cam){return[m("div",{class:["profileBox","promo-ad",cam.ad().classes,Cam4User.lang].join(" "),onclick:function(){var callback,onClick=cam.ad().onClick;switch(onClick){case"popTokens":callback=TipFactory[onClick];break;default:callback=Registration[onClick]}"function"==typeof callback&&callback(),ctrl.pushGTMEvent()}},[m("div",{class:"profileDataBox"},[m("a",[m("img",{src:BLANK_IMG,width:120,height:90})]),m("div",{class:"profileDetailBox"})])])]}function camType(cam){switch(cam.type()){case CamType.valentinesDay:case CamType.standardAd:case CamType.summerSale:case CamType.olympicGold:case CamType.goldBonusTokens:return adCam(cam);case CamType.standard:default:return standardCam(cam)}}function getAspectRatioClass(cam){var resolution=cam.resolution().split(":"),width=resolution[0],height=resolution[1];return cam.vrStream()&&(height>width?height/=2:width/=2),width/height>=1?"wide-thumbnails":"portrait-thumbnails"}function standardCam(cam){return[m("div",{class:"profileBox"},[m("div",{class:"profileDataBox "+(cam.rec()?"recEng ":"")+getAspectRatioClass(cam),opacity:0,config:function(element,isInitialized,ctx){isInitialized||"undefined"!=typeof DirectoryPreviewHLS&&DirectoryPreviewHLS.load(element)}},[newTagView(cam.newPerformer()),m("a",{href:"/"+cam.username(),class:"profile-preview","data-profile-preview":"true",style:"display:none","data-hls-preview-url":cam.hlsPreviewUrl()},[m("video",{id:"inlinepreview_segment_"+(new Date).getTime()+"_"+cam.username(),muted:"",loop:"","data-setup":"{}",class:"video-js profile-preview "+(cam.vrStream()?"vrPreview ":"")+("mobile"===cam.source()?"mobilePreview ":""),autoplay:""})]),m("a",{href:"/"+cam.username(),class:"loading clearfix"},[m("img",{src:BLANK_IMG,class:"profile-thumb",width:"120",height:"90","data-thumbs":cam.snapshotThumbnailIds(),key:cam.userId(),config:function(element,isInitialized,ctx){if(!isInitialized){var snapshots=~[NewShowType.GROUP_SHOW,NewShowType.PRIVATE_SHOW].indexOf(cam.showType())||cam.privateRoom()?[]:cam.snapshotThumbnailIds();SFW?ctx.snapshot=new DirectorySnapshot(element,null,[],cam.snapshotImageLink(),cam.profileImageLinkSFW(),cam.defaultImageLink(),cam.thumbnailId(),cam.username(),cam.gender(),function(){"undefined"!=typeof SearchDirectory&&SearchDirectory.cycleImage($j(element))}):ctx.snapshot=new DirectorySnapshot(element,null,snapshots,cam.snapshotImageLink(),cam.profileImageLink(),cam.defaultImageLink(),cam.thumbnailId(),cam.username(),cam.gender(),function(){"undefined"!=typeof SearchDirectory&&SearchDirectory.cycleImage($j(element))})}}}),UserAgent.desktop?m("div",{class:"fade"}):""]),privateShowView(cam),profileStatus(cam),m("div",{class:"icon-wrp"},kiirooView(cam.kiiroo()),awardView(cam.dailyAward(),cam.monthlyAward()),showTypeView(cam.showType()),sourceView(cam.source()),camTypeView(cam)),profileDetailsView(cam)])])]}var BLANK_IMG=WEB_CDN+"/images/blank.gif";return ctrl.getAll().length<args.minimumCamsToDisplay?[]:["headerView"in args?args.headerView(ctrl):[],m("div",{class:"cams-wrapper clearfix",config:function(element,isInitialized){isInitialized||Cam4Event.dispatch("segmentLoaded",args.key)}},[ctrl.getAll().slice(0,args.numberOfCams).map(function(cam){return camType(cam)})])]}}(CamsListing||(CamsListing={}));var RecentlyWatched;!function(RecentlyWatched){var Listing=function(){function Listing(){var _this=this,store=new RecentlyWatched.Store;RequestParameters.isDirectory&&RecentlyWatched.Listing.getCams(store.get()).then(function(cams){_this.cams=cams,_this.mountCams()})}return Object.defineProperty(Listing,"REQUEST_URL",{get:function(){return"/getBroadcasting"},enumerable:!0,configurable:!0}),Listing.prototype.mountCams=function(){var container=document.getElementById("recent-cams");!UserAgent.phone&&container&&(this.camsComponent=m.component(CamsListing,{cams:this.cams,headerView:function(ctrl){return m("div",{class:"seg-title"},[m("span",directoryInt.recentlyWatched)])},numberOfCams:20,minimumCamsToDisplay:3}),this.camsModule=m.module(container,this.camsComponent))},Listing.getCams=function(usernames){return m.request({url:Listing.REQUEST_URL,data:{usernames:usernames.join(",")}})},Listing}();RecentlyWatched.Listing=Listing;var Store=function(){function Store(){this.STORE_KEY="cam4_recently_watched",this.LIMIT=50;var users,usernameStorage=Cam4Storage.get(this.STORE_KEY);usernameStorage?((users=JSON.parse(usernameStorage)).length>this.LIMIT&&users.splice(this.LIMIT),this.usernames=users):this.usernames=[],"undefined"!=typeof mN&&this.add(mN)}return Store.prototype.get=function(){return this.usernames},Store.prototype.add=function(username){this.isDuplicate(username)&&this.usernames.splice(this.usernames.indexOf(username),1),this.usernames.unshift(username),this.update()},Store.prototype.update=function(){Cam4Storage.set(this.STORE_KEY,JSON.stringify(this.usernames))},Store.prototype.isDuplicate=function(username){return~this.usernames.indexOf(username)},Store}();RecentlyWatched.Store=Store}(RecentlyWatched||(RecentlyWatched={})),jQuery(function(){new RecentlyWatched.Listing});
var FavoritesForGold={camsComponent:"",camsModule:"",cams:[],offset:"",hasNext:!1,hasPrevious:!1,prevOffset:"",nextOffset:"",usersPerPage:4,refreshInterval:6e4,getFavorites:function(){m.request({method:"GET",url:"/profile/favoritesForGolds?broadcaster="+Cam4User.performerName+FavoritesForGold.offset}).then(function(response){FavoritesForGold.handleResponse(response)})},handleResponse:function(response){var favorites=JSON.parse(response.favorites);this.hasNext=!1,favorites.length&&(this.hasNext=response.hasNext,this.hasPrevious=response.hasPrevious,this.usersPerPage=response.usersPerPage,this.prevOffset=response.prevOffset,this.nextOffset=response.nextOffset,this.deleteCams(),favorites.map(function(cam){FavoritesForGold.cams.push(cam)}),this.mountCams(this.cams))},mountCams:function(cams){this.camsComponent=m.component(CamsListing,{cams:cams,headerView:this.headerView,numberOfCams:8,minimumCamsToDisplay:1}),this.camsModule=m.module(document.getElementById("favoritesForGolds").getElementsByClassName("multicamWrap_mini")[0],this.camsComponent)},deleteCams:function(){this.cams=[]},changePage:function(offset){this.offset="&offset="+offset,this.getFavorites()},headerView:function(){return[m("div",{class:"multiCamHeader"},FavoritesForGold.hasPrevious?m("div",{class:"leftButtonArrw",onclick:function(){FavoritesForGold.changePage(FavoritesForGold.prevOffset)}}):"",FavoritesForGold.hasNext?m("div",{class:"rightButtonArrw",onclick:function(){FavoritesForGold.changePage(FavoritesForGold.nextOffset)}}):"",m("p",{},js_i18n.favoriteCams),"("+js_i18n.onlineNow+")")]}};window.addEventListener("load",function(){document.getElementById("favoritesForGolds")&&(FavoritesForGold.getFavorites(),setInterval(function(){FavoritesForGold.getFavorites()},FavoritesForGold.refreshInterval))});
var SnapshotsLogger=function(){function sendDataToLoggerServer(server,data){var request=$.ajax({url:server,type:"POST",data:JSON.stringify(data),contentType:"application/json",timeout:RETRY_SEND_TIMEOUT});request.done(function(){_pendingResponse=!1}),request.fail(function(){_pendingResponse=!1,totalSnapshots+=data.totalSnapshots,failedSnapshots+=data.errorCount,successSnapshots+=data.successCount,totalTimeToLoad+=data.totalTimeToLoad})}function prepareData(){if(!(!0===_pendingResponse||totalSnapshots<5)){var dataToSend={username:Cam4User.username,errorCount:failedSnapshots,successCount:successSnapshots,totalSnapshots:totalSnapshots,totalTimeToLoad:totalTimeToLoad,loadTime:totalTimeToLoad/totalSnapshots,useOogler:ControlledFeatures.USE_SNAPSHOTS_API&&!SFW};_pendingResponse=!0,totalSnapshots=failedSnapshots=successSnapshots=totalTimeToLoad=0,sendDataToLoggerServer(_loggingServer,dataToSend)}}var _loggingServer="",_pendingResponse=!1,RETRY_SEND_TIMEOUT=5e3,totalSnapshots=0,failedSnapshots=0,successSnapshots=0,totalTimeToLoad=0;return{init:function(server){Cam4User.userAcceptedSexualProfiling&&server&&""!==server&&(_loggingServer=server,setInterval(prepareData,RETRY_SEND_TIMEOUT))},logSnapshotFail:function(timeToLoad){totalSnapshots++,failedSnapshots++,totalTimeToLoad+=timeToLoad},logSnapshotSuccess:function(timeToLoad){totalSnapshots++,successSnapshots++,totalTimeToLoad+=timeToLoad}}}();SnapshotsLogger.init(SNAPSHOTS_LOGGER_SERVER);
